<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "https://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml" lang="en-US">
<head>
<meta http-equiv="Content-Type" content="text/xhtml;charset=UTF-8"/>
<meta http-equiv="X-UA-Compatible" content="IE=11"/>
<meta name="generator" content="Doxygen 1.9.6"/>
<meta name="viewport" content="width=device-width, initial-scale=1"/>
<title>DynoSAM: dyno::vision_tools Namespace Reference</title>
<link href="tabs.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="jquery.js"></script>
<script type="text/javascript" src="dynsections.js"></script>
<link href="search/search.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="search/searchdata.js"></script>
<script type="text/javascript" src="search/search.js"></script>
<link href="doxygen.css" rel="stylesheet" type="text/css" />
</head>
<body>
<div id="top"><!-- do not remove this div, it is closed by doxygen! -->
<div id="titlearea">
<table cellspacing="0" cellpadding="0">
 <tbody>
 <tr id="projectrow">
  <td id="projectalign">
   <div id="projectname">DynoSAM
   </div>
   <div id="projectbrief">Dynamic Object Smoothing and Mapping for Dynamic SLAM</div>
  </td>
 </tr>
 </tbody>
</table>
</div>
<!-- end header part -->
<!-- Generated by Doxygen 1.9.6 -->
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:d3d9a9a6595521f9666a5e94cc830dab83b65699&amp;dn=expat.txt MIT */
var searchBox = new SearchBox("searchBox", "search/",'.html');
/* @license-end */
</script>
<script type="text/javascript" src="menudata.js"></script>
<script type="text/javascript" src="menu.js"></script>
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:d3d9a9a6595521f9666a5e94cc830dab83b65699&amp;dn=expat.txt MIT */
$(function() {
  initMenu('',true,false,'search.php','Search');
  $(document).ready(function() { init_search(); });
});
/* @license-end */
</script>
<div id="main-nav"></div>
<!-- window showing the filter options -->
<div id="MSearchSelectWindow"
     onmouseover="return searchBox.OnSearchSelectShow()"
     onmouseout="return searchBox.OnSearchSelectHide()"
     onkeydown="return searchBox.OnSearchSelectKey(event)">
</div>

<!-- iframe showing the search results (closed by default) -->
<div id="MSearchResultsWindow">
<div id="MSearchResults">
<div class="SRPage">
<div id="SRIndex">
<div id="SRResults"></div>
<div class="SRStatus" id="Loading">Loading...</div>
<div class="SRStatus" id="Searching">Searching...</div>
<div class="SRStatus" id="NoMatches">No Matches</div>
</div>
</div>
</div>
</div>

<div id="nav-path" class="navpath">
  <ul>
<li class="navelem"><a class="el" href="namespacedyno.html">dyno</a></li><li class="navelem"><a class="el" href="namespacedyno_1_1vision__tools.html">vision_tools</a></li>  </ul>
</div>
</div><!-- top -->
<div class="header">
  <div class="summary">
<a href="#func-members">Functions</a>  </div>
  <div class="headertitle"><div class="title">dyno::vision_tools Namespace Reference</div></div>
</div><!--header-->
<div class="contents">
<table class="memberdecls">
<tr class="heading"><td colspan="2"><h2 class="groupheader"><a id="func-members" name="func-members"></a>
Functions</h2></td></tr>
<tr class="memitem:ac7721b6e34c712cd9d194afe30dec47c"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="namespacedyno_1_1vision__tools.html#ac7721b6e34c712cd9d194afe30dec47c">getCorrespondences</a> (<a class="el" href="namespacedyno.html#a7ec6a986cfe4a517505dd137d0844e7c">FeaturePairs</a> &amp;correspondences, const <a class="el" href="namespacedyno.html#aeaa15616abde5162319c97576823c59a">FeatureFilterIterator</a> &amp;previous_features, const <a class="el" href="namespacedyno.html#aeaa15616abde5162319c97576823c59a">FeatureFilterIterator</a> &amp;current_features)</td></tr>
<tr class="separator:ac7721b6e34c712cd9d194afe30dec47c"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a3a09fe6c15aeb5e18979dc27d68c4616"><td class="memItemLeft" align="right" valign="top"><a class="el" href="namespacedyno.html#ae777b079c377ffa066d89051ee0cc623">ObjectIds</a>&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="namespacedyno_1_1vision__tools.html#a3a09fe6c15aeb5e18979dc27d68c4616">getObjectLabels</a> (const cv::Mat &amp;image)</td></tr>
<tr class="memdesc:a3a09fe6c15aeb5e18979dc27d68c4616"><td class="mdescLeft">&#160;</td><td class="mdescRight">Finds the unique object labels (j) as present in the instance segmentation image. Does not include the background label.  <br /></td></tr>
<tr class="separator:a3a09fe6c15aeb5e18979dc27d68c4616"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a70f3daa5a2a0fb3a715ffb1fb65992cb"><td class="memItemLeft" align="right" valign="top">std::vector&lt; std::vector&lt; int &gt; &gt;&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="namespacedyno_1_1vision__tools.html#a70f3daa5a2a0fb3a715ffb1fb65992cb">trackDynamic</a> (const <a class="el" href="structdyno_1_1FrontendParams.html">FrontendParams</a> &amp;params, const <a class="el" href="classdyno_1_1Frame.html">Frame</a> &amp;previous_frame, Frame::Ptr current_frame)</td></tr>
<tr class="memdesc:a70f3daa5a2a0fb3a715ffb1fb65992cb"><td class="mdescLeft">&#160;</td><td class="mdescRight">Depricate ;)  <br /></td></tr>
<tr class="separator:a70f3daa5a2a0fb3a715ffb1fb65992cb"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a518b3162f275ce3e2301d249a7e1a6ff"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="namespacedyno_1_1vision__tools.html#a518b3162f275ce3e2301d249a7e1a6ff">shrinkMask</a> (const cv::Mat &amp;mask, cv::Mat &amp;shrunk_mask, int erosion_size)</td></tr>
<tr class="memdesc:a518b3162f275ce3e2301d249a7e1a6ff"><td class="mdescLeft">&#160;</td><td class="mdescRight">Shrinks all found object masks by a given ammount.  <br /></td></tr>
<tr class="separator:a518b3162f275ce3e2301d249a7e1a6ff"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a01601f2fba95a79f4ecaa11b89286d99"><td class="memItemLeft" align="right" valign="top">bool&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="namespacedyno_1_1vision__tools.html#a01601f2fba95a79f4ecaa11b89286d99">findObjectBoundingBox</a> (const cv::Mat &amp;mask, <a class="el" href="namespacedyno.html#a38bb86e4154b86428b8d133be03fb2b5">ObjectId</a> object_id, cv::Rect &amp;detected_rect, std::vector&lt; std::vector&lt; cv::Point &gt; &gt; &amp;detected_contours)</td></tr>
<tr class="memdesc:a01601f2fba95a79f4ecaa11b89286d99"><td class="mdescLeft">&#160;</td><td class="mdescRight">From a instance/semantic mask type img, construct the bounding box for the mask of object_id.  <br /></td></tr>
<tr class="separator:a01601f2fba95a79f4ecaa11b89286d99"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a46d0411291384b813e022cf32c66a82b"><td class="memItemLeft" align="right" valign="top">bool&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="namespacedyno_1_1vision__tools.html#a46d0411291384b813e022cf32c66a82b">findObjectBoundingBox</a> (const cv::Mat &amp;mask, <a class="el" href="namespacedyno.html#a38bb86e4154b86428b8d133be03fb2b5">ObjectId</a> object_id, cv::Rect &amp;detected_rect)</td></tr>
<tr class="memdesc:a46d0411291384b813e022cf32c66a82b"><td class="mdescLeft">&#160;</td><td class="mdescRight">From a instance/semantic mask type img, construct the bounding box for the mask of object_id.  <br /></td></tr>
<tr class="separator:a46d0411291384b813e022cf32c66a82b"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a351551c72ca4e39c5c9e0185ecde00b7"><td class="memItemLeft" align="right" valign="top">bool&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="namespacedyno_1_1vision__tools.html#a351551c72ca4e39c5c9e0185ecde00b7">findObjectBoundingBox</a> (const cv::Mat &amp;mask, <a class="el" href="namespacedyno.html#a38bb86e4154b86428b8d133be03fb2b5">ObjectId</a> object_id, std::vector&lt; std::vector&lt; cv::Point &gt; &gt; &amp;detected_contours)</td></tr>
<tr class="memdesc:a351551c72ca4e39c5c9e0185ecde00b7"><td class="mdescLeft">&#160;</td><td class="mdescRight">From a instance/semantic mask type img, construct the bounding box for the mask of object_id.  <br /></td></tr>
<tr class="separator:a351551c72ca4e39c5c9e0185ecde00b7"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a2c6285cb428d1df8a2ea1071d9a06757"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="namespacedyno_1_1vision__tools.html#a2c6285cb428d1df8a2ea1071d9a06757">computeObjectMaskBoundaryMask</a> (const cv::Mat &amp;mask, cv::Mat &amp;boundary_mask, int thickness, bool use_as_feature_detection_mask=true)</td></tr>
<tr class="memdesc:a2c6285cb428d1df8a2ea1071d9a06757"><td class="mdescLeft">&#160;</td><td class="mdescRight">From an input instance/semantic mask type img construct a image mask (binary) that has True values around each object in the image, with a certain thickness.  <br /></td></tr>
<tr class="separator:a2c6285cb428d1df8a2ea1071d9a06757"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ae077e5d2722435f6731a8f58e3aab848"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="namespacedyno_1_1vision__tools.html#ae077e5d2722435f6731a8f58e3aab848">relabelMasks</a> (const cv::Mat &amp;mask, cv::Mat &amp;relabelled_mask, const <a class="el" href="namespacedyno.html#ae777b079c377ffa066d89051ee0cc623">ObjectIds</a> &amp;old_labels, const <a class="el" href="namespacedyno.html#ae777b079c377ffa066d89051ee0cc623">ObjectIds</a> &amp;new_labels)</td></tr>
<tr class="separator:ae077e5d2722435f6731a8f58e3aab848"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a299ddb654abf59383dcf29f7b013ba6f"><td class="memItemLeft" align="right" valign="top">gtsam::FastMap&lt; <a class="el" href="namespacedyno.html#a38bb86e4154b86428b8d133be03fb2b5">ObjectId</a>, <a class="el" href="classdyno_1_1Histogram.html">Histogram</a> &gt;&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="namespacedyno_1_1vision__tools.html#a299ddb654abf59383dcf29f7b013ba6f">makeTrackletLengthHistorgram</a> (const Frame::Ptr frame, const std::vector&lt; size_t &gt; &amp;bins={0, 1, 2, 3, 5, 7, 10, 15, 25, 40, 60, std::numeric_limits&lt; size_t &gt;::max()})</td></tr>
<tr class="memdesc:a299ddb654abf59383dcf29f7b013ba6f"><td class="mdescLeft">&#160;</td><td class="mdescRight">Constructs a map of histograms (static features: 0, one for each dynamic object) containing the tracklet length at this frame.  <br /></td></tr>
<tr class="separator:a299ddb654abf59383dcf29f7b013ba6f"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:aaabcfcca356f30c83a45a51259e39783"><td class="memItemLeft" align="right" valign="top">cv::Mat&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="namespacedyno_1_1vision__tools.html#aaabcfcca356f30c83a45a51259e39783">depthTo3D</a> (const <a class="el" href="structdyno_1_1ImageWrapper.html">ImageWrapper</a>&lt; <a class="el" href="structdyno_1_1ImageType_1_1Depth.html">ImageType::Depth</a> &gt; &amp;depth_image, const cv::Mat &amp;K)</td></tr>
<tr class="memdesc:aaabcfcca356f30c83a45a51259e39783"><td class="mdescLeft">&#160;</td><td class="mdescRight">Projects a dense depth map to 3D coordinates in the local frame.  <br /></td></tr>
<tr class="separator:aaabcfcca356f30c83a45a51259e39783"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a5d8b89d2b560b498934853c77a7d9f28"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="namespacedyno_1_1vision__tools.html#a5d8b89d2b560b498934853c77a7d9f28">writeOutProjectMaskAndDepthMap</a> (const <a class="el" href="structdyno_1_1ImageWrapper.html">ImageWrapper</a>&lt; <a class="el" href="structdyno_1_1ImageType_1_1Depth.html">ImageType::Depth</a> &gt; &amp;depth_image, const <a class="el" href="structdyno_1_1ImageWrapper.html">ImageWrapper</a>&lt; <a class="el" href="structdyno_1_1ImageType_1_1SemanticMask.html">ImageType::SemanticMask</a> &gt; &amp;mask_image, const <a class="el" href="classdyno_1_1Camera.html">Camera</a> &amp;camera, <a class="el" href="namespacedyno.html#ac4303d6fafb755f794b072d76f9cfb41">FrameId</a> frame_id)</td></tr>
<tr class="memdesc:a5d8b89d2b560b498934853c77a7d9f28"><td class="mdescLeft">&#160;</td><td class="mdescRight">Saves a re-projected 3D point cloud with labelled points to file as a cv::Mat.  <br /></td></tr>
<tr class="separator:a5d8b89d2b560b498934853c77a7d9f28"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a8cf2c16aa30d7bfa4ea4844abb555716"><td class="memItemLeft" align="right" valign="top">std::pair&lt; gtsam::Vector3, gtsam::Matrix3 &gt;&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="namespacedyno_1_1vision__tools.html#a8cf2c16aa30d7bfa4ea4844abb555716">backProjectAndCovariance</a> (const <a class="el" href="classdyno_1_1Feature.html">Feature</a> &amp;feature, const <a class="el" href="classdyno_1_1Camera.html">Camera</a> &amp;camera, double pixel_sigma, double depth_sigma)</td></tr>
<tr class="memdesc:a8cf2c16aa30d7bfa4ea4844abb555716"><td class="mdescLeft">&#160;</td><td class="mdescRight">From a feature with valid depth, backproject to a 3D point in the camera frame with the associated covariance (3x3) matrix.  <br /></td></tr>
<tr class="separator:a8cf2c16aa30d7bfa4ea4844abb555716"><td class="memSeparator" colspan="2">&#160;</td></tr>
</table>
<h2 class="groupheader">Function Documentation</h2>
<a id="a8cf2c16aa30d7bfa4ea4844abb555716" name="a8cf2c16aa30d7bfa4ea4844abb555716"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a8cf2c16aa30d7bfa4ea4844abb555716">&#9670;&#160;</a></span>backProjectAndCovariance()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">std::pair&lt; gtsam::Vector3, gtsam::Matrix3 &gt; dyno::vision_tools::backProjectAndCovariance </td>
          <td>(</td>
          <td class="paramtype">const <a class="el" href="classdyno_1_1Feature.html">Feature</a> &amp;&#160;</td>
          <td class="paramname"><em>feature</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const <a class="el" href="classdyno_1_1Camera.html">Camera</a> &amp;&#160;</td>
          <td class="paramname"><em>camera</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">double&#160;</td>
          <td class="paramname"><em>pixel_sigma</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">double&#160;</td>
          <td class="paramname"><em>depth_sigma</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>From a feature with valid depth, backproject to a 3D point in the camera frame with the associated covariance (3x3) matrix. </p>
<p>The measurement covariance matrix for the pixel measurement is obtanied directly as a 2x2 diagonal matrix from the pixel sigma and the measurement covariance for the depth is modelled as a quadratic cost where sigma = depth * depth_sgima^2.</p>
<p>The final covariance matrix is in the diagonal form [x,y,z]</p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">feature</td><td></td></tr>
    <tr><td class="paramname">camera</td><td></td></tr>
    <tr><td class="paramname">pixel_sigma</td><td></td></tr>
    <tr><td class="paramname">depth_sigma</td><td></td></tr>
  </table>
  </dd>
</dl>
<dl class="section return"><dt>Returns</dt><dd>std::pair&lt;gtsam::Vector3, gtsam::Matrix3&gt; </dd></dl>

<p class="definition">Definition at line <a class="el" href="VisionTools_8cc_source.html#l00672">672</a> of file <a class="el" href="VisionTools_8cc_source.html">VisionTools.cc</a>.</p>
<div class="fragment"><div class="line"><span class="lineno">  674</span>                        {</div>
<div class="line"><span class="lineno">  675</span>  <span class="keyword">const</span> <span class="keyword">auto</span> gtsam_camera = camera.<a class="code hl_function" href="classdyno_1_1Camera.html#afa242b874c0c1a185adb8d83a35171c8">getImplCamera</a>();</div>
<div class="line"><span class="lineno">  676</span>  <span class="keyword">const</span> <span class="keyword">auto</span> keypoint = feature.<a class="code hl_function" href="classdyno_1_1Feature.html#ada9f9980d950874a7a157a82b9921f8a">keypoint</a>();</div>
<div class="line"><span class="lineno">  677</span> </div>
<div class="line"><span class="lineno">  678</span>  CHECK(feature.<a class="code hl_function" href="classdyno_1_1Feature.html#ae7d554f489558630f69b617f82c24173">hasDepth</a>());</div>
<div class="line"><span class="lineno">  679</span>  <span class="keyword">const</span> <span class="keyword">auto</span> depth = feature.<a class="code hl_function" href="classdyno_1_1Feature.html#aa1dad2ea2a931bbccb56ae5b53822943">depth</a>();</div>
<div class="line"><span class="lineno">  680</span> </div>
<div class="line"><span class="lineno">  681</span>  gtsam::Matrix32 J_keypoint;</div>
<div class="line"><span class="lineno">  682</span>  gtsam::Matrix31 J_depth;</div>
<div class="line"><span class="lineno">  683</span>  gtsam::Point3 landmark = gtsam_camera-&gt;backproject(</div>
<div class="line"><span class="lineno">  684</span>      keypoint, depth, boost::none, J_keypoint, J_depth, boost::none);</div>
<div class="line"><span class="lineno">  685</span> </div>
<div class="line"><span class="lineno">  686</span>  <span class="comment">// form measurement covariance matrices</span></div>
<div class="line"><span class="lineno">  687</span>  gtsam::Matrix22 pixel_covariance_matrix;</div>
<div class="line"><span class="lineno">  688</span>  pixel_covariance_matrix &lt;&lt; pixel_sigma, 0.0, 0.0, pixel_sigma;</div>
<div class="line"><span class="lineno">  689</span> </div>
<div class="line"><span class="lineno">  690</span>  <span class="comment">// for depth uncertainty, we model it as a quadratic increase with distnace</span></div>
<div class="line"><span class="lineno">  691</span>  <span class="keywordtype">double</span> depth_covariance = depth_sigma * std::pow(depth, 2);</div>
<div class="line"><span class="lineno">  692</span> </div>
<div class="line"><span class="lineno">  693</span>  <span class="comment">// calcualte 3x3 covairance matrix</span></div>
<div class="line"><span class="lineno">  694</span>  gtsam::Matrix33 covariance =</div>
<div class="line"><span class="lineno">  695</span>      J_keypoint * pixel_covariance_matrix * J_keypoint.transpose() +</div>
<div class="line"><span class="lineno">  696</span>      J_depth * depth_covariance * J_depth.transpose();</div>
<div class="line"><span class="lineno">  697</span>  <span class="keywordflow">return</span> {landmark, covariance};</div>
<div class="line"><span class="lineno">  698</span>}</div>
<div class="ttc" id="aclassdyno_1_1Camera_html_afa242b874c0c1a185adb8d83a35171c8"><div class="ttname"><a href="classdyno_1_1Camera.html#afa242b874c0c1a185adb8d83a35171c8">dyno::Camera::getImplCamera</a></div><div class="ttdeci">CameraImpl * getImplCamera() const</div><div class="ttdef"><b>Definition:</b> <a href="Camera_8hpp_source.html#l00161">Camera.hpp:161</a></div></div>
<div class="ttc" id="aclassdyno_1_1Feature_html_aa1dad2ea2a931bbccb56ae5b53822943"><div class="ttname"><a href="classdyno_1_1Feature.html#aa1dad2ea2a931bbccb56ae5b53822943">dyno::Feature::depth</a></div><div class="ttdeci">Depth depth() const</div><div class="ttdoc">Depth of this keypoint (will be Feature::invalid_depth is depth is not set).</div><div class="ttdef"><b>Definition:</b> <a href="Feature_8hpp_source.html#l00205">Feature.hpp:205</a></div></div>
<div class="ttc" id="aclassdyno_1_1Feature_html_ada9f9980d950874a7a157a82b9921f8a"><div class="ttname"><a href="classdyno_1_1Feature.html#ada9f9980d950874a7a157a82b9921f8a">dyno::Feature::keypoint</a></div><div class="ttdeci">Keypoint keypoint() const</div><div class="ttdoc">Gets keypoint observation.</div><div class="ttdef"><b>Definition:</b> <a href="Feature_8hpp_source.html#l00105">Feature.hpp:105</a></div></div>
<div class="ttc" id="aclassdyno_1_1Feature_html_ae7d554f489558630f69b617f82c24173"><div class="ttname"><a href="classdyno_1_1Feature.html#ae7d554f489558630f69b617f82c24173">dyno::Feature::hasDepth</a></div><div class="ttdeci">bool hasDepth() const</div><div class="ttdef"><b>Definition:</b> <a href="Feature_8hpp_source.html#l00322">Feature.hpp:322</a></div></div>
</div><!-- fragment -->
<p class="reference">References <a class="el" href="classdyno_1_1Feature.html#aa1dad2ea2a931bbccb56ae5b53822943">dyno::Feature::depth()</a>, <a class="el" href="classdyno_1_1Camera.html#afa242b874c0c1a185adb8d83a35171c8">dyno::Camera::getImplCamera()</a>, <a class="el" href="classdyno_1_1Feature.html#ae7d554f489558630f69b617f82c24173">dyno::Feature::hasDepth()</a>, and <a class="el" href="classdyno_1_1Feature.html#ada9f9980d950874a7a157a82b9921f8a">dyno::Feature::keypoint()</a>.</p>
<div class="dynheader">
Here is the call graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="namespacedyno_1_1vision__tools_a8cf2c16aa30d7bfa4ea4844abb555716_cgraph.png" border="0" usemap="#anamespacedyno_1_1vision__tools_a8cf2c16aa30d7bfa4ea4844abb555716_cgraph" alt=""/></div>
<map name="anamespacedyno_1_1vision__tools_a8cf2c16aa30d7bfa4ea4844abb555716_cgraph" id="anamespacedyno_1_1vision__tools_a8cf2c16aa30d7bfa4ea4844abb555716_cgraph">
<area shape="rect" title="From a feature with valid depth, backproject to a 3D point in the camera frame with the associated co..." alt="" coords="5,73,209,113"/>
<area shape="rect" href="classdyno_1_1Feature.html#aa1dad2ea2a931bbccb56ae5b53822943" title="Depth of this keypoint (will be Feature::invalid_depth is depth is not set)." alt="" coords="291,5,447,31"/>
<area shape="rect" href="classdyno_1_1Camera.html#afa242b874c0c1a185adb8d83a35171c8" title=" " alt="" coords="257,55,480,80"/>
<area shape="rect" href="classdyno_1_1Feature.html#ae7d554f489558630f69b617f82c24173" title=" " alt="" coords="278,104,459,129"/>
<area shape="rect" href="classdyno_1_1Feature.html#ada9f9980d950874a7a157a82b9921f8a" title="Gets keypoint observation." alt="" coords="281,153,456,179"/>
</map>
</div>

</div>
</div>
<a id="a2c6285cb428d1df8a2ea1071d9a06757" name="a2c6285cb428d1df8a2ea1071d9a06757"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a2c6285cb428d1df8a2ea1071d9a06757">&#9670;&#160;</a></span>computeObjectMaskBoundaryMask()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void dyno::vision_tools::computeObjectMaskBoundaryMask </td>
          <td>(</td>
          <td class="paramtype">const cv::Mat &amp;&#160;</td>
          <td class="paramname"><em>mask</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">cv::Mat &amp;&#160;</td>
          <td class="paramname"><em>boundary_mask</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int&#160;</td>
          <td class="paramname"><em>thickness</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">bool&#160;</td>
          <td class="paramname"><em>use_as_feature_detection_mask</em> = <code>true</code>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>From an input instance/semantic mask type img construct a image mask (binary) that has True values around each object in the image, with a certain thickness. </p>
<p>This is used to mark all points intside the mask as invalid and should not be tracked. Like any mask used for an feature detector the output mask is a 8-bit integer matrix with non-zero values in the region of interest.</p>
<p>When use_as_feature_detection_mask is True, all pixels inside the thicc boarder are set to zero, and all other values are 255. If this argument is False, the opposite is true (pixels inside the boarder are 255 and others are set to 0)</p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">mask</td><td></td></tr>
    <tr><td class="paramname">boundary_mask</td><td></td></tr>
    <tr><td class="paramname">thickness</td><td></td></tr>
    <tr><td class="paramname">use_as_feature_detection_mask.</td><td>Default is true. </td></tr>
  </table>
  </dd>
</dl>

<p class="definition">Definition at line <a class="el" href="VisionTools_8cc_source.html#l00515">515</a> of file <a class="el" href="VisionTools_8cc_source.html">VisionTools.cc</a>.</p>
<div class="fragment"><div class="line"><span class="lineno">  517</span>                                                                       {</div>
<div class="line"><span class="lineno">  518</span>  cv::Mat thicc_boarder;  <span class="comment">// god im so funny</span></div>
<div class="line"><span class="lineno">  519</span>  cv::Scalar fill_colour;</div>
<div class="line"><span class="lineno">  520</span> </div>
<div class="line"><span class="lineno">  521</span>  <span class="comment">// background should be 255 as we&#39;re can detect in this region and boarder</span></div>
<div class="line"><span class="lineno">  522</span>  <span class="comment">// region should be zero</span></div>
<div class="line"><span class="lineno">  523</span>  <span class="keywordflow">if</span> (use_as_feature_detection_mask) {</div>
<div class="line"><span class="lineno">  524</span>    thicc_boarder = cv::Mat(mask.size(), CV_8U, cv::Scalar(255));</div>
<div class="line"><span class="lineno">  525</span>    fill_colour = cv::Scalar(0);</div>
<div class="line"><span class="lineno">  526</span>  } <span class="keywordflow">else</span> {</div>
<div class="line"><span class="lineno">  527</span>    thicc_boarder = cv::Mat(mask.size(), CV_8U, cv::Scalar(0));</div>
<div class="line"><span class="lineno">  528</span>    fill_colour = cv::Scalar(255);</div>
<div class="line"><span class="lineno">  529</span>  }</div>
<div class="line"><span class="lineno">  530</span> </div>
<div class="line"><span class="lineno">  531</span>  <span class="keyword">const</span> ObjectIds instance_labels = vision_tools::getObjectLabels(mask);</div>
<div class="line"><span class="lineno">  532</span>  <span class="keywordflow">for</span> (<span class="keyword">const</span> <span class="keyword">auto</span> object_id : instance_labels) {</div>
<div class="line"><span class="lineno">  533</span>    std::vector&lt;std::vector&lt;cv::Point&gt;&gt; detected_contours;</div>
<div class="line"><span class="lineno">  534</span>    vision_tools::findObjectBoundingBox(mask, object_id, detected_contours);</div>
<div class="line"><span class="lineno">  535</span> </div>
<div class="line"><span class="lineno">  536</span>    cv::drawContours(thicc_boarder, detected_contours, -1, fill_colour,</div>
<div class="line"><span class="lineno">  537</span>                     thickness);</div>
<div class="line"><span class="lineno">  538</span>  }</div>
<div class="line"><span class="lineno">  539</span> </div>
<div class="line"><span class="lineno">  540</span>  boundary_mask = thicc_boarder;</div>
<div class="line"><span class="lineno">  541</span>}</div>
</div><!-- fragment -->
<p class="reference">References <a class="el" href="namespacedyno_1_1vision__tools.html#a01601f2fba95a79f4ecaa11b89286d99">findObjectBoundingBox()</a>, and <a class="el" href="namespacedyno_1_1vision__tools.html#a3a09fe6c15aeb5e18979dc27d68c4616">getObjectLabels()</a>.</p>

<p class="reference">Referenced by <a class="el" href="classdyno_1_1FeatureTracker.html#a23296ac35b5935656d31a18450dc5e4c">dyno::FeatureTracker::track()</a>.</p>
<div class="dynheader">
Here is the call graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="namespacedyno_1_1vision__tools_a2c6285cb428d1df8a2ea1071d9a06757_cgraph.png" border="0" usemap="#anamespacedyno_1_1vision__tools_a2c6285cb428d1df8a2ea1071d9a06757_cgraph" alt=""/></div>
<map name="anamespacedyno_1_1vision__tools_a2c6285cb428d1df8a2ea1071d9a06757_cgraph" id="anamespacedyno_1_1vision__tools_a2c6285cb428d1df8a2ea1071d9a06757_cgraph">
<area shape="rect" title="From an input instance/semantic mask type img construct a image mask (binary) that has True values ar..." alt="" coords="5,37,267,77"/>
<area shape="rect" href="namespacedyno_1_1vision__tools.html#a01601f2fba95a79f4ecaa11b89286d99" title="From a instance/semantic mask type img, construct the bounding box for the mask of object_id." alt="" coords="315,5,497,45"/>
<area shape="rect" href="namespacedyno_1_1vision__tools.html#a3a09fe6c15aeb5e18979dc27d68c4616" title="Finds the unique object labels (j) as present in the instance segmentation image. Does not include th..." alt="" coords="336,69,476,109"/>
</map>
</div>
<div class="dynheader">
Here is the caller graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="namespacedyno_1_1vision__tools_a2c6285cb428d1df8a2ea1071d9a06757_icgraph.png" border="0" usemap="#anamespacedyno_1_1vision__tools_a2c6285cb428d1df8a2ea1071d9a06757_icgraph" alt=""/></div>
<map name="anamespacedyno_1_1vision__tools_a2c6285cb428d1df8a2ea1071d9a06757_icgraph" id="anamespacedyno_1_1vision__tools_a2c6285cb428d1df8a2ea1071d9a06757_icgraph">
<area shape="rect" title="From an input instance/semantic mask type img construct a image mask (binary) that has True values ar..." alt="" coords="211,5,472,45"/>
<area shape="rect" href="classdyno_1_1FeatureTracker.html#a23296ac35b5935656d31a18450dc5e4c" title=" " alt="" coords="5,5,163,45"/>
</map>
</div>

</div>
</div>
<a id="aaabcfcca356f30c83a45a51259e39783" name="aaabcfcca356f30c83a45a51259e39783"></a>
<h2 class="memtitle"><span class="permalink"><a href="#aaabcfcca356f30c83a45a51259e39783">&#9670;&#160;</a></span>depthTo3D()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">cv::Mat dyno::vision_tools::depthTo3D </td>
          <td>(</td>
          <td class="paramtype">const <a class="el" href="structdyno_1_1ImageWrapper.html">ImageWrapper</a>&lt; <a class="el" href="structdyno_1_1ImageType_1_1Depth.html">ImageType::Depth</a> &gt; &amp;&#160;</td>
          <td class="paramname"><em>depth_image</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const cv::Mat &amp;&#160;</td>
          <td class="paramname"><em>K</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Projects a dense depth map to 3D coordinates in the local frame. </p>
<p>Returns a (H x W x 3) image of type CV_64F</p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">depth_image</td><td></td></tr>
    <tr><td class="paramname">K</td><td></td></tr>
  </table>
  </dd>
</dl>
<dl class="section return"><dt>Returns</dt><dd>cv::Mat </dd></dl>

<p class="definition">Definition at line <a class="el" href="VisionTools_8cc_source.html#l00599">599</a> of file <a class="el" href="VisionTools_8cc_source.html">VisionTools.cc</a>.</p>
<div class="fragment"><div class="line"><span class="lineno">  600</span>                                  {</div>
<div class="line"><span class="lineno">  601</span>  <span class="keyword">const</span> cv::Mat&amp; depth_map = depth_image;</div>
<div class="line"><span class="lineno">  602</span>  <span class="keywordtype">int</span> <a class="code hl_function" href="namespacedyno.html#a362927fda6438780973f55111b77455c">H</a> = depth_map.rows;</div>
<div class="line"><span class="lineno">  603</span>  <span class="keywordtype">int</span> W = depth_map.cols;</div>
<div class="line"><span class="lineno">  604</span> </div>
<div class="line"><span class="lineno">  605</span>  <span class="comment">// Camera intrinsic parameters</span></div>
<div class="line"><span class="lineno">  606</span>  <span class="keywordtype">double</span> fx = K.at&lt;<span class="keywordtype">double</span>&gt;(0, 0);</div>
<div class="line"><span class="lineno">  607</span>  <span class="keywordtype">double</span> fy = K.at&lt;<span class="keywordtype">double</span>&gt;(1, 1);</div>
<div class="line"><span class="lineno">  608</span>  <span class="keywordtype">double</span> cx = K.at&lt;<span class="keywordtype">double</span>&gt;(0, 2);</div>
<div class="line"><span class="lineno">  609</span>  <span class="keywordtype">double</span> cy = K.at&lt;<span class="keywordtype">double</span>&gt;(1, 2);</div>
<div class="line"><span class="lineno">  610</span> </div>
<div class="line"><span class="lineno">  611</span>  <span class="comment">// Generate pixel grid</span></div>
<div class="line"><span class="lineno">  612</span>  cv::Mat u_grid, v_grid;</div>
<div class="line"><span class="lineno">  613</span>  cv::Mat u = cv::Mat::zeros(H, W, CV_64F);</div>
<div class="line"><span class="lineno">  614</span>  cv::Mat v = cv::Mat::zeros(H, W, CV_64F);</div>
<div class="line"><span class="lineno">  615</span> </div>
<div class="line"><span class="lineno">  616</span>  <span class="keywordflow">for</span> (<span class="keywordtype">int</span> y = 0; y &lt; <a class="code hl_function" href="namespacedyno.html#a362927fda6438780973f55111b77455c">H</a>; ++y) {</div>
<div class="line"><span class="lineno">  617</span>    <span class="keywordflow">for</span> (<span class="keywordtype">int</span> x = 0; x &lt; W; ++x) {</div>
<div class="line"><span class="lineno">  618</span>      u.at&lt;<span class="keywordtype">double</span>&gt;(y, x) = <span class="keyword">static_cast&lt;</span><span class="keywordtype">double</span><span class="keyword">&gt;</span>(x);</div>
<div class="line"><span class="lineno">  619</span>      v.at&lt;<span class="keywordtype">double</span>&gt;(y, x) = <span class="keyword">static_cast&lt;</span><span class="keywordtype">double</span><span class="keyword">&gt;</span>(y);</div>
<div class="line"><span class="lineno">  620</span>    }</div>
<div class="line"><span class="lineno">  621</span>  }</div>
<div class="line"><span class="lineno">  622</span> </div>
<div class="line"><span class="lineno">  623</span>  <span class="comment">// Normalize pixel coordinates by the intrinsic matrix</span></div>
<div class="line"><span class="lineno">  624</span>  cv::Mat X_norm = (u - cx) / fx;</div>
<div class="line"><span class="lineno">  625</span>  cv::Mat Y_norm = (v - cy) / fy;</div>
<div class="line"><span class="lineno">  626</span> </div>
<div class="line"><span class="lineno">  627</span>  <span class="comment">// Depth map scaling for 3D coordinates</span></div>
<div class="line"><span class="lineno">  628</span>  cv::Mat X_3D = X_norm.mul(depth_map);</div>
<div class="line"><span class="lineno">  629</span>  cv::Mat Y_3D = Y_norm.mul(depth_map);</div>
<div class="line"><span class="lineno">  630</span> </div>
<div class="line"><span class="lineno">  631</span>  cv::Mat Z_3D = depth_map.clone();</div>
<div class="line"><span class="lineno">  632</span> </div>
<div class="line"><span class="lineno">  633</span>  std::vector&lt;cv::Mat&gt; channels = {X_3D, Y_3D, Z_3D};</div>
<div class="line"><span class="lineno">  634</span>  cv::Mat point_cloud;</div>
<div class="line"><span class="lineno">  635</span>  cv::merge(channels, point_cloud);</div>
<div class="line"><span class="lineno">  636</span> </div>
<div class="line"><span class="lineno">  637</span>  <span class="keywordflow">return</span> point_cloud;  <span class="comment">// 3-channel float matrix (H x W x 3)</span></div>
<div class="line"><span class="lineno">  638</span>}</div>
<div class="ttc" id="anamespacedyno_html_a362927fda6438780973f55111b77455c"><div class="ttname"><a href="namespacedyno.html#a362927fda6438780973f55111b77455c">dyno::H</a></div><div class="ttdeci">gtsam::Key H(unsigned char label, std::uint64_t j)</div><div class="ttdef"><b>Definition:</b> <a href="BackendDefinitions_8hpp_source.html#l00063">BackendDefinitions.hpp:63</a></div></div>
</div><!-- fragment -->
<p class="reference">References <a class="el" href="namespacedyno.html#a362927fda6438780973f55111b77455c">dyno::H()</a>.</p>

<p class="reference">Referenced by <a class="el" href="namespacedyno_1_1vision__tools.html#a5d8b89d2b560b498934853c77a7d9f28">writeOutProjectMaskAndDepthMap()</a>.</p>
<div class="dynheader">
Here is the call graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="namespacedyno_1_1vision__tools_aaabcfcca356f30c83a45a51259e39783_cgraph.png" border="0" usemap="#anamespacedyno_1_1vision__tools_aaabcfcca356f30c83a45a51259e39783_cgraph" alt=""/></div>
<map name="anamespacedyno_1_1vision__tools_aaabcfcca356f30c83a45a51259e39783_cgraph" id="anamespacedyno_1_1vision__tools_aaabcfcca356f30c83a45a51259e39783_cgraph">
<area shape="rect" title="Projects a dense depth map to 3D coordinates in the local frame." alt="" coords="5,5,145,45"/>
<area shape="rect" href="namespacedyno.html#a362927fda6438780973f55111b77455c" title=" " alt="" coords="193,13,265,38"/>
</map>
</div>
<div class="dynheader">
Here is the caller graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="namespacedyno_1_1vision__tools_aaabcfcca356f30c83a45a51259e39783_icgraph.png" border="0" usemap="#anamespacedyno_1_1vision__tools_aaabcfcca356f30c83a45a51259e39783_icgraph" alt=""/></div>
<map name="anamespacedyno_1_1vision__tools_aaabcfcca356f30c83a45a51259e39783_icgraph" id="anamespacedyno_1_1vision__tools_aaabcfcca356f30c83a45a51259e39783_icgraph">
<area shape="rect" title="Projects a dense depth map to 3D coordinates in the local frame." alt="" coords="572,5,712,45"/>
<area shape="rect" href="namespacedyno_1_1vision__tools.html#a5d8b89d2b560b498934853c77a7d9f28" title="Saves a re&#45;projected 3D point cloud with labelled points to file as a cv::Mat." alt="" coords="265,5,524,45"/>
<area shape="rect" href="classdyno_1_1RGBDInstanceFrontendModule.html#a4528368033583ee53198dac3a803c5f2" title=" " alt="" coords="5,5,217,45"/>
</map>
</div>

</div>
</div>
<a id="a46d0411291384b813e022cf32c66a82b" name="a46d0411291384b813e022cf32c66a82b"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a46d0411291384b813e022cf32c66a82b">&#9670;&#160;</a></span>findObjectBoundingBox() <span class="overload">[1/3]</span></h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">bool dyno::vision_tools::findObjectBoundingBox </td>
          <td>(</td>
          <td class="paramtype">const cv::Mat &amp;&#160;</td>
          <td class="paramname"><em>mask</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="namespacedyno.html#a38bb86e4154b86428b8d133be03fb2b5">ObjectId</a>&#160;</td>
          <td class="paramname"><em>object_id</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">cv::Rect &amp;&#160;</td>
          <td class="paramname"><em>detected_rect</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>From a instance/semantic mask type img, construct the bounding box for the mask of object_id. </p>
<p>Differes only in output variables.</p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">mask</td><td></td></tr>
    <tr><td class="paramname">object_id</td><td></td></tr>
    <tr><td class="paramname">detected_rect</td><td></td></tr>
  </table>
  </dd>
</dl>
<dl class="section return"><dt>Returns</dt><dd>true </dd>
<dd>
false </dd></dl>

<p class="definition">Definition at line <a class="el" href="VisionTools_8cc_source.html#l00479">479</a> of file <a class="el" href="VisionTools_8cc_source.html">VisionTools.cc</a>.</p>
<div class="fragment"><div class="line"><span class="lineno">  480</span>                                                  {</div>
<div class="line"><span class="lineno">  481</span>  std::vector&lt;std::vector&lt;cv::Point&gt;&gt; detected_contours;</div>
<div class="line"><span class="lineno">  482</span>  <span class="keyword">auto</span> result =</div>
<div class="line"><span class="lineno">  483</span>      <a class="code hl_function" href="namespacedyno_1_1vision__tools.html#a01601f2fba95a79f4ecaa11b89286d99">findObjectBoundingBox</a>(mask, object_id, detected_rect, detected_contours);</div>
<div class="line"><span class="lineno">  484</span>  (void)detected_contours;</div>
<div class="line"><span class="lineno">  485</span>  <span class="keywordflow">return</span> result;</div>
<div class="line"><span class="lineno">  486</span>}</div>
<div class="ttc" id="anamespacedyno_1_1vision__tools_html_a01601f2fba95a79f4ecaa11b89286d99"><div class="ttname"><a href="namespacedyno_1_1vision__tools.html#a01601f2fba95a79f4ecaa11b89286d99">dyno::vision_tools::findObjectBoundingBox</a></div><div class="ttdeci">bool findObjectBoundingBox(const cv::Mat &amp;mask, ObjectId object_id, cv::Rect &amp;detected_rect, std::vector&lt; std::vector&lt; cv::Point &gt; &gt; &amp;detected_contours)</div><div class="ttdoc">From a instance/semantic mask type img, construct the bounding box for the mask of object_id.</div><div class="ttdef"><b>Definition:</b> <a href="VisionTools_8cc_source.html#l00440">VisionTools.cc:440</a></div></div>
</div><!-- fragment -->
<p class="reference">References <a class="el" href="namespacedyno_1_1vision__tools.html#a01601f2fba95a79f4ecaa11b89286d99">findObjectBoundingBox()</a>.</p>
<div class="dynheader">
Here is the call graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="namespacedyno_1_1vision__tools_a46d0411291384b813e022cf32c66a82b_cgraph.png" border="0" usemap="#anamespacedyno_1_1vision__tools_a46d0411291384b813e022cf32c66a82b_cgraph" alt=""/></div>
<map name="anamespacedyno_1_1vision__tools_a46d0411291384b813e022cf32c66a82b_cgraph" id="anamespacedyno_1_1vision__tools_a46d0411291384b813e022cf32c66a82b_cgraph">
<area shape="rect" title="From a instance/semantic mask type img, construct the bounding box for the mask of object_id." alt="" coords="5,5,188,45"/>
<area shape="rect" href="namespacedyno_1_1vision__tools.html#a01601f2fba95a79f4ecaa11b89286d99" title="From a instance/semantic mask type img, construct the bounding box for the mask of object_id." alt="" coords="236,5,419,45"/>
</map>
</div>

</div>
</div>
<a id="a01601f2fba95a79f4ecaa11b89286d99" name="a01601f2fba95a79f4ecaa11b89286d99"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a01601f2fba95a79f4ecaa11b89286d99">&#9670;&#160;</a></span>findObjectBoundingBox() <span class="overload">[2/3]</span></h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">bool dyno::vision_tools::findObjectBoundingBox </td>
          <td>(</td>
          <td class="paramtype">const cv::Mat &amp;&#160;</td>
          <td class="paramname"><em>mask</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="namespacedyno.html#a38bb86e4154b86428b8d133be03fb2b5">ObjectId</a>&#160;</td>
          <td class="paramname"><em>object_id</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">cv::Rect &amp;&#160;</td>
          <td class="paramname"><em>detected_rect</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">std::vector&lt; std::vector&lt; cv::Point &gt; &gt; &amp;&#160;</td>
          <td class="paramname"><em>detected_contours</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>From a instance/semantic mask type img, construct the bounding box for the mask of object_id. </p>
<p>If object_id is not present in the mask (ie.e no pixe values with this mask), or no valid contours could be constructed, false is returned.</p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">mask</td><td>const cv::Mat&amp; </td></tr>
    <tr><td class="paramname">object_id</td><td>ObjectId </td></tr>
    <tr><td class="paramname">detected_rect</td><td>cv::Rect&amp; The calcualted bounding box </td></tr>
    <tr><td class="paramname">detected_contours</td><td>std::vector&lt;std::vector&lt;cv::Point&gt;&gt;&amp; The calcualted contours used to find the bounding box </td></tr>
  </table>
  </dd>
</dl>
<dl class="section return"><dt>Returns</dt><dd>true </dd>
<dd>
false </dd></dl>

<p class="definition">Definition at line <a class="el" href="VisionTools_8cc_source.html#l00440">440</a> of file <a class="el" href="VisionTools_8cc_source.html">VisionTools.cc</a>.</p>
<div class="fragment"><div class="line"><span class="lineno">  442</span>                                                      {</div>
<div class="line"><span class="lineno">  443</span>  cv::Mat mask_copy = mask.clone();</div>
<div class="line"><span class="lineno">  444</span> </div>
<div class="line"><span class="lineno">  445</span>  cv::Mat obj_mask = (mask_copy == object_id);</div>
<div class="line"><span class="lineno">  446</span>  cv::Mat dilated_obj_mask;</div>
<div class="line"><span class="lineno">  447</span>  <span class="comment">// dilate to fill any small holes in the mask to get a more complete set of</span></div>
<div class="line"><span class="lineno">  448</span>  <span class="comment">// contours</span></div>
<div class="line"><span class="lineno">  449</span>  cv::Mat dilate_element = cv::getStructuringElement(</div>
<div class="line"><span class="lineno">  450</span>      cv::MORPH_RECT, cv::Size(1, 11));  <span class="comment">// a rectangle of 1*5</span></div>
<div class="line"><span class="lineno">  451</span>  cv::dilate(obj_mask, dilated_obj_mask, dilate_element, cv::Point(-1, -1));</div>
<div class="line"><span class="lineno">  452</span> </div>
<div class="line"><span class="lineno">  453</span>  std::vector&lt;std::vector&lt;cv::Point&gt;&gt; contours;</div>
<div class="line"><span class="lineno">  454</span>  std::vector&lt;cv::Vec4i&gt; hierarchy;</div>
<div class="line"><span class="lineno">  455</span>  cv::findContours(dilated_obj_mask, contours, hierarchy, cv::RETR_TREE,</div>
<div class="line"><span class="lineno">  456</span>                   cv::CHAIN_APPROX_NONE);</div>
<div class="line"><span class="lineno">  457</span> </div>
<div class="line"><span class="lineno">  458</span>  detected_contours = contours;</div>
<div class="line"><span class="lineno">  459</span> </div>
<div class="line"><span class="lineno">  460</span>  <span class="keywordflow">if</span> (contours.empty()) {</div>
<div class="line"><span class="lineno">  461</span>    detected_rect = cv::Rect();</div>
<div class="line"><span class="lineno">  462</span>    <span class="keywordflow">return</span> <span class="keyword">false</span>;</div>
<div class="line"><span class="lineno">  463</span>  } <span class="keywordflow">else</span> <span class="keywordflow">if</span> (contours.size() == 1u) {</div>
<div class="line"><span class="lineno">  464</span>    detected_rect = cv::boundingRect(contours.at(0));</div>
<div class="line"><span class="lineno">  465</span>  } <span class="keywordflow">else</span> {</div>
<div class="line"><span class="lineno">  466</span>    std::vector&lt;cv::Rect&gt; rectangles;</div>
<div class="line"><span class="lineno">  467</span>    <span class="keywordflow">for</span> (<span class="keyword">auto</span> it : contours) {</div>
<div class="line"><span class="lineno">  468</span>      rectangles.push_back(cv::boundingRect(it));</div>
<div class="line"><span class="lineno">  469</span>    }</div>
<div class="line"><span class="lineno">  470</span>    cv::Rect merged_rect = rectangles[0];</div>
<div class="line"><span class="lineno">  471</span>    <span class="keywordflow">for</span> (<span class="keyword">const</span> <span class="keyword">auto</span>&amp; r : rectangles) {</div>
<div class="line"><span class="lineno">  472</span>      merged_rect |= r;</div>
<div class="line"><span class="lineno">  473</span>    }</div>
<div class="line"><span class="lineno">  474</span>    detected_rect = merged_rect;</div>
<div class="line"><span class="lineno">  475</span>  }</div>
<div class="line"><span class="lineno">  476</span>  <span class="keywordflow">return</span> <span class="keyword">true</span>;</div>
<div class="line"><span class="lineno">  477</span>}</div>
</div><!-- fragment -->
<p class="reference">Referenced by <a class="el" href="classdyno_1_1ClusterSlamAllLoader.html#a074af7358c98d715599460ca2671ecc4">dyno::ClusterSlamAllLoader::associateDetectedBBWithObject()</a>, <a class="el" href="namespacedyno_1_1vision__tools.html#a2c6285cb428d1df8a2ea1071d9a06757">computeObjectMaskBoundaryMask()</a>, <a class="el" href="classdyno_1_1Frame.html#ab038b536516e42beb788f1b794801270">dyno::Frame::constructDynamicObservations()</a>, <a class="el" href="namespacedyno_1_1vision__tools.html#a46d0411291384b813e022cf32c66a82b">findObjectBoundingBox()</a>, and <a class="el" href="classdyno_1_1ByteObjectTracker.html#aeb79dc19fb881160be780b9f4a2b2240">dyno::ByteObjectTracker::track()</a>.</p>
<div class="dynheader">
Here is the caller graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="namespacedyno_1_1vision__tools_a01601f2fba95a79f4ecaa11b89286d99_icgraph.png" border="0" usemap="#anamespacedyno_1_1vision__tools_a01601f2fba95a79f4ecaa11b89286d99_icgraph" alt=""/></div>
<map name="anamespacedyno_1_1vision__tools_a01601f2fba95a79f4ecaa11b89286d99_icgraph" id="anamespacedyno_1_1vision__tools_a01601f2fba95a79f4ecaa11b89286d99_icgraph">
<area shape="rect" title="From a instance/semantic mask type img, construct the bounding box for the mask of object_id." alt="" coords="565,133,748,173"/>
<area shape="rect" href="classdyno_1_1ClusterSlamAllLoader.html#a074af7358c98d715599460ca2671ecc4" title=" " alt="" coords="266,5,507,45"/>
<area shape="rect" href="namespacedyno_1_1vision__tools.html#a2c6285cb428d1df8a2ea1071d9a06757" title="From an input instance/semantic mask type img construct a image mask (binary) that has True values ar..." alt="" coords="256,69,517,109"/>
<area shape="rect" href="classdyno_1_1Frame.html#ab038b536516e42beb788f1b794801270" title=" " alt="" coords="272,133,501,173"/>
<area shape="rect" href="namespacedyno_1_1vision__tools.html#a46d0411291384b813e022cf32c66a82b" title="From a instance/semantic mask type img, construct the bounding box for the mask of object_id." alt="" coords="295,197,478,237"/>
<area shape="rect" href="classdyno_1_1ByteObjectTracker.html#aeb79dc19fb881160be780b9f4a2b2240" title=" " alt="" coords="297,285,477,325"/>
<area shape="rect" href="classdyno_1_1ClusterSlamAllLoader.html#a6dbf46c48ea9477aa915bff62ee98ea8" title=" " alt="" coords="5,5,208,45"/>
<area shape="rect" href="classdyno_1_1FeatureTracker.html#a23296ac35b5935656d31a18450dc5e4c" title=" " alt="" coords="28,69,185,109"/>
<area shape="rect" href="classdyno_1_1Frame.html#a5553af4c0c310c23d0f39e0c1daf0478" title=" " alt="" coords="31,141,183,166"/>
</map>
</div>

</div>
</div>
<a id="a351551c72ca4e39c5c9e0185ecde00b7" name="a351551c72ca4e39c5c9e0185ecde00b7"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a351551c72ca4e39c5c9e0185ecde00b7">&#9670;&#160;</a></span>findObjectBoundingBox() <span class="overload">[3/3]</span></h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">bool dyno::vision_tools::findObjectBoundingBox </td>
          <td>(</td>
          <td class="paramtype">const cv::Mat &amp;&#160;</td>
          <td class="paramname"><em>mask</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="namespacedyno.html#a38bb86e4154b86428b8d133be03fb2b5">ObjectId</a>&#160;</td>
          <td class="paramname"><em>object_id</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">std::vector&lt; std::vector&lt; cv::Point &gt; &gt; &amp;&#160;</td>
          <td class="paramname"><em>detected_contours</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>From a instance/semantic mask type img, construct the bounding box for the mask of object_id. </p>
<p>Differes only in output variables.</p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">mask</td><td></td></tr>
    <tr><td class="paramname">object_id</td><td></td></tr>
    <tr><td class="paramname">detected_contours</td><td></td></tr>
  </table>
  </dd>
</dl>
<dl class="section return"><dt>Returns</dt><dd>true </dd>
<dd>
false </dd></dl>

<p class="definition">Definition at line <a class="el" href="VisionTools_8cc_source.html#l00488">488</a> of file <a class="el" href="VisionTools_8cc_source.html">VisionTools.cc</a>.</p>
<div class="fragment"><div class="line"><span class="lineno">  490</span>                                                      {</div>
<div class="line"><span class="lineno">  491</span>  cv::Rect detected_rect;</div>
<div class="line"><span class="lineno">  492</span>  <span class="keyword">auto</span> result =</div>
<div class="line"><span class="lineno">  493</span>      <a class="code hl_function" href="namespacedyno_1_1vision__tools.html#a01601f2fba95a79f4ecaa11b89286d99">findObjectBoundingBox</a>(mask, object_id, detected_rect, detected_contours);</div>
<div class="line"><span class="lineno">  494</span>  (void)detected_rect;</div>
<div class="line"><span class="lineno">  495</span>  <span class="keywordflow">return</span> result;</div>
<div class="line"><span class="lineno">  496</span>}</div>
</div><!-- fragment -->
<p class="reference">References <a class="el" href="namespacedyno_1_1vision__tools.html#a01601f2fba95a79f4ecaa11b89286d99">findObjectBoundingBox()</a>.</p>
<div class="dynheader">
Here is the call graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="namespacedyno_1_1vision__tools_a351551c72ca4e39c5c9e0185ecde00b7_cgraph.png" border="0" usemap="#anamespacedyno_1_1vision__tools_a351551c72ca4e39c5c9e0185ecde00b7_cgraph" alt=""/></div>
<map name="anamespacedyno_1_1vision__tools_a351551c72ca4e39c5c9e0185ecde00b7_cgraph" id="anamespacedyno_1_1vision__tools_a351551c72ca4e39c5c9e0185ecde00b7_cgraph">
<area shape="rect" title="From a instance/semantic mask type img, construct the bounding box for the mask of object_id." alt="" coords="5,5,188,45"/>
<area shape="rect" href="namespacedyno_1_1vision__tools.html#a01601f2fba95a79f4ecaa11b89286d99" title="From a instance/semantic mask type img, construct the bounding box for the mask of object_id." alt="" coords="236,5,419,45"/>
</map>
</div>

</div>
</div>
<a id="ac7721b6e34c712cd9d194afe30dec47c" name="ac7721b6e34c712cd9d194afe30dec47c"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ac7721b6e34c712cd9d194afe30dec47c">&#9670;&#160;</a></span>getCorrespondences()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void dyno::vision_tools::getCorrespondences </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="namespacedyno.html#a7ec6a986cfe4a517505dd137d0844e7c">FeaturePairs</a> &amp;&#160;</td>
          <td class="paramname"><em>correspondences</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const <a class="el" href="namespacedyno.html#aeaa15616abde5162319c97576823c59a">FeatureFilterIterator</a> &amp;&#160;</td>
          <td class="paramname"><em>previous_features</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const <a class="el" href="namespacedyno.html#aeaa15616abde5162319c97576823c59a">FeatureFilterIterator</a> &amp;&#160;</td>
          <td class="paramname"><em>current_features</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="VisionTools_8cc_source.html#l00044">44</a> of file <a class="el" href="VisionTools_8cc_source.html">VisionTools.cc</a>.</p>
<div class="fragment"><div class="line"><span class="lineno">   46</span>                                                                       {</div>
<div class="line"><span class="lineno">   47</span>  correspondences.clear();</div>
<div class="line"><span class="lineno">   48</span> </div>
<div class="line"><span class="lineno">   49</span>  <span class="keyword">const</span> <a class="code hl_class" href="classdyno_1_1FeatureContainer.html">FeatureContainer</a>&amp; previous_feature_container =</div>
<div class="line"><span class="lineno">   50</span>      previous_features.<a class="code hl_function" href="structdyno_1_1internal_1_1filter__iterator__base.html#ac1df3e0d6d5b4ef5851cd10f7d327a6f">getContainer</a>();</div>
<div class="line"><span class="lineno">   51</span> </div>
<div class="line"><span class="lineno">   52</span>  <span class="keywordflow">for</span> (<span class="keyword">const</span> <span class="keyword">auto</span>&amp; curr_feature : current_features) {</div>
<div class="line"><span class="lineno">   53</span>    <span class="comment">// check if previous feature and is valid</span></div>
<div class="line"><span class="lineno">   54</span>    <span class="keywordflow">if</span> (previous_feature_container.<a class="code hl_function" href="classdyno_1_1FeatureContainer.html#abf2f2d568f5dc17944cc122c537a65f5">exists</a>(curr_feature-&gt;trackletId())) {</div>
<div class="line"><span class="lineno">   55</span>      <span class="keyword">const</span> <span class="keyword">auto</span> prev_feature = previous_feature_container.<a class="code hl_function" href="classdyno_1_1FeatureContainer.html#a5b73e75d2f4063ac9c16dd0fd565f8da">getByTrackletId</a>(</div>
<div class="line"><span class="lineno">   56</span>          curr_feature-&gt;trackletId());</div>
<div class="line"><span class="lineno">   57</span>      CHECK(prev_feature);</div>
<div class="line"><span class="lineno">   58</span> </div>
<div class="line"><span class="lineno">   59</span>      <span class="comment">// having checked that feature is in the previous set, also check that it</span></div>
<div class="line"><span class="lineno">   60</span>      <span class="comment">// ahderes to the filter</span></div>
<div class="line"><span class="lineno">   61</span>      <span class="keywordflow">if</span> (!previous_features(prev_feature)) {</div>
<div class="line"><span class="lineno">   62</span>        <span class="keywordflow">continue</span>;</div>
<div class="line"><span class="lineno">   63</span>      }</div>
<div class="line"><span class="lineno">   64</span>      correspondences.push_back({prev_feature, curr_feature});</div>
<div class="line"><span class="lineno">   65</span>    }</div>
<div class="line"><span class="lineno">   66</span>  }</div>
<div class="line"><span class="lineno">   67</span>}</div>
<div class="ttc" id="aclassdyno_1_1FeatureContainer_html"><div class="ttname"><a href="classdyno_1_1FeatureContainer.html">dyno::FeatureContainer</a></div><div class="ttdoc">Basic container mapping tracklet id's to a feature (pointer).</div><div class="ttdef"><b>Definition:</b> <a href="Feature_8hpp_source.html#l00401">Feature.hpp:401</a></div></div>
<div class="ttc" id="aclassdyno_1_1FeatureContainer_html_a5b73e75d2f4063ac9c16dd0fd565f8da"><div class="ttname"><a href="classdyno_1_1FeatureContainer.html#a5b73e75d2f4063ac9c16dd0fd565f8da">dyno::FeatureContainer::getByTrackletId</a></div><div class="ttdeci">Feature::Ptr getByTrackletId(TrackletId tracklet_id) const</div><div class="ttdoc">Gets a feature given its tracklet id. If the feature does not exist, nullptr is returned.</div><div class="ttdef"><b>Definition:</b> <a href="Feature_8cc_source.html#l00107">Feature.cc:107</a></div></div>
<div class="ttc" id="aclassdyno_1_1FeatureContainer_html_abf2f2d568f5dc17944cc122c537a65f5"><div class="ttname"><a href="classdyno_1_1FeatureContainer.html#abf2f2d568f5dc17944cc122c537a65f5">dyno::FeatureContainer::exists</a></div><div class="ttdeci">bool exists(TrackletId tracklet_id) const</div><div class="ttdoc">Returns true if a feature with the given tracklet id exists.</div><div class="ttdef"><b>Definition:</b> <a href="Feature_8cc_source.html#l00114">Feature.cc:114</a></div></div>
<div class="ttc" id="astructdyno_1_1internal_1_1filter__iterator__base_html_ac1df3e0d6d5b4ef5851cd10f7d327a6f"><div class="ttname"><a href="structdyno_1_1internal_1_1filter__iterator__base.html#ac1df3e0d6d5b4ef5851cd10f7d327a6f">dyno::internal::filter_iterator_base::getContainer</a></div><div class="ttdeci">Container &amp; getContainer()</div><div class="ttdef"><b>Definition:</b> <a href="StructuredContainers_8hpp_source.html#l00108">StructuredContainers.hpp:108</a></div></div>
</div><!-- fragment -->
<p class="reference">References <a class="el" href="classdyno_1_1FeatureContainer.html#abf2f2d568f5dc17944cc122c537a65f5">dyno::FeatureContainer::exists()</a>, <a class="el" href="classdyno_1_1FeatureContainer.html#a5b73e75d2f4063ac9c16dd0fd565f8da">dyno::FeatureContainer::getByTrackletId()</a>, and <a class="el" href="structdyno_1_1internal_1_1filter__iterator__base.html#ac1df3e0d6d5b4ef5851cd10f7d327a6f">dyno::internal::filter_iterator_base&lt; Container, Iter, FilterFunction &gt;::getContainer()</a>.</p>

<p class="reference">Referenced by <a class="el" href="classdyno_1_1Frame.html#acd53bfdd333a0577003c2c85f7d60dbd">dyno::Frame::getDynamicCorrespondences()</a>, and <a class="el" href="classdyno_1_1Frame.html#a2dae0d4fd6d5ae47802ff8f6602d652b">dyno::Frame::getStaticCorrespondences()</a>.</p>
<div class="dynheader">
Here is the call graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="namespacedyno_1_1vision__tools_ac7721b6e34c712cd9d194afe30dec47c_cgraph.png" border="0" usemap="#anamespacedyno_1_1vision__tools_ac7721b6e34c712cd9d194afe30dec47c_cgraph" alt=""/></div>
<map name="anamespacedyno_1_1vision__tools_ac7721b6e34c712cd9d194afe30dec47c_cgraph" id="anamespacedyno_1_1vision__tools_ac7721b6e34c712cd9d194afe30dec47c_cgraph">
<area shape="rect" title=" " alt="" coords="5,33,168,73"/>
<area shape="rect" href="classdyno_1_1FeatureContainer.html#abf2f2d568f5dc17944cc122c537a65f5" title="Returns true if a feature with the given tracklet id exists." alt="" coords="471,5,645,45"/>
<area shape="rect" href="classdyno_1_1FeatureContainer.html#a5b73e75d2f4063ac9c16dd0fd565f8da" title="Gets a feature given its tracklet id. If the feature does not exist, nullptr is returned." alt="" coords="232,33,407,73"/>
<area shape="rect" href="structdyno_1_1internal_1_1filter__iterator__base.html#ac1df3e0d6d5b4ef5851cd10f7d327a6f" title=" " alt="" coords="216,97,423,137"/>
</map>
</div>
<div class="dynheader">
Here is the caller graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="namespacedyno_1_1vision__tools_ac7721b6e34c712cd9d194afe30dec47c_icgraph.png" border="0" usemap="#anamespacedyno_1_1vision__tools_ac7721b6e34c712cd9d194afe30dec47c_icgraph" alt=""/></div>
<map name="anamespacedyno_1_1vision__tools_ac7721b6e34c712cd9d194afe30dec47c_icgraph" id="anamespacedyno_1_1vision__tools_ac7721b6e34c712cd9d194afe30dec47c_icgraph">
<area shape="rect" title=" " alt="" coords="999,23,1161,63"/>
<area shape="rect" href="classdyno_1_1Frame.html#acd53bfdd333a0577003c2c85f7d60dbd" title="Gets the set of tracked pairs between this frame and the previous frame for a tracked dynamic object ..." alt="" coords="648,55,951,80"/>
<area shape="rect" href="classdyno_1_1Frame.html#a2dae0d4fd6d5ae47802ff8f6602d652b" title=" " alt="" coords="659,5,940,31"/>
<area shape="rect" href="classdyno_1_1Frame.html#a0ee3d3a6479eada0e5443feb48613cdc" title="Gets the set of tracked pairs between this frame and the previous frame. All correspondences will be ..." alt="" coords="327,5,571,31"/>
<area shape="rect" href="classdyno_1_1Frame.html#a2efd60e3d057b2519572ef951308dd8c" title=" " alt="" coords="297,55,600,80"/>
<area shape="rect" href="classdyno_1_1Frame.html#a40ef74f44116cf581522314b3a053c3a" title=" " alt="" coords="5,5,249,31"/>
</map>
</div>

</div>
</div>
<a id="a3a09fe6c15aeb5e18979dc27d68c4616" name="a3a09fe6c15aeb5e18979dc27d68c4616"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a3a09fe6c15aeb5e18979dc27d68c4616">&#9670;&#160;</a></span>getObjectLabels()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="namespacedyno.html#ae777b079c377ffa066d89051ee0cc623">ObjectIds</a> dyno::vision_tools::getObjectLabels </td>
          <td>(</td>
          <td class="paramtype">const cv::Mat &amp;&#160;</td>
          <td class="paramname"><em>image</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Finds the unique object labels (j) as present in the instance segmentation image. Does not include the background label. </p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">image</td><td>const cv::Mat&amp; </td></tr>
  </table>
  </dd>
</dl>
<dl class="section return"><dt>Returns</dt><dd>ObjectIds </dd></dl>

<p class="definition">Definition at line <a class="el" href="VisionTools_8cc_source.html#l00069">69</a> of file <a class="el" href="VisionTools_8cc_source.html">VisionTools.cc</a>.</p>
<div class="fragment"><div class="line"><span class="lineno">   69</span>                                              {</div>
<div class="line"><span class="lineno">   70</span>  CHECK(!image.empty());</div>
<div class="line"><span class="lineno">   71</span>  <span class="comment">// TODO: this could be optimised by mapping the data directly to a std::set?</span></div>
<div class="line"><span class="lineno">   72</span>  std::set&lt;ObjectId&gt; unique_labels;</div>
<div class="line"><span class="lineno">   73</span>  <span class="keywordflow">for</span> (<span class="keywordtype">int</span> i = 0; i &lt; image.rows; i++) {</div>
<div class="line"><span class="lineno">   74</span>    <span class="keywordflow">for</span> (<span class="keywordtype">int</span> j = 0; j &lt; image.cols; j++) {</div>
<div class="line"><span class="lineno">   75</span>      <span class="keyword">const</span> <a class="code hl_typedef" href="namespacedyno.html#a38bb86e4154b86428b8d133be03fb2b5">ObjectId</a> label = image.at&lt;<a class="code hl_typedef" href="namespacedyno.html#a38bb86e4154b86428b8d133be03fb2b5">ObjectId</a>&gt;(i, j);</div>
<div class="line"><span class="lineno">   76</span> </div>
<div class="line"><span class="lineno">   77</span>      <span class="keywordflow">if</span> (label != background_label) {</div>
<div class="line"><span class="lineno">   78</span>        unique_labels.insert(label);</div>
<div class="line"><span class="lineno">   79</span>      }</div>
<div class="line"><span class="lineno">   80</span>    }</div>
<div class="line"><span class="lineno">   81</span>  }</div>
<div class="line"><span class="lineno">   82</span> </div>
<div class="line"><span class="lineno">   83</span>  <span class="keywordflow">return</span> <a class="code hl_typedef" href="namespacedyno.html#ae777b079c377ffa066d89051ee0cc623">ObjectIds</a>(unique_labels.begin(), unique_labels.end());</div>
<div class="line"><span class="lineno">   84</span>}</div>
<div class="ttc" id="anamespacedyno_html_a38bb86e4154b86428b8d133be03fb2b5"><div class="ttname"><a href="namespacedyno.html#a38bb86e4154b86428b8d133be03fb2b5">dyno::ObjectId</a></div><div class="ttdeci">int ObjectId</div><div class="ttdoc">Discrete object id, j.</div><div class="ttdef"><b>Definition:</b> <a href="Types_8hpp_source.html#l00068">Types.hpp:68</a></div></div>
<div class="ttc" id="anamespacedyno_html_ae777b079c377ffa066d89051ee0cc623"><div class="ttname"><a href="namespacedyno.html#ae777b079c377ffa066d89051ee0cc623">dyno::ObjectIds</a></div><div class="ttdeci">std::vector&lt; ObjectId &gt; ObjectIds</div><div class="ttdef"><b>Definition:</b> <a href="Types_8hpp_source.html#l00069">Types.hpp:69</a></div></div>
</div><!-- fragment -->
<p class="reference">References <a class="el" href="namespacedyno.html#ae78915ea0afc5025dafb398829f15ba3">dyno::background_label</a>.</p>

<p class="reference">Referenced by <a class="el" href="classdyno_1_1ClusterSlamAllLoader.html#a074af7358c98d715599460ca2671ecc4">dyno::ClusterSlamAllLoader::associateDetectedBBWithObject()</a>, <a class="el" href="namespacedyno_1_1vision__tools.html#a2c6285cb428d1df8a2ea1071d9a06757">computeObjectMaskBoundaryMask()</a>, <a class="el" href="classdyno_1_1Frame.html#ab038b536516e42beb788f1b794801270">dyno::Frame::constructDynamicObservations()</a>, <a class="el" href="namespacedyno.html#a4222260b2e297cbd6e2df476b0f58aaf">dyno::removeStaticObjectFromMask()</a>, <a class="el" href="namespacedyno_1_1vision__tools.html#a518b3162f275ce3e2301d249a7e1a6ff">shrinkMask()</a>, and <a class="el" href="classdyno_1_1ByteObjectTracker.html#aeb79dc19fb881160be780b9f4a2b2240">dyno::ByteObjectTracker::track()</a>.</p>
<div class="dynheader">
Here is the caller graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="namespacedyno_1_1vision__tools_a3a09fe6c15aeb5e18979dc27d68c4616_icgraph.png" border="0" usemap="#anamespacedyno_1_1vision__tools_a3a09fe6c15aeb5e18979dc27d68c4616_icgraph" alt=""/></div>
<map name="anamespacedyno_1_1vision__tools_a3a09fe6c15aeb5e18979dc27d68c4616_icgraph" id="anamespacedyno_1_1vision__tools_a3a09fe6c15aeb5e18979dc27d68c4616_icgraph">
<area shape="rect" title="Finds the unique object labels (j) as present in the instance segmentation image. Does not include th..." alt="" coords="565,165,705,205"/>
<area shape="rect" href="classdyno_1_1ClusterSlamAllLoader.html#a074af7358c98d715599460ca2671ecc4" title=" " alt="" coords="266,5,507,45"/>
<area shape="rect" href="namespacedyno_1_1vision__tools.html#a2c6285cb428d1df8a2ea1071d9a06757" title="From an input instance/semantic mask type img construct a image mask (binary) that has True values ar..." alt="" coords="256,69,517,109"/>
<area shape="rect" href="classdyno_1_1Frame.html#ab038b536516e42beb788f1b794801270" title=" " alt="" coords="272,133,501,173"/>
<area shape="rect" href="namespacedyno.html#a4222260b2e297cbd6e2df476b0f58aaf" title="From an instance semantic mask (one that satisfies the requirements for a SemanticMask),..." alt="" coords="291,197,482,237"/>
<area shape="rect" href="namespacedyno_1_1vision__tools.html#a518b3162f275ce3e2301d249a7e1a6ff" title="Shrinks all found object masks by a given ammount." alt="" coords="317,261,457,301"/>
<area shape="rect" href="classdyno_1_1ByteObjectTracker.html#aeb79dc19fb881160be780b9f4a2b2240" title=" " alt="" coords="297,349,477,389"/>
<area shape="rect" href="classdyno_1_1ClusterSlamAllLoader.html#a6dbf46c48ea9477aa915bff62ee98ea8" title=" " alt="" coords="5,5,208,45"/>
<area shape="rect" href="classdyno_1_1FeatureTracker.html#a23296ac35b5935656d31a18450dc5e4c" title=" " alt="" coords="28,69,185,109"/>
<area shape="rect" href="classdyno_1_1Frame.html#a5553af4c0c310c23d0f39e0c1daf0478" title=" " alt="" coords="31,141,183,166"/>
<area shape="rect" href="classdyno_1_1VirtualKittiMotionSegFolder.html#a5fbe696de81a23607cfb6333a6ff1f94" title=" " alt="" coords="18,197,195,237"/>
</map>
</div>

</div>
</div>
<a id="a299ddb654abf59383dcf29f7b013ba6f" name="a299ddb654abf59383dcf29f7b013ba6f"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a299ddb654abf59383dcf29f7b013ba6f">&#9670;&#160;</a></span>makeTrackletLengthHistorgram()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">gtsam::FastMap&lt; <a class="el" href="namespacedyno.html#a38bb86e4154b86428b8d133be03fb2b5">ObjectId</a>, <a class="el" href="classdyno_1_1Histogram.html">Histogram</a> &gt; dyno::vision_tools::makeTrackletLengthHistorgram </td>
          <td>(</td>
          <td class="paramtype">const Frame::Ptr&#160;</td>
          <td class="paramname"><em>frame</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const std::vector&lt; size_t &gt; &amp;&#160;</td>
          <td class="paramname"><em>bins</em> = <code>{0,&#160;1,&#160;2,&#160;3,&#160;5,&#160;7,&#160;10,&#160;15,&#160;25,&#160;40,&#160;60,&#160;std::numeric_limits&lt;size_t&gt;::max()}</code>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Constructs a map of histograms (static features: 0, one for each dynamic object) containing the tracklet length at this frame. </p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">frame</td><td></td></tr>
    <tr><td class="paramname">bins</td><td></td></tr>
  </table>
  </dd>
</dl>
<dl class="section return"><dt>Returns</dt><dd>gtsam::FastMap&lt;ObjectId, Histogram&gt; </dd></dl>

<p class="definition">Definition at line <a class="el" href="VisionTools_8cc_source.html#l00568">568</a> of file <a class="el" href="VisionTools_8cc_source.html">VisionTools.cc</a>.</p>
<div class="fragment"><div class="line"><span class="lineno">  569</span>                                                         {</div>
<div class="line"><span class="lineno">  570</span>  <span class="comment">// one for every object + 1 for static points</span></div>
<div class="line"><span class="lineno">  571</span>  gtsam::FastMap&lt;ObjectId, Histogram&gt; histograms;</div>
<div class="line"><span class="lineno">  572</span> </div>
<div class="line"><span class="lineno">  573</span>  <span class="comment">// collect dynamic features</span></div>
<div class="line"><span class="lineno">  574</span>  <span class="keywordflow">for</span> (<span class="keyword">const</span> <span class="keyword">auto</span>&amp; [object_id, observations] : frame-&gt;getObjectObservations()) {</div>
<div class="line"><span class="lineno">  575</span>    <a class="code hl_class" href="classdyno_1_1Histogram.html">Histogram</a> hist(bh::make_histogram(bh::axis::variable&lt;&gt;(bins)));</div>
<div class="line"><span class="lineno">  576</span>    hist.name_ = <span class="stringliteral">&quot;tacklet-length-&quot;</span> + std::to_string(object_id);</div>
<div class="line"><span class="lineno">  577</span> </div>
<div class="line"><span class="lineno">  578</span>    <span class="keywordflow">for</span> (<span class="keyword">auto</span> tracklet_id : observations.object_features_) {</div>
<div class="line"><span class="lineno">  579</span>      <span class="keyword">const</span> Feature::Ptr feature = frame-&gt;at(tracklet_id);</div>
<div class="line"><span class="lineno">  580</span>      CHECK(feature);</div>
<div class="line"><span class="lineno">  581</span>      <span class="keywordflow">if</span> (feature-&gt;usable()) {</div>
<div class="line"><span class="lineno">  582</span>        hist.histogram_(feature-&gt;age());</div>
<div class="line"><span class="lineno">  583</span>      }</div>
<div class="line"><span class="lineno">  584</span>    }</div>
<div class="line"><span class="lineno">  585</span> </div>
<div class="line"><span class="lineno">  586</span>    histograms.insert2(object_id, hist);</div>
<div class="line"><span class="lineno">  587</span>  }</div>
<div class="line"><span class="lineno">  588</span> </div>
<div class="line"><span class="lineno">  589</span>  <span class="comment">// collect static features</span></div>
<div class="line"><span class="lineno">  590</span>  Histogram static_hist(bh::make_histogram(bh::axis::variable&lt;&gt;(bins)));</div>
<div class="line"><span class="lineno">  591</span>  static_hist.name_ = <span class="stringliteral">&quot;tacklet-length-0&quot;</span>;</div>
<div class="line"><span class="lineno">  592</span>  <span class="keywordflow">for</span> (<span class="keyword">const</span> <span class="keyword">auto</span>&amp; static_feature : frame-&gt;static_features_.beginUsable()) {</div>
<div class="line"><span class="lineno">  593</span>    static_hist.histogram_(static_feature-&gt;age());</div>
<div class="line"><span class="lineno">  594</span>  }</div>
<div class="line"><span class="lineno">  595</span>  histograms.insert2(background_label, static_hist);</div>
<div class="line"><span class="lineno">  596</span>  <span class="keywordflow">return</span> histograms;</div>
<div class="line"><span class="lineno">  597</span>}</div>
<div class="ttc" id="aclassdyno_1_1Histogram_html"><div class="ttname"><a href="classdyno_1_1Histogram.html">dyno::Histogram</a></div><div class="ttdef"><b>Definition:</b> <a href="Histogram_8hpp_source.html#l00038">Histogram.hpp:38</a></div></div>
</div><!-- fragment -->
<p class="reference">References <a class="el" href="namespacedyno.html#ae78915ea0afc5025dafb398829f15ba3">dyno::background_label</a>, <a class="el" href="classdyno_1_1Histogram.html#a88536a6a75b12af6e2a480d856d56560">dyno::Histogram::histogram_</a>, and <a class="el" href="classdyno_1_1Histogram.html#a411c9781e100046a9ade240c287ba6d0">dyno::Histogram::name_</a>.</p>

<p class="reference">Referenced by <a class="el" href="classdyno_1_1RGBDFrontendLogger.html#a87ab9ef3f6f6c14345dd7f1b1c23b00c">dyno::RGBDFrontendLogger::logTrackingLengthHistogram()</a>.</p>
<div class="dynheader">
Here is the caller graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="namespacedyno_1_1vision__tools_a299ddb654abf59383dcf29f7b013ba6f_icgraph.png" border="0" usemap="#anamespacedyno_1_1vision__tools_a299ddb654abf59383dcf29f7b013ba6f_icgraph" alt=""/></div>
<map name="anamespacedyno_1_1vision__tools_a299ddb654abf59383dcf29f7b013ba6f_icgraph" id="anamespacedyno_1_1vision__tools_a299ddb654abf59383dcf29f7b013ba6f_icgraph">
<area shape="rect" title="Constructs a map of histograms (static features: 0, one for each dynamic object) containing the track..." alt="" coords="269,5,504,45"/>
<area shape="rect" href="classdyno_1_1RGBDFrontendLogger.html#a87ab9ef3f6f6c14345dd7f1b1c23b00c" title=" " alt="" coords="5,5,221,45"/>
</map>
</div>

</div>
</div>
<a id="ae077e5d2722435f6731a8f58e3aab848" name="ae077e5d2722435f6731a8f58e3aab848"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ae077e5d2722435f6731a8f58e3aab848">&#9670;&#160;</a></span>relabelMasks()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void dyno::vision_tools::relabelMasks </td>
          <td>(</td>
          <td class="paramtype">const cv::Mat &amp;&#160;</td>
          <td class="paramname"><em>mask</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">cv::Mat &amp;&#160;</td>
          <td class="paramname"><em>relabelled_mask</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const <a class="el" href="namespacedyno.html#ae777b079c377ffa066d89051ee0cc623">ObjectIds</a> &amp;&#160;</td>
          <td class="paramname"><em>old_labels</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const <a class="el" href="namespacedyno.html#ae777b079c377ffa066d89051ee0cc623">ObjectIds</a> &amp;&#160;</td>
          <td class="paramname"><em>new_labels</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="VisionTools_8cc_source.html#l00543">543</a> of file <a class="el" href="VisionTools_8cc_source.html">VisionTools.cc</a>.</p>
<div class="fragment"><div class="line"><span class="lineno">  544</span>                                                                            {</div>
<div class="line"><span class="lineno">  545</span>  <span class="keywordflow">if</span> (old_labels.size() != old_labels.size()) {</div>
<div class="line"><span class="lineno">  546</span>    <span class="keywordflow">throw</span> std::invalid_argument(</div>
<div class="line"><span class="lineno">  547</span>        <span class="stringliteral">&quot;Old labels and new labels must have the same size&quot;</span>);</div>
<div class="line"><span class="lineno">  548</span>  }</div>
<div class="line"><span class="lineno">  549</span> </div>
<div class="line"><span class="lineno">  550</span>  <span class="comment">// Create a map from old labels to new labels</span></div>
<div class="line"><span class="lineno">  551</span>  std::unordered_map&lt;ObjectId, ObjectId&gt; label_map;</div>
<div class="line"><span class="lineno">  552</span>  <span class="keywordflow">for</span> (<span class="keywordtype">size_t</span> i = 0; i &lt; old_labels.size(); ++i) {</div>
<div class="line"><span class="lineno">  553</span>    label_map[old_labels[i]] = new_labels[i];</div>
<div class="line"><span class="lineno">  554</span>  }</div>
<div class="line"><span class="lineno">  555</span> </div>
<div class="line"><span class="lineno">  556</span>  mask.copyTo(relabelled_mask);</div>
<div class="line"><span class="lineno">  557</span>  <span class="comment">// / Relabel the pixels</span></div>
<div class="line"><span class="lineno">  558</span>  <span class="keywordflow">for</span> (<span class="keywordtype">int</span> r = 0; r &lt; relabelled_mask.rows; ++r) {</div>
<div class="line"><span class="lineno">  559</span>    <span class="keywordflow">for</span> (<span class="keywordtype">int</span> c = 0; c &lt; relabelled_mask.cols; ++c) {</div>
<div class="line"><span class="lineno">  560</span>      ObjectId pixelValue = relabelled_mask.at&lt;ObjectId&gt;(r, c);</div>
<div class="line"><span class="lineno">  561</span>      <span class="keywordflow">if</span> (label_map.find(pixelValue) != label_map.end()) {</div>
<div class="line"><span class="lineno">  562</span>        relabelled_mask.at&lt;ObjectId&gt;(r, c) = label_map[pixelValue];</div>
<div class="line"><span class="lineno">  563</span>      }</div>
<div class="line"><span class="lineno">  564</span>    }</div>
<div class="line"><span class="lineno">  565</span>  }</div>
<div class="line"><span class="lineno">  566</span>}</div>
</div><!-- fragment -->
<p class="reference">Referenced by <a class="el" href="classdyno_1_1ClusterSlamAllLoader.html#a074af7358c98d715599460ca2671ecc4">dyno::ClusterSlamAllLoader::associateDetectedBBWithObject()</a>, and <a class="el" href="classdyno_1_1ByteObjectTracker.html#aeb79dc19fb881160be780b9f4a2b2240">dyno::ByteObjectTracker::track()</a>.</p>
<div class="dynheader">
Here is the caller graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="namespacedyno_1_1vision__tools_ae077e5d2722435f6731a8f58e3aab848_icgraph.png" border="0" usemap="#anamespacedyno_1_1vision__tools_ae077e5d2722435f6731a8f58e3aab848_icgraph" alt=""/></div>
<map name="anamespacedyno_1_1vision__tools_ae077e5d2722435f6731a8f58e3aab848_icgraph" id="anamespacedyno_1_1vision__tools_ae077e5d2722435f6731a8f58e3aab848_icgraph">
<area shape="rect" title=" " alt="" coords="545,49,685,89"/>
<area shape="rect" href="classdyno_1_1ClusterSlamAllLoader.html#a074af7358c98d715599460ca2671ecc4" title=" " alt="" coords="256,5,497,45"/>
<area shape="rect" href="classdyno_1_1ByteObjectTracker.html#aeb79dc19fb881160be780b9f4a2b2240" title=" " alt="" coords="287,93,467,133"/>
<area shape="rect" href="classdyno_1_1ClusterSlamAllLoader.html#a6dbf46c48ea9477aa915bff62ee98ea8" title=" " alt="" coords="5,5,208,45"/>
</map>
</div>

</div>
</div>
<a id="a518b3162f275ce3e2301d249a7e1a6ff" name="a518b3162f275ce3e2301d249a7e1a6ff"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a518b3162f275ce3e2301d249a7e1a6ff">&#9670;&#160;</a></span>shrinkMask()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void dyno::vision_tools::shrinkMask </td>
          <td>(</td>
          <td class="paramtype">const cv::Mat &amp;&#160;</td>
          <td class="paramname"><em>mask</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">cv::Mat &amp;&#160;</td>
          <td class="paramname"><em>shrunk_mask</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int&#160;</td>
          <td class="paramname"><em>erosion_size</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Shrinks all found object masks by a given ammount. </p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">mask</td><td>const cv::Mat&amp; input object mask with pixel values 0, 1... j </td></tr>
    <tr><td class="paramname">shrunk_mask</td><td>cv::Mat&amp; output object mask with shrink masks. </td></tr>
    <tr><td class="paramname">erosion_size</td><td>int erosion size </td></tr>
  </table>
  </dd>
</dl>

<p class="definition">Definition at line <a class="el" href="VisionTools_8cc_source.html#l00498">498</a> of file <a class="el" href="VisionTools_8cc_source.html">VisionTools.cc</a>.</p>
<div class="fragment"><div class="line"><span class="lineno">  498</span>                                                                         {</div>
<div class="line"><span class="lineno">  499</span>  shrunk_mask = cv::Mat::zeros(mask.size(), mask.type());</div>
<div class="line"><span class="lineno">  500</span>  shrunk_mask.setTo(background_label);</div>
<div class="line"><span class="lineno">  501</span> </div>
<div class="line"><span class="lineno">  502</span>  <span class="keyword">const</span> <a class="code hl_typedef" href="namespacedyno.html#ae777b079c377ffa066d89051ee0cc623">ObjectIds</a> original_object_labels = <a class="code hl_function" href="namespacedyno_1_1vision__tools.html#a3a09fe6c15aeb5e18979dc27d68c4616">getObjectLabels</a>(mask);</div>
<div class="line"><span class="lineno">  503</span> </div>
<div class="line"><span class="lineno">  504</span>  <span class="keyword">const</span> cv::Mat element = cv::getStructuringElement(</div>
<div class="line"><span class="lineno">  505</span>      cv::MORPH_RECT, cv::Size(2 * erosion_size + 1, 2 * erosion_size + 1));</div>
<div class="line"><span class="lineno">  506</span> </div>
<div class="line"><span class="lineno">  507</span>  <span class="keywordflow">for</span> (<span class="keyword">const</span> <span class="keyword">auto</span> object_id : original_object_labels) {</div>
<div class="line"><span class="lineno">  508</span>    cv::Mat obj_mask = (mask == object_id);</div>
<div class="line"><span class="lineno">  509</span>    cv::Mat eroded_mask;</div>
<div class="line"><span class="lineno">  510</span>    cv::erode(obj_mask, eroded_mask, element);</div>
<div class="line"><span class="lineno">  511</span>    shrunk_mask = shrunk_mask.setTo(object_id, eroded_mask);</div>
<div class="line"><span class="lineno">  512</span>  }</div>
<div class="line"><span class="lineno">  513</span>}</div>
<div class="ttc" id="anamespacedyno_1_1vision__tools_html_a3a09fe6c15aeb5e18979dc27d68c4616"><div class="ttname"><a href="namespacedyno_1_1vision__tools.html#a3a09fe6c15aeb5e18979dc27d68c4616">dyno::vision_tools::getObjectLabels</a></div><div class="ttdeci">ObjectIds getObjectLabels(const cv::Mat &amp;image)</div><div class="ttdoc">Finds the unique object labels (j) as present in the instance segmentation image. Does not include th...</div><div class="ttdef"><b>Definition:</b> <a href="VisionTools_8cc_source.html#l00069">VisionTools.cc:69</a></div></div>
</div><!-- fragment -->
<p class="reference">References <a class="el" href="namespacedyno.html#ae78915ea0afc5025dafb398829f15ba3">dyno::background_label</a>, and <a class="el" href="namespacedyno_1_1vision__tools.html#a3a09fe6c15aeb5e18979dc27d68c4616">getObjectLabels()</a>.</p>
<div class="dynheader">
Here is the call graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="namespacedyno_1_1vision__tools_a518b3162f275ce3e2301d249a7e1a6ff_cgraph.png" border="0" usemap="#anamespacedyno_1_1vision__tools_a518b3162f275ce3e2301d249a7e1a6ff_cgraph" alt=""/></div>
<map name="anamespacedyno_1_1vision__tools_a518b3162f275ce3e2301d249a7e1a6ff_cgraph" id="anamespacedyno_1_1vision__tools_a518b3162f275ce3e2301d249a7e1a6ff_cgraph">
<area shape="rect" title="Shrinks all found object masks by a given ammount." alt="" coords="5,5,145,45"/>
<area shape="rect" href="namespacedyno_1_1vision__tools.html#a3a09fe6c15aeb5e18979dc27d68c4616" title="Finds the unique object labels (j) as present in the instance segmentation image. Does not include th..." alt="" coords="193,5,333,45"/>
</map>
</div>

</div>
</div>
<a id="a70f3daa5a2a0fb3a715ffb1fb65992cb" name="a70f3daa5a2a0fb3a715ffb1fb65992cb"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a70f3daa5a2a0fb3a715ffb1fb65992cb">&#9670;&#160;</a></span>trackDynamic()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">std::vector&lt; std::vector&lt; int &gt; &gt; dyno::vision_tools::trackDynamic </td>
          <td>(</td>
          <td class="paramtype">const <a class="el" href="structdyno_1_1FrontendParams.html">FrontendParams</a> &amp;&#160;</td>
          <td class="paramname"><em>params</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const <a class="el" href="classdyno_1_1Frame.html">Frame</a> &amp;&#160;</td>
          <td class="paramname"><em>previous_frame</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">Frame::Ptr&#160;</td>
          <td class="paramname"><em>current_frame</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Depricate ;) </p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">params</td><td></td></tr>
    <tr><td class="paramname">previous_frame</td><td></td></tr>
    <tr><td class="paramname">current_frame</td><td></td></tr>
  </table>
  </dd>
</dl>
<dl class="section return"><dt>Returns</dt><dd></dd></dl>

<p class="definition">Definition at line <a class="el" href="VisionTools_8cc_source.html#l00317">317</a> of file <a class="el" href="VisionTools_8cc_source.html">VisionTools.cc</a>.</p>
<div class="fragment"><div class="line"><span class="lineno">  319</span>                                                                   {</div>
<div class="line"><span class="lineno">  320</span>  <span class="keyword">auto</span>&amp; objects_by_instance_label = current_frame-&gt;object_observations_;</div>
<div class="line"><span class="lineno">  321</span> </div>
<div class="line"><span class="lineno">  322</span>  <span class="keyword">auto</span>&amp; previous_dynamic_feature_container = previous_frame.<a class="code hl_variable" href="classdyno_1_1Frame.html#a25df20e3d82010bd6d0fb5d9106ea5ff">dynamic_features_</a>;</div>
<div class="line"><span class="lineno">  323</span>  <span class="keyword">auto</span>&amp; current_dynamic_feature_container = current_frame-&gt;dynamic_features_;</div>
<div class="line"><span class="lineno">  324</span> </div>
<div class="line"><span class="lineno">  325</span>  <a class="code hl_typedef" href="namespacedyno.html#ae777b079c377ffa066d89051ee0cc623">ObjectIds</a> instance_labels_to_remove;</div>
<div class="line"><span class="lineno">  326</span> </div>
<div class="line"><span class="lineno">  327</span>  <span class="comment">// TODO: shrink object boundary?</span></div>
<div class="line"><span class="lineno">  328</span>  <span class="keywordflow">for</span> (<span class="keyword">auto</span>&amp; [instance_label, object_observation] : objects_by_instance_label) {</div>
<div class="line"><span class="lineno">  329</span>    <span class="keywordtype">double</span> obj_center_depth = 0, sf_min = 100, sf_max = 0, sf_mean = 0,</div>
<div class="line"><span class="lineno">  330</span>           sf_count = 0;</div>
<div class="line"><span class="lineno">  331</span>    std::vector&lt;int&gt; sf_range(10, 0);</div>
<div class="line"><span class="lineno">  332</span> </div>
<div class="line"><span class="lineno">  333</span>    <span class="keyword">const</span> <span class="keywordtype">size_t</span> num_object_features =</div>
<div class="line"><span class="lineno">  334</span>        object_observation.object_features_.size();</div>
<div class="line"><span class="lineno">  335</span>    <span class="comment">// LOG(INFO) &lt;&lt; &quot;tracking object observation with instance label &quot; &lt;&lt;</span></div>
<div class="line"><span class="lineno">  336</span>    <span class="comment">// instance_label &lt;&lt; &quot; and &quot; &lt;&lt; num_object_features &lt;&lt; &quot; features&quot;;</span></div>
<div class="line"><span class="lineno">  337</span> </div>
<div class="line"><span class="lineno">  338</span>    <span class="keywordtype">int</span> feature_pairs_valid = 0;</div>
<div class="line"><span class="lineno">  339</span>    <span class="keywordtype">int</span> num_found = 0;</div>
<div class="line"><span class="lineno">  340</span>    <span class="keywordflow">for</span> (<span class="keyword">const</span> <a class="code hl_typedef" href="namespacedyno.html#afdd174eb44901fb205371d796287378c">TrackletId</a> tracklet_id : object_observation.object_features_) {</div>
<div class="line"><span class="lineno">  341</span>      <span class="keywordflow">if</span> (previous_dynamic_feature_container.exists(tracklet_id)) {</div>
<div class="line"><span class="lineno">  342</span>        num_found++;</div>
<div class="line"><span class="lineno">  343</span>        CHECK(current_dynamic_feature_container.exists(tracklet_id));</div>
<div class="line"><span class="lineno">  344</span> </div>
<div class="line"><span class="lineno">  345</span>        Feature::Ptr current_feature =</div>
<div class="line"><span class="lineno">  346</span>            current_dynamic_feature_container.getByTrackletId(tracklet_id);</div>
<div class="line"><span class="lineno">  347</span>        Feature::Ptr previous_feature =</div>
<div class="line"><span class="lineno">  348</span>            previous_dynamic_feature_container.getByTrackletId(tracklet_id);</div>
<div class="line"><span class="lineno">  349</span> </div>
<div class="line"><span class="lineno">  350</span>        <span class="keywordflow">if</span> (!previous_feature-&gt;usable()) {</div>
<div class="line"><span class="lineno">  351</span>          current_feature-&gt;markInvalid();</div>
<div class="line"><span class="lineno">  352</span>          <span class="keywordflow">continue</span>;</div>
<div class="line"><span class="lineno">  353</span>        }</div>
<div class="line"><span class="lineno">  354</span> </div>
<div class="line"><span class="lineno">  355</span>        <span class="comment">// this can happen in situations such as the updateDepths when depths &gt;</span></div>
<div class="line"><span class="lineno">  356</span>        <span class="comment">// thresh are marked invalud</span></div>
<div class="line"><span class="lineno">  357</span>        <span class="keywordflow">if</span> (!current_feature-&gt;usable()) {</div>
<div class="line"><span class="lineno">  358</span>          <span class="keywordflow">continue</span>;</div>
<div class="line"><span class="lineno">  359</span>        }</div>
<div class="line"><span class="lineno">  360</span> </div>
<div class="line"><span class="lineno">  361</span>        CHECK(!previous_feature-&gt;isStatic());</div>
<div class="line"><span class="lineno">  362</span>        CHECK(!current_feature-&gt;isStatic());</div>
<div class="line"><span class="lineno">  363</span> </div>
<div class="line"><span class="lineno">  364</span>        Landmark lmk_previous = previous_frame.<a class="code hl_function" href="classdyno_1_1Frame.html#ae588299966f1a710e11db6d64cc5b707">backProjectToWorld</a>(tracklet_id);</div>
<div class="line"><span class="lineno">  365</span>        Landmark lmk_current = current_frame-&gt;backProjectToWorld(tracklet_id);</div>
<div class="line"><span class="lineno">  366</span> </div>
<div class="line"><span class="lineno">  367</span>        Landmark flow_world = lmk_current - lmk_previous;</div>
<div class="line"><span class="lineno">  368</span>        <span class="keywordtype">double</span> sf_norm = flow_world.norm();</div>
<div class="line"><span class="lineno">  369</span> </div>
<div class="line"><span class="lineno">  370</span>        feature_pairs_valid++;</div>
<div class="line"><span class="lineno">  371</span> </div>
<div class="line"><span class="lineno">  372</span>        <span class="keywordflow">if</span> (sf_norm &lt; params.<a class="code hl_variable" href="structdyno_1_1FrontendParams.html#a27cd8ab520f7cbeb68e75a3b49cf26ef">scene_flow_magnitude</a>) sf_count = sf_count + 1;</div>
<div class="line"><span class="lineno">  373</span>        <span class="keywordflow">if</span> (sf_norm &lt; sf_min) sf_min = sf_norm;</div>
<div class="line"><span class="lineno">  374</span>        <span class="keywordflow">if</span> (sf_norm &gt; sf_max) sf_max = sf_norm;</div>
<div class="line"><span class="lineno">  375</span>        sf_mean = sf_mean + sf_norm;</div>
<div class="line"><span class="lineno">  376</span> </div>
<div class="line"><span class="lineno">  377</span>        {</div>
<div class="line"><span class="lineno">  378</span>          <span class="keywordflow">if</span> (0.0 &lt;= sf_norm &amp;&amp; sf_norm &lt; 0.05)</div>
<div class="line"><span class="lineno">  379</span>            sf_range[0] = sf_range[0] + 1;</div>
<div class="line"><span class="lineno">  380</span>          <span class="keywordflow">else</span> <span class="keywordflow">if</span> (0.05 &lt;= sf_norm &amp;&amp; sf_norm &lt; 0.1)</div>
<div class="line"><span class="lineno">  381</span>            sf_range[1] = sf_range[1] + 1;</div>
<div class="line"><span class="lineno">  382</span>          <span class="keywordflow">else</span> <span class="keywordflow">if</span> (0.1 &lt;= sf_norm &amp;&amp; sf_norm &lt; 0.2)</div>
<div class="line"><span class="lineno">  383</span>            sf_range[2] = sf_range[2] + 1;</div>
<div class="line"><span class="lineno">  384</span>          <span class="keywordflow">else</span> <span class="keywordflow">if</span> (0.2 &lt;= sf_norm &amp;&amp; sf_norm &lt; 0.4)</div>
<div class="line"><span class="lineno">  385</span>            sf_range[3] = sf_range[3] + 1;</div>
<div class="line"><span class="lineno">  386</span>          <span class="keywordflow">else</span> <span class="keywordflow">if</span> (0.4 &lt;= sf_norm &amp;&amp; sf_norm &lt; 0.8)</div>
<div class="line"><span class="lineno">  387</span>            sf_range[4] = sf_range[4] + 1;</div>
<div class="line"><span class="lineno">  388</span>          <span class="keywordflow">else</span> <span class="keywordflow">if</span> (0.8 &lt;= sf_norm &amp;&amp; sf_norm &lt; 1.6)</div>
<div class="line"><span class="lineno">  389</span>            sf_range[5] = sf_range[5] + 1;</div>
<div class="line"><span class="lineno">  390</span>          <span class="keywordflow">else</span> <span class="keywordflow">if</span> (1.6 &lt;= sf_norm &amp;&amp; sf_norm &lt; 3.2)</div>
<div class="line"><span class="lineno">  391</span>            sf_range[6] = sf_range[6] + 1;</div>
<div class="line"><span class="lineno">  392</span>          <span class="keywordflow">else</span> <span class="keywordflow">if</span> (3.2 &lt;= sf_norm &amp;&amp; sf_norm &lt; 6.4)</div>
<div class="line"><span class="lineno">  393</span>            sf_range[7] = sf_range[7] + 1;</div>
<div class="line"><span class="lineno">  394</span>          <span class="keywordflow">else</span> <span class="keywordflow">if</span> (6.4 &lt;= sf_norm &amp;&amp; sf_norm &lt; 12.8)</div>
<div class="line"><span class="lineno">  395</span>            sf_range[8] = sf_range[8] + 1;</div>
<div class="line"><span class="lineno">  396</span>          <span class="keywordflow">else</span> <span class="keywordflow">if</span> (12.8 &lt;= sf_norm &amp;&amp; sf_norm &lt; 25.6)</div>
<div class="line"><span class="lineno">  397</span>            sf_range[9] = sf_range[9] + 1;</div>
<div class="line"><span class="lineno">  398</span>        }</div>
<div class="line"><span class="lineno">  399</span>      }</div>
<div class="line"><span class="lineno">  400</span>    }</div>
<div class="line"><span class="lineno">  401</span> </div>
<div class="line"><span class="lineno">  402</span>    VLOG(10) &lt;&lt; <span class="stringliteral">&quot;Number feature pairs valid &quot;</span> &lt;&lt; feature_pairs_valid</div>
<div class="line"><span class="lineno">  403</span>             &lt;&lt; <span class="stringliteral">&quot; out of &quot;</span> &lt;&lt; num_object_features &lt;&lt; <span class="stringliteral">&quot; for instance  &quot;</span></div>
<div class="line"><span class="lineno">  404</span>             &lt;&lt; instance_label &lt;&lt; <span class="stringliteral">&quot; num found &quot;</span> &lt;&lt; num_found;</div>
<div class="line"><span class="lineno">  405</span> </div>
<div class="line"><span class="lineno">  406</span>    <span class="comment">// if no points found (i.e tracked)</span></div>
<div class="line"><span class="lineno">  407</span>    <span class="comment">// dont do anything as this is a new object so we cannot say if its dynamic</span></div>
<div class="line"><span class="lineno">  408</span>    <span class="comment">// or not</span></div>
<div class="line"><span class="lineno">  409</span>    <span class="keywordflow">if</span> (num_found == 0) {</div>
<div class="line"><span class="lineno">  410</span>      <span class="comment">// TODO: i guess?</span></div>
<div class="line"><span class="lineno">  411</span>      object_observation.marked_as_moving_ = <span class="keyword">true</span>;</div>
<div class="line"><span class="lineno">  412</span>    }</div>
<div class="line"><span class="lineno">  413</span>    <span class="keywordflow">if</span> (sf_count / num_object_features &gt; params.<a class="code hl_variable" href="structdyno_1_1FrontendParams.html#ae4e06ec2821e70fd421cfe0ba74ad8c5">scene_flow_percentage</a> ||</div>
<div class="line"><span class="lineno">  414</span>        num_object_features &lt; 30)</div>
<div class="line"><span class="lineno">  415</span>    <span class="comment">// else if (sf_count/num_object_features&gt;params.scene_flow_percentage ||</span></div>
<div class="line"><span class="lineno">  416</span>    <span class="comment">// num_object_features &lt; 15)</span></div>
<div class="line"><span class="lineno">  417</span>    {</div>
<div class="line"><span class="lineno">  418</span>      <span class="comment">// label this object as static background</span></div>
<div class="line"><span class="lineno">  419</span>      <span class="comment">// LOG(INFO) &lt;&lt; &quot;Instance object &quot; &lt;&lt; instance_label &lt;&lt; &quot; to static for</span></div>
<div class="line"><span class="lineno">  420</span>      <span class="comment">// frame &quot; &lt;&lt; current_frame-&gt;frame_id_;</span></div>
<div class="line"><span class="lineno">  421</span>      instance_labels_to_remove.push_back(instance_label);</div>
<div class="line"><span class="lineno">  422</span>    } <span class="keywordflow">else</span> {</div>
<div class="line"><span class="lineno">  423</span>      <span class="comment">// LOG(INFO) &lt;&lt; &quot;Instance object &quot; &lt;&lt; instance_label &lt;&lt; &quot; marked as</span></div>
<div class="line"><span class="lineno">  424</span>      <span class="comment">// dynamic&quot;;</span></div>
<div class="line"><span class="lineno">  425</span>      object_observation.marked_as_moving_ = <span class="keyword">true</span>;</div>
<div class="line"><span class="lineno">  426</span>    }</div>
<div class="line"><span class="lineno">  427</span>  }</div>
<div class="line"><span class="lineno">  428</span> </div>
<div class="line"><span class="lineno">  429</span>  <span class="comment">// we do the removal after the iteration so as not to mess up the loop</span></div>
<div class="line"><span class="lineno">  430</span>  <span class="keywordflow">for</span> (<span class="keyword">const</span> <span class="keyword">auto</span> label : instance_labels_to_remove) {</div>
<div class="line"><span class="lineno">  431</span>    VLOG(30) &lt;&lt; <span class="stringliteral">&quot;Removing label &quot;</span> &lt;&lt; label;</div>
<div class="line"><span class="lineno">  432</span>    <span class="comment">// TODO: this is really really slow!!</span></div>
<div class="line"><span class="lineno">  433</span>    current_frame-&gt;moveObjectToStatic(label);</div>
<div class="line"><span class="lineno">  434</span>    <span class="comment">// LOG(INFO) &lt;&lt; &quot;Done Removing label &quot; &lt;&lt; label;</span></div>
<div class="line"><span class="lineno">  435</span>  }</div>
<div class="line"><span class="lineno">  436</span> </div>
<div class="line"><span class="lineno">  437</span>  <span class="keywordflow">return</span> std::vector&lt;std::vector&lt;int&gt;&gt;();</div>
<div class="line"><span class="lineno">  438</span>}</div>
<div class="ttc" id="aclassdyno_1_1Frame_html_a25df20e3d82010bd6d0fb5d9106ea5ff"><div class="ttname"><a href="classdyno_1_1Frame.html#a25df20e3d82010bd6d0fb5d9106ea5ff">dyno::Frame::dynamic_features_</a></div><div class="ttdeci">FeatureContainer dynamic_features_</div><div class="ttdef"><b>Definition:</b> <a href="Frame_8hpp_source.html#l00057">Frame.hpp:57</a></div></div>
<div class="ttc" id="aclassdyno_1_1Frame_html_ae588299966f1a710e11db6d64cc5b707"><div class="ttname"><a href="classdyno_1_1Frame.html#ae588299966f1a710e11db6d64cc5b707">dyno::Frame::backProjectToWorld</a></div><div class="ttdeci">Landmark backProjectToWorld(TrackletId tracklet_id) const</div><div class="ttdoc">Project the feature into the world frame using the frames pose (T_world_camera_) and returns the 3D l...</div><div class="ttdef"><b>Definition:</b> <a href="Frame_8cc_source.html#l00128">Frame.cc:128</a></div></div>
<div class="ttc" id="anamespacedyno_html_afdd174eb44901fb205371d796287378c"><div class="ttname"><a href="namespacedyno.html#afdd174eb44901fb205371d796287378c">dyno::TrackletId</a></div><div class="ttdeci">long int TrackletId</div><div class="ttdoc">Unique tracklet/landmark id, i.</div><div class="ttdef"><b>Definition:</b> <a href="Types_8hpp_source.html#l00079">Types.hpp:79</a></div></div>
<div class="ttc" id="astructdyno_1_1FrontendParams_html_a27cd8ab520f7cbeb68e75a3b49cf26ef"><div class="ttname"><a href="structdyno_1_1FrontendParams.html#a27cd8ab520f7cbeb68e75a3b49cf26ef">dyno::FrontendParams::scene_flow_magnitude</a></div><div class="ttdeci">double scene_flow_magnitude</div><div class="ttdef"><b>Definition:</b> <a href="FrontendParams_8hpp_source.html#l00038">FrontendParams.hpp:38</a></div></div>
<div class="ttc" id="astructdyno_1_1FrontendParams_html_ae4e06ec2821e70fd421cfe0ba74ad8c5"><div class="ttname"><a href="structdyno_1_1FrontendParams.html#ae4e06ec2821e70fd421cfe0ba74ad8c5">dyno::FrontendParams::scene_flow_percentage</a></div><div class="ttdeci">double scene_flow_percentage</div><div class="ttdef"><b>Definition:</b> <a href="FrontendParams_8hpp_source.html#l00039">FrontendParams.hpp:39</a></div></div>
</div><!-- fragment -->
<p class="reference">References <a class="el" href="classdyno_1_1Frame.html#ae588299966f1a710e11db6d64cc5b707">dyno::Frame::backProjectToWorld()</a>, <a class="el" href="classdyno_1_1Frame.html#a25df20e3d82010bd6d0fb5d9106ea5ff">dyno::Frame::dynamic_features_</a>, <a class="el" href="structdyno_1_1FrontendParams.html#a27cd8ab520f7cbeb68e75a3b49cf26ef">dyno::FrontendParams::scene_flow_magnitude</a>, and <a class="el" href="structdyno_1_1FrontendParams.html#ae4e06ec2821e70fd421cfe0ba74ad8c5">dyno::FrontendParams::scene_flow_percentage</a>.</p>

<p class="reference">Referenced by <a class="el" href="classdyno_1_1RGBDInstanceFrontendModule.html#a4528368033583ee53198dac3a803c5f2">dyno::RGBDInstanceFrontendModule::nominalSpin()</a>.</p>
<div class="dynheader">
Here is the call graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="namespacedyno_1_1vision__tools_a70f3daa5a2a0fb3a715ffb1fb65992cb_cgraph.png" border="0" usemap="#anamespacedyno_1_1vision__tools_a70f3daa5a2a0fb3a715ffb1fb65992cb_cgraph" alt=""/></div>
<map name="anamespacedyno_1_1vision__tools_a70f3daa5a2a0fb3a715ffb1fb65992cb_cgraph" id="anamespacedyno_1_1vision__tools_a70f3daa5a2a0fb3a715ffb1fb65992cb_cgraph">
<area shape="rect" title="Depricate ;)" alt="" coords="5,45,145,85"/>
<area shape="rect" href="classdyno_1_1Frame.html#ae588299966f1a710e11db6d64cc5b707" title="Project the feature into the world frame using the frames pose (T_world_camera_) and returns the 3D l..." alt="" coords="193,45,380,85"/>
<area shape="rect" href="classdyno_1_1Frame.html#ab1af68fa722b3a69160ae0436318ad19" title="Gets a feature from its tracklet ID. Could be static or dynamic. Nullptr is returned if the feature d..." alt="" coords="465,23,589,49"/>
<area shape="rect" href="classdyno_1_1Frame.html#a32308c0857baace44e2d5e8e406be685" title=" " alt="" coords="428,73,625,113"/>
<area shape="rect" href="classdyno_1_1FeatureContainer.html#abf2f2d568f5dc17944cc122c537a65f5" title="Returns true if a feature with the given tracklet id exists." alt="" coords="896,16,1071,56"/>
<area shape="rect" href="classdyno_1_1Frame.html#ab9f7b3f513aeff82d47de7a72d66a69a" title="Checks if a feature exists within this frame. Could be static or dynamic." alt="" coords="685,23,836,49"/>
<area shape="rect" href="classdyno_1_1FeatureContainer.html#a5b73e75d2f4063ac9c16dd0fd565f8da" title="Gets a feature given its tracklet id. If the feature does not exist, nullptr is returned." alt="" coords="673,73,848,113"/>
</map>
</div>
<div class="dynheader">
Here is the caller graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="namespacedyno_1_1vision__tools_a70f3daa5a2a0fb3a715ffb1fb65992cb_icgraph.png" border="0" usemap="#anamespacedyno_1_1vision__tools_a70f3daa5a2a0fb3a715ffb1fb65992cb_icgraph" alt=""/></div>
<map name="anamespacedyno_1_1vision__tools_a70f3daa5a2a0fb3a715ffb1fb65992cb_icgraph" id="anamespacedyno_1_1vision__tools_a70f3daa5a2a0fb3a715ffb1fb65992cb_icgraph">
<area shape="rect" title="Depricate ;)" alt="" coords="265,5,405,45"/>
<area shape="rect" href="classdyno_1_1RGBDInstanceFrontendModule.html#a4528368033583ee53198dac3a803c5f2" title=" " alt="" coords="5,5,217,45"/>
</map>
</div>

</div>
</div>
<a id="a5d8b89d2b560b498934853c77a7d9f28" name="a5d8b89d2b560b498934853c77a7d9f28"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a5d8b89d2b560b498934853c77a7d9f28">&#9670;&#160;</a></span>writeOutProjectMaskAndDepthMap()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void dyno::vision_tools::writeOutProjectMaskAndDepthMap </td>
          <td>(</td>
          <td class="paramtype">const <a class="el" href="structdyno_1_1ImageWrapper.html">ImageWrapper</a>&lt; <a class="el" href="structdyno_1_1ImageType_1_1Depth.html">ImageType::Depth</a> &gt; &amp;&#160;</td>
          <td class="paramname"><em>depth_image</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const <a class="el" href="structdyno_1_1ImageWrapper.html">ImageWrapper</a>&lt; <a class="el" href="structdyno_1_1ImageType_1_1SemanticMask.html">ImageType::SemanticMask</a> &gt; &amp;&#160;</td>
          <td class="paramname"><em>mask_image</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const <a class="el" href="classdyno_1_1Camera.html">Camera</a> &amp;&#160;</td>
          <td class="paramname"><em>camera</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="namespacedyno.html#ac4303d6fafb755f794b072d76f9cfb41">FrameId</a>&#160;</td>
          <td class="paramname"><em>frame_id</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Saves a re-projected 3D point cloud with labelled points to file as a cv::Mat. </p>
<p>The depth map is projected into the camera coordinate frame and each pixel is labelled with the tracking label from the mask.</p>
<p>The final image is saved as a CV_64F (double) of W X H X 4 where channels [0:3] are the xyz values of the point and [3] is the tracking label (0=background, 1....N object track label).</p>
<p>Used for reconstructing testing.</p>
<p>Write to a folder called project_mask in the OutputFolder defined by getOutputFilePath.</p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">depth_image</td><td>NOTE: can be any mask (motion, semantic...) </td></tr>
    <tr><td class="paramname">mask_image</td><td></td></tr>
    <tr><td class="paramname">frame_id</td><td></td></tr>
  </table>
  </dd>
</dl>

<p class="definition">Definition at line <a class="el" href="VisionTools_8cc_source.html#l00640">640</a> of file <a class="el" href="VisionTools_8cc_source.html">VisionTools.cc</a>.</p>
<div class="fragment"><div class="line"><span class="lineno">  643</span>                                            {</div>
<div class="line"><span class="lineno">  644</span>  cv::Mat point_cloud =</div>
<div class="line"><span class="lineno">  645</span>      <a class="code hl_function" href="namespacedyno_1_1vision__tools.html#aaabcfcca356f30c83a45a51259e39783">depthTo3D</a>(depth_image, camera.<a class="code hl_function" href="classdyno_1_1Camera.html#af56ce3541d3ef8a7bcb2246e4634ca59">getParams</a>().<a class="code hl_function" href="classdyno_1_1CameraParams.html#ae50eb600c23415b3f7bd46e70553f96a">getCameraMatrix</a>());</div>
<div class="line"><span class="lineno">  646</span> </div>
<div class="line"><span class="lineno">  647</span>  <span class="keyword">const</span> cv::Mat&amp; mask = mask_image;</div>
<div class="line"><span class="lineno">  648</span> </div>
<div class="line"><span class="lineno">  649</span>  <span class="comment">// new mask of double type to match the type of the output cloud</span></div>
<div class="line"><span class="lineno">  650</span>  cv::Mat mask_double;</div>
<div class="line"><span class="lineno">  651</span>  mask.copyTo(mask_double);</div>
<div class="line"><span class="lineno">  652</span>  mask_double.convertTo(mask_double, CV_64F);</div>
<div class="line"><span class="lineno">  653</span> </div>
<div class="line"><span class="lineno">  654</span>  std::vector&lt;cv::Mat&gt; channels = {point_cloud, mask_double};</div>
<div class="line"><span class="lineno">  655</span> </div>
<div class="line"><span class="lineno">  656</span>  cv::Mat projected_cloud;</div>
<div class="line"><span class="lineno">  657</span>  cv::merge(channels, projected_cloud);</div>
<div class="line"><span class="lineno">  658</span> </div>
<div class="line"><span class="lineno">  659</span>  <span class="keyword">static</span> <span class="keyword">const</span> <span class="keyword">auto</span> folder_name = <span class="stringliteral">&quot;project_mask&quot;</span>;</div>
<div class="line"><span class="lineno">  660</span>  <span class="keyword">const</span> std::string output_folder = <a class="code hl_function" href="namespacedyno.html#a80a71f28f4f692dc9c21976237dfcfe1">getOutputFilePath</a>(folder_name);</div>
<div class="line"><span class="lineno">  661</span> </div>
<div class="line"><span class="lineno">  662</span>  <span class="comment">// create write out directly if it does not exist</span></div>
<div class="line"><span class="lineno">  663</span>  <a class="code hl_function" href="namespacedyno.html#a2c13b22c0d8be0826712863c5ce0770e">createDirectory</a>(output_folder);</div>
<div class="line"><span class="lineno">  664</span> </div>
<div class="line"><span class="lineno">  665</span>  <span class="keyword">const</span> std::string file_name =</div>
<div class="line"><span class="lineno">  666</span>      output_folder + <span class="stringliteral">&quot;/&quot;</span> + std::to_string(frame_id) + <span class="stringliteral">&quot;.yml&quot;</span>;</div>
<div class="line"><span class="lineno">  667</span>  cv::FileStorage file(file_name, cv::FileStorage::WRITE);</div>
<div class="line"><span class="lineno">  668</span>  file &lt;&lt; <span class="stringliteral">&quot;matrix&quot;</span> &lt;&lt; projected_cloud;</div>
<div class="line"><span class="lineno">  669</span>  file.release();</div>
<div class="line"><span class="lineno">  670</span>}</div>
<div class="ttc" id="aclassdyno_1_1CameraParams_html_ae50eb600c23415b3f7bd46e70553f96a"><div class="ttname"><a href="classdyno_1_1CameraParams.html#ae50eb600c23415b3f7bd46e70553f96a">dyno::CameraParams::getCameraMatrix</a></div><div class="ttdeci">cv::Mat getCameraMatrix() const</div><div class="ttdef"><b>Definition:</b> <a href="CameraParams_8hpp_source.html#l00110">CameraParams.hpp:110</a></div></div>
<div class="ttc" id="aclassdyno_1_1Camera_html_af56ce3541d3ef8a7bcb2246e4634ca59"><div class="ttname"><a href="classdyno_1_1Camera.html#af56ce3541d3ef8a7bcb2246e4634ca59">dyno::Camera::getParams</a></div><div class="ttdeci">const CameraParams &amp; getParams() const</div><div class="ttdef"><b>Definition:</b> <a href="Camera_8hpp_source.html#l00163">Camera.hpp:163</a></div></div>
<div class="ttc" id="anamespacedyno_1_1vision__tools_html_aaabcfcca356f30c83a45a51259e39783"><div class="ttname"><a href="namespacedyno_1_1vision__tools.html#aaabcfcca356f30c83a45a51259e39783">dyno::vision_tools::depthTo3D</a></div><div class="ttdeci">cv::Mat depthTo3D(const ImageWrapper&lt; ImageType::Depth &gt; &amp;depth_image, const cv::Mat &amp;K)</div><div class="ttdoc">Projects a dense depth map to 3D coordinates in the local frame.</div><div class="ttdef"><b>Definition:</b> <a href="VisionTools_8cc_source.html#l00599">VisionTools.cc:599</a></div></div>
<div class="ttc" id="anamespacedyno_html_a2c13b22c0d8be0826712863c5ce0770e"><div class="ttname"><a href="namespacedyno.html#a2c13b22c0d8be0826712863c5ce0770e">dyno::createDirectory</a></div><div class="ttdeci">bool createDirectory(const std::string &amp;path)</div><div class="ttdoc">Create a directory at the given path.</div><div class="ttdef"><b>Definition:</b> <a href="Logger_8cc_source.html#l00064">Logger.cc:64</a></div></div>
<div class="ttc" id="anamespacedyno_html_a80a71f28f4f692dc9c21976237dfcfe1"><div class="ttname"><a href="namespacedyno.html#a80a71f28f4f692dc9c21976237dfcfe1">dyno::getOutputFilePath</a></div><div class="ttdeci">std::string getOutputFilePath(const std::string &amp;file_name)</div><div class="ttdoc">Constructs a file path (using the file name) where the root of the path is defined by the FLAGS_outpu...</div><div class="ttdef"><b>Definition:</b> <a href="Logger_8cc_source.html#l00047">Logger.cc:47</a></div></div>
</div><!-- fragment -->
<p class="reference">References <a class="el" href="namespacedyno.html#a2c13b22c0d8be0826712863c5ce0770e">dyno::createDirectory()</a>, <a class="el" href="namespacedyno_1_1vision__tools.html#aaabcfcca356f30c83a45a51259e39783">depthTo3D()</a>, <a class="el" href="classdyno_1_1CameraParams.html#ae50eb600c23415b3f7bd46e70553f96a">dyno::CameraParams::getCameraMatrix()</a>, <a class="el" href="namespacedyno.html#a80a71f28f4f692dc9c21976237dfcfe1">dyno::getOutputFilePath()</a>, and <a class="el" href="classdyno_1_1Camera.html#af56ce3541d3ef8a7bcb2246e4634ca59">dyno::Camera::getParams()</a>.</p>

<p class="reference">Referenced by <a class="el" href="classdyno_1_1RGBDInstanceFrontendModule.html#a4528368033583ee53198dac3a803c5f2">dyno::RGBDInstanceFrontendModule::nominalSpin()</a>.</p>
<div class="dynheader">
Here is the call graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="namespacedyno_1_1vision__tools_a5d8b89d2b560b498934853c77a7d9f28_cgraph.png" border="0" usemap="#anamespacedyno_1_1vision__tools_a5d8b89d2b560b498934853c77a7d9f28_cgraph" alt=""/></div>
<map name="anamespacedyno_1_1vision__tools_a5d8b89d2b560b498934853c77a7d9f28_cgraph" id="anamespacedyno_1_1vision__tools_a5d8b89d2b560b498934853c77a7d9f28_cgraph">
<area shape="rect" title="Saves a re&#45;projected 3D point cloud with labelled points to file as a cv::Mat." alt="" coords="5,119,264,159"/>
<area shape="rect" href="namespacedyno.html#a2c13b22c0d8be0826712863c5ce0770e" title="Create a directory at the given path." alt="" coords="326,5,489,31"/>
<area shape="rect" href="namespacedyno_1_1vision__tools.html#aaabcfcca356f30c83a45a51259e39783" title="Projects a dense depth map to 3D coordinates in the local frame." alt="" coords="337,55,477,95"/>
<area shape="rect" href="classdyno_1_1CameraParams.html#ae50eb600c23415b3f7bd46e70553f96a" title=" " alt="" coords="327,119,488,159"/>
<area shape="rect" href="namespacedyno.html#a80a71f28f4f692dc9c21976237dfcfe1" title="Constructs a file path (using the file name) where the root of the path is defined by the FLAGS_outpu..." alt="" coords="318,184,497,209"/>
<area shape="rect" href="classdyno_1_1Camera.html#af56ce3541d3ef8a7bcb2246e4634ca59" title=" " alt="" coords="312,233,503,259"/>
<area shape="rect" href="namespacedyno.html#a362927fda6438780973f55111b77455c" title=" " alt="" coords="551,63,623,88"/>
</map>
</div>
<div class="dynheader">
Here is the caller graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="namespacedyno_1_1vision__tools_a5d8b89d2b560b498934853c77a7d9f28_icgraph.png" border="0" usemap="#anamespacedyno_1_1vision__tools_a5d8b89d2b560b498934853c77a7d9f28_icgraph" alt=""/></div>
<map name="anamespacedyno_1_1vision__tools_a5d8b89d2b560b498934853c77a7d9f28_icgraph" id="anamespacedyno_1_1vision__tools_a5d8b89d2b560b498934853c77a7d9f28_icgraph">
<area shape="rect" title="Saves a re&#45;projected 3D point cloud with labelled points to file as a cv::Mat." alt="" coords="265,5,524,45"/>
<area shape="rect" href="classdyno_1_1RGBDInstanceFrontendModule.html#a4528368033583ee53198dac3a803c5f2" title=" " alt="" coords="5,5,217,45"/>
</map>
</div>

</div>
</div>
</div><!-- contents -->
<!-- start footer part -->
<hr class="footer"/><address class="footer"><small>
Generated by&#160;<a href="https://www.doxygen.org/index.html"><img class="footer" src="doxygen.svg" width="104" height="31" alt="doxygen"/></a> 1.9.6
</small></address>
</body>
</html>
