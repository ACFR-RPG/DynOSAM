<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "https://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml" lang="en-US">
<head>
<meta http-equiv="Content-Type" content="text/xhtml;charset=UTF-8"/>
<meta http-equiv="X-UA-Compatible" content="IE=11"/>
<meta name="generator" content="Doxygen 1.9.6"/>
<meta name="viewport" content="width=device-width, initial-scale=1"/>
<title>DynoSAM: dyno::Formulation&lt; MAP &gt; Class Template Reference</title>
<link href="tabs.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="jquery.js"></script>
<script type="text/javascript" src="dynsections.js"></script>
<link href="search/search.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="search/searchdata.js"></script>
<script type="text/javascript" src="search/search.js"></script>
<link href="doxygen.css" rel="stylesheet" type="text/css" />
</head>
<body>
<div id="top"><!-- do not remove this div, it is closed by doxygen! -->
<div id="titlearea">
<table cellspacing="0" cellpadding="0">
 <tbody>
 <tr id="projectrow">
  <td id="projectalign">
   <div id="projectname">DynoSAM
   </div>
   <div id="projectbrief">Dynamic Object Smoothing and Mapping for Dynamic SLAM</div>
  </td>
 </tr>
 </tbody>
</table>
</div>
<!-- end header part -->
<!-- Generated by Doxygen 1.9.6 -->
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:d3d9a9a6595521f9666a5e94cc830dab83b65699&amp;dn=expat.txt MIT */
var searchBox = new SearchBox("searchBox", "search/",'.html');
/* @license-end */
</script>
<script type="text/javascript" src="menudata.js"></script>
<script type="text/javascript" src="menu.js"></script>
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:d3d9a9a6595521f9666a5e94cc830dab83b65699&amp;dn=expat.txt MIT */
$(function() {
  initMenu('',true,false,'search.php','Search');
  $(document).ready(function() { init_search(); });
});
/* @license-end */
</script>
<div id="main-nav"></div>
<!-- window showing the filter options -->
<div id="MSearchSelectWindow"
     onmouseover="return searchBox.OnSearchSelectShow()"
     onmouseout="return searchBox.OnSearchSelectHide()"
     onkeydown="return searchBox.OnSearchSelectKey(event)">
</div>

<!-- iframe showing the search results (closed by default) -->
<div id="MSearchResultsWindow">
<div id="MSearchResults">
<div class="SRPage">
<div id="SRIndex">
<div id="SRResults"></div>
<div class="SRStatus" id="Loading">Loading...</div>
<div class="SRStatus" id="Searching">Searching...</div>
<div class="SRStatus" id="NoMatches">No Matches</div>
</div>
</div>
</div>
</div>

<div id="nav-path" class="navpath">
  <ul>
<li class="navelem"><a class="el" href="namespacedyno.html">dyno</a></li><li class="navelem"><a class="el" href="classdyno_1_1Formulation.html">Formulation</a></li>  </ul>
</div>
</div><!-- top -->
<div class="header">
  <div class="summary">
<a href="#pub-types">Public Types</a> &#124;
<a href="#pub-methods">Public Member Functions</a> &#124;
<a href="#pro-methods">Protected Member Functions</a> &#124;
<a href="#pro-attribs">Protected Attributes</a> &#124;
<a href="#pri-methods">Private Member Functions</a> &#124;
<a href="#pri-attribs">Private Attributes</a> &#124;
<a href="classdyno_1_1Formulation-members.html">List of all members</a>  </div>
  <div class="headertitle"><div class="title">dyno::Formulation&lt; MAP &gt; Class Template Reference<span class="mlabels"><span class="mlabel">abstract</span></span></div></div>
</div><!--header-->
<div class="contents">

<p>Base class for a formulation that defines the structure and implementation for a factor-graph based Dynamic SLAM solution. Derived formulations construct the specific factor-graph which are solved independandtly to the formulation. The formulation is responsible for the construction of a single factor-graph with a single set of initial values and has an associated <a class="el" href="classdyno_1_1Accessor.html" title="Accessor defines the interface between the structured output of a BackendModule and any formulation u...">Accessor</a> which knows how to extract these values into a common format. In the DynoSAM paper, this is referred to as the \mathbf{O}_k, which is the output of the backend. See <a class="el" href="Accessor_8hpp.html">Accessor.hpp</a> for more details.  
 <a href="classdyno_1_1Formulation.html#details">More...</a></p>

<p><code>#include &lt;<a class="el" href="Formulation_8hpp_source.html">Formulation.hpp</a>&gt;</code></p>
<div class="dynheader">
Collaboration diagram for dyno::Formulation&lt; MAP &gt;:</div>
<div class="dyncontent">
<div class="center"><img src="classdyno_1_1Formulation__coll__graph.png" border="0" usemap="#adyno_1_1Formulation_3_01MAP_01_4_coll__map" alt="Collaboration graph"/></div>
<map name="adyno_1_1Formulation_3_01MAP_01_4_coll__map" id="adyno_1_1Formulation_3_01MAP_01_4_coll__map">
<area shape="rect" title="Base class for a formulation that defines the structure and implementation for a factor&#45;graph based D..." alt="" coords="120,93,271,133"/>
<area shape="rect" href="structdyno_1_1FormulationParams.html" title=" " alt="" coords="5,5,193,31"/>
<area shape="rect" href="structdyno_1_1NoiseModels.html" title=" " alt="" coords="218,5,365,31"/>
</map>
<center><span class="legend">[<a href="graph_legend.html">legend</a>]</span></center></div>
<table class="memberdecls">
<tr class="heading"><td colspan="2"><h2 class="groupheader"><a id="pub-types" name="pub-types"></a>
Public Types</h2></td></tr>
<tr class="memitem:a0d23288e66f5eeb4022958765693a6e2"><td class="memItemLeft" align="right" valign="top">using&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classdyno_1_1Formulation.html#a0d23288e66f5eeb4022958765693a6e2">Map</a> = MAP</td></tr>
<tr class="separator:a0d23288e66f5eeb4022958765693a6e2"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a6e9a7f6d55f4d622ac051dcd9530ff22"><td class="memItemLeft" align="right" valign="top">using&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classdyno_1_1Formulation.html#a6e9a7f6d55f4d622ac051dcd9530ff22">This</a> = <a class="el" href="classdyno_1_1Formulation.html">Formulation</a>&lt; <a class="el" href="classdyno_1_1Formulation.html#a0d23288e66f5eeb4022958765693a6e2">Map</a> &gt;</td></tr>
<tr class="separator:a6e9a7f6d55f4d622ac051dcd9530ff22"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a1d2f31a8b905f003dec50bc08e832adb"><td class="memItemLeft" align="right" valign="top">using&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classdyno_1_1Formulation.html#a1d2f31a8b905f003dec50bc08e832adb">MapTraitsType</a> = <a class="el" href="structdyno_1_1MapTraits.html">MapTraits</a>&lt; <a class="el" href="classdyno_1_1Formulation.html#a0d23288e66f5eeb4022958765693a6e2">Map</a> &gt;</td></tr>
<tr class="separator:a1d2f31a8b905f003dec50bc08e832adb"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a9a172e526e325ba2bdfef03640ef1802"><td class="memItemLeft" align="right" valign="top">using&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classdyno_1_1Formulation.html#a9a172e526e325ba2bdfef03640ef1802">PointUpdateContextType</a> = <a class="el" href="structdyno_1_1PointUpdateContext.html">PointUpdateContext</a>&lt; <a class="el" href="classdyno_1_1Formulation.html#a0d23288e66f5eeb4022958765693a6e2">Map</a> &gt;</td></tr>
<tr class="separator:a9a172e526e325ba2bdfef03640ef1802"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a3a8077c836f8dc574c084ed01f69d9c7"><td class="memItemLeft" align="right" valign="top">using&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classdyno_1_1Formulation.html#a3a8077c836f8dc574c084ed01f69d9c7">ObjectUpdateContextType</a> = <a class="el" href="structdyno_1_1ObjectUpdateContext.html">ObjectUpdateContext</a>&lt; <a class="el" href="classdyno_1_1Formulation.html#a0d23288e66f5eeb4022958765693a6e2">Map</a> &gt;</td></tr>
<tr class="separator:a3a8077c836f8dc574c084ed01f69d9c7"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:abfb552d78bbec6db6dc746aba349bc12"><td class="memItemLeft" align="right" valign="top">using&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classdyno_1_1Formulation.html#abfb552d78bbec6db6dc746aba349bc12">AccessorType</a> = <a class="el" href="classdyno_1_1Accessor.html">Accessor</a>&lt; MAP &gt;</td></tr>
<tr class="separator:abfb552d78bbec6db6dc746aba349bc12"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:acc95b135e9cd6ab66208afd5bcb75c29"><td class="memItemLeft" align="right" valign="top">using&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classdyno_1_1Formulation.html#acc95b135e9cd6ab66208afd5bcb75c29">AccessorTypePointer</a> = typename <a class="el" href="classdyno_1_1Accessor.html">Accessor</a>&lt; MAP &gt;::Ptr</td></tr>
<tr class="separator:acc95b135e9cd6ab66208afd5bcb75c29"><td class="memSeparator" colspan="2">&#160;</td></tr>
</table><table class="memberdecls">
<tr class="heading"><td colspan="2"><h2 class="groupheader"><a id="pub-methods" name="pub-methods"></a>
Public Member Functions</h2></td></tr>
<tr class="memitem:a8724f7b7761d769e2030d8b313c245e1"><td class="memItemLeft" align="right" valign="top">&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classdyno_1_1Formulation.html#a8724f7b7761d769e2030d8b313c245e1">Formulation</a> (const <a class="el" href="structdyno_1_1FormulationParams.html">FormulationParams</a> &amp;params, typename Map::Ptr <a class="el" href="classdyno_1_1Formulation.html#aa882dfc5e5e0cc12a03184b08889ad7f">map</a>, const <a class="el" href="structdyno_1_1NoiseModels.html">NoiseModels</a> &amp;noise_models)</td></tr>
<tr class="separator:a8724f7b7761d769e2030d8b313c245e1"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a12c70534b19467ff8ad447d10cbcec8f"><td class="memItemLeft" align="right" valign="top">virtual&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classdyno_1_1Formulation.html#a12c70534b19467ff8ad447d10cbcec8f">~Formulation</a> ()=default</td></tr>
<tr class="separator:a12c70534b19467ff8ad447d10cbcec8f"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:aa882dfc5e5e0cc12a03184b08889ad7f"><td class="memItemLeft" align="right" valign="top">Map::Ptr&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classdyno_1_1Formulation.html#aa882dfc5e5e0cc12a03184b08889ad7f">map</a> () const</td></tr>
<tr class="memdesc:aa882dfc5e5e0cc12a03184b08889ad7f"><td class="mdescLeft">&#160;</td><td class="mdescRight">Get the map used by the formulation.  <br /></td></tr>
<tr class="separator:aa882dfc5e5e0cc12a03184b08889ad7f"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ab453db0a7949192fc9499aab026e012f"><td class="memItemLeft" align="right" valign="top">const gtsam::Values &amp;&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classdyno_1_1Formulation.html#ab453db0a7949192fc9499aab026e012f">getTheta</a> () const</td></tr>
<tr class="memdesc:ab453db0a7949192fc9499aab026e012f"><td class="mdescLeft">&#160;</td><td class="mdescRight">Get the current linearization point for this formulation. These values can be updated after external optimisation and are constructed by the derived formulation during update.  <br /></td></tr>
<tr class="separator:ab453db0a7949192fc9499aab026e012f"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a87be187fbe18eee7b20ace93327ba4b8"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classdyno_1_1Formulation.html#a87be187fbe18eee7b20ace93327ba4b8">setTheta</a> (const gtsam::Values &amp;linearization)</td></tr>
<tr class="memdesc:a87be187fbe18eee7b20ace93327ba4b8"><td class="mdescLeft">&#160;</td><td class="mdescRight">Sets the full set of theta values (overrides them). This is used after external optimisation to update the values for the accessor which has a internal reference (pointer) to theta.  <br /></td></tr>
<tr class="separator:a87be187fbe18eee7b20ace93327ba4b8"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a1b5ff63de3f707bd29838b65ef7a2ec9"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classdyno_1_1Formulation.html#a1b5ff63de3f707bd29838b65ef7a2ec9">updateTheta</a> (const gtsam::Values &amp;linearization)</td></tr>
<tr class="memdesc:a1b5ff63de3f707bd29838b65ef7a2ec9"><td class="mdescLeft">&#160;</td><td class="mdescRight">Updates and assigns new values to theta. This is used after external optimisation to update the values for the accessor which has a internal reference (pointer) to theta.  <br /></td></tr>
<tr class="separator:a1b5ff63de3f707bd29838b65ef7a2ec9"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a5897842d346d80f87315ed7870d7d580"><td class="memItemLeft" align="right" valign="top">const gtsam::NonlinearFactorGraph &amp;&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classdyno_1_1Formulation.html#a5897842d346d80f87315ed7870d7d580">getGraph</a> () const</td></tr>
<tr class="memdesc:a5897842d346d80f87315ed7870d7d580"><td class="mdescLeft">&#160;</td><td class="mdescRight">Gets the current graph associated with the current theta and constructed by the derived formulation. Along theta, this should be used by an external optimisation routine.  <br /></td></tr>
<tr class="separator:a5897842d346d80f87315ed7870d7d580"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a6b9b3b3a6c14748b57725bee233bcca4"><td class="memItemLeft" align="right" valign="top">const std::string&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classdyno_1_1Formulation.html#a6b9b3b3a6c14748b57725bee233bcca4">getFullyQualifiedName</a> () const</td></tr>
<tr class="memdesc:a6b9b3b3a6c14748b57725bee233bcca4"><td class="mdescLeft">&#160;</td><td class="mdescRight">Get the fully qualified name of this formulation which is derived from the loggerPrefix and optionally the <a class="el" href="structdyno_1_1FormulationParams.html#ac3367e0c0d80aec0900a00132becd768">FormulationParams::suffix</a> if given.  <br /></td></tr>
<tr class="separator:a6b9b3b3a6c14748b57725bee233bcca4"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a536dbcbdd6fcd6598fcedb7866cec1de"><td class="memItemLeft" align="right" valign="top">AccessorType::Ptr&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classdyno_1_1Formulation.html#a536dbcbdd6fcd6598fcedb7866cec1de">accessorFromTheta</a> () const</td></tr>
<tr class="memdesc:a536dbcbdd6fcd6598fcedb7866cec1de"><td class="mdescLeft">&#160;</td><td class="mdescRight">Public fucntion to access the <a class="el" href="classdyno_1_1Accessor.html" title="Accessor defines the interface between the structured output of a BackendModule and any formulation u...">Accessor</a> for the derived formulation.  <br /></td></tr>
<tr class="separator:a536dbcbdd6fcd6598fcedb7866cec1de"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a61251ff882e273eb439bb238e87762e4"><td class="memItemLeft" align="right" valign="top">BackendLogger::UniquePtr&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classdyno_1_1Formulation.html#a61251ff882e273eb439bb238e87762e4">makeFullyQualifiedLogger</a> () const</td></tr>
<tr class="memdesc:a61251ff882e273eb439bb238e87762e4"><td class="mdescLeft">&#160;</td><td class="mdescRight">Makes a logger using the fully-qualified name for this formulation.  <br /></td></tr>
<tr class="separator:a61251ff882e273eb439bb238e87762e4"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:aef00ff0f96ad2253cc394b8905065882"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classdyno_1_1Formulation.html#aef00ff0f96ad2253cc394b8905065882">setInitialPose</a> (const gtsam::Pose3 &amp;T_world_camera, <a class="el" href="namespacedyno.html#ac4303d6fafb755f794b072d76f9cfb41">FrameId</a> frame_id_k, gtsam::Values &amp;new_values)</td></tr>
<tr class="memdesc:aef00ff0f96ad2253cc394b8905065882"><td class="mdescLeft">&#160;</td><td class="mdescRight">Adds a gtsam::Pose3 as a value in the graph at frame k.  <br /></td></tr>
<tr class="separator:aef00ff0f96ad2253cc394b8905065882"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a32192676e4fab1dc4d35045373c155a3"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classdyno_1_1Formulation.html#a32192676e4fab1dc4d35045373c155a3">setInitialPosePrior</a> (const gtsam::Pose3 &amp;T_world_camera, <a class="el" href="namespacedyno.html#ac4303d6fafb755f794b072d76f9cfb41">FrameId</a> frame_id_k, gtsam::NonlinearFactorGraph &amp;new_factors)</td></tr>
<tr class="memdesc:a32192676e4fab1dc4d35045373c155a3"><td class="mdescLeft">&#160;</td><td class="mdescRight">Adds a pose prior on a value in the graph at frame k using the given pose value as the prior's mean.  <br /></td></tr>
<tr class="separator:a32192676e4fab1dc4d35045373c155a3"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a849272ad3138932bb3a0957ccba9ac5c"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classdyno_1_1Formulation.html#a849272ad3138932bb3a0957ccba9ac5c">addOdometry</a> (<a class="el" href="namespacedyno.html#ac4303d6fafb755f794b072d76f9cfb41">FrameId</a> from_frame, <a class="el" href="namespacedyno.html#ac4303d6fafb755f794b072d76f9cfb41">FrameId</a> to_frame, gtsam::Values &amp;new_values, gtsam::NonlinearFactorGraph &amp;new_factors)</td></tr>
<tr class="memdesc:a849272ad3138932bb3a0957ccba9ac5c"><td class="mdescLeft">&#160;</td><td class="mdescRight">Adds odometry factor between multiple frames using the initial values from the front-end (as stored in the map) to calculate the odometry.  <br /></td></tr>
<tr class="separator:a849272ad3138932bb3a0957ccba9ac5c"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ad3c2df3ba1ce22a47c529c07bba70bf8"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classdyno_1_1Formulation.html#ad3c2df3ba1ce22a47c529c07bba70bf8">addOdometry</a> (<a class="el" href="namespacedyno.html#ac4303d6fafb755f794b072d76f9cfb41">FrameId</a> frame_id_k, const gtsam::Pose3 &amp;T_world_camera, gtsam::Values &amp;new_values, gtsam::NonlinearFactorGraph &amp;new_factors)</td></tr>
<tr class="memdesc:ad3c2df3ba1ce22a47c529c07bba70bf8"><td class="mdescLeft">&#160;</td><td class="mdescRight">Adds odometry factor betwene k-1 and k using T_world_camera as the measurement at k and the existing value in the graph (or initial value from the front-end) as the pose measurement for k-1.  <br /></td></tr>
<tr class="separator:ad3c2df3ba1ce22a47c529c07bba70bf8"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a4e62c29e14bd5ea89fc24d5693bdefea"><td class="memItemLeft" align="right" valign="top"><a class="el" href="structdyno_1_1UpdateObservationResult.html">UpdateObservationResult</a>&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classdyno_1_1Formulation.html#a4e62c29e14bd5ea89fc24d5693bdefea">updateStaticObservations</a> (<a class="el" href="namespacedyno.html#ac4303d6fafb755f794b072d76f9cfb41">FrameId</a> from_frame, <a class="el" href="namespacedyno.html#ac4303d6fafb755f794b072d76f9cfb41">FrameId</a> to_frame, gtsam::Values &amp;new_values, gtsam::NonlinearFactorGraph &amp;new_factors, const <a class="el" href="structdyno_1_1UpdateObservationParams.html">UpdateObservationParams</a> &amp;update_params)</td></tr>
<tr class="memdesc:a4e62c29e14bd5ea89fc24d5693bdefea"><td class="mdescLeft">&#160;</td><td class="mdescRight">Update the static-point part of the factor graph between multiple frames. Internally makes several calls to <a class="el" href="classdyno_1_1Formulation.html#a74de91cf6b4755060af63627d28fed2c" title="Updates the static-point part of the factor graph for frame k. This contains all the bookeeping logic...">updateStaticObservations(FrameId,gtsam::Values&amp;,gtsam::NonlinearFactorGraph&amp;,const UpdateObservationParams&amp;)</a> and returns the accumulated <a class="el" href="structdyno_1_1UpdateObservationResult.html">UpdateObservationResult</a>.  <br /></td></tr>
<tr class="separator:a4e62c29e14bd5ea89fc24d5693bdefea"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a4097a531fcdb07ef22b249bdeee52b23"><td class="memItemLeft" align="right" valign="top"><a class="el" href="structdyno_1_1UpdateObservationResult.html">UpdateObservationResult</a>&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classdyno_1_1Formulation.html#a4097a531fcdb07ef22b249bdeee52b23">updateDynamicObservations</a> (<a class="el" href="namespacedyno.html#ac4303d6fafb755f794b072d76f9cfb41">FrameId</a> from_frame, <a class="el" href="namespacedyno.html#ac4303d6fafb755f794b072d76f9cfb41">FrameId</a> to_frame, gtsam::Values &amp;new_values, gtsam::NonlinearFactorGraph &amp;new_factors, const <a class="el" href="structdyno_1_1UpdateObservationParams.html">UpdateObservationParams</a> &amp;update_params)</td></tr>
<tr class="memdesc:a4097a531fcdb07ef22b249bdeee52b23"><td class="mdescLeft">&#160;</td><td class="mdescRight">Update the dynamic-point part of the factor graph between multiple frames. Internally makes several calls to <a class="el" href="classdyno_1_1Formulation.html#ad78d57e7de23e30b9aa287a3939bb3a9" title="Updates the dyanmic-point part of the factor graph for frame k. This contains all the big-boi bookeep...">updateDynamicObservations(FrameId,gtsam::Values&amp;,gtsam::NonlinearFactorGraph&amp;,const UpdateObservationParams&amp;)</a> and returns the accumulated <a class="el" href="structdyno_1_1UpdateObservationResult.html">UpdateObservationResult</a>.  <br /></td></tr>
<tr class="separator:a4097a531fcdb07ef22b249bdeee52b23"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a74de91cf6b4755060af63627d28fed2c"><td class="memItemLeft" align="right" valign="top"><a class="el" href="structdyno_1_1UpdateObservationResult.html">UpdateObservationResult</a>&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classdyno_1_1Formulation.html#a74de91cf6b4755060af63627d28fed2c">updateStaticObservations</a> (<a class="el" href="namespacedyno.html#ac4303d6fafb755f794b072d76f9cfb41">FrameId</a> frame_id_k, gtsam::Values &amp;new_values, gtsam::NonlinearFactorGraph &amp;new_factors, const <a class="el" href="structdyno_1_1UpdateObservationParams.html">UpdateObservationParams</a> &amp;update_params)</td></tr>
<tr class="memdesc:a74de91cf6b4755060af63627d28fed2c"><td class="mdescLeft">&#160;</td><td class="mdescRight">Updates the static-point part of the factor graph for frame k. This contains all the bookeeping logic to update the factor graph with static points.  <br /></td></tr>
<tr class="separator:a74de91cf6b4755060af63627d28fed2c"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ad78d57e7de23e30b9aa287a3939bb3a9"><td class="memItemLeft" align="right" valign="top"><a class="el" href="structdyno_1_1UpdateObservationResult.html">UpdateObservationResult</a>&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classdyno_1_1Formulation.html#ad78d57e7de23e30b9aa287a3939bb3a9">updateDynamicObservations</a> (<a class="el" href="namespacedyno.html#ac4303d6fafb755f794b072d76f9cfb41">FrameId</a> frame_id_k, gtsam::Values &amp;new_values, gtsam::NonlinearFactorGraph &amp;new_factors, const <a class="el" href="structdyno_1_1UpdateObservationParams.html">UpdateObservationParams</a> &amp;update_params)</td></tr>
<tr class="memdesc:ad78d57e7de23e30b9aa287a3939bb3a9"><td class="mdescLeft">&#160;</td><td class="mdescRight">Updates the dyanmic-point part of the factor graph for frame k. This contains all the big-boi bookeeping logic to update the factor graph with dyanmic points and objects. This is where the virtual dynamicPointUpdateCallback and objectUpdateContext functions are called.  <br /></td></tr>
<tr class="separator:ad78d57e7de23e30b9aa287a3939bb3a9"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a7a559d73e69e026a67b5af2e7b8c1eae"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classdyno_1_1Formulation.html#a7a559d73e69e026a67b5af2e7b8c1eae">logBackendFromMap</a> (const <a class="el" href="structdyno_1_1BackendMetaData.html">BackendMetaData</a> &amp;backend_info)</td></tr>
<tr class="memdesc:a7a559d73e69e026a67b5af2e7b8c1eae"><td class="mdescLeft">&#160;</td><td class="mdescRight">Logs all frames and values to file using <a class="el" href="classdyno_1_1Accessor.html" title="Accessor defines the interface between the structured output of a BackendModule and any formulation u...">Accessor</a> and <a class="el" href="classdyno_1_1BackendLogger.html">BackendLogger</a>. The <a class="el" href="structdyno_1_1BackendMetaData.html">BackendMetaData</a> provides meta-data and ground truth information for logging.  <br /></td></tr>
<tr class="separator:a7a559d73e69e026a67b5af2e7b8c1eae"><td class="memSeparator" colspan="2">&#160;</td></tr>
</table><table class="memberdecls">
<tr class="heading"><td colspan="2"><h2 class="groupheader"><a id="pro-methods" name="pro-methods"></a>
Protected Member Functions</h2></td></tr>
<tr class="memitem:af93533f32a88133a492b5e3ed790267f"><td class="memItemLeft" align="right" valign="top">virtual void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classdyno_1_1Formulation.html#af93533f32a88133a492b5e3ed790267f">dynamicPointUpdateCallback</a> (const <a class="el" href="classdyno_1_1Formulation.html#a9a172e526e325ba2bdfef03640ef1802">PointUpdateContextType</a> &amp;context, <a class="el" href="structdyno_1_1UpdateObservationResult.html">UpdateObservationResult</a> &amp;result, gtsam::Values &amp;new_values, gtsam::NonlinearFactorGraph &amp;new_factors)=0</td></tr>
<tr class="memdesc:af93533f32a88133a492b5e3ed790267f"><td class="mdescLeft">&#160;</td><td class="mdescRight">Virtual function to be implemented by derived class and indicates that a specific landmark has new measurements and new values/factors should be added. Details on the landmark to be updated are provied by the context. In general, this is used to add projection/motion factors and initial values for landmarks.  <br /></td></tr>
<tr class="separator:af93533f32a88133a492b5e3ed790267f"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a37aa6f06b484ce9d3fe46312063281e5"><td class="memItemLeft" align="right" valign="top">virtual void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classdyno_1_1Formulation.html#a37aa6f06b484ce9d3fe46312063281e5">objectUpdateContext</a> (const <a class="el" href="classdyno_1_1Formulation.html#a3a8077c836f8dc574c084ed01f69d9c7">ObjectUpdateContextType</a> &amp;context, <a class="el" href="structdyno_1_1UpdateObservationResult.html">UpdateObservationResult</a> &amp;result, gtsam::Values &amp;new_values, gtsam::NonlinearFactorGraph &amp;new_factors)=0</td></tr>
<tr class="memdesc:a37aa6f06b484ce9d3fe46312063281e5"><td class="mdescLeft">&#160;</td><td class="mdescRight">Virtual function to be implemented by derived class and indicates that a specific object j and time-step k has been observed and its dynamic points updated in the graph, and associated values/factors should be added. Details on the object to be updated are provied by the context. In general, this is used to add smoothing factors and initial values for object motion/pose.  <br /></td></tr>
<tr class="separator:a37aa6f06b484ce9d3fe46312063281e5"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a7cbe87537d35b8d21463d402342ef356"><td class="memItemLeft" align="right" valign="top">virtual bool&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classdyno_1_1Formulation.html#a7cbe87537d35b8d21463d402342ef356">isDynamicTrackletInMap</a> (const typename <a class="el" href="structdyno_1_1MapTraits.html#a72db8cc0191a116471646c6302bea29b">MapTraitsType::LandmarkNodePtr</a> &amp;lmk_node) const =0</td></tr>
<tr class="memdesc:a7cbe87537d35b8d21463d402342ef356"><td class="mdescLeft">&#160;</td><td class="mdescRight">Virtual function to be implemented by derived class and indicates that the specified landmark exists within the graph already. This is used as part of the internal bookeeping.  <br /></td></tr>
<tr class="separator:a7cbe87537d35b8d21463d402342ef356"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:aa3902e16e40c4eb8215ddfb4b7a625c5"><td class="memItemLeft" align="right" valign="top">virtual std::string&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classdyno_1_1Formulation.html#aa3902e16e40c4eb8215ddfb4b7a625c5">loggerPrefix</a> () const =0</td></tr>
<tr class="memdesc:aa3902e16e40c4eb8215ddfb4b7a625c5"><td class="mdescLeft">&#160;</td><td class="mdescRight">Defines the base name of this formulation. This name will appear as part of the output logs and may be augmented with the <a class="el" href="structdyno_1_1FormulationParams.html#ac3367e0c0d80aec0900a00132becd768">FormulationParams::suffix</a>, if given. To get the fully qualified name (the actual name that will appear in the logs), use <a class="el" href="classdyno_1_1Formulation.html#a6b9b3b3a6c14748b57725bee233bcca4" title="Get the fully qualified name of this formulation which is derived from the loggerPrefix and optionall...">This::getFullyQualifiedName()</a>.  <br /></td></tr>
<tr class="separator:aa3902e16e40c4eb8215ddfb4b7a625c5"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a087924d81177adf630c030364e5f5025"><td class="memItemLeft" align="right" valign="top">virtual AccessorType::Ptr&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classdyno_1_1Formulation.html#a087924d81177adf630c030364e5f5025">createAccessor</a> (const gtsam::Values *values) const =0</td></tr>
<tr class="memdesc:a087924d81177adf630c030364e5f5025"><td class="mdescLeft">&#160;</td><td class="mdescRight">Creates the associated <a class="el" href="classdyno_1_1Accessor.html" title="Accessor defines the interface between the structured output of a BackendModule and any formulation u...">Accessor</a> for the derived formulation. The accessor will contain a pointer to <a class="el" href="classdyno_1_1Formulation.html#aece87cef780a5692feeffc034e3dbd44" title="Current linearisation that will be associated with the current graph.">This::theta_</a>, so that when the values are updated the accessor has access to the latest values.  <br /></td></tr>
<tr class="separator:a087924d81177adf630c030364e5f5025"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a3369b4fa4dd649495e5bace0e9b715d9"><td class="memItemLeft" align="right" valign="top">gtsam::Pose3&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classdyno_1_1Formulation.html#a3369b4fa4dd649495e5bace0e9b715d9">getInitialOrLinearizedSensorPose</a> (<a class="el" href="namespacedyno.html#ac4303d6fafb755f794b072d76f9cfb41">FrameId</a> frame_id) const</td></tr>
<tr class="separator:a3369b4fa4dd649495e5bace0e9b715d9"><td class="memSeparator" colspan="2">&#160;</td></tr>
</table><table class="memberdecls">
<tr class="heading"><td colspan="2"><h2 class="groupheader"><a id="pro-attribs" name="pro-attribs"></a>
Protected Attributes</h2></td></tr>
<tr class="memitem:a18df73bd68393b6b9860c6c332bd5496"><td class="memItemLeft" align="right" valign="top">const <a class="el" href="structdyno_1_1FormulationParams.html">FormulationParams</a>&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classdyno_1_1Formulation.html#a18df73bd68393b6b9860c6c332bd5496">params_</a></td></tr>
<tr class="separator:a18df73bd68393b6b9860c6c332bd5496"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a100326929d58a9a30f663f51969058f9"><td class="memItemLeft" align="right" valign="top">Map::Ptr&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classdyno_1_1Formulation.html#a100326929d58a9a30f663f51969058f9">map_</a></td></tr>
<tr class="separator:a100326929d58a9a30f663f51969058f9"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a0e9e95a8f33f2da1fe8f7123feecf81c"><td class="memItemLeft" align="right" valign="top">const <a class="el" href="structdyno_1_1NoiseModels.html">NoiseModels</a>&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classdyno_1_1Formulation.html#a0e9e95a8f33f2da1fe8f7123feecf81c">noise_models_</a></td></tr>
<tr class="separator:a0e9e95a8f33f2da1fe8f7123feecf81c"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:af8fa9cd53878c20db3b398f702e45b49"><td class="memItemLeft" align="right" valign="top">gtsam::FastMap&lt; gtsam::Key, bool &gt;&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classdyno_1_1Formulation.html#af8fa9cd53878c20db3b398f702e45b49">is_other_values_in_map</a></td></tr>
<tr class="memdesc:af8fa9cd53878c20db3b398f702e45b49"><td class="mdescLeft">&#160;</td><td class="mdescRight">the set of (static related) values managed by this updater. Allows checking if values have already been added over successifve function calls  <br /></td></tr>
<tr class="separator:af8fa9cd53878c20db3b398f702e45b49"><td class="memSeparator" colspan="2">&#160;</td></tr>
</table><table class="memberdecls">
<tr class="heading"><td colspan="2"><h2 class="groupheader"><a id="pri-methods" name="pri-methods"></a>
Private Member Functions</h2></td></tr>
<tr class="memitem:abc91d003af81579a6918973ff7b83ea5"><td class="memItemLeft" align="right" valign="top">std::string&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classdyno_1_1Formulation.html#abc91d003af81579a6918973ff7b83ea5">setFullyQualifiedName</a> () const</td></tr>
<tr class="separator:abc91d003af81579a6918973ff7b83ea5"><td class="memSeparator" colspan="2">&#160;</td></tr>
</table><table class="memberdecls">
<tr class="heading"><td colspan="2"><h2 class="groupheader"><a id="pri-attribs" name="pri-attribs"></a>
Private Attributes</h2></td></tr>
<tr class="memitem:aece87cef780a5692feeffc034e3dbd44"><td class="memItemLeft" align="right" valign="top">gtsam::Values&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classdyno_1_1Formulation.html#aece87cef780a5692feeffc034e3dbd44">theta_</a></td></tr>
<tr class="memdesc:aece87cef780a5692feeffc034e3dbd44"><td class="mdescLeft">&#160;</td><td class="mdescRight">Current linearisation that will be associated with the current graph.  <br /></td></tr>
<tr class="separator:aece87cef780a5692feeffc034e3dbd44"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:aabc461bd6dfa004c931e99356477104e"><td class="memItemLeft" align="right" valign="top">gtsam::NonlinearFactorGraph&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classdyno_1_1Formulation.html#aabc461bd6dfa004c931e99356477104e">factors_</a></td></tr>
<tr class="separator:aabc461bd6dfa004c931e99356477104e"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ad73481666a52d300f4a4e4da65a718ba"><td class="memItemLeft" align="right" valign="top">AccessorType::Ptr&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classdyno_1_1Formulation.html#ad73481666a52d300f4a4e4da65a718ba">accessor_theta_</a></td></tr>
<tr class="separator:ad73481666a52d300f4a4e4da65a718ba"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a1f64fc4ad8d279acfb5402ba9748087d"><td class="memItemLeft" align="right" valign="top">std::optional&lt; std::string &gt;&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classdyno_1_1Formulation.html#a1f64fc4ad8d279acfb5402ba9748087d">fully_qualified_name_</a> {std::nullopt}</td></tr>
<tr class="memdesc:a1f64fc4ad8d279acfb5402ba9748087d"><td class="mdescLeft">&#160;</td><td class="mdescRight">Full name of the formulation and accounts for the additional configuration from the <a class="el" href="structdyno_1_1FormulationParams.html">FormulationParams</a>.  <br /></td></tr>
<tr class="separator:a1f64fc4ad8d279acfb5402ba9748087d"><td class="memSeparator" colspan="2">&#160;</td></tr>
</table>
<a name="details" id="details"></a><h2 class="groupheader">Detailed Description</h2>
<div class="textblock"><div class="compoundTemplParams">template&lt;typename MAP&gt;<br />
class dyno::Formulation&lt; MAP &gt;</div><p>Base class for a formulation that defines the structure and implementation for a factor-graph based Dynamic SLAM solution. Derived formulations construct the specific factor-graph which are solved independandtly to the formulation. The formulation is responsible for the construction of a single factor-graph with a single set of initial values and has an associated <a class="el" href="classdyno_1_1Accessor.html" title="Accessor defines the interface between the structured output of a BackendModule and any formulation u...">Accessor</a> which knows how to extract these values into a common format. In the DynoSAM paper, this is referred to as the \mathbf{O}_k, which is the output of the backend. See <a class="el" href="Accessor_8hpp.html">Accessor.hpp</a> for more details. </p>
<p>The base formulation manages all high-level book keeping associated with any Dynamic SLAM factor graph and decided when points and objects should be added to the graph in a general sense (e.g. points must be seen multiple times, has this point already been added the graph in a general way). This is achieved in two ways:</p><ol type="1">
<li>Key virtual functions which provides the base formulation with some knowledge of the dervied formulations actions and</li>
<li>Access to the MAP which defines the structure of frames, objects and points directly from measurements.</li>
</ol>
<p>At a high-level the formulation has the following functionalities:</p><ul>
<li>Addition of odometry and pose priors</li>
<li>Static point updates (which adds factors and values for static points)</li>
<li>Dynamic point updates (which adds factors and values for dynamic points AND dynamic objects).</li>
</ul>
<p>The derived class must implement the dynamicPointUpdateCallback and objectUpdateContext pure-virtual functions and updated the <a class="el" href="structdyno_1_1UpdateObservationResult.html">UpdateObservationResult</a>,gtsam::Values and gtsam::NonlinearFactorGraph objects based on the additional context that is parsed in. The context is build by the base-formulation class as part of the high-level bookeeping and indicates that this dynamic point/object has new observations associated with it and therefore new values/factors should be added. The new values/factors will eventually be added to the base-formualtions internal theta_ and factors_. These virtual functions are called in the corresponding update static/dynamic observation functions when the base class has determined new obsevrations have occurned.</p>
<dl class="tparams"><dt>Template Parameters</dt><dd>
  <table class="tparams">
    <tr><td class="paramname">MAP</td><td></td></tr>
  </table>
  </dd>
</dl>

<p class="definition">Definition at line <a class="el" href="Formulation_8hpp_source.html#l00150">150</a> of file <a class="el" href="Formulation_8hpp_source.html">Formulation.hpp</a>.</p>
</div><h2 class="groupheader">Member Typedef Documentation</h2>
<a id="abfb552d78bbec6db6dc746aba349bc12" name="abfb552d78bbec6db6dc746aba349bc12"></a>
<h2 class="memtitle"><span class="permalink"><a href="#abfb552d78bbec6db6dc746aba349bc12">&#9670;&#160;</a></span>AccessorType</h2>

<div class="memitem">
<div class="memproto">
<div class="memtemplate">
template&lt;typename MAP &gt; </div>
      <table class="memname">
        <tr>
          <td class="memname">using <a class="el" href="classdyno_1_1Formulation.html">dyno::Formulation</a>&lt; MAP &gt;::AccessorType =  <a class="el" href="classdyno_1_1Accessor.html">Accessor</a>&lt;MAP&gt;</td>
        </tr>
      </table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="Formulation_8hpp_source.html#l00158">158</a> of file <a class="el" href="Formulation_8hpp_source.html">Formulation.hpp</a>.</p>

</div>
</div>
<a id="acc95b135e9cd6ab66208afd5bcb75c29" name="acc95b135e9cd6ab66208afd5bcb75c29"></a>
<h2 class="memtitle"><span class="permalink"><a href="#acc95b135e9cd6ab66208afd5bcb75c29">&#9670;&#160;</a></span>AccessorTypePointer</h2>

<div class="memitem">
<div class="memproto">
<div class="memtemplate">
template&lt;typename MAP &gt; </div>
      <table class="memname">
        <tr>
          <td class="memname">using <a class="el" href="classdyno_1_1Formulation.html">dyno::Formulation</a>&lt; MAP &gt;::AccessorTypePointer =  typename <a class="el" href="classdyno_1_1Accessor.html">Accessor</a>&lt;MAP&gt;::Ptr</td>
        </tr>
      </table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="Formulation_8hpp_source.html#l00159">159</a> of file <a class="el" href="Formulation_8hpp_source.html">Formulation.hpp</a>.</p>

</div>
</div>
<a id="a0d23288e66f5eeb4022958765693a6e2" name="a0d23288e66f5eeb4022958765693a6e2"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a0d23288e66f5eeb4022958765693a6e2">&#9670;&#160;</a></span>Map</h2>

<div class="memitem">
<div class="memproto">
<div class="memtemplate">
template&lt;typename MAP &gt; </div>
      <table class="memname">
        <tr>
          <td class="memname">using <a class="el" href="classdyno_1_1Formulation.html">dyno::Formulation</a>&lt; MAP &gt;::Map =  MAP</td>
        </tr>
      </table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="Formulation_8hpp_source.html#l00152">152</a> of file <a class="el" href="Formulation_8hpp_source.html">Formulation.hpp</a>.</p>

</div>
</div>
<a id="a1d2f31a8b905f003dec50bc08e832adb" name="a1d2f31a8b905f003dec50bc08e832adb"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a1d2f31a8b905f003dec50bc08e832adb">&#9670;&#160;</a></span>MapTraitsType</h2>

<div class="memitem">
<div class="memproto">
<div class="memtemplate">
template&lt;typename MAP &gt; </div>
      <table class="memname">
        <tr>
          <td class="memname">using <a class="el" href="classdyno_1_1Formulation.html">dyno::Formulation</a>&lt; MAP &gt;::MapTraitsType =  <a class="el" href="structdyno_1_1MapTraits.html">MapTraits</a>&lt;<a class="el" href="classdyno_1_1Formulation.html#a0d23288e66f5eeb4022958765693a6e2">Map</a>&gt;</td>
        </tr>
      </table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="Formulation_8hpp_source.html#l00154">154</a> of file <a class="el" href="Formulation_8hpp_source.html">Formulation.hpp</a>.</p>

</div>
</div>
<a id="a3a8077c836f8dc574c084ed01f69d9c7" name="a3a8077c836f8dc574c084ed01f69d9c7"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a3a8077c836f8dc574c084ed01f69d9c7">&#9670;&#160;</a></span>ObjectUpdateContextType</h2>

<div class="memitem">
<div class="memproto">
<div class="memtemplate">
template&lt;typename MAP &gt; </div>
      <table class="memname">
        <tr>
          <td class="memname">using <a class="el" href="classdyno_1_1Formulation.html">dyno::Formulation</a>&lt; MAP &gt;::ObjectUpdateContextType =  <a class="el" href="structdyno_1_1ObjectUpdateContext.html">ObjectUpdateContext</a>&lt;<a class="el" href="classdyno_1_1Formulation.html#a0d23288e66f5eeb4022958765693a6e2">Map</a>&gt;</td>
        </tr>
      </table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="Formulation_8hpp_source.html#l00157">157</a> of file <a class="el" href="Formulation_8hpp_source.html">Formulation.hpp</a>.</p>

</div>
</div>
<a id="a9a172e526e325ba2bdfef03640ef1802" name="a9a172e526e325ba2bdfef03640ef1802"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a9a172e526e325ba2bdfef03640ef1802">&#9670;&#160;</a></span>PointUpdateContextType</h2>

<div class="memitem">
<div class="memproto">
<div class="memtemplate">
template&lt;typename MAP &gt; </div>
      <table class="memname">
        <tr>
          <td class="memname">using <a class="el" href="classdyno_1_1Formulation.html">dyno::Formulation</a>&lt; MAP &gt;::PointUpdateContextType =  <a class="el" href="structdyno_1_1PointUpdateContext.html">PointUpdateContext</a>&lt;<a class="el" href="classdyno_1_1Formulation.html#a0d23288e66f5eeb4022958765693a6e2">Map</a>&gt;</td>
        </tr>
      </table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="Formulation_8hpp_source.html#l00156">156</a> of file <a class="el" href="Formulation_8hpp_source.html">Formulation.hpp</a>.</p>

</div>
</div>
<a id="a6e9a7f6d55f4d622ac051dcd9530ff22" name="a6e9a7f6d55f4d622ac051dcd9530ff22"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a6e9a7f6d55f4d622ac051dcd9530ff22">&#9670;&#160;</a></span>This</h2>

<div class="memitem">
<div class="memproto">
<div class="memtemplate">
template&lt;typename MAP &gt; </div>
      <table class="memname">
        <tr>
          <td class="memname">using <a class="el" href="classdyno_1_1Formulation.html">dyno::Formulation</a>&lt; MAP &gt;::This =  <a class="el" href="classdyno_1_1Formulation.html">Formulation</a>&lt;<a class="el" href="classdyno_1_1Formulation.html#a0d23288e66f5eeb4022958765693a6e2">Map</a>&gt;</td>
        </tr>
      </table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="Formulation_8hpp_source.html#l00153">153</a> of file <a class="el" href="Formulation_8hpp_source.html">Formulation.hpp</a>.</p>

</div>
</div>
<h2 class="groupheader">Constructor &amp; Destructor Documentation</h2>
<a id="a8724f7b7761d769e2030d8b313c245e1" name="a8724f7b7761d769e2030d8b313c245e1"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a8724f7b7761d769e2030d8b313c245e1">&#9670;&#160;</a></span>Formulation()</h2>

<div class="memitem">
<div class="memproto">
<div class="memtemplate">
template&lt;typename MAP &gt; </div>
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="classdyno_1_1Formulation.html">dyno::Formulation</a>&lt; MAP &gt;::Formulation </td>
          <td>(</td>
          <td class="paramtype">const <a class="el" href="structdyno_1_1FormulationParams.html">FormulationParams</a> &amp;&#160;</td>
          <td class="paramname"><em>params</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">typename Map::Ptr&#160;</td>
          <td class="paramname"><em>map</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const <a class="el" href="structdyno_1_1NoiseModels.html">NoiseModels</a> &amp;&#160;</td>
          <td class="paramname"><em>noise_models</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="Formulation-impl_8hpp_source.html#l00041">41</a> of file <a class="el" href="Formulation-impl_8hpp_source.html">Formulation-impl.hpp</a>.</p>
<div class="fragment"><div class="line"><span class="lineno">   44</span>    : <a class="code hl_variable" href="classdyno_1_1Formulation.html#a18df73bd68393b6b9860c6c332bd5496">params_</a>(params), <a class="code hl_variable" href="classdyno_1_1Formulation.html#a100326929d58a9a30f663f51969058f9">map_</a>(<a class="code hl_function" href="classdyno_1_1Formulation.html#aa882dfc5e5e0cc12a03184b08889ad7f">map</a>), <a class="code hl_variable" href="classdyno_1_1Formulation.html#a0e9e95a8f33f2da1fe8f7123feecf81c">noise_models_</a>(noise_models) {}</div>
<div class="ttc" id="aclassdyno_1_1Formulation_html_a0e9e95a8f33f2da1fe8f7123feecf81c"><div class="ttname"><a href="classdyno_1_1Formulation.html#a0e9e95a8f33f2da1fe8f7123feecf81c">dyno::Formulation::noise_models_</a></div><div class="ttdeci">const NoiseModels noise_models_</div><div class="ttdef"><b>Definition:</b> <a href="Formulation_8hpp_source.html#l00446">Formulation.hpp:446</a></div></div>
<div class="ttc" id="aclassdyno_1_1Formulation_html_a100326929d58a9a30f663f51969058f9"><div class="ttname"><a href="classdyno_1_1Formulation.html#a100326929d58a9a30f663f51969058f9">dyno::Formulation::map_</a></div><div class="ttdeci">Map::Ptr map_</div><div class="ttdef"><b>Definition:</b> <a href="Formulation_8hpp_source.html#l00445">Formulation.hpp:445</a></div></div>
<div class="ttc" id="aclassdyno_1_1Formulation_html_a18df73bd68393b6b9860c6c332bd5496"><div class="ttname"><a href="classdyno_1_1Formulation.html#a18df73bd68393b6b9860c6c332bd5496">dyno::Formulation::params_</a></div><div class="ttdeci">const FormulationParams params_</div><div class="ttdef"><b>Definition:</b> <a href="Formulation_8hpp_source.html#l00444">Formulation.hpp:444</a></div></div>
<div class="ttc" id="aclassdyno_1_1Formulation_html_aa882dfc5e5e0cc12a03184b08889ad7f"><div class="ttname"><a href="classdyno_1_1Formulation.html#aa882dfc5e5e0cc12a03184b08889ad7f">dyno::Formulation::map</a></div><div class="ttdeci">Map::Ptr map() const</div><div class="ttdoc">Get the map used by the formulation.</div><div class="ttdef"><b>Definition:</b> <a href="Formulation_8hpp_source.html#l00261">Formulation.hpp:261</a></div></div>
</div><!-- fragment -->
</div>
</div>
<a id="a12c70534b19467ff8ad447d10cbcec8f" name="a12c70534b19467ff8ad447d10cbcec8f"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a12c70534b19467ff8ad447d10cbcec8f">&#9670;&#160;</a></span>~Formulation()</h2>

<div class="memitem">
<div class="memproto">
<div class="memtemplate">
template&lt;typename MAP &gt; </div>
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">virtual <a class="el" href="classdyno_1_1Formulation.html">dyno::Formulation</a>&lt; MAP &gt;::~<a class="el" href="classdyno_1_1Formulation.html">Formulation</a> </td>
          <td>(</td>
          <td class="paramname"></td><td>)</td>
          <td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">virtual</span><span class="mlabel">default</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

</div>
</div>
<h2 class="groupheader">Member Function Documentation</h2>
<a id="a536dbcbdd6fcd6598fcedb7866cec1de" name="a536dbcbdd6fcd6598fcedb7866cec1de"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a536dbcbdd6fcd6598fcedb7866cec1de">&#9670;&#160;</a></span>accessorFromTheta()</h2>

<div class="memitem">
<div class="memproto">
<div class="memtemplate">
template&lt;typename MAP &gt; </div>
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="classdyno_1_1Formulation.html">Formulation</a>&lt; MAP &gt;::AccessorType::Ptr <a class="el" href="classdyno_1_1Formulation.html">dyno::Formulation</a>&lt; MAP &gt;::accessorFromTheta</td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Public fucntion to access the <a class="el" href="classdyno_1_1Accessor.html" title="Accessor defines the interface between the structured output of a BackendModule and any formulation u...">Accessor</a> for the derived formulation. </p>
<dl class="section return"><dt>Returns</dt><dd>AccessorType::Ptr </dd></dl>

<p class="definition">Definition at line <a class="el" href="Formulation-impl_8hpp_source.html#l00648">648</a> of file <a class="el" href="Formulation-impl_8hpp_source.html">Formulation-impl.hpp</a>.</p>
<div class="fragment"><div class="line"><span class="lineno">  648</span>                                          {</div>
<div class="line"><span class="lineno">  649</span>  <span class="keywordflow">if</span> (!<a class="code hl_variable" href="classdyno_1_1Formulation.html#ad73481666a52d300f4a4e4da65a718ba">accessor_theta_</a>) {</div>
<div class="line"><span class="lineno">  650</span>    <a class="code hl_variable" href="classdyno_1_1Formulation.html#ad73481666a52d300f4a4e4da65a718ba">accessor_theta_</a> = <a class="code hl_function" href="classdyno_1_1Formulation.html#a087924d81177adf630c030364e5f5025">createAccessor</a>(&amp;<a class="code hl_variable" href="classdyno_1_1Formulation.html#aece87cef780a5692feeffc034e3dbd44">theta_</a>);</div>
<div class="line"><span class="lineno">  651</span>  }</div>
<div class="line"><span class="lineno">  652</span>  <span class="keywordflow">return</span> <a class="code hl_variable" href="classdyno_1_1Formulation.html#ad73481666a52d300f4a4e4da65a718ba">accessor_theta_</a>;</div>
<div class="line"><span class="lineno">  653</span>}</div>
<div class="ttc" id="aclassdyno_1_1Formulation_html_a087924d81177adf630c030364e5f5025"><div class="ttname"><a href="classdyno_1_1Formulation.html#a087924d81177adf630c030364e5f5025">dyno::Formulation::createAccessor</a></div><div class="ttdeci">virtual AccessorType::Ptr createAccessor(const gtsam::Values *values) const =0</div><div class="ttdoc">Creates the associated Accessor for the derived formulation. The accessor will contain a pointer to T...</div></div>
<div class="ttc" id="aclassdyno_1_1Formulation_html_ad73481666a52d300f4a4e4da65a718ba"><div class="ttname"><a href="classdyno_1_1Formulation.html#ad73481666a52d300f4a4e4da65a718ba">dyno::Formulation::accessor_theta_</a></div><div class="ttdeci">AccessorType::Ptr accessor_theta_</div><div class="ttdef"><b>Definition:</b> <a href="Formulation_8hpp_source.html#l00454">Formulation.hpp:454</a></div></div>
<div class="ttc" id="aclassdyno_1_1Formulation_html_aece87cef780a5692feeffc034e3dbd44"><div class="ttname"><a href="classdyno_1_1Formulation.html#aece87cef780a5692feeffc034e3dbd44">dyno::Formulation::theta_</a></div><div class="ttdeci">gtsam::Values theta_</div><div class="ttdoc">Current linearisation that will be associated with the current graph.</div><div class="ttdef"><b>Definition:</b> <a href="Formulation_8hpp_source.html#l00452">Formulation.hpp:452</a></div></div>
</div><!-- fragment -->
<p class="reference">Referenced by <a class="el" href="classdyno_1_1RGBDBackendModule.html#a26b5b762684936e022839599b8895e95">dyno::RGBDBackendModule::constructOutputPacket()</a>.</p>
<div class="dynheader">
Here is the caller graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="classdyno_1_1Formulation_a536dbcbdd6fcd6598fcedb7866cec1de_icgraph.png" border="0" usemap="#aclassdyno_1_1Formulation_a536dbcbdd6fcd6598fcedb7866cec1de_icgraph" alt=""/></div>
<map name="aclassdyno_1_1Formulation_a536dbcbdd6fcd6598fcedb7866cec1de_icgraph" id="aclassdyno_1_1Formulation_a536dbcbdd6fcd6598fcedb7866cec1de_icgraph">
<area shape="rect" title="Public fucntion to access the Accessor for the derived formulation." alt="" coords="256,5,405,45"/>
<area shape="rect" href="classdyno_1_1RGBDBackendModule.html#a26b5b762684936e022839599b8895e95" title=" " alt="" coords="5,5,208,45"/>
</map>
</div>

</div>
</div>
<a id="ad3c2df3ba1ce22a47c529c07bba70bf8" name="ad3c2df3ba1ce22a47c529c07bba70bf8"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ad3c2df3ba1ce22a47c529c07bba70bf8">&#9670;&#160;</a></span>addOdometry() <span class="overload">[1/2]</span></h2>

<div class="memitem">
<div class="memproto">
<div class="memtemplate">
template&lt;typename MAP &gt; </div>
      <table class="memname">
        <tr>
          <td class="memname">void <a class="el" href="classdyno_1_1Formulation.html">dyno::Formulation</a>&lt; MAP &gt;::addOdometry </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="namespacedyno.html#ac4303d6fafb755f794b072d76f9cfb41">FrameId</a>&#160;</td>
          <td class="paramname"><em>frame_id_k</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const gtsam::Pose3 &amp;&#160;</td>
          <td class="paramname"><em>T_world_camera</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">gtsam::Values &amp;&#160;</td>
          <td class="paramname"><em>new_values</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">gtsam::NonlinearFactorGraph &amp;&#160;</td>
          <td class="paramname"><em>new_factors</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Adds odometry factor betwene k-1 and k using T_world_camera as the measurement at k and the existing value in the graph (or initial value from the front-end) as the pose measurement for k-1. </p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">frame_id_k</td><td>FrameId </td></tr>
    <tr><td class="paramname">T_world_camera</td><td>const gtsam::Pose3&amp; </td></tr>
    <tr><td class="paramname">new_values</td><td>gtsam::Values&amp; </td></tr>
    <tr><td class="paramname">new_factors</td><td>gtsam::NonlinearFactorGraph&amp; </td></tr>
  </table>
  </dd>
</dl>

<p class="definition">Definition at line <a class="el" href="Formulation-impl_8hpp_source.html#l00129">129</a> of file <a class="el" href="Formulation-impl_8hpp_source.html">Formulation-impl.hpp</a>.</p>
<div class="fragment"><div class="line"><span class="lineno">  132</span>                                                                           {</div>
<div class="line"><span class="lineno">  133</span>  new_values.insert(<a class="code hl_function" href="namespacedyno.html#a314d7f58c130d0aa28270309ff7500c5">CameraPoseSymbol</a>(frame_id_k), T_world_camera);</div>
<div class="line"><span class="lineno">  134</span>  <a class="code hl_variable" href="classdyno_1_1Formulation.html#aece87cef780a5692feeffc034e3dbd44">theta_</a>.insert_or_assign(new_values);</div>
<div class="line"><span class="lineno">  135</span>  <span class="keyword">auto</span> odometry_noise = <a class="code hl_variable" href="classdyno_1_1Formulation.html#a0e9e95a8f33f2da1fe8f7123feecf81c">noise_models_</a>.<a class="code hl_variable" href="structdyno_1_1NoiseModels.html#a8c89c4f869e6ec9ea6ebe16c5de8e73c">odometry_noise</a>;</div>
<div class="line"><span class="lineno">  136</span> </div>
<div class="line"><span class="lineno">  137</span>  <span class="keyword">typename</span> Map::Ptr <a class="code hl_function" href="classdyno_1_1Formulation.html#aa882dfc5e5e0cc12a03184b08889ad7f">map</a> = this-&gt;<a class="code hl_function" href="classdyno_1_1Formulation.html#aa882dfc5e5e0cc12a03184b08889ad7f">map</a>();</div>
<div class="line"><span class="lineno">  138</span> </div>
<div class="line"><span class="lineno">  139</span>  CHECK_GT(frame_id_k, <a class="code hl_function" href="classdyno_1_1Formulation.html#aa882dfc5e5e0cc12a03184b08889ad7f">map</a>-&gt;firstFrameId());</div>
<div class="line"><span class="lineno">  140</span>  <span class="keyword">const</span> <a class="code hl_typedef" href="namespacedyno.html#ac4303d6fafb755f794b072d76f9cfb41">FrameId</a> frame_id_k_1 = frame_id_k - 1u;</div>
<div class="line"><span class="lineno">  141</span> </div>
<div class="line"><span class="lineno">  142</span>  gtsam::Pose3 T_world_camera_k_1_frontend;</div>
<div class="line"><span class="lineno">  143</span>  CHECK(this-&gt;<a class="code hl_function" href="classdyno_1_1Formulation.html#aa882dfc5e5e0cc12a03184b08889ad7f">map</a>()-&gt;hasInitialSensorPose(frame_id_k_1,</div>
<div class="line"><span class="lineno">  144</span>                                          &amp;T_world_camera_k_1_frontend));</div>
<div class="line"><span class="lineno">  145</span> </div>
<div class="line"><span class="lineno">  146</span>  LOG(INFO) &lt;&lt; <span class="stringliteral">&quot;Adding odom between &quot;</span> &lt;&lt; frame_id_k_1 &lt;&lt; <span class="stringliteral">&quot; and &quot;</span> &lt;&lt; frame_id_k;</div>
<div class="line"><span class="lineno">  147</span>  gtsam::Pose3 odom = T_world_camera_k_1_frontend.inverse() * T_world_camera;</div>
<div class="line"><span class="lineno">  148</span> </div>
<div class="line"><span class="lineno">  149</span>  <span class="comment">// keep track of the new factors added in this function</span></div>
<div class="line"><span class="lineno">  150</span>  <span class="comment">// these are then appended to the internal factors_ and new_factors</span></div>
<div class="line"><span class="lineno">  151</span>  <span class="comment">// TODO: put somewhere else?</span></div>
<div class="line"><span class="lineno">  152</span>  <span class="keywordflow">if</span> (<span class="keyword">true</span>) {  <span class="comment">// if(FLAGS_use_vo_factor) {</span></div>
<div class="line"><span class="lineno">  153</span>    gtsam::NonlinearFactorGraph internal_new_factors;</div>
<div class="line"><span class="lineno">  154</span> </div>
<div class="line"><span class="lineno">  155</span>    <a class="code hl_function" href="namespacedyno_1_1factor__graph__tools.html#a3d58225c246103a5e85572e32cd17706">factor_graph_tools::addBetweenFactor</a>(frame_id_k_1, frame_id_k, odom,</div>
<div class="line"><span class="lineno">  156</span>                                         odometry_noise, internal_new_factors);</div>
<div class="line"><span class="lineno">  157</span>    <a class="code hl_variable" href="classdyno_1_1Formulation.html#aabc461bd6dfa004c931e99356477104e">factors_</a> += internal_new_factors;</div>
<div class="line"><span class="lineno">  158</span>    new_factors += internal_new_factors;</div>
<div class="line"><span class="lineno">  159</span>    LOG(INFO) &lt;&lt; <span class="stringliteral">&quot;Finished adding odom&quot;</span>;</div>
<div class="line"><span class="lineno">  160</span>  }</div>
<div class="line"><span class="lineno">  161</span>}</div>
<div class="ttc" id="aclassdyno_1_1Formulation_html_aabc461bd6dfa004c931e99356477104e"><div class="ttname"><a href="classdyno_1_1Formulation.html#aabc461bd6dfa004c931e99356477104e">dyno::Formulation::factors_</a></div><div class="ttdeci">gtsam::NonlinearFactorGraph factors_</div><div class="ttdef"><b>Definition:</b> <a href="Formulation_8hpp_source.html#l00453">Formulation.hpp:453</a></div></div>
<div class="ttc" id="anamespacedyno_1_1factor__graph__tools_html_a3d58225c246103a5e85572e32cd17706"><div class="ttname"><a href="namespacedyno_1_1factor__graph__tools.html#a3d58225c246103a5e85572e32cd17706">dyno::factor_graph_tools::addBetweenFactor</a></div><div class="ttdeci">void addBetweenFactor(FrameId from_frame, FrameId to_frame, const gtsam::Pose3 from_pose_to, gtsam::SharedNoiseModel noise_model, gtsam::NonlinearFactorGraph &amp;graph)</div><div class="ttdef"><b>Definition:</b> <a href="FactorGraphTools_8cc_source.html#l00073">FactorGraphTools.cc:73</a></div></div>
<div class="ttc" id="anamespacedyno_html_a314d7f58c130d0aa28270309ff7500c5"><div class="ttname"><a href="namespacedyno.html#a314d7f58c130d0aa28270309ff7500c5">dyno::CameraPoseSymbol</a></div><div class="ttdeci">gtsam::Symbol CameraPoseSymbol(FrameId frame_id)</div><div class="ttdef"><b>Definition:</b> <a href="BackendDefinitions_8hpp_source.html#l00070">BackendDefinitions.hpp:70</a></div></div>
<div class="ttc" id="anamespacedyno_html_ac4303d6fafb755f794b072d76f9cfb41"><div class="ttname"><a href="namespacedyno.html#ac4303d6fafb755f794b072d76f9cfb41">dyno::FrameId</a></div><div class="ttdeci">size_t FrameId</div><div class="ttdoc">Discrete time-step k.</div><div class="ttdef"><b>Definition:</b> <a href="Types_8hpp_source.html#l00072">Types.hpp:72</a></div></div>
<div class="ttc" id="astructdyno_1_1NoiseModels_html_a8c89c4f869e6ec9ea6ebe16c5de8e73c"><div class="ttname"><a href="structdyno_1_1NoiseModels.html#a8c89c4f869e6ec9ea6ebe16c5de8e73c">dyno::NoiseModels::odometry_noise</a></div><div class="ttdeci">gtsam::SharedNoiseModel odometry_noise</div><div class="ttdoc">Between factor noise for between two consequative poses.</div><div class="ttdef"><b>Definition:</b> <a href="BackendDefinitions_8hpp_source.html#l00099">BackendDefinitions.hpp:99</a></div></div>
</div><!-- fragment -->
<p class="reference">References <a class="el" href="namespacedyno_1_1factor__graph__tools.html#a3d58225c246103a5e85572e32cd17706">dyno::factor_graph_tools::addBetweenFactor()</a>, and <a class="el" href="namespacedyno.html#a314d7f58c130d0aa28270309ff7500c5">dyno::CameraPoseSymbol()</a>.</p>
<div class="dynheader">
Here is the call graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="classdyno_1_1Formulation_ad3c2df3ba1ce22a47c529c07bba70bf8_cgraph.png" border="0" usemap="#aclassdyno_1_1Formulation_ad3c2df3ba1ce22a47c529c07bba70bf8_cgraph" alt=""/></div>
<map name="aclassdyno_1_1Formulation_ad3c2df3ba1ce22a47c529c07bba70bf8_cgraph" id="aclassdyno_1_1Formulation_ad3c2df3ba1ce22a47c529c07bba70bf8_cgraph">
<area shape="rect" title="Adds odometry factor betwene k&#45;1 and k using T_world_camera as the measurement at k and the existing ..." alt="" coords="5,35,153,75"/>
<area shape="rect" href="namespacedyno_1_1factor__graph__tools.html#a3d58225c246103a5e85572e32cd17706" title=" " alt="" coords="201,5,391,45"/>
<area shape="rect" href="namespacedyno.html#a314d7f58c130d0aa28270309ff7500c5" title=" " alt="" coords="439,42,632,67"/>
</map>
</div>

</div>
</div>
<a id="a849272ad3138932bb3a0957ccba9ac5c" name="a849272ad3138932bb3a0957ccba9ac5c"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a849272ad3138932bb3a0957ccba9ac5c">&#9670;&#160;</a></span>addOdometry() <span class="overload">[2/2]</span></h2>

<div class="memitem">
<div class="memproto">
<div class="memtemplate">
template&lt;typename MAP &gt; </div>
      <table class="memname">
        <tr>
          <td class="memname">void <a class="el" href="classdyno_1_1Formulation.html">dyno::Formulation</a>&lt; MAP &gt;::addOdometry </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="namespacedyno.html#ac4303d6fafb755f794b072d76f9cfb41">FrameId</a>&#160;</td>
          <td class="paramname"><em>from_frame</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="namespacedyno.html#ac4303d6fafb755f794b072d76f9cfb41">FrameId</a>&#160;</td>
          <td class="paramname"><em>to_frame</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">gtsam::Values &amp;&#160;</td>
          <td class="paramname"><em>new_values</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">gtsam::NonlinearFactorGraph &amp;&#160;</td>
          <td class="paramname"><em>new_factors</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Adds odometry factor between multiple frames using the initial values from the front-end (as stored in the map) to calculate the odometry. </p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">from_frame</td><td>FrameId </td></tr>
    <tr><td class="paramname">to_frame</td><td>FrameId </td></tr>
    <tr><td class="paramname">new_values</td><td>gtsam::Values&amp; </td></tr>
    <tr><td class="paramname">new_factors</td><td>gtsam::NonlinearFactorGraph&amp; </td></tr>
  </table>
  </dd>
</dl>

<p class="definition">Definition at line <a class="el" href="Formulation-impl_8hpp_source.html#l00107">107</a> of file <a class="el" href="Formulation-impl_8hpp_source.html">Formulation-impl.hpp</a>.</p>
<div class="fragment"><div class="line"><span class="lineno">  109</span>                                                                           {</div>
<div class="line"><span class="lineno">  110</span>  CHECK_LT(from_frame, to_frame);</div>
<div class="line"><span class="lineno">  111</span>  CHECK_GT(from_frame, this-&gt;<a class="code hl_function" href="classdyno_1_1Formulation.html#aa882dfc5e5e0cc12a03184b08889ad7f">map</a>()-&gt;firstFrameId());</div>
<div class="line"><span class="lineno">  112</span> </div>
<div class="line"><span class="lineno">  113</span>  <span class="keywordflow">for</span> (<span class="keyword">auto</span> frame_id = from_frame; frame_id &lt;= to_frame; frame_id++) {</div>
<div class="line"><span class="lineno">  114</span>    gtsam::Values values;</div>
<div class="line"><span class="lineno">  115</span>    gtsam::NonlinearFactorGraph graph;</div>
<div class="line"><span class="lineno">  116</span> </div>
<div class="line"><span class="lineno">  117</span>    <span class="comment">// pose estimate from frontend</span></div>
<div class="line"><span class="lineno">  118</span>    gtsam::Pose3 T_world_camera_k;</div>
<div class="line"><span class="lineno">  119</span>    CHECK(this-&gt;<a class="code hl_function" href="classdyno_1_1Formulation.html#aa882dfc5e5e0cc12a03184b08889ad7f">map</a>()-&gt;hasInitialSensorPose(frame_id, &amp;T_world_camera_k));</div>
<div class="line"><span class="lineno">  120</span> </div>
<div class="line"><span class="lineno">  121</span>    <a class="code hl_function" href="classdyno_1_1Formulation.html#a849272ad3138932bb3a0957ccba9ac5c">addOdometry</a>(frame_id, T_world_camera_k, values, graph);</div>
<div class="line"><span class="lineno">  122</span> </div>
<div class="line"><span class="lineno">  123</span>    new_values.insert(values);</div>
<div class="line"><span class="lineno">  124</span>    new_factors += graph;</div>
<div class="line"><span class="lineno">  125</span>  }</div>
<div class="line"><span class="lineno">  126</span>}</div>
<div class="ttc" id="aclassdyno_1_1Formulation_html_a849272ad3138932bb3a0957ccba9ac5c"><div class="ttname"><a href="classdyno_1_1Formulation.html#a849272ad3138932bb3a0957ccba9ac5c">dyno::Formulation::addOdometry</a></div><div class="ttdeci">void addOdometry(FrameId from_frame, FrameId to_frame, gtsam::Values &amp;new_values, gtsam::NonlinearFactorGraph &amp;new_factors)</div><div class="ttdoc">Adds odometry factor between multiple frames using the initial values from the front-end (as stored i...</div><div class="ttdef"><b>Definition:</b> <a href="Formulation-impl_8hpp_source.html#l00107">Formulation-impl.hpp:107</a></div></div>
</div><!-- fragment -->
</div>
</div>
<a id="a087924d81177adf630c030364e5f5025" name="a087924d81177adf630c030364e5f5025"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a087924d81177adf630c030364e5f5025">&#9670;&#160;</a></span>createAccessor()</h2>

<div class="memitem">
<div class="memproto">
<div class="memtemplate">
template&lt;typename MAP &gt; </div>
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">virtual AccessorType::Ptr <a class="el" href="classdyno_1_1Formulation.html">dyno::Formulation</a>&lt; MAP &gt;::createAccessor </td>
          <td>(</td>
          <td class="paramtype">const gtsam::Values *&#160;</td>
          <td class="paramname"><em>values</em></td><td>)</td>
          <td> const</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">protected</span><span class="mlabel">pure virtual</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>Creates the associated <a class="el" href="classdyno_1_1Accessor.html" title="Accessor defines the interface between the structured output of a BackendModule and any formulation u...">Accessor</a> for the derived formulation. The accessor will contain a pointer to <a class="el" href="classdyno_1_1Formulation.html#aece87cef780a5692feeffc034e3dbd44" title="Current linearisation that will be associated with the current graph.">This::theta_</a>, so that when the values are updated the accessor has access to the latest values. </p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">values</td><td>const gtsam::Values* </td></tr>
  </table>
  </dd>
</dl>
<dl class="section return"><dt>Returns</dt><dd>AccessorType::Ptr </dd></dl>

<p>Implemented in <a class="el" href="classdyno_1_1WorldMotionFormulation.html#a1a34a66f03ab125c54586fa643273b25">dyno::WorldMotionFormulation</a>, and <a class="el" href="classdyno_1_1WorldPoseFormulation.html#ab5111da2ceb450b612fefe10c29ceaeb">dyno::WorldPoseFormulation</a>.</p>

</div>
</div>
<a id="af93533f32a88133a492b5e3ed790267f" name="af93533f32a88133a492b5e3ed790267f"></a>
<h2 class="memtitle"><span class="permalink"><a href="#af93533f32a88133a492b5e3ed790267f">&#9670;&#160;</a></span>dynamicPointUpdateCallback()</h2>

<div class="memitem">
<div class="memproto">
<div class="memtemplate">
template&lt;typename MAP &gt; </div>
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">virtual void <a class="el" href="classdyno_1_1Formulation.html">dyno::Formulation</a>&lt; MAP &gt;::dynamicPointUpdateCallback </td>
          <td>(</td>
          <td class="paramtype">const <a class="el" href="classdyno_1_1Formulation.html#a9a172e526e325ba2bdfef03640ef1802">PointUpdateContextType</a> &amp;&#160;</td>
          <td class="paramname"><em>context</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="structdyno_1_1UpdateObservationResult.html">UpdateObservationResult</a> &amp;&#160;</td>
          <td class="paramname"><em>result</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">gtsam::Values &amp;&#160;</td>
          <td class="paramname"><em>new_values</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">gtsam::NonlinearFactorGraph &amp;&#160;</td>
          <td class="paramname"><em>new_factors</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">protected</span><span class="mlabel">pure virtual</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>Virtual function to be implemented by derived class and indicates that a specific landmark has new measurements and new values/factors should be added. Details on the landmark to be updated are provied by the context. In general, this is used to add projection/motion factors and initial values for landmarks. </p>
<p>This function is called when, for a frame k, a point has new measurements (from the front-end) and the point is well-tracked (e.g has been seen at least n times).</p>
<p>If the point is new the gtsam::Values should be updated and gtsam::NonlinearFactorGraph should be updated with new factors. Note that the PointUpdateContextType is constructed in-terms of a MOTION so that information is provided about the k-1 and k'th observation. In the case that this point is first observed, this construction means that the point has been seen twice (at k-1 and k).</p>
<p><a class="el" href="structdyno_1_1UpdateObservationResult.html">UpdateObservationResult</a> MUST also be updated if a new value or factor is added as this tells the base formulation that new information has been added to the graph. The result is used to determine which object's to then form a ObjectUpdateContextType for.</p>
<p>This function should also set any internal logic to ensure that after a new point has been initalised/added, isDynamicTrackletInMap returns true as this is used internally.</p>
<p>For all factor-graph construction functions, all functions additionally return (via out-args) all new factors and values added during the function. These new values/factors will ALSO be added to the internal theta_/factors_. This allows the <a class="el" href="classdyno_1_1Formulation.html" title="Base class for a formulation that defines the structure and implementation for a factor-graph based D...">Formulation</a> to be used for batch optimisation, by accessing the full graph (<a class="el" href="classdyno_1_1Formulation.html#ab453db0a7949192fc9499aab026e012f" title="Get the current linearization point for this formulation. These values can be updated after external ...">getTheta()</a>, <a class="el" href="classdyno_1_1Formulation.html#a5897842d346d80f87315ed7870d7d580" title="Gets the current graph associated with the current theta and constructed by the derived formulation....">getGraph()</a>) or incremental optimisation by updating the incremental optimser using just the new values/factors returned from the update functions.</p>
<p>NOTE all point update callbacks are triggered before any objectUpdateContext, although the order is arbitrary.</p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">context</td><td>const PointUpdateContextType&amp; </td></tr>
    <tr><td class="paramname">result</td><td><a class="el" href="structdyno_1_1UpdateObservationResult.html">UpdateObservationResult</a>&amp; </td></tr>
    <tr><td class="paramname">new_values</td><td>gtsam::Values&amp; </td></tr>
    <tr><td class="paramname">new_factors</td><td>gtsam::NonlinearFactorGraph&amp; </td></tr>
  </table>
  </dd>
</dl>

</div>
</div>
<a id="a6b9b3b3a6c14748b57725bee233bcca4" name="a6b9b3b3a6c14748b57725bee233bcca4"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a6b9b3b3a6c14748b57725bee233bcca4">&#9670;&#160;</a></span>getFullyQualifiedName()</h2>

<div class="memitem">
<div class="memproto">
<div class="memtemplate">
template&lt;typename MAP &gt; </div>
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">const std::string <a class="el" href="classdyno_1_1Formulation.html">dyno::Formulation</a>&lt; MAP &gt;::getFullyQualifiedName </td>
          <td>(</td>
          <td class="paramname"></td><td>)</td>
          <td> const</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">inline</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>Get the fully qualified name of this formulation which is derived from the loggerPrefix and optionally the <a class="el" href="structdyno_1_1FormulationParams.html#ac3367e0c0d80aec0900a00132becd768">FormulationParams::suffix</a> if given. </p>
<dl class="section return"><dt>Returns</dt><dd>const std::string </dd></dl>

<p class="definition">Definition at line <a class="el" href="Formulation_8hpp_source.html#l00301">301</a> of file <a class="el" href="Formulation_8hpp_source.html">Formulation.hpp</a>.</p>
<div class="fragment"><div class="line"><span class="lineno">  301</span>{ <span class="keywordflow">return</span> <a class="code hl_variable" href="classdyno_1_1Formulation.html#a1f64fc4ad8d279acfb5402ba9748087d">fully_qualified_name_</a>.value_or(<a class="code hl_function" href="classdyno_1_1Formulation.html#abc91d003af81579a6918973ff7b83ea5">setFullyQualifiedName</a>()); }</div>
<div class="ttc" id="aclassdyno_1_1Formulation_html_a1f64fc4ad8d279acfb5402ba9748087d"><div class="ttname"><a href="classdyno_1_1Formulation.html#a1f64fc4ad8d279acfb5402ba9748087d">dyno::Formulation::fully_qualified_name_</a></div><div class="ttdeci">std::optional&lt; std::string &gt; fully_qualified_name_</div><div class="ttdoc">Full name of the formulation and accounts for the additional configuration from the FormulationParams...</div><div class="ttdef"><b>Definition:</b> <a href="Formulation_8hpp_source.html#l00456">Formulation.hpp:456</a></div></div>
<div class="ttc" id="aclassdyno_1_1Formulation_html_abc91d003af81579a6918973ff7b83ea5"><div class="ttname"><a href="classdyno_1_1Formulation.html#abc91d003af81579a6918973ff7b83ea5">dyno::Formulation::setFullyQualifiedName</a></div><div class="ttdeci">std::string setFullyQualifiedName() const</div><div class="ttdef"><b>Definition:</b> <a href="Formulation-impl_8hpp_source.html#l00656">Formulation-impl.hpp:656</a></div></div>
</div><!-- fragment -->
<p class="reference">References <a class="el" href="classdyno_1_1Formulation.html#a1f64fc4ad8d279acfb5402ba9748087d">dyno::Formulation&lt; MAP &gt;::fully_qualified_name_</a>, and <a class="el" href="classdyno_1_1Formulation.html#abc91d003af81579a6918973ff7b83ea5">dyno::Formulation&lt; MAP &gt;::setFullyQualifiedName()</a>.</p>
<div class="dynheader">
Here is the call graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="classdyno_1_1Formulation_a6b9b3b3a6c14748b57725bee233bcca4_cgraph.png" border="0" usemap="#aclassdyno_1_1Formulation_a6b9b3b3a6c14748b57725bee233bcca4_cgraph" alt=""/></div>
<map name="aclassdyno_1_1Formulation_a6b9b3b3a6c14748b57725bee233bcca4_cgraph" id="aclassdyno_1_1Formulation_a6b9b3b3a6c14748b57725bee233bcca4_cgraph">
<area shape="rect" title="Get the fully qualified name of this formulation which is derived from the loggerPrefix and optionall..." alt="" coords="5,5,176,45"/>
<area shape="rect" href="classdyno_1_1Formulation.html#abc91d003af81579a6918973ff7b83ea5" title=" " alt="" coords="224,5,395,45"/>
</map>
</div>

</div>
</div>
<a id="a5897842d346d80f87315ed7870d7d580" name="a5897842d346d80f87315ed7870d7d580"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a5897842d346d80f87315ed7870d7d580">&#9670;&#160;</a></span>getGraph()</h2>

<div class="memitem">
<div class="memproto">
<div class="memtemplate">
template&lt;typename MAP &gt; </div>
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">const gtsam::NonlinearFactorGraph &amp; <a class="el" href="classdyno_1_1Formulation.html">dyno::Formulation</a>&lt; MAP &gt;::getGraph </td>
          <td>(</td>
          <td class="paramname"></td><td>)</td>
          <td> const</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">inline</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>Gets the current graph associated with the current theta and constructed by the derived formulation. Along theta, this should be used by an external optimisation routine. </p>
<dl class="section return"><dt>Returns</dt><dd>const gtsam::NonlinearFactorGraph&amp; </dd></dl>

<p class="definition">Definition at line <a class="el" href="Formulation_8hpp_source.html#l00293">293</a> of file <a class="el" href="Formulation_8hpp_source.html">Formulation.hpp</a>.</p>
<div class="fragment"><div class="line"><span class="lineno">  293</span>{ <span class="keywordflow">return</span> <a class="code hl_variable" href="classdyno_1_1Formulation.html#aabc461bd6dfa004c931e99356477104e">factors_</a>; }</div>
</div><!-- fragment -->
<p class="reference">References <a class="el" href="classdyno_1_1Formulation.html#aabc461bd6dfa004c931e99356477104e">dyno::Formulation&lt; MAP &gt;::factors_</a>.</p>

</div>
</div>
<a id="a3369b4fa4dd649495e5bace0e9b715d9" name="a3369b4fa4dd649495e5bace0e9b715d9"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a3369b4fa4dd649495e5bace0e9b715d9">&#9670;&#160;</a></span>getInitialOrLinearizedSensorPose()</h2>

<div class="memitem">
<div class="memproto">
<div class="memtemplate">
template&lt;typename MAP &gt; </div>
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">gtsam::Pose3 <a class="el" href="classdyno_1_1Formulation.html">dyno::Formulation</a>&lt; MAP &gt;::getInitialOrLinearizedSensorPose </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="namespacedyno.html#ac4303d6fafb755f794b072d76f9cfb41">FrameId</a>&#160;</td>
          <td class="paramname"><em>frame_id</em></td><td>)</td>
          <td> const</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">protected</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="Formulation-impl_8hpp_source.html#l00063">63</a> of file <a class="el" href="Formulation-impl_8hpp_source.html">Formulation-impl.hpp</a>.</p>
<div class="fragment"><div class="line"><span class="lineno">   64</span>                            {</div>
<div class="line"><span class="lineno">   65</span>  <span class="keyword">const</span> <span class="keyword">auto</span> accessor = this-&gt;<a class="code hl_function" href="classdyno_1_1Formulation.html#a536dbcbdd6fcd6598fcedb7866cec1de">accessorFromTheta</a>();</div>
<div class="line"><span class="lineno">   66</span>  <span class="comment">// sensor pose from a previous/current linearisation point</span></div>
<div class="line"><span class="lineno">   67</span>  StateQuery&lt;gtsam::Pose3&gt; X_k_theta = accessor-&gt;getSensorPose(frame_id);</div>
<div class="line"><span class="lineno">   68</span> </div>
<div class="line"><span class="lineno">   69</span>  gtsam::Pose3 X_k_initial;</div>
<div class="line"><span class="lineno">   70</span>  CHECK(this-&gt;<a class="code hl_function" href="classdyno_1_1Formulation.html#aa882dfc5e5e0cc12a03184b08889ad7f">map</a>()-&gt;hasInitialSensorPose(frame_id, &amp;X_k_initial));</div>
<div class="line"><span class="lineno">   71</span>  <span class="comment">// take either the query value from the map (if we have a previous</span></div>
<div class="line"><span class="lineno">   72</span>  <span class="comment">// initalisation), or the estimate from the camera</span></div>
<div class="line"><span class="lineno">   73</span>  gtsam::Pose3 X_k;</div>
<div class="line"><span class="lineno">   74</span>  <a class="code hl_function" href="namespacedyno.html#ad5ce0869676f7888164ba26aceda60a9">getSafeQuery</a>(X_k, X_k_theta, X_k_initial);</div>
<div class="line"><span class="lineno">   75</span>  <span class="keywordflow">return</span> X_k;</div>
<div class="line"><span class="lineno">   76</span>}</div>
<div class="ttc" id="aclassdyno_1_1Formulation_html_a536dbcbdd6fcd6598fcedb7866cec1de"><div class="ttname"><a href="classdyno_1_1Formulation.html#a536dbcbdd6fcd6598fcedb7866cec1de">dyno::Formulation::accessorFromTheta</a></div><div class="ttdeci">AccessorType::Ptr accessorFromTheta() const</div><div class="ttdoc">Public fucntion to access the Accessor for the derived formulation.</div><div class="ttdef"><b>Definition:</b> <a href="Formulation-impl_8hpp_source.html#l00648">Formulation-impl.hpp:648</a></div></div>
<div class="ttc" id="anamespacedyno_html_ad5ce0869676f7888164ba26aceda60a9"><div class="ttname"><a href="namespacedyno.html#ad5ce0869676f7888164ba26aceda60a9">dyno::getSafeQuery</a></div><div class="ttdeci">bool getSafeQuery(ValueType &amp;result, const StateQuery&lt; ValueType &gt; &amp;query, const ValueType &amp;default_value)</div><div class="ttdoc">Safe getter to a StateQuery object. If the StateQuery is successful, result is set to the value of th...</div><div class="ttdef"><b>Definition:</b> <a href="MapNodes_8hpp_source.html#l00332">MapNodes.hpp:332</a></div></div>
</div><!-- fragment -->
<p class="reference">References <a class="el" href="namespacedyno.html#ad5ce0869676f7888164ba26aceda60a9">dyno::getSafeQuery()</a>.</p>
<div class="dynheader">
Here is the call graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="classdyno_1_1Formulation_a3369b4fa4dd649495e5bace0e9b715d9_cgraph.png" border="0" usemap="#aclassdyno_1_1Formulation_a3369b4fa4dd649495e5bace0e9b715d9_cgraph" alt=""/></div>
<map name="aclassdyno_1_1Formulation_a3369b4fa4dd649495e5bace0e9b715d9_cgraph" id="aclassdyno_1_1Formulation_a3369b4fa4dd649495e5bace0e9b715d9_cgraph">
<area shape="rect" title=" " alt="" coords="5,5,243,45"/>
<area shape="rect" href="namespacedyno.html#ad5ce0869676f7888164ba26aceda60a9" title="Safe getter to a StateQuery object. If the StateQuery is successful, result is set to the value of th..." alt="" coords="291,13,441,38"/>
<area shape="rect" href="classdyno_1_1StateQuery.html#af7ca5fb04717f5719c62a54b3b67fd17" title=" " alt="" coords="489,13,652,38"/>
<area shape="rect" href="namespacedyno.html#a2d6f925680f57dbc72ada75daefdb2f9" title=" " alt="" coords="700,13,911,38"/>
</map>
</div>

</div>
</div>
<a id="ab453db0a7949192fc9499aab026e012f" name="ab453db0a7949192fc9499aab026e012f"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ab453db0a7949192fc9499aab026e012f">&#9670;&#160;</a></span>getTheta()</h2>

<div class="memitem">
<div class="memproto">
<div class="memtemplate">
template&lt;typename MAP &gt; </div>
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">const gtsam::Values &amp; <a class="el" href="classdyno_1_1Formulation.html">dyno::Formulation</a>&lt; MAP &gt;::getTheta </td>
          <td>(</td>
          <td class="paramname"></td><td>)</td>
          <td> const</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">inline</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>Get the current linearization point for this formulation. These values can be updated after external optimisation and are constructed by the derived formulation during update. </p>
<dl class="section return"><dt>Returns</dt><dd>const gtsam::Values&amp; </dd></dl>

<p class="definition">Definition at line <a class="el" href="Formulation_8hpp_source.html#l00269">269</a> of file <a class="el" href="Formulation_8hpp_source.html">Formulation.hpp</a>.</p>
<div class="fragment"><div class="line"><span class="lineno">  269</span>{ <span class="keywordflow">return</span> <a class="code hl_variable" href="classdyno_1_1Formulation.html#aece87cef780a5692feeffc034e3dbd44">theta_</a>; }</div>
</div><!-- fragment -->
<p class="reference">References <a class="el" href="classdyno_1_1Formulation.html#aece87cef780a5692feeffc034e3dbd44">dyno::Formulation&lt; MAP &gt;::theta_</a>.</p>

</div>
</div>
<a id="a7cbe87537d35b8d21463d402342ef356" name="a7cbe87537d35b8d21463d402342ef356"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a7cbe87537d35b8d21463d402342ef356">&#9670;&#160;</a></span>isDynamicTrackletInMap()</h2>

<div class="memitem">
<div class="memproto">
<div class="memtemplate">
template&lt;typename MAP &gt; </div>
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">virtual bool <a class="el" href="classdyno_1_1Formulation.html">dyno::Formulation</a>&lt; MAP &gt;::isDynamicTrackletInMap </td>
          <td>(</td>
          <td class="paramtype">const typename <a class="el" href="structdyno_1_1MapTraits.html#a72db8cc0191a116471646c6302bea29b">MapTraitsType::LandmarkNodePtr</a> &amp;&#160;</td>
          <td class="paramname"><em>lmk_node</em></td><td>)</td>
          <td> const</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">protected</span><span class="mlabel">pure virtual</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>Virtual function to be implemented by derived class and indicates that the specified landmark exists within the graph already. This is used as part of the internal bookeeping. </p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">lmk_node</td><td>typename <a class="el" href="structdyno_1_1MapTraits.html#a72db8cc0191a116471646c6302bea29b">MapTraitsType::LandmarkNodePtr</a>&amp;. Pointer to a landmark node. </td></tr>
  </table>
  </dd>
</dl>
<dl class="section return"><dt>Returns</dt><dd>true </dd>
<dd>
false </dd></dl>

</div>
</div>
<a id="a7a559d73e69e026a67b5af2e7b8c1eae" name="a7a559d73e69e026a67b5af2e7b8c1eae"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a7a559d73e69e026a67b5af2e7b8c1eae">&#9670;&#160;</a></span>logBackendFromMap()</h2>

<div class="memitem">
<div class="memproto">
<div class="memtemplate">
template&lt;typename MAP &gt; </div>
      <table class="memname">
        <tr>
          <td class="memname">void <a class="el" href="classdyno_1_1Formulation.html">dyno::Formulation</a>&lt; MAP &gt;::logBackendFromMap </td>
          <td>(</td>
          <td class="paramtype">const <a class="el" href="structdyno_1_1BackendMetaData.html">BackendMetaData</a> &amp;&#160;</td>
          <td class="paramname"><em>backend_info</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Logs all frames and values to file using <a class="el" href="classdyno_1_1Accessor.html" title="Accessor defines the interface between the structured output of a BackendModule and any formulation u...">Accessor</a> and <a class="el" href="classdyno_1_1BackendLogger.html">BackendLogger</a>. The <a class="el" href="structdyno_1_1BackendMetaData.html">BackendMetaData</a> provides meta-data and ground truth information for logging. </p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">backend_info</td><td>const <a class="el" href="structdyno_1_1BackendMetaData.html">BackendMetaData</a>&amp; </td></tr>
  </table>
  </dd>
</dl>

<p class="definition">Definition at line <a class="el" href="Formulation-impl_8hpp_source.html#l00587">587</a> of file <a class="el" href="Formulation-impl_8hpp_source.html">Formulation-impl.hpp</a>.</p>
<div class="fragment"><div class="line"><span class="lineno">  587</span>                                                                            {</div>
<div class="line"><span class="lineno">  588</span>  BackendLogger::UniquePtr logger = <a class="code hl_function" href="classdyno_1_1Formulation.html#a61251ff882e273eb439bb238e87762e4">makeFullyQualifiedLogger</a>();</div>
<div class="line"><span class="lineno">  589</span> </div>
<div class="line"><span class="lineno">  590</span>  <span class="keyword">typename</span> Map::Ptr <a class="code hl_function" href="classdyno_1_1Formulation.html#aa882dfc5e5e0cc12a03184b08889ad7f">map</a> = this-&gt;<a class="code hl_function" href="classdyno_1_1Formulation.html#aa882dfc5e5e0cc12a03184b08889ad7f">map</a>();</div>
<div class="line"><span class="lineno">  591</span>  <span class="keyword">auto</span> accessor = this-&gt;<a class="code hl_function" href="classdyno_1_1Formulation.html#a536dbcbdd6fcd6598fcedb7866cec1de">accessorFromTheta</a>();</div>
<div class="line"><span class="lineno">  592</span>  <span class="keyword">const</span> <span class="keyword">auto</span>&amp; ground_truth_packets = backend_info.ground_truth_packets;</div>
<div class="line"><span class="lineno">  593</span>  <span class="keyword">const</span> <span class="keyword">auto</span>&amp; backend_params = backend_info.params;</div>
<div class="line"><span class="lineno">  594</span> </div>
<div class="line"><span class="lineno">  595</span>  <span class="keyword">const</span> <a class="code hl_typedef" href="namespacedyno.html#a47c0a08523c12765d4bd6e243f900c16">ObjectPoseMap</a> object_pose_map = accessor-&gt;getObjectPoses();</div>
<div class="line"><span class="lineno">  596</span> </div>
<div class="line"><span class="lineno">  597</span>  <span class="keywordflow">for</span> (<a class="code hl_typedef" href="namespacedyno.html#ac4303d6fafb755f794b072d76f9cfb41">FrameId</a> frame_k : <a class="code hl_function" href="classdyno_1_1Formulation.html#aa882dfc5e5e0cc12a03184b08889ad7f">map</a>-&gt;getFrameIds()) {</div>
<div class="line"><span class="lineno">  598</span>    <span class="comment">// TODO: hack - only go up to frames &lt; full batch so we actually only</span></div>
<div class="line"><span class="lineno">  599</span>    <span class="comment">// include the optimised alues</span></div>
<div class="line"><span class="lineno">  600</span>    <span class="keywordflow">if</span> (backend_params.use_use_full_batch_opt &amp;&amp;</div>
<div class="line"><span class="lineno">  601</span>        backend_params.full_batch_frame - 1 == (<span class="keywordtype">int</span>)frame_k) {</div>
<div class="line"><span class="lineno">  602</span>      <span class="keywordflow">break</span>;</div>
<div class="line"><span class="lineno">  603</span>    }</div>
<div class="line"><span class="lineno">  604</span> </div>
<div class="line"><span class="lineno">  605</span>    std::stringstream ss;</div>
<div class="line"><span class="lineno">  606</span>    ss &lt;&lt; <span class="stringliteral">&quot;Logging data from map at frame &quot;</span> &lt;&lt; frame_k;</div>
<div class="line"><span class="lineno">  607</span> </div>
<div class="line"><span class="lineno">  608</span>    <span class="comment">// get MotionestimateMap</span></div>
<div class="line"><span class="lineno">  609</span>    <span class="comment">//  const MotionEstimateMap motions = map-&gt;getMotionEstimates(frame_k);</span></div>
<div class="line"><span class="lineno">  610</span>    {</div>
<div class="line"><span class="lineno">  611</span>      <span class="keyword">const</span> <a class="code hl_typedef" href="namespacedyno.html#acef42ad0a1e53f5876f1000defc23e3b">MotionEstimateMap</a> motions = accessor-&gt;getObjectMotions(frame_k);</div>
<div class="line"><span class="lineno">  612</span>      <span class="keyword">auto</span> result =</div>
<div class="line"><span class="lineno">  613</span>          logger-&gt;logObjectMotion(frame_k, motions, ground_truth_packets);</div>
<div class="line"><span class="lineno">  614</span>      <span class="keywordflow">if</span> (result)</div>
<div class="line"><span class="lineno">  615</span>        ss &lt;&lt; <span class="stringliteral">&quot; Logged &quot;</span> &lt;&lt; *result &lt;&lt; <span class="stringliteral">&quot; motions from &quot;</span> &lt;&lt; motions.size()</div>
<div class="line"><span class="lineno">  616</span>           &lt;&lt; <span class="stringliteral">&quot; computed motions.&quot;</span>;</div>
<div class="line"><span class="lineno">  617</span>      <span class="keywordflow">else</span></div>
<div class="line"><span class="lineno">  618</span>        ss &lt;&lt; <span class="stringliteral">&quot; Could not log object motions.&quot;</span>;</div>
<div class="line"><span class="lineno">  619</span>    }</div>
<div class="line"><span class="lineno">  620</span> </div>
<div class="line"><span class="lineno">  621</span>    StateQuery&lt;gtsam::Pose3&gt; X_k_query = accessor-&gt;getSensorPose(frame_k);</div>
<div class="line"><span class="lineno">  622</span> </div>
<div class="line"><span class="lineno">  623</span>    <span class="keywordflow">if</span> (X_k_query) {</div>
<div class="line"><span class="lineno">  624</span>      logger-&gt;logCameraPose(frame_k, X_k_query.get(), ground_truth_packets);</div>
<div class="line"><span class="lineno">  625</span>    } <span class="keywordflow">else</span> {</div>
<div class="line"><span class="lineno">  626</span>      LOG(WARNING) &lt;&lt; <span class="stringliteral">&quot;Could not log camera pose estimate at frame &quot;</span> &lt;&lt; frame_k;</div>
<div class="line"><span class="lineno">  627</span>    }</div>
<div class="line"><span class="lineno">  628</span> </div>
<div class="line"><span class="lineno">  629</span>    logger-&gt;logObjectPose(frame_k, object_pose_map, ground_truth_packets);</div>
<div class="line"><span class="lineno">  630</span> </div>
<div class="line"><span class="lineno">  631</span>    <span class="keywordflow">if</span> (<a class="code hl_function" href="classdyno_1_1Formulation.html#aa882dfc5e5e0cc12a03184b08889ad7f">map</a>-&gt;frameExists(frame_k)) {</div>
<div class="line"><span class="lineno">  632</span>      <span class="keyword">auto</span> static_map = accessor-&gt;getStaticLandmarkEstimates(frame_k);</div>
<div class="line"><span class="lineno">  633</span>      <span class="keyword">auto</span> dynamic_map = accessor-&gt;getDynamicLandmarkEstimates(frame_k);</div>
<div class="line"><span class="lineno">  634</span> </div>
<div class="line"><span class="lineno">  635</span>      CHECK(X_k_query);  <span class="comment">// actually not needed for points in world!!</span></div>
<div class="line"><span class="lineno">  636</span>      logger-&gt;logPoints(frame_k, *X_k_query, static_map);</div>
<div class="line"><span class="lineno">  637</span>      logger-&gt;logPoints(frame_k, *X_k_query, dynamic_map);</div>
<div class="line"><span class="lineno">  638</span>    }</div>
<div class="line"><span class="lineno">  639</span> </div>
<div class="line"><span class="lineno">  640</span>    LOG(INFO) &lt;&lt; ss.str();</div>
<div class="line"><span class="lineno">  641</span>  }</div>
<div class="line"><span class="lineno">  642</span> </div>
<div class="line"><span class="lineno">  643</span>  logger.reset();</div>
<div class="line"><span class="lineno">  644</span>}</div>
<div class="ttc" id="aclassdyno_1_1Formulation_html_a61251ff882e273eb439bb238e87762e4"><div class="ttname"><a href="classdyno_1_1Formulation.html#a61251ff882e273eb439bb238e87762e4">dyno::Formulation::makeFullyQualifiedLogger</a></div><div class="ttdeci">BackendLogger::UniquePtr makeFullyQualifiedLogger() const</div><div class="ttdoc">Makes a logger using the fully-qualified name for this formulation.</div><div class="ttdef"><b>Definition:</b> <a href="Formulation-impl_8hpp_source.html#l00079">Formulation-impl.hpp:79</a></div></div>
<div class="ttc" id="anamespacedyno_html_a47c0a08523c12765d4bd6e243f900c16"><div class="ttname"><a href="namespacedyno.html#a47c0a08523c12765d4bd6e243f900c16">dyno::ObjectPoseMap</a></div><div class="ttdeci">GenericObjectCentricMap&lt; gtsam::Pose3 &gt; ObjectPoseMap</div><div class="ttdoc">Map of object poses per object per frame.</div><div class="ttdef"><b>Definition:</b> <a href="Types_8hpp_source.html#l00524">Types.hpp:524</a></div></div>
<div class="ttc" id="anamespacedyno_html_acef42ad0a1e53f5876f1000defc23e3b"><div class="ttname"><a href="namespacedyno.html#acef42ad0a1e53f5876f1000defc23e3b">dyno::MotionEstimateMap</a></div><div class="ttdeci">EstimateMap&lt; ObjectId, Motion3 &gt; MotionEstimateMap</div><div class="ttdoc">Map of object ids to ReferenceFrameValue's of motions.</div><div class="ttdef"><b>Definition:</b> <a href="Types_8hpp_source.html#l00388">Types.hpp:388</a></div></div>
</div><!-- fragment -->
<p class="reference">References <a class="el" href="classdyno_1_1StateQuery.html#af7ca5fb04717f5719c62a54b3b67fd17">dyno::StateQuery&lt; ValueType &gt;::get()</a>, <a class="el" href="structdyno_1_1BackendMetaData.html#a5343304e8813a2c3ff5142cf6b11572e">dyno::BackendMetaData::ground_truth_packets</a>, and <a class="el" href="structdyno_1_1BackendMetaData.html#af80d3b3123e6b3523464c46d3be2e68b">dyno::BackendMetaData::params</a>.</p>
<div class="dynheader">
Here is the call graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="classdyno_1_1Formulation_a7a559d73e69e026a67b5af2e7b8c1eae_cgraph.png" border="0" usemap="#aclassdyno_1_1Formulation_a7a559d73e69e026a67b5af2e7b8c1eae_cgraph" alt=""/></div>
<map name="aclassdyno_1_1Formulation_a7a559d73e69e026a67b5af2e7b8c1eae_cgraph" id="aclassdyno_1_1Formulation_a7a559d73e69e026a67b5af2e7b8c1eae_cgraph">
<area shape="rect" title="Logs all frames and values to file using Accessor and BackendLogger. The BackendMetaData provides met..." alt="" coords="5,5,164,45"/>
<area shape="rect" href="classdyno_1_1StateQuery.html#af7ca5fb04717f5719c62a54b3b67fd17" title=" " alt="" coords="212,13,375,38"/>
<area shape="rect" href="namespacedyno.html#a2d6f925680f57dbc72ada75daefdb2f9" title=" " alt="" coords="423,13,633,38"/>
</map>
</div>

</div>
</div>
<a id="aa3902e16e40c4eb8215ddfb4b7a625c5" name="aa3902e16e40c4eb8215ddfb4b7a625c5"></a>
<h2 class="memtitle"><span class="permalink"><a href="#aa3902e16e40c4eb8215ddfb4b7a625c5">&#9670;&#160;</a></span>loggerPrefix()</h2>

<div class="memitem">
<div class="memproto">
<div class="memtemplate">
template&lt;typename MAP &gt; </div>
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">virtual std::string <a class="el" href="classdyno_1_1Formulation.html">dyno::Formulation</a>&lt; MAP &gt;::loggerPrefix </td>
          <td>(</td>
          <td class="paramname"></td><td>)</td>
          <td> const</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">protected</span><span class="mlabel">pure virtual</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>Defines the base name of this formulation. This name will appear as part of the output logs and may be augmented with the <a class="el" href="structdyno_1_1FormulationParams.html#ac3367e0c0d80aec0900a00132becd768">FormulationParams::suffix</a>, if given. To get the fully qualified name (the actual name that will appear in the logs), use <a class="el" href="classdyno_1_1Formulation.html#a6b9b3b3a6c14748b57725bee233bcca4" title="Get the fully qualified name of this formulation which is derived from the loggerPrefix and optionall...">This::getFullyQualifiedName()</a>. </p>
<dl class="section return"><dt>Returns</dt><dd>std::string </dd></dl>

<p>Implemented in <a class="el" href="classdyno_1_1WorldMotionFormulation.html#a793731282e0f2e115533709c4387cdae">dyno::WorldMotionFormulation</a>, and <a class="el" href="classdyno_1_1WorldPoseFormulation.html#a50488d29033d15a68f76fcaaffd63754">dyno::WorldPoseFormulation</a>.</p>

</div>
</div>
<a id="a61251ff882e273eb439bb238e87762e4" name="a61251ff882e273eb439bb238e87762e4"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a61251ff882e273eb439bb238e87762e4">&#9670;&#160;</a></span>makeFullyQualifiedLogger()</h2>

<div class="memitem">
<div class="memproto">
<div class="memtemplate">
template&lt;typename MAP &gt; </div>
      <table class="memname">
        <tr>
          <td class="memname">BackendLogger::UniquePtr <a class="el" href="classdyno_1_1Formulation.html">dyno::Formulation</a>&lt; MAP &gt;::makeFullyQualifiedLogger</td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Makes a logger using the fully-qualified name for this formulation. </p>
<dl class="section return"><dt>Returns</dt><dd>BackendLogger::UniquePtr </dd></dl>

<p class="definition">Definition at line <a class="el" href="Formulation-impl_8hpp_source.html#l00079">79</a> of file <a class="el" href="Formulation-impl_8hpp_source.html">Formulation-impl.hpp</a>.</p>
<div class="fragment"><div class="line"><span class="lineno">   79</span>                                                                        {</div>
<div class="line"><span class="lineno">   80</span>  <span class="keywordflow">return</span> std::make_unique&lt;BackendLogger&gt;(<a class="code hl_function" href="classdyno_1_1Formulation.html#a6b9b3b3a6c14748b57725bee233bcca4">getFullyQualifiedName</a>());</div>
<div class="line"><span class="lineno">   81</span>}</div>
<div class="ttc" id="aclassdyno_1_1Formulation_html_a6b9b3b3a6c14748b57725bee233bcca4"><div class="ttname"><a href="classdyno_1_1Formulation.html#a6b9b3b3a6c14748b57725bee233bcca4">dyno::Formulation::getFullyQualifiedName</a></div><div class="ttdeci">const std::string getFullyQualifiedName() const</div><div class="ttdoc">Get the fully qualified name of this formulation which is derived from the loggerPrefix and optionall...</div><div class="ttdef"><b>Definition:</b> <a href="Formulation_8hpp_source.html#l00301">Formulation.hpp:301</a></div></div>
</div><!-- fragment -->
</div>
</div>
<a id="aa882dfc5e5e0cc12a03184b08889ad7f" name="aa882dfc5e5e0cc12a03184b08889ad7f"></a>
<h2 class="memtitle"><span class="permalink"><a href="#aa882dfc5e5e0cc12a03184b08889ad7f">&#9670;&#160;</a></span>map()</h2>

<div class="memitem">
<div class="memproto">
<div class="memtemplate">
template&lt;typename MAP &gt; </div>
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">Map::Ptr <a class="el" href="classdyno_1_1Formulation.html">dyno::Formulation</a>&lt; MAP &gt;::map </td>
          <td>(</td>
          <td class="paramname"></td><td>)</td>
          <td> const</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">inline</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>Get the map used by the formulation. </p>
<dl class="section return"><dt>Returns</dt><dd>Map::Ptr </dd></dl>

<p class="definition">Definition at line <a class="el" href="Formulation_8hpp_source.html#l00261">261</a> of file <a class="el" href="Formulation_8hpp_source.html">Formulation.hpp</a>.</p>
<div class="fragment"><div class="line"><span class="lineno">  261</span>{ <span class="keywordflow">return</span> <a class="code hl_variable" href="classdyno_1_1Formulation.html#a100326929d58a9a30f663f51969058f9">map_</a>; }</div>
</div><!-- fragment -->
<p class="reference">References <a class="el" href="classdyno_1_1Formulation.html#a100326929d58a9a30f663f51969058f9">dyno::Formulation&lt; MAP &gt;::map_</a>.</p>

<p class="reference">Referenced by <a class="el" href="classdyno_1_1RGBDBackendModule.html#a26b5b762684936e022839599b8895e95">dyno::RGBDBackendModule::constructOutputPacket()</a>.</p>
<div class="dynheader">
Here is the caller graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="classdyno_1_1Formulation_aa882dfc5e5e0cc12a03184b08889ad7f_icgraph.png" border="0" usemap="#aclassdyno_1_1Formulation_aa882dfc5e5e0cc12a03184b08889ad7f_icgraph" alt=""/></div>
<map name="aclassdyno_1_1Formulation_aa882dfc5e5e0cc12a03184b08889ad7f_icgraph" id="aclassdyno_1_1Formulation_aa882dfc5e5e0cc12a03184b08889ad7f_icgraph">
<area shape="rect" title="Get the map used by the formulation." alt="" coords="256,13,433,38"/>
<area shape="rect" href="classdyno_1_1RGBDBackendModule.html#a26b5b762684936e022839599b8895e95" title=" " alt="" coords="5,5,208,45"/>
</map>
</div>

</div>
</div>
<a id="a37aa6f06b484ce9d3fe46312063281e5" name="a37aa6f06b484ce9d3fe46312063281e5"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a37aa6f06b484ce9d3fe46312063281e5">&#9670;&#160;</a></span>objectUpdateContext()</h2>

<div class="memitem">
<div class="memproto">
<div class="memtemplate">
template&lt;typename MAP &gt; </div>
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">virtual void <a class="el" href="classdyno_1_1Formulation.html">dyno::Formulation</a>&lt; MAP &gt;::objectUpdateContext </td>
          <td>(</td>
          <td class="paramtype">const <a class="el" href="classdyno_1_1Formulation.html#a3a8077c836f8dc574c084ed01f69d9c7">ObjectUpdateContextType</a> &amp;&#160;</td>
          <td class="paramname"><em>context</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="structdyno_1_1UpdateObservationResult.html">UpdateObservationResult</a> &amp;&#160;</td>
          <td class="paramname"><em>result</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">gtsam::Values &amp;&#160;</td>
          <td class="paramname"><em>new_values</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">gtsam::NonlinearFactorGraph &amp;&#160;</td>
          <td class="paramname"><em>new_factors</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">protected</span><span class="mlabel">pure virtual</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>Virtual function to be implemented by derived class and indicates that a specific object j and time-step k has been observed and its dynamic points updated in the graph, and associated values/factors should be added. Details on the object to be updated are provied by the context. In general, this is used to add smoothing factors and initial values for object motion/pose. </p>
<p>This function is called when, for a frame k, the object has been seen at least m times and there is at least n points on this object that have new values/factors since the last iteration (as determined by the <a class="el" href="structdyno_1_1UpdateObservationResult.html">UpdateObservationResult</a> from dynamicPointUpdateCallback).</p>
<p>NOTE this function is called independanly for all objects and is triggered after all dynamicPointUpdateCallback's been called.</p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">context</td><td>const ObjectUpdateContextType&amp; context </td></tr>
    <tr><td class="paramname">result</td><td><a class="el" href="structdyno_1_1UpdateObservationResult.html">UpdateObservationResult</a>&amp; </td></tr>
    <tr><td class="paramname">new_values</td><td>gtsam::Values&amp; </td></tr>
    <tr><td class="paramname">new_factors</td><td>gtsam::NonlinearFactorGraph&amp; </td></tr>
  </table>
  </dd>
</dl>

</div>
</div>
<a id="abc91d003af81579a6918973ff7b83ea5" name="abc91d003af81579a6918973ff7b83ea5"></a>
<h2 class="memtitle"><span class="permalink"><a href="#abc91d003af81579a6918973ff7b83ea5">&#9670;&#160;</a></span>setFullyQualifiedName()</h2>

<div class="memitem">
<div class="memproto">
<div class="memtemplate">
template&lt;typename MAP &gt; </div>
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">std::string <a class="el" href="classdyno_1_1Formulation.html">dyno::Formulation</a>&lt; MAP &gt;::setFullyQualifiedName</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">private</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="Formulation-impl_8hpp_source.html#l00656">656</a> of file <a class="el" href="Formulation-impl_8hpp_source.html">Formulation-impl.hpp</a>.</p>
<div class="fragment"><div class="line"><span class="lineno">  656</span>                                                        {</div>
<div class="line"><span class="lineno">  657</span>  <span class="comment">// get the derived name of the formulation</span></div>
<div class="line"><span class="lineno">  658</span>  std::string logger_prefix = this-&gt;<a class="code hl_function" href="classdyno_1_1Formulation.html#aa3902e16e40c4eb8215ddfb4b7a625c5">loggerPrefix</a>();</div>
<div class="line"><span class="lineno">  659</span>  <span class="keyword">const</span> std::string suffix = <a class="code hl_variable" href="classdyno_1_1Formulation.html#a18df73bd68393b6b9860c6c332bd5496">params_</a>.<a class="code hl_variable" href="structdyno_1_1FormulationParams.html#ac3367e0c0d80aec0900a00132becd768">suffix</a>;</div>
<div class="line"><span class="lineno">  660</span> </div>
<div class="line"><span class="lineno">  661</span>  <span class="comment">// add suffix to name if required</span></div>
<div class="line"><span class="lineno">  662</span>  <span class="keywordflow">if</span> (!suffix.empty()) {</div>
<div class="line"><span class="lineno">  663</span>    logger_prefix += (<span class="stringliteral">&quot;_&quot;</span> + suffix);</div>
<div class="line"><span class="lineno">  664</span>  }</div>
<div class="line"><span class="lineno">  665</span>  <a class="code hl_variable" href="classdyno_1_1Formulation.html#a1f64fc4ad8d279acfb5402ba9748087d">fully_qualified_name_</a> = logger_prefix;</div>
<div class="line"><span class="lineno">  666</span>  <span class="keywordflow">return</span> *<a class="code hl_variable" href="classdyno_1_1Formulation.html#a1f64fc4ad8d279acfb5402ba9748087d">fully_qualified_name_</a>;</div>
<div class="line"><span class="lineno">  667</span>}</div>
<div class="ttc" id="aclassdyno_1_1Formulation_html_aa3902e16e40c4eb8215ddfb4b7a625c5"><div class="ttname"><a href="classdyno_1_1Formulation.html#aa3902e16e40c4eb8215ddfb4b7a625c5">dyno::Formulation::loggerPrefix</a></div><div class="ttdeci">virtual std::string loggerPrefix() const =0</div><div class="ttdoc">Defines the base name of this formulation. This name will appear as part of the output logs and may b...</div></div>
<div class="ttc" id="astructdyno_1_1FormulationParams_html_ac3367e0c0d80aec0900a00132becd768"><div class="ttname"><a href="structdyno_1_1FormulationParams.html#ac3367e0c0d80aec0900a00132becd768">dyno::FormulationParams::suffix</a></div><div class="ttdeci">std::string suffix</div><div class="ttdef"><b>Definition:</b> <a href="Formulation_8hpp_source.html#l00120">Formulation.hpp:120</a></div></div>
</div><!-- fragment -->
<p class="reference">Referenced by <a class="el" href="classdyno_1_1Formulation.html#a6b9b3b3a6c14748b57725bee233bcca4">dyno::Formulation&lt; MAP &gt;::getFullyQualifiedName()</a>.</p>
<div class="dynheader">
Here is the caller graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="classdyno_1_1Formulation_abc91d003af81579a6918973ff7b83ea5_icgraph.png" border="0" usemap="#aclassdyno_1_1Formulation_abc91d003af81579a6918973ff7b83ea5_icgraph" alt=""/></div>
<map name="aclassdyno_1_1Formulation_abc91d003af81579a6918973ff7b83ea5_icgraph" id="aclassdyno_1_1Formulation_abc91d003af81579a6918973ff7b83ea5_icgraph">
<area shape="rect" title=" " alt="" coords="224,5,395,45"/>
<area shape="rect" href="classdyno_1_1Formulation.html#a6b9b3b3a6c14748b57725bee233bcca4" title="Get the fully qualified name of this formulation which is derived from the loggerPrefix and optionall..." alt="" coords="5,5,176,45"/>
</map>
</div>

</div>
</div>
<a id="aef00ff0f96ad2253cc394b8905065882" name="aef00ff0f96ad2253cc394b8905065882"></a>
<h2 class="memtitle"><span class="permalink"><a href="#aef00ff0f96ad2253cc394b8905065882">&#9670;&#160;</a></span>setInitialPose()</h2>

<div class="memitem">
<div class="memproto">
<div class="memtemplate">
template&lt;typename MAP &gt; </div>
      <table class="memname">
        <tr>
          <td class="memname">void <a class="el" href="classdyno_1_1Formulation.html">dyno::Formulation</a>&lt; MAP &gt;::setInitialPose </td>
          <td>(</td>
          <td class="paramtype">const gtsam::Pose3 &amp;&#160;</td>
          <td class="paramname"><em>T_world_camera</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="namespacedyno.html#ac4303d6fafb755f794b072d76f9cfb41">FrameId</a>&#160;</td>
          <td class="paramname"><em>frame_id_k</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">gtsam::Values &amp;&#160;</td>
          <td class="paramname"><em>new_values</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Adds a gtsam::Pose3 as a value in the graph at frame k. </p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">T_world_camera</td><td>const gtsam::Pose3&amp; </td></tr>
    <tr><td class="paramname">frame_id_k</td><td>FrameId </td></tr>
    <tr><td class="paramname">new_values</td><td>gtsam::Values&amp; </td></tr>
  </table>
  </dd>
</dl>

<p class="definition">Definition at line <a class="el" href="Formulation-impl_8hpp_source.html#l00084">84</a> of file <a class="el" href="Formulation-impl_8hpp_source.html">Formulation-impl.hpp</a>.</p>
<div class="fragment"><div class="line"><span class="lineno">   86</span>                                                               {</div>
<div class="line"><span class="lineno">   87</span>  new_values.insert(<a class="code hl_function" href="namespacedyno.html#a314d7f58c130d0aa28270309ff7500c5">CameraPoseSymbol</a>(frame_id_k), T_world_camera);</div>
<div class="line"><span class="lineno">   88</span>  <a class="code hl_variable" href="classdyno_1_1Formulation.html#aece87cef780a5692feeffc034e3dbd44">theta_</a>.insert_or_assign(new_values);</div>
<div class="line"><span class="lineno">   89</span>}</div>
</div><!-- fragment -->
<p class="reference">References <a class="el" href="namespacedyno.html#a314d7f58c130d0aa28270309ff7500c5">dyno::CameraPoseSymbol()</a>.</p>
<div class="dynheader">
Here is the call graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="classdyno_1_1Formulation_aef00ff0f96ad2253cc394b8905065882_cgraph.png" border="0" usemap="#aclassdyno_1_1Formulation_aef00ff0f96ad2253cc394b8905065882_cgraph" alt=""/></div>
<map name="aclassdyno_1_1Formulation_aef00ff0f96ad2253cc394b8905065882_cgraph" id="aclassdyno_1_1Formulation_aef00ff0f96ad2253cc394b8905065882_cgraph">
<area shape="rect" title="Adds a gtsam::Pose3 as a value in the graph at frame k." alt="" coords="5,5,153,45"/>
<area shape="rect" href="namespacedyno.html#a314d7f58c130d0aa28270309ff7500c5" title=" " alt="" coords="201,13,395,38"/>
</map>
</div>

</div>
</div>
<a id="a32192676e4fab1dc4d35045373c155a3" name="a32192676e4fab1dc4d35045373c155a3"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a32192676e4fab1dc4d35045373c155a3">&#9670;&#160;</a></span>setInitialPosePrior()</h2>

<div class="memitem">
<div class="memproto">
<div class="memtemplate">
template&lt;typename MAP &gt; </div>
      <table class="memname">
        <tr>
          <td class="memname">void <a class="el" href="classdyno_1_1Formulation.html">dyno::Formulation</a>&lt; MAP &gt;::setInitialPosePrior </td>
          <td>(</td>
          <td class="paramtype">const gtsam::Pose3 &amp;&#160;</td>
          <td class="paramname"><em>T_world_camera</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="namespacedyno.html#ac4303d6fafb755f794b072d76f9cfb41">FrameId</a>&#160;</td>
          <td class="paramname"><em>frame_id_k</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">gtsam::NonlinearFactorGraph &amp;&#160;</td>
          <td class="paramname"><em>new_factors</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Adds a pose prior on a value in the graph at frame k using the given pose value as the prior's mean. </p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">T_world_camera</td><td>const gtsam::Pose3&amp; </td></tr>
    <tr><td class="paramname">frame_id_k</td><td>FrameId </td></tr>
    <tr><td class="paramname">new_factors</td><td>gtsam::NonlinearFactorGraph&amp; </td></tr>
  </table>
  </dd>
</dl>

<p class="definition">Definition at line <a class="el" href="Formulation-impl_8hpp_source.html#l00092">92</a> of file <a class="el" href="Formulation-impl_8hpp_source.html">Formulation-impl.hpp</a>.</p>
<div class="fragment"><div class="line"><span class="lineno">   94</span>                                            {</div>
<div class="line"><span class="lineno">   95</span>  <span class="keyword">auto</span> initial_pose_prior = <a class="code hl_variable" href="classdyno_1_1Formulation.html#a0e9e95a8f33f2da1fe8f7123feecf81c">noise_models_</a>.<a class="code hl_variable" href="structdyno_1_1NoiseModels.html#a8c1059db7ca3353919cd1789b1891c54">initial_pose_prior</a>;</div>
<div class="line"><span class="lineno">   96</span> </div>
<div class="line"><span class="lineno">   97</span>  <span class="comment">// keep track of the new factors added in this function</span></div>
<div class="line"><span class="lineno">   98</span>  <span class="comment">// these are then appended to the internal factors_ and new_factors</span></div>
<div class="line"><span class="lineno">   99</span>  gtsam::NonlinearFactorGraph internal_new_factors;</div>
<div class="line"><span class="lineno">  100</span>  internal_new_factors.addPrior(<a class="code hl_function" href="namespacedyno.html#a314d7f58c130d0aa28270309ff7500c5">CameraPoseSymbol</a>(frame_id_k), T_world_camera,</div>
<div class="line"><span class="lineno">  101</span>                                initial_pose_prior);</div>
<div class="line"><span class="lineno">  102</span>  new_factors += internal_new_factors;</div>
<div class="line"><span class="lineno">  103</span>  <a class="code hl_variable" href="classdyno_1_1Formulation.html#aabc461bd6dfa004c931e99356477104e">factors_</a> += internal_new_factors;</div>
<div class="line"><span class="lineno">  104</span>}</div>
<div class="ttc" id="astructdyno_1_1NoiseModels_html_a8c1059db7ca3353919cd1789b1891c54"><div class="ttname"><a href="structdyno_1_1NoiseModels.html#a8c1059db7ca3353919cd1789b1891c54">dyno::NoiseModels::initial_pose_prior</a></div><div class="ttdeci">gtsam::SharedNoiseModel initial_pose_prior</div><div class="ttdef"><b>Definition:</b> <a href="BackendDefinitions_8hpp_source.html#l00097">BackendDefinitions.hpp:97</a></div></div>
</div><!-- fragment -->
<p class="reference">References <a class="el" href="namespacedyno.html#a314d7f58c130d0aa28270309ff7500c5">dyno::CameraPoseSymbol()</a>.</p>
<div class="dynheader">
Here is the call graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="classdyno_1_1Formulation_a32192676e4fab1dc4d35045373c155a3_cgraph.png" border="0" usemap="#aclassdyno_1_1Formulation_a32192676e4fab1dc4d35045373c155a3_cgraph" alt=""/></div>
<map name="aclassdyno_1_1Formulation_a32192676e4fab1dc4d35045373c155a3_cgraph" id="aclassdyno_1_1Formulation_a32192676e4fab1dc4d35045373c155a3_cgraph">
<area shape="rect" title="Adds a pose prior on a value in the graph at frame k using the given pose value as the prior&#39;s mean." alt="" coords="5,5,153,45"/>
<area shape="rect" href="namespacedyno.html#a314d7f58c130d0aa28270309ff7500c5" title=" " alt="" coords="201,13,395,38"/>
</map>
</div>

</div>
</div>
<a id="a87be187fbe18eee7b20ace93327ba4b8" name="a87be187fbe18eee7b20ace93327ba4b8"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a87be187fbe18eee7b20ace93327ba4b8">&#9670;&#160;</a></span>setTheta()</h2>

<div class="memitem">
<div class="memproto">
<div class="memtemplate">
template&lt;typename MAP &gt; </div>
      <table class="memname">
        <tr>
          <td class="memname">void <a class="el" href="classdyno_1_1Formulation.html">dyno::Formulation</a>&lt; MAP &gt;::setTheta </td>
          <td>(</td>
          <td class="paramtype">const gtsam::Values &amp;&#160;</td>
          <td class="paramname"><em>linearization</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Sets the full set of theta values (overrides them). This is used after external optimisation to update the values for the accessor which has a internal reference (pointer) to theta. </p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">linearization</td><td>const gtsam::Values&amp; </td></tr>
  </table>
  </dd>
</dl>

<p class="definition">Definition at line <a class="el" href="Formulation-impl_8hpp_source.html#l00047">47</a> of file <a class="el" href="Formulation-impl_8hpp_source.html">Formulation-impl.hpp</a>.</p>
<div class="fragment"><div class="line"><span class="lineno">   47</span>                                                                {</div>
<div class="line"><span class="lineno">   48</span>  <a class="code hl_variable" href="classdyno_1_1Formulation.html#aece87cef780a5692feeffc034e3dbd44">theta_</a> = linearization;</div>
<div class="line"><span class="lineno">   49</span>  <span class="comment">// TODO: comment backed in!!</span></div>
<div class="line"><span class="lineno">   50</span>  <span class="comment">//  accessorFromTheta()-&gt;postUpdateCallback();</span></div>
<div class="line"><span class="lineno">   51</span>}</div>
</div><!-- fragment -->
</div>
</div>
<a id="ad78d57e7de23e30b9aa287a3939bb3a9" name="ad78d57e7de23e30b9aa287a3939bb3a9"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ad78d57e7de23e30b9aa287a3939bb3a9">&#9670;&#160;</a></span>updateDynamicObservations() <span class="overload">[1/2]</span></h2>

<div class="memitem">
<div class="memproto">
<div class="memtemplate">
template&lt;typename MAP &gt; </div>
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="structdyno_1_1UpdateObservationResult.html">UpdateObservationResult</a> <a class="el" href="classdyno_1_1Formulation.html">dyno::Formulation</a>&lt; MAP &gt;::updateDynamicObservations </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="namespacedyno.html#ac4303d6fafb755f794b072d76f9cfb41">FrameId</a>&#160;</td>
          <td class="paramname"><em>frame_id_k</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">gtsam::Values &amp;&#160;</td>
          <td class="paramname"><em>new_values</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">gtsam::NonlinearFactorGraph &amp;&#160;</td>
          <td class="paramname"><em>new_factors</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const <a class="el" href="structdyno_1_1UpdateObservationParams.html">UpdateObservationParams</a> &amp;&#160;</td>
          <td class="paramname"><em>update_params</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Updates the dyanmic-point part of the factor graph for frame k. This contains all the big-boi bookeeping logic to update the factor graph with dyanmic points and objects. This is where the virtual dynamicPointUpdateCallback and objectUpdateContext functions are called. </p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">frame_id_k</td><td></td></tr>
    <tr><td class="paramname">new_values</td><td></td></tr>
    <tr><td class="paramname">new_factors</td><td></td></tr>
    <tr><td class="paramname">update_params</td><td></td></tr>
  </table>
  </dd>
</dl>
<dl class="section return"><dt>Returns</dt><dd><a class="el" href="structdyno_1_1UpdateObservationResult.html">UpdateObservationResult</a> </dd></dl>
<p>At least three points on the object are required to solve otherise the system is indeterminate</p>

<p class="definition">Definition at line <a class="el" href="Formulation-impl_8hpp_source.html#l00308">308</a> of file <a class="el" href="Formulation-impl_8hpp_source.html">Formulation-impl.hpp</a>.</p>
<div class="fragment"><div class="line"><span class="lineno">  311</span>                                                  {</div>
<div class="line"><span class="lineno">  312</span>  <span class="keyword">typename</span> Map::Ptr <a class="code hl_function" href="classdyno_1_1Formulation.html#aa882dfc5e5e0cc12a03184b08889ad7f">map</a> = this-&gt;<a class="code hl_function" href="classdyno_1_1Formulation.html#aa882dfc5e5e0cc12a03184b08889ad7f">map</a>();</div>
<div class="line"><span class="lineno">  313</span>  <span class="keyword">auto</span> accessor = this-&gt;<a class="code hl_function" href="classdyno_1_1Formulation.html#a536dbcbdd6fcd6598fcedb7866cec1de">accessorFromTheta</a>();</div>
<div class="line"><span class="lineno">  314</span>  <span class="comment">// collect noise models to be used</span></div>
<div class="line"><span class="lineno">  315</span>  <span class="keyword">auto</span> landmark_motion_noise = <a class="code hl_variable" href="classdyno_1_1Formulation.html#a0e9e95a8f33f2da1fe8f7123feecf81c">noise_models_</a>.<a class="code hl_variable" href="structdyno_1_1NoiseModels.html#a83368aae44c18d90239c00dcf557729a">landmark_motion_noise</a>;</div>
<div class="line"><span class="lineno">  316</span>  <span class="keyword">auto</span> dynamic_point_noise = <a class="code hl_variable" href="classdyno_1_1Formulation.html#a0e9e95a8f33f2da1fe8f7123feecf81c">noise_models_</a>.<a class="code hl_variable" href="structdyno_1_1NoiseModels.html#aa0ba01119cae77c87c562c119497c8d0">dynamic_point_noise</a>;</div>
<div class="line"><span class="lineno">  317</span>  <span class="comment">// keep track of the new factors added in this function</span></div>
<div class="line"><span class="lineno">  318</span>  <span class="comment">// these are then appended to the internal factors_ and new_factors</span></div>
<div class="line"><span class="lineno">  319</span>  gtsam::NonlinearFactorGraph internal_new_factors;</div>
<div class="line"><span class="lineno">  320</span> </div>
<div class="line"><span class="lineno">  321</span>  UpdateObservationResult result;</div>
<div class="line"><span class="lineno">  322</span>  <span class="keywordflow">if</span> (update_params.enable_debug_info) {</div>
<div class="line"><span class="lineno">  323</span>    result.debug_info = DebugInfo();</div>
<div class="line"><span class="lineno">  324</span>  }</div>
<div class="line"><span class="lineno">  325</span> </div>
<div class="line"><span class="lineno">  328</span>  <span class="keyword">constexpr</span> <span class="keyword">static</span> <span class="keywordtype">size_t</span> kMinNumberPoints = 3u;</div>
<div class="line"><span class="lineno">  329</span> </div>
<div class="line"><span class="lineno">  330</span>  <span class="keyword">const</span> <a class="code hl_typedef" href="namespacedyno.html#ac4303d6fafb755f794b072d76f9cfb41">FrameId</a> frame_id_k_1 = frame_id_k - 1u;</div>
<div class="line"><span class="lineno">  331</span>  VLOG(20) &lt;&lt; <span class="stringliteral">&quot;Add dynamic observations between frames &quot;</span> &lt;&lt; frame_id_k_1</div>
<div class="line"><span class="lineno">  332</span>           &lt;&lt; <span class="stringliteral">&quot; and &quot;</span> &lt;&lt; frame_id_k;</div>
<div class="line"><span class="lineno">  333</span>  <span class="keyword">const</span> <span class="keyword">auto</span> frame_node_k = <a class="code hl_function" href="classdyno_1_1Formulation.html#aa882dfc5e5e0cc12a03184b08889ad7f">map</a>-&gt;getFrame(frame_id_k);</div>
<div class="line"><span class="lineno">  334</span>  <span class="keyword">const</span> <span class="keyword">auto</span> frame_node_k_1 = <a class="code hl_function" href="classdyno_1_1Formulation.html#aa882dfc5e5e0cc12a03184b08889ad7f">map</a>-&gt;getFrame(frame_id_k_1);</div>
<div class="line"><span class="lineno">  335</span>  CHECK_NOTNULL(frame_node_k_1);</div>
<div class="line"><span class="lineno">  336</span> </div>
<div class="line"><span class="lineno">  337</span>  <span class="comment">// pose estimate from frontend</span></div>
<div class="line"><span class="lineno">  338</span>  <span class="comment">// CHECK(parent_-&gt;initial_camera_poses_.exists(frame_id_k));</span></div>
<div class="line"><span class="lineno">  339</span>  <span class="comment">// const gtsam::Pose3&amp; T_world_camera_initial_k =</span></div>
<div class="line"><span class="lineno">  340</span>  <span class="comment">// new_values.at&lt;gtsam::Pose3&gt;(CameraPoseSymbol(frame_id_k));</span></div>
<div class="line"><span class="lineno">  341</span> </div>
<div class="line"><span class="lineno">  342</span>  utils::TimingStatsCollector dyn_obj_itr_timer(this-&gt;<a class="code hl_function" href="classdyno_1_1Formulation.html#aa3902e16e40c4eb8215ddfb4b7a625c5">loggerPrefix</a>() +</div>
<div class="line"><span class="lineno">  343</span>                                                <span class="stringliteral">&quot;.dynamic_object_itr&quot;</span>);</div>
<div class="line"><span class="lineno">  344</span>  <span class="keywordflow">for</span> (<span class="keyword">const</span> <span class="keyword">auto</span>&amp; object_node : frame_node_k-&gt;objects_seen) {</div>
<div class="line"><span class="lineno">  345</span>    DebugInfo::ObjectInfo object_debug_info;</div>
<div class="line"><span class="lineno">  346</span>    <span class="keyword">const</span> <a class="code hl_typedef" href="namespacedyno.html#a38bb86e4154b86428b8d133be03fb2b5">ObjectId</a> object_id = object_node-&gt;getId();</div>
<div class="line"><span class="lineno">  347</span> </div>
<div class="line"><span class="lineno">  348</span>    <span class="comment">// first check that object exists in the previous frame</span></div>
<div class="line"><span class="lineno">  349</span>    <span class="keywordflow">if</span> (!frame_node_k-&gt;objectMotionExpected(object_id)) {</div>
<div class="line"><span class="lineno">  350</span>      <span class="keywordflow">continue</span>;</div>
<div class="line"><span class="lineno">  351</span>    }</div>
<div class="line"><span class="lineno">  352</span>    <span class="comment">// possibly the longest call?</span></div>
<div class="line"><span class="lineno">  353</span>    <span class="comment">// landmarks on this object seen at frame k</span></div>
<div class="line"><span class="lineno">  354</span>    <span class="keyword">auto</span> seen_lmks_k = object_node-&gt;getLandmarksSeenAtFrame(frame_id_k);</div>
<div class="line"><span class="lineno">  355</span> </div>
<div class="line"><span class="lineno">  356</span>    <span class="comment">// if we dont have at least N observations of this object in this frame AND</span></div>
<div class="line"><span class="lineno">  357</span>    <span class="comment">// the previous frame</span></div>
<div class="line"><span class="lineno">  358</span>    <span class="keywordflow">if</span> (seen_lmks_k.size() &lt; kMinNumberPoints ||</div>
<div class="line"><span class="lineno">  359</span>        object_node-&gt;getLandmarksSeenAtFrame(frame_id_k_1).size() &lt;</div>
<div class="line"><span class="lineno">  360</span>            kMinNumberPoints) {</div>
<div class="line"><span class="lineno">  361</span>      <span class="keywordflow">continue</span>;</div>
<div class="line"><span class="lineno">  362</span>    }</div>
<div class="line"><span class="lineno">  363</span> </div>
<div class="line"><span class="lineno">  364</span>    utils::TimingStatsCollector dyn_point_itr_timer(this-&gt;<a class="code hl_function" href="classdyno_1_1Formulation.html#aa3902e16e40c4eb8215ddfb4b7a625c5">loggerPrefix</a>() +</div>
<div class="line"><span class="lineno">  365</span>                                                    <span class="stringliteral">&quot;.dynamic_point_itr&quot;</span>);</div>
<div class="line"><span class="lineno">  366</span>    VLOG(10) &lt;&lt; <span class="stringliteral">&quot;Seen lmks at frame &quot;</span> &lt;&lt; frame_id_k &lt;&lt; <span class="stringliteral">&quot; obj &quot;</span> &lt;&lt; object_id</div>
<div class="line"><span class="lineno">  367</span>             &lt;&lt; <span class="stringliteral">&quot;: &quot;</span> &lt;&lt; seen_lmks_k.size();</div>
<div class="line"><span class="lineno">  368</span>    <span class="comment">// iterate over each lmk we have on this object</span></div>
<div class="line"><span class="lineno">  369</span>    <span class="keywordflow">for</span> (<span class="keyword">const</span> <span class="keyword">auto</span>&amp; obj_lmk_node : seen_lmks_k) {</div>
<div class="line"><span class="lineno">  370</span>      CHECK_EQ(obj_lmk_node-&gt;getObjectId(), object_id);</div>
<div class="line"><span class="lineno">  371</span> </div>
<div class="line"><span class="lineno">  372</span>      <span class="comment">// see if we have enough observations to add this lmk</span></div>
<div class="line"><span class="lineno">  373</span>      <span class="keywordflow">if</span> (obj_lmk_node-&gt;numObservations() &lt; <a class="code hl_variable" href="classdyno_1_1Formulation.html#a18df73bd68393b6b9860c6c332bd5496">params_</a>.<a class="code hl_variable" href="structdyno_1_1FormulationParams.html#a49d144a77a2a729d6bde2831e13dd6ba">min_dynamic_observations</a>) {</div>
<div class="line"><span class="lineno">  374</span>        <span class="keywordflow">continue</span>;</div>
<div class="line"><span class="lineno">  375</span>      }</div>
<div class="line"><span class="lineno">  376</span> </div>
<div class="line"><span class="lineno">  377</span>      <a class="code hl_typedef" href="namespacedyno.html#afdd174eb44901fb205371d796287378c">TrackletId</a> tracklet_id = obj_lmk_node-&gt;getId();</div>
<div class="line"><span class="lineno">  378</span> </div>
<div class="line"><span class="lineno">  379</span>      <span class="comment">// if does not exist, we need to go back and all the previous measurements</span></div>
<div class="line"><span class="lineno">  380</span>      <span class="comment">// &amp; factors &amp; motions</span></div>
<div class="line"><span class="lineno">  381</span>      <span class="keywordflow">if</span> (!<a class="code hl_function" href="classdyno_1_1Formulation.html#a7cbe87537d35b8d21463d402342ef356">isDynamicTrackletInMap</a>(obj_lmk_node)) {</div>
<div class="line"><span class="lineno">  382</span>        <span class="comment">// add the points/motions from the past</span></div>
<div class="line"><span class="lineno">  383</span>        <span class="keyword">auto</span> seen_frames = obj_lmk_node-&gt;getSeenFrames();</div>
<div class="line"><span class="lineno">  384</span>        <span class="comment">// assert frame observations are continuous?</span></div>
<div class="line"><span class="lineno">  385</span> </div>
<div class="line"><span class="lineno">  386</span>        <span class="comment">// start at the first frame we want to start adding points in as we know</span></div>
<div class="line"><span class="lineno">  387</span>        <span class="comment">// have seen them enough times start from +1, becuase the motion index</span></div>
<div class="line"><span class="lineno">  388</span>        <span class="comment">// is k-1 to k and there is no motion k-2 to k-1 but the first poitns we</span></div>
<div class="line"><span class="lineno">  389</span>        <span class="comment">// want to add are at k-1</span></div>
<div class="line"><span class="lineno">  390</span>        <a class="code hl_typedef" href="namespacedyno.html#ac4303d6fafb755f794b072d76f9cfb41">FrameId</a> starting_motion_frame;</div>
<div class="line"><span class="lineno">  391</span>        <span class="keywordflow">if</span> (update_params.do_backtrack) {</div>
<div class="line"><span class="lineno">  392</span>          starting_motion_frame =</div>
<div class="line"><span class="lineno">  393</span>              seen_frames.template getFirstIndex&lt;FrameId&gt;() +</div>
<div class="line"><span class="lineno">  394</span>              1u;  <span class="comment">// as we index the motion from k</span></div>
<div class="line"><span class="lineno">  395</span>        } <span class="keywordflow">else</span> {</div>
<div class="line"><span class="lineno">  396</span>          <span class="comment">// start from the requested index, this will still mean that we will</span></div>
<div class="line"><span class="lineno">  397</span>          <span class="comment">// add the previous frame as always add a motion between k-1 and k</span></div>
<div class="line"><span class="lineno">  398</span>          starting_motion_frame = frame_id_k;</div>
<div class="line"><span class="lineno">  399</span> </div>
<div class="line"><span class="lineno">  400</span>          <span class="keywordflow">if</span> (starting_motion_frame &lt;</div>
<div class="line"><span class="lineno">  401</span>              seen_frames.template getFirstIndex&lt;FrameId&gt;() + 1u) {</div>
<div class="line"><span class="lineno">  402</span>            <span class="comment">// if the requested starting frame is not the first frame + 1u of</span></div>
<div class="line"><span class="lineno">  403</span>            <span class="comment">// the actul track (ie. the second seen frame) we cannot use it yet</span></div>
<div class="line"><span class="lineno">  404</span>            <span class="comment">// as we have to index BACKWARDS from the starting motion frame if</span></div>
<div class="line"><span class="lineno">  405</span>            <span class="comment">// we used frame_id_k as the starting_motion_frame, we would end up</span></div>
<div class="line"><span class="lineno">  406</span>            <span class="comment">// with an iterator pointing to the end instead, we will have to get</span></div>
<div class="line"><span class="lineno">  407</span>            <span class="comment">// it next frame!!!</span></div>
<div class="line"><span class="lineno">  408</span>            <span class="keywordflow">continue</span>;</div>
<div class="line"><span class="lineno">  409</span>          }</div>
<div class="line"><span class="lineno">  410</span>        }</div>
<div class="line"><span class="lineno">  411</span> </div>
<div class="line"><span class="lineno">  412</span>        <span class="keyword">auto</span> starting_motion_frame_itr =</div>
<div class="line"><span class="lineno">  413</span>            seen_frames.find(starting_motion_frame);</div>
<div class="line"><span class="lineno">  414</span>        CHECK(starting_motion_frame_itr != seen_frames.end())</div>
<div class="line"><span class="lineno">  415</span>            &lt;&lt; <span class="stringliteral">&quot;Starting motion frame is &quot;</span> &lt;&lt; starting_motion_frame</div>
<div class="line"><span class="lineno">  416</span>            &lt;&lt; <span class="stringliteral">&quot; but first frame is &quot;</span></div>
<div class="line"><span class="lineno">  417</span>            &lt;&lt; seen_frames.template getFirstIndex&lt;FrameId&gt;();</div>
<div class="line"><span class="lineno">  418</span> </div>
<div class="line"><span class="lineno">  419</span>        std::stringstream ss;</div>
<div class="line"><span class="lineno">  420</span>        ss &lt;&lt; <span class="stringliteral">&quot;Going back to add point on object &quot;</span> &lt;&lt; object_id</div>
<div class="line"><span class="lineno">  421</span>           &lt;&lt; <span class="stringliteral">&quot; at frames\n&quot;</span>;</div>
<div class="line"><span class="lineno">  422</span> </div>
<div class="line"><span class="lineno">  423</span>        <span class="comment">// iterate over k-N to k (inclusive) and all all</span></div>
<div class="line"><span class="lineno">  424</span>        utils::TimingStatsCollector dyn_point_backtrack_timer(</div>
<div class="line"><span class="lineno">  425</span>            this-&gt;<a class="code hl_function" href="classdyno_1_1Formulation.html#aa3902e16e40c4eb8215ddfb4b7a625c5">loggerPrefix</a>() + <span class="stringliteral">&quot;.dynamic_point_backtrack&quot;</span>);</div>
<div class="line"><span class="lineno">  426</span>        <span class="keywordflow">for</span> (<span class="keyword">auto</span> seen_frames_itr = starting_motion_frame_itr;</div>
<div class="line"><span class="lineno">  427</span>             seen_frames_itr != seen_frames.end(); seen_frames_itr++) {</div>
<div class="line"><span class="lineno">  428</span>          <span class="keyword">auto</span> seen_frames_itr_prev = seen_frames_itr;</div>
<div class="line"><span class="lineno">  429</span>          std::advance(seen_frames_itr_prev, -1);</div>
<div class="line"><span class="lineno">  430</span>          CHECK(seen_frames_itr_prev != seen_frames.end())</div>
<div class="line"><span class="lineno">  431</span>              &lt;&lt; <span class="stringliteral">&quot; For object  &quot;</span> &lt;&lt; object_id;</div>
<div class="line"><span class="lineno">  432</span> </div>
<div class="line"><span class="lineno">  433</span>          <span class="keyword">auto</span> query_frame_node_k = *seen_frames_itr;</div>
<div class="line"><span class="lineno">  434</span>          <span class="keyword">auto</span> query_frame_node_k_1 = *seen_frames_itr_prev;</div>
<div class="line"><span class="lineno">  435</span> </div>
<div class="line"><span class="lineno">  436</span>          CHECK_EQ(query_frame_node_k-&gt;frame_id,</div>
<div class="line"><span class="lineno">  437</span>                   query_frame_node_k_1-&gt;frame_id + 1u);</div>
<div class="line"><span class="lineno">  438</span> </div>
<div class="line"><span class="lineno">  439</span>          <span class="comment">// add points UP TO AND INCLUDING the current frame</span></div>
<div class="line"><span class="lineno">  440</span>          <span class="keywordflow">if</span> (query_frame_node_k-&gt;frame_id &gt; frame_id_k) {</div>
<div class="line"><span class="lineno">  441</span>            <span class="keywordflow">break</span>;</div>
<div class="line"><span class="lineno">  442</span>          }</div>
<div class="line"><span class="lineno">  443</span> </div>
<div class="line"><span class="lineno">  444</span>          <span class="comment">// point needs to be be in k and k-1 -&gt; we have validated the object</span></div>
<div class="line"><span class="lineno">  445</span>          <span class="comment">// exists in these two frames but not the points</span></div>
<div class="line"><span class="lineno">  446</span>          CHECK(obj_lmk_node-&gt;seenAtFrame(query_frame_node_k-&gt;frame_id));</div>
<div class="line"><span class="lineno">  447</span>          <span class="keywordflow">if</span> (!obj_lmk_node-&gt;seenAtFrame(query_frame_node_k_1-&gt;frame_id)) {</div>
<div class="line"><span class="lineno">  448</span>            LOG(WARNING) &lt;&lt; <span class="stringliteral">&quot;Tracklet &quot;</span> &lt;&lt; tracklet_id &lt;&lt; <span class="stringliteral">&quot; on object &quot;</span></div>
<div class="line"><span class="lineno">  449</span>                         &lt;&lt; object_id &lt;&lt; <span class="stringliteral">&quot; seen at &quot;</span></div>
<div class="line"><span class="lineno">  450</span>                         &lt;&lt; query_frame_node_k-&gt;frame_id &lt;&lt; <span class="stringliteral">&quot; but not &quot;</span></div>
<div class="line"><span class="lineno">  451</span>                         &lt;&lt; query_frame_node_k_1-&gt;frame_id;</div>
<div class="line"><span class="lineno">  452</span>            <span class="keywordflow">break</span>;</div>
<div class="line"><span class="lineno">  453</span>          }  <span class="comment">// this miay mean this this point never gets added?</span></div>
<div class="line"><span class="lineno">  454</span> </div>
<div class="line"><span class="lineno">  455</span>          ss &lt;&lt; query_frame_node_k_1-&gt;frame_id &lt;&lt; <span class="stringliteral">&quot; &quot;</span></div>
<div class="line"><span class="lineno">  456</span>             &lt;&lt; query_frame_node_k-&gt;frame_id &lt;&lt; <span class="stringliteral">&quot;\n&quot;</span>;</div>
<div class="line"><span class="lineno">  457</span> </div>
<div class="line"><span class="lineno">  458</span>          <span class="comment">// this should DEFINITELY be in the map, as long as we update the</span></div>
<div class="line"><span class="lineno">  459</span>          <span class="comment">// values in the map everyy time</span></div>
<div class="line"><span class="lineno">  460</span>          StateQuery&lt;gtsam::Pose3&gt; T_world_camera_k_1_query =</div>
<div class="line"><span class="lineno">  461</span>              accessor-&gt;getSensorPose(query_frame_node_k_1-&gt;frame_id);</div>
<div class="line"><span class="lineno">  462</span>          CHECK(T_world_camera_k_1_query)</div>
<div class="line"><span class="lineno">  463</span>              &lt;&lt; <span class="stringliteral">&quot;Failed cam pose query at frame &quot;</span></div>
<div class="line"><span class="lineno">  464</span>              &lt;&lt; query_frame_node_k_1-&gt;frame_id</div>
<div class="line"><span class="lineno">  465</span>              &lt;&lt; <span class="stringliteral">&quot;. This may happen if the map_ is not updated every iteration &quot;</span></div>
<div class="line"><span class="lineno">  466</span>                 <span class="stringliteral">&quot;OR something is wrong with the tracking...&quot;</span>;</div>
<div class="line"><span class="lineno">  467</span>          <span class="keyword">const</span> gtsam::Pose3 T_world_camera_k_1 =</div>
<div class="line"><span class="lineno">  468</span>              T_world_camera_k_1_query.get();</div>
<div class="line"><span class="lineno">  469</span> </div>
<div class="line"><span class="lineno">  470</span>          gtsam::Pose3 T_world_camera_k =</div>
<div class="line"><span class="lineno">  471</span>              <a class="code hl_function" href="classdyno_1_1Formulation.html#a3369b4fa4dd649495e5bace0e9b715d9">getInitialOrLinearizedSensorPose</a>(query_frame_node_k_1-&gt;frame_id);</div>
<div class="line"><span class="lineno">  472</span> </div>
<div class="line"><span class="lineno">  473</span>          <a class="code hl_typedef" href="classdyno_1_1Formulation.html#a9a172e526e325ba2bdfef03640ef1802">PointUpdateContextType</a> point_context;</div>
<div class="line"><span class="lineno">  474</span>          point_context.lmk_node = obj_lmk_node;</div>
<div class="line"><span class="lineno">  475</span>          point_context.frame_node_k_1 = query_frame_node_k_1;</div>
<div class="line"><span class="lineno">  476</span>          point_context.frame_node_k = query_frame_node_k;</div>
<div class="line"><span class="lineno">  477</span>          point_context.X_k_measured = T_world_camera_k;</div>
<div class="line"><span class="lineno">  478</span>          point_context.X_k_1_measured = T_world_camera_k_1;</div>
<div class="line"><span class="lineno">  479</span> </div>
<div class="line"><span class="lineno">  480</span>          <span class="comment">// this assumes we add all the points in order and have continuous</span></div>
<div class="line"><span class="lineno">  481</span>          <span class="comment">// frames (which we should have?)</span></div>
<div class="line"><span class="lineno">  482</span>          <span class="keywordflow">if</span> (seen_frames_itr == starting_motion_frame_itr) {</div>
<div class="line"><span class="lineno">  483</span>            point_context.is_starting_motion_frame = <span class="keyword">true</span>;</div>
<div class="line"><span class="lineno">  484</span>          }</div>
<div class="line"><span class="lineno">  485</span>          utils::TimingStatsCollector dyn_point_update_timer(</div>
<div class="line"><span class="lineno">  486</span>              this-&gt;<a class="code hl_function" href="classdyno_1_1Formulation.html#aa3902e16e40c4eb8215ddfb4b7a625c5">loggerPrefix</a>() + <span class="stringliteral">&quot;.dyn_point_update_1&quot;</span>);</div>
<div class="line"><span class="lineno">  487</span>          <span class="comment">// the true set of values that are added from the update</span></div>
<div class="line"><span class="lineno">  488</span>          gtsam::Values local_new_values;</div>
<div class="line"><span class="lineno">  489</span>          <a class="code hl_function" href="classdyno_1_1Formulation.html#af93533f32a88133a492b5e3ed790267f">dynamicPointUpdateCallback</a>(point_context, result, local_new_values,</div>
<div class="line"><span class="lineno">  490</span>                                     internal_new_factors);</div>
<div class="line"><span class="lineno">  491</span>          <span class="comment">// update internal theta and factors</span></div>
<div class="line"><span class="lineno">  492</span>          <a class="code hl_variable" href="classdyno_1_1Formulation.html#aece87cef780a5692feeffc034e3dbd44">theta_</a>.insert(local_new_values);</div>
<div class="line"><span class="lineno">  493</span>          <span class="comment">// add to the external new_values</span></div>
<div class="line"><span class="lineno">  494</span>          new_values.insert(local_new_values);</div>
<div class="line"><span class="lineno">  495</span>        }</div>
<div class="line"><span class="lineno">  496</span>      } <span class="keywordflow">else</span> {</div>
<div class="line"><span class="lineno">  497</span>        <span class="comment">// these tracklets should already be in the graph so we should only need</span></div>
<div class="line"><span class="lineno">  498</span>        <span class="comment">// to add the new measurements from this frame check that we have</span></div>
<div class="line"><span class="lineno">  499</span>        <span class="comment">// previous point for this frame</span></div>
<div class="line"><span class="lineno">  500</span>        <a class="code hl_typedef" href="classdyno_1_1Formulation.html#a9a172e526e325ba2bdfef03640ef1802">PointUpdateContextType</a> point_context;</div>
<div class="line"><span class="lineno">  501</span>        point_context.lmk_node = obj_lmk_node;</div>
<div class="line"><span class="lineno">  502</span>        point_context.frame_node_k_1 = frame_node_k_1;</div>
<div class="line"><span class="lineno">  503</span>        point_context.frame_node_k = frame_node_k;</div>
<div class="line"><span class="lineno">  504</span>        point_context.X_k_1_measured =</div>
<div class="line"><span class="lineno">  505</span>            <a class="code hl_function" href="classdyno_1_1Formulation.html#a3369b4fa4dd649495e5bace0e9b715d9">getInitialOrLinearizedSensorPose</a>(frame_node_k_1-&gt;frame_id);</div>
<div class="line"><span class="lineno">  506</span>        point_context.X_k_measured =</div>
<div class="line"><span class="lineno">  507</span>            <a class="code hl_function" href="classdyno_1_1Formulation.html#a3369b4fa4dd649495e5bace0e9b715d9">getInitialOrLinearizedSensorPose</a>(frame_node_k-&gt;frame_id);</div>
<div class="line"><span class="lineno">  508</span>        point_context.is_starting_motion_frame = <span class="keyword">false</span>;</div>
<div class="line"><span class="lineno">  509</span>        utils::TimingStatsCollector dyn_point_update_timer(</div>
<div class="line"><span class="lineno">  510</span>            this-&gt;<a class="code hl_function" href="classdyno_1_1Formulation.html#aa3902e16e40c4eb8215ddfb4b7a625c5">loggerPrefix</a>() + <span class="stringliteral">&quot;.dyn_point_update_2&quot;</span>);</div>
<div class="line"><span class="lineno">  511</span>        <span class="comment">// the true set of values that are added from the update</span></div>
<div class="line"><span class="lineno">  512</span>        gtsam::Values local_new_values;</div>
<div class="line"><span class="lineno">  513</span>        <a class="code hl_function" href="classdyno_1_1Formulation.html#af93533f32a88133a492b5e3ed790267f">dynamicPointUpdateCallback</a>(point_context, result, local_new_values,</div>
<div class="line"><span class="lineno">  514</span>                                   internal_new_factors);</div>
<div class="line"><span class="lineno">  515</span>        <span class="comment">// update internal theta and factors</span></div>
<div class="line"><span class="lineno">  516</span>        <a class="code hl_variable" href="classdyno_1_1Formulation.html#aece87cef780a5692feeffc034e3dbd44">theta_</a>.insert(local_new_values);</div>
<div class="line"><span class="lineno">  517</span>        <span class="comment">// add to the external new_values</span></div>
<div class="line"><span class="lineno">  518</span>        new_values.insert(local_new_values);</div>
<div class="line"><span class="lineno">  519</span>      }</div>
<div class="line"><span class="lineno">  520</span>    }</div>
<div class="line"><span class="lineno">  521</span>  }</div>
<div class="line"><span class="lineno">  522</span>  <span class="comment">// iterate over objects for which a motion was added</span></div>
<div class="line"><span class="lineno">  523</span>  <span class="comment">// becuase we add lots of new points every frame, we may go over the same</span></div>
<div class="line"><span class="lineno">  524</span>  <span class="comment">// object many times to account for backtracking over new points over this</span></div>
<div class="line"><span class="lineno">  525</span>  <span class="comment">// object this is a bit inefficient as we do this iteration even if no new</span></div>
<div class="line"><span class="lineno">  526</span>  <span class="comment">// object values are added becuuse we dont know if the affected frames are</span></div>
<div class="line"><span class="lineno">  527</span>  <span class="comment">// becuase of old points as well as new points</span></div>
<div class="line"><span class="lineno">  528</span>  <span class="comment">//  utils::TimingStatsCollector dyn_obj_affected_timer(this-&gt;loggerPrefix() +</span></div>
<div class="line"><span class="lineno">  529</span>  <span class="comment">//  &quot;.dyn_object_affected&quot;);</span></div>
<div class="line"><span class="lineno">  530</span>  <span class="keywordflow">for</span> (<span class="keyword">const</span> <span class="keyword">auto</span>&amp; [object_id, frames_affected] :</div>
<div class="line"><span class="lineno">  531</span>       result.objects_affected_per_frame) {</div>
<div class="line"><span class="lineno">  532</span>    VLOG(20) &lt;&lt; <span class="stringliteral">&quot;Iterating over frames for which a motion was added &quot;</span></div>
<div class="line"><span class="lineno">  533</span>             &lt;&lt; <a class="code hl_function" href="namespacedyno.html#a17d3c448677824ae83870358b2a3e01d">container_to_string</a>(frames_affected) &lt;&lt; <span class="stringliteral">&quot; for object &quot;</span></div>
<div class="line"><span class="lineno">  534</span>             &lt;&lt; object_id;</div>
<div class="line"><span class="lineno">  535</span> </div>
<div class="line"><span class="lineno">  536</span>    <span class="keyword">auto</span> object_node = <a class="code hl_function" href="classdyno_1_1Formulation.html#aa882dfc5e5e0cc12a03184b08889ad7f">map</a>-&gt;getObject(object_id);</div>
<div class="line"><span class="lineno">  537</span> </div>
<div class="line"><span class="lineno">  538</span>    std::vector&lt;FrameId&gt; frames_affected_vector(frames_affected.begin(),</div>
<div class="line"><span class="lineno">  539</span>                                                frames_affected.end());</div>
<div class="line"><span class="lineno">  540</span>    <span class="comment">// TODO: should always have at least two frames (prev and current) as we</span></div>
<div class="line"><span class="lineno">  541</span>    <span class="comment">// must add factors on this frame and the previous frame</span></div>
<div class="line"><span class="lineno">  542</span>    CHECK_GE(frames_affected_vector.size(), 2u);</div>
<div class="line"><span class="lineno">  543</span>    <span class="keywordflow">for</span> (<span class="keywordtype">size_t</span> frame_idx = 0; frame_idx &lt; frames_affected_vector.size();</div>
<div class="line"><span class="lineno">  544</span>         frame_idx++) {</div>
<div class="line"><span class="lineno">  545</span>      <span class="keyword">const</span> <a class="code hl_typedef" href="namespacedyno.html#ac4303d6fafb755f794b072d76f9cfb41">FrameId</a> frame_id = frames_affected_vector.at(frame_idx);</div>
<div class="line"><span class="lineno">  546</span>      <span class="keyword">auto</span> frame_node_k_impl = <a class="code hl_function" href="classdyno_1_1Formulation.html#aa882dfc5e5e0cc12a03184b08889ad7f">map</a>-&gt;getFrame(frame_id);</div>
<div class="line"><span class="lineno">  547</span> </div>
<div class="line"><span class="lineno">  548</span>      <a class="code hl_typedef" href="classdyno_1_1Formulation.html#a3a8077c836f8dc574c084ed01f69d9c7">ObjectUpdateContextType</a> object_update_context;</div>
<div class="line"><span class="lineno">  549</span>      <span class="comment">// perform motion check on this frame -&gt; if this is the first frame (of at</span></div>
<div class="line"><span class="lineno">  550</span>      <span class="comment">// least 2) then there should be no motion at this frame (since it is k-1</span></div>
<div class="line"><span class="lineno">  551</span>      <span class="comment">// of a motion pair and there is no k-2)</span></div>
<div class="line"><span class="lineno">  552</span>      <span class="keywordflow">if</span> (frame_idx == 0) {</div>
<div class="line"><span class="lineno">  553</span>        object_update_context.has_motion_pair = <span class="keyword">false</span>;</div>
<div class="line"><span class="lineno">  554</span>      } <span class="keywordflow">else</span> {</div>
<div class="line"><span class="lineno">  555</span>        object_update_context.has_motion_pair = <span class="keyword">true</span>;</div>
<div class="line"><span class="lineno">  556</span>      }</div>
<div class="line"><span class="lineno">  557</span>      object_update_context.frame_node_k = frame_node_k_impl;</div>
<div class="line"><span class="lineno">  558</span>      object_update_context.object_node = object_node;</div>
<div class="line"><span class="lineno">  559</span> </div>
<div class="line"><span class="lineno">  560</span>      gtsam::Values local_new_values;</div>
<div class="line"><span class="lineno">  561</span>      <a class="code hl_function" href="classdyno_1_1Formulation.html#a37aa6f06b484ce9d3fe46312063281e5">objectUpdateContext</a>(object_update_context, result, local_new_values,</div>
<div class="line"><span class="lineno">  562</span>                          internal_new_factors);</div>
<div class="line"><span class="lineno">  563</span>      <span class="comment">// update internal theta and factors</span></div>
<div class="line"><span class="lineno">  564</span>      <a class="code hl_variable" href="classdyno_1_1Formulation.html#aece87cef780a5692feeffc034e3dbd44">theta_</a>.insert(local_new_values);</div>
<div class="line"><span class="lineno">  565</span>      <span class="comment">// add to the external new_values</span></div>
<div class="line"><span class="lineno">  566</span>      new_values.insert(local_new_values);</div>
<div class="line"><span class="lineno">  567</span>    }</div>
<div class="line"><span class="lineno">  568</span>  }</div>
<div class="line"><span class="lineno">  569</span> </div>
<div class="line"><span class="lineno">  570</span>  <span class="comment">// this doesnt really work any more as debug info is meant to be per frame?</span></div>
<div class="line"><span class="lineno">  571</span>  <span class="keywordflow">if</span> (result.debug_info &amp;&amp; VLOG_IS_ON(20)) {</div>
<div class="line"><span class="lineno">  572</span>    <span class="keywordflow">for</span> (<span class="keyword">const</span> <span class="keyword">auto</span>&amp; [object_id, object_info] :</div>
<div class="line"><span class="lineno">  573</span>         result.debug_info-&gt;getObjectInfos()) {</div>
<div class="line"><span class="lineno">  574</span>      std::stringstream ss;</div>
<div class="line"><span class="lineno">  575</span>      ss &lt;&lt; <span class="stringliteral">&quot;Object id debug info: &quot;</span> &lt;&lt; object_id &lt;&lt; <span class="stringliteral">&quot;\n&quot;</span>;</div>
<div class="line"><span class="lineno">  576</span>      ss &lt;&lt; object_info;</div>
<div class="line"><span class="lineno">  577</span>      LOG(INFO) &lt;&lt; ss.str();</div>
<div class="line"><span class="lineno">  578</span>    }</div>
<div class="line"><span class="lineno">  579</span>  }</div>
<div class="line"><span class="lineno">  580</span> </div>
<div class="line"><span class="lineno">  581</span>  <a class="code hl_variable" href="classdyno_1_1Formulation.html#aabc461bd6dfa004c931e99356477104e">factors_</a> += internal_new_factors;</div>
<div class="line"><span class="lineno">  582</span>  new_factors += internal_new_factors;</div>
<div class="line"><span class="lineno">  583</span>  <span class="keywordflow">return</span> result;</div>
<div class="line"><span class="lineno">  584</span>}</div>
<div class="ttc" id="aclassdyno_1_1Formulation_html_a3369b4fa4dd649495e5bace0e9b715d9"><div class="ttname"><a href="classdyno_1_1Formulation.html#a3369b4fa4dd649495e5bace0e9b715d9">dyno::Formulation::getInitialOrLinearizedSensorPose</a></div><div class="ttdeci">gtsam::Pose3 getInitialOrLinearizedSensorPose(FrameId frame_id) const</div><div class="ttdef"><b>Definition:</b> <a href="Formulation-impl_8hpp_source.html#l00063">Formulation-impl.hpp:63</a></div></div>
<div class="ttc" id="aclassdyno_1_1Formulation_html_a37aa6f06b484ce9d3fe46312063281e5"><div class="ttname"><a href="classdyno_1_1Formulation.html#a37aa6f06b484ce9d3fe46312063281e5">dyno::Formulation::objectUpdateContext</a></div><div class="ttdeci">virtual void objectUpdateContext(const ObjectUpdateContextType &amp;context, UpdateObservationResult &amp;result, gtsam::Values &amp;new_values, gtsam::NonlinearFactorGraph &amp;new_factors)=0</div><div class="ttdoc">Virtual function to be implemented by derived class and indicates that a specific object j and time-s...</div></div>
<div class="ttc" id="aclassdyno_1_1Formulation_html_a3a8077c836f8dc574c084ed01f69d9c7"><div class="ttname"><a href="classdyno_1_1Formulation.html#a3a8077c836f8dc574c084ed01f69d9c7">dyno::Formulation::ObjectUpdateContextType</a></div><div class="ttdeci">ObjectUpdateContext&lt; Map &gt; ObjectUpdateContextType</div><div class="ttdef"><b>Definition:</b> <a href="Formulation_8hpp_source.html#l00157">Formulation.hpp:157</a></div></div>
<div class="ttc" id="aclassdyno_1_1Formulation_html_a7cbe87537d35b8d21463d402342ef356"><div class="ttname"><a href="classdyno_1_1Formulation.html#a7cbe87537d35b8d21463d402342ef356">dyno::Formulation::isDynamicTrackletInMap</a></div><div class="ttdeci">virtual bool isDynamicTrackletInMap(const typename MapTraitsType::LandmarkNodePtr &amp;lmk_node) const =0</div><div class="ttdoc">Virtual function to be implemented by derived class and indicates that the specified landmark exists ...</div></div>
<div class="ttc" id="aclassdyno_1_1Formulation_html_a9a172e526e325ba2bdfef03640ef1802"><div class="ttname"><a href="classdyno_1_1Formulation.html#a9a172e526e325ba2bdfef03640ef1802">dyno::Formulation::PointUpdateContextType</a></div><div class="ttdeci">PointUpdateContext&lt; Map &gt; PointUpdateContextType</div><div class="ttdef"><b>Definition:</b> <a href="Formulation_8hpp_source.html#l00156">Formulation.hpp:156</a></div></div>
<div class="ttc" id="aclassdyno_1_1Formulation_html_af93533f32a88133a492b5e3ed790267f"><div class="ttname"><a href="classdyno_1_1Formulation.html#af93533f32a88133a492b5e3ed790267f">dyno::Formulation::dynamicPointUpdateCallback</a></div><div class="ttdeci">virtual void dynamicPointUpdateCallback(const PointUpdateContextType &amp;context, UpdateObservationResult &amp;result, gtsam::Values &amp;new_values, gtsam::NonlinearFactorGraph &amp;new_factors)=0</div><div class="ttdoc">Virtual function to be implemented by derived class and indicates that a specific landmark has new me...</div></div>
<div class="ttc" id="anamespacedyno_html_a17d3c448677824ae83870358b2a3e01d"><div class="ttname"><a href="namespacedyno.html#a17d3c448677824ae83870358b2a3e01d">dyno::container_to_string</a></div><div class="ttdeci">std::string container_to_string(const Container &amp;container, const std::string &amp;delimiter=&quot; &quot;)</div><div class="ttdef"><b>Definition:</b> <a href="Types_8hpp_source.html#l00542">Types.hpp:542</a></div></div>
<div class="ttc" id="anamespacedyno_html_a38bb86e4154b86428b8d133be03fb2b5"><div class="ttname"><a href="namespacedyno.html#a38bb86e4154b86428b8d133be03fb2b5">dyno::ObjectId</a></div><div class="ttdeci">int ObjectId</div><div class="ttdoc">Discrete object id, j.</div><div class="ttdef"><b>Definition:</b> <a href="Types_8hpp_source.html#l00068">Types.hpp:68</a></div></div>
<div class="ttc" id="anamespacedyno_html_afdd174eb44901fb205371d796287378c"><div class="ttname"><a href="namespacedyno.html#afdd174eb44901fb205371d796287378c">dyno::TrackletId</a></div><div class="ttdeci">long int TrackletId</div><div class="ttdoc">Unique tracklet/landmark id, i.</div><div class="ttdef"><b>Definition:</b> <a href="Types_8hpp_source.html#l00079">Types.hpp:79</a></div></div>
<div class="ttc" id="astructdyno_1_1FormulationParams_html_a49d144a77a2a729d6bde2831e13dd6ba"><div class="ttname"><a href="structdyno_1_1FormulationParams.html#a49d144a77a2a729d6bde2831e13dd6ba">dyno::FormulationParams::min_dynamic_observations</a></div><div class="ttdeci">size_t min_dynamic_observations</div><div class="ttdef"><b>Definition:</b> <a href="Formulation_8hpp_source.html#l00118">Formulation.hpp:118</a></div></div>
<div class="ttc" id="astructdyno_1_1NoiseModels_html_a83368aae44c18d90239c00dcf557729a"><div class="ttname"><a href="structdyno_1_1NoiseModels.html#a83368aae44c18d90239c00dcf557729a">dyno::NoiseModels::landmark_motion_noise</a></div><div class="ttdeci">gtsam::SharedNoiseModel landmark_motion_noise</div><div class="ttdoc">Noise on the landmark tenrary factor.</div><div class="ttdef"><b>Definition:</b> <a href="BackendDefinitions_8hpp_source.html#l00101">BackendDefinitions.hpp:101</a></div></div>
<div class="ttc" id="astructdyno_1_1NoiseModels_html_aa0ba01119cae77c87c562c119497c8d0"><div class="ttname"><a href="structdyno_1_1NoiseModels.html#aa0ba01119cae77c87c562c119497c8d0">dyno::NoiseModels::dynamic_point_noise</a></div><div class="ttdeci">gtsam::SharedNoiseModel dynamic_point_noise</div><div class="ttdoc">Isometric [3x3] noise model on dynamic points;.</div><div class="ttdef"><b>Definition:</b> <a href="BackendDefinitions_8hpp_source.html#l00105">BackendDefinitions.hpp:105</a></div></div>
</div><!-- fragment -->
</div>
</div>
<a id="a4097a531fcdb07ef22b249bdeee52b23" name="a4097a531fcdb07ef22b249bdeee52b23"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a4097a531fcdb07ef22b249bdeee52b23">&#9670;&#160;</a></span>updateDynamicObservations() <span class="overload">[2/2]</span></h2>

<div class="memitem">
<div class="memproto">
<div class="memtemplate">
template&lt;typename MAP &gt; </div>
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="structdyno_1_1UpdateObservationResult.html">UpdateObservationResult</a> <a class="el" href="classdyno_1_1Formulation.html">dyno::Formulation</a>&lt; MAP &gt;::updateDynamicObservations </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="namespacedyno.html#ac4303d6fafb755f794b072d76f9cfb41">FrameId</a>&#160;</td>
          <td class="paramname"><em>from_frame</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="namespacedyno.html#ac4303d6fafb755f794b072d76f9cfb41">FrameId</a>&#160;</td>
          <td class="paramname"><em>to_frame</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">gtsam::Values &amp;&#160;</td>
          <td class="paramname"><em>new_values</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">gtsam::NonlinearFactorGraph &amp;&#160;</td>
          <td class="paramname"><em>new_factors</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const <a class="el" href="structdyno_1_1UpdateObservationParams.html">UpdateObservationParams</a> &amp;&#160;</td>
          <td class="paramname"><em>update_params</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Update the dynamic-point part of the factor graph between multiple frames. Internally makes several calls to <a class="el" href="classdyno_1_1Formulation.html#ad78d57e7de23e30b9aa287a3939bb3a9" title="Updates the dyanmic-point part of the factor graph for frame k. This contains all the big-boi bookeep...">updateDynamicObservations(FrameId,gtsam::Values&amp;,gtsam::NonlinearFactorGraph&amp;,const UpdateObservationParams&amp;)</a> and returns the accumulated <a class="el" href="structdyno_1_1UpdateObservationResult.html">UpdateObservationResult</a>. </p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">from_frame</td><td>FrameId </td></tr>
    <tr><td class="paramname">to_frame</td><td>FrameId </td></tr>
    <tr><td class="paramname">new_values</td><td>gtsam::Values&amp; </td></tr>
    <tr><td class="paramname">new_factors</td><td>gtsam::NonlinearFactorGraph&amp; </td></tr>
    <tr><td class="paramname">update_params</td><td>const <a class="el" href="structdyno_1_1UpdateObservationParams.html">UpdateObservationParams</a>&amp; </td></tr>
  </table>
  </dd>
</dl>
<dl class="section return"><dt>Returns</dt><dd><a class="el" href="structdyno_1_1UpdateObservationResult.html">UpdateObservationResult</a> </dd></dl>

<p class="definition">Definition at line <a class="el" href="Formulation-impl_8hpp_source.html#l00186">186</a> of file <a class="el" href="Formulation-impl_8hpp_source.html">Formulation-impl.hpp</a>.</p>
<div class="fragment"><div class="line"><span class="lineno">  189</span>                                                  {</div>
<div class="line"><span class="lineno">  190</span>  CHECK_LT(from_frame, to_frame);</div>
<div class="line"><span class="lineno">  191</span>  CHECK_GT(from_frame, this-&gt;<a class="code hl_function" href="classdyno_1_1Formulation.html#aa882dfc5e5e0cc12a03184b08889ad7f">map</a>()-&gt;firstFrameId());</div>
<div class="line"><span class="lineno">  192</span> </div>
<div class="line"><span class="lineno">  193</span>  UpdateObservationResult result;</div>
<div class="line"><span class="lineno">  194</span>  <span class="keywordflow">for</span> (<span class="keyword">auto</span> frame_id = from_frame; frame_id &lt;= to_frame; frame_id++) {</div>
<div class="line"><span class="lineno">  195</span>    gtsam::NonlinearFactorGraph factors;</div>
<div class="line"><span class="lineno">  196</span>    result +=</div>
<div class="line"><span class="lineno">  197</span>        <a class="code hl_function" href="classdyno_1_1Formulation.html#a4097a531fcdb07ef22b249bdeee52b23">updateDynamicObservations</a>(frame_id, new_values, factors, update_params);</div>
<div class="line"><span class="lineno">  198</span>    new_factors += factors;</div>
<div class="line"><span class="lineno">  199</span>  }</div>
<div class="line"><span class="lineno">  200</span>  <span class="keywordflow">return</span> result;</div>
<div class="line"><span class="lineno">  201</span>}</div>
<div class="ttc" id="aclassdyno_1_1Formulation_html_a4097a531fcdb07ef22b249bdeee52b23"><div class="ttname"><a href="classdyno_1_1Formulation.html#a4097a531fcdb07ef22b249bdeee52b23">dyno::Formulation::updateDynamicObservations</a></div><div class="ttdeci">UpdateObservationResult updateDynamicObservations(FrameId from_frame, FrameId to_frame, gtsam::Values &amp;new_values, gtsam::NonlinearFactorGraph &amp;new_factors, const UpdateObservationParams &amp;update_params)</div><div class="ttdoc">Update the dynamic-point part of the factor graph between multiple frames. Internally makes several c...</div><div class="ttdef"><b>Definition:</b> <a href="Formulation-impl_8hpp_source.html#l00186">Formulation-impl.hpp:186</a></div></div>
</div><!-- fragment -->
</div>
</div>
<a id="a74de91cf6b4755060af63627d28fed2c" name="a74de91cf6b4755060af63627d28fed2c"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a74de91cf6b4755060af63627d28fed2c">&#9670;&#160;</a></span>updateStaticObservations() <span class="overload">[1/2]</span></h2>

<div class="memitem">
<div class="memproto">
<div class="memtemplate">
template&lt;typename MAP &gt; </div>
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="structdyno_1_1UpdateObservationResult.html">UpdateObservationResult</a> <a class="el" href="classdyno_1_1Formulation.html">dyno::Formulation</a>&lt; MAP &gt;::updateStaticObservations </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="namespacedyno.html#ac4303d6fafb755f794b072d76f9cfb41">FrameId</a>&#160;</td>
          <td class="paramname"><em>frame_id_k</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">gtsam::Values &amp;&#160;</td>
          <td class="paramname"><em>new_values</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">gtsam::NonlinearFactorGraph &amp;&#160;</td>
          <td class="paramname"><em>new_factors</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const <a class="el" href="structdyno_1_1UpdateObservationParams.html">UpdateObservationParams</a> &amp;&#160;</td>
          <td class="paramname"><em>update_params</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Updates the static-point part of the factor graph for frame k. This contains all the bookeeping logic to update the factor graph with static points. </p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">frame_id_k</td><td>FrameId </td></tr>
    <tr><td class="paramname">new_values</td><td>gtsam::Values&amp; </td></tr>
    <tr><td class="paramname">new_factors</td><td>gtsam::NonlinearFactorGraph&amp; </td></tr>
    <tr><td class="paramname">update_params</td><td>const <a class="el" href="structdyno_1_1UpdateObservationParams.html">UpdateObservationParams</a>&amp; </td></tr>
  </table>
  </dd>
</dl>
<dl class="section return"><dt>Returns</dt><dd><a class="el" href="structdyno_1_1UpdateObservationResult.html">UpdateObservationResult</a> </dd></dl>

<p class="definition">Definition at line <a class="el" href="Formulation-impl_8hpp_source.html#l00204">204</a> of file <a class="el" href="Formulation-impl_8hpp_source.html">Formulation-impl.hpp</a>.</p>
<div class="fragment"><div class="line"><span class="lineno">  207</span>                                                  {</div>
<div class="line"><span class="lineno">  208</span>  <span class="keyword">typename</span> Map::Ptr <a class="code hl_function" href="classdyno_1_1Formulation.html#aa882dfc5e5e0cc12a03184b08889ad7f">map</a> = this-&gt;<a class="code hl_function" href="classdyno_1_1Formulation.html#aa882dfc5e5e0cc12a03184b08889ad7f">map</a>();</div>
<div class="line"><span class="lineno">  209</span>  <span class="keyword">auto</span> accessor = this-&gt;<a class="code hl_function" href="classdyno_1_1Formulation.html#a536dbcbdd6fcd6598fcedb7866cec1de">accessorFromTheta</a>();</div>
<div class="line"><span class="lineno">  210</span> </div>
<div class="line"><span class="lineno">  211</span>  <span class="keyword">auto</span> static_point_noise = <a class="code hl_variable" href="classdyno_1_1Formulation.html#a0e9e95a8f33f2da1fe8f7123feecf81c">noise_models_</a>.<a class="code hl_variable" href="structdyno_1_1NoiseModels.html#a8a6fbd96ef271a3670ab1b1a2fcc999c">static_point_noise</a>;</div>
<div class="line"><span class="lineno">  212</span>  <span class="comment">// keep track of the new factors added in this function</span></div>
<div class="line"><span class="lineno">  213</span>  <span class="comment">// these are then appended to the internal factors_ and new_factors</span></div>
<div class="line"><span class="lineno">  214</span>  gtsam::NonlinearFactorGraph internal_new_factors;</div>
<div class="line"><span class="lineno">  215</span> </div>
<div class="line"><span class="lineno">  216</span>  UpdateObservationResult result;</div>
<div class="line"><span class="lineno">  217</span>  <span class="keywordflow">if</span> (update_params.enable_debug_info) {</div>
<div class="line"><span class="lineno">  218</span>    result.debug_info = DebugInfo();</div>
<div class="line"><span class="lineno">  219</span>  }</div>
<div class="line"><span class="lineno">  220</span> </div>
<div class="line"><span class="lineno">  221</span>  <span class="keyword">const</span> <span class="keyword">auto</span> frame_node_k = <a class="code hl_function" href="classdyno_1_1Formulation.html#aa882dfc5e5e0cc12a03184b08889ad7f">map</a>-&gt;getFrame(frame_id_k);</div>
<div class="line"><span class="lineno">  222</span>  CHECK_NOTNULL(frame_node_k);</div>
<div class="line"><span class="lineno">  223</span> </div>
<div class="line"><span class="lineno">  224</span>  <span class="comment">// pose estimate from frontend</span></div>
<div class="line"><span class="lineno">  225</span>  gtsam::Pose3 T_world_camera_frontend;</div>
<div class="line"><span class="lineno">  226</span>  CHECK(</div>
<div class="line"><span class="lineno">  227</span>      this-&gt;<a class="code hl_function" href="classdyno_1_1Formulation.html#aa882dfc5e5e0cc12a03184b08889ad7f">map</a>()-&gt;hasInitialSensorPose(frame_id_k, &amp;T_world_camera_frontend));</div>
<div class="line"><span class="lineno">  228</span> </div>
<div class="line"><span class="lineno">  229</span>  VLOG(20) &lt;&lt; <span class="stringliteral">&quot;Looping over &quot;</span> &lt;&lt; frame_node_k-&gt;static_landmarks.size()</div>
<div class="line"><span class="lineno">  230</span>           &lt;&lt; <span class="stringliteral">&quot; static lmks for frame &quot;</span> &lt;&lt; frame_id_k;</div>
<div class="line"><span class="lineno">  231</span>  <span class="keywordflow">for</span> (<span class="keyword">const</span> <span class="keyword">auto</span>&amp; lmk_node : frame_node_k-&gt;static_landmarks) {</div>
<div class="line"><span class="lineno">  232</span>    <span class="keyword">const</span> gtsam::Key point_key = lmk_node-&gt;makeStaticKey();</div>
<div class="line"><span class="lineno">  233</span>    <span class="comment">// check if lmk node is already in map (which should mean it is equivalently</span></div>
<div class="line"><span class="lineno">  234</span>    <span class="comment">// in isam)</span></div>
<div class="line"><span class="lineno">  235</span>    <span class="keywordflow">if</span> (<a class="code hl_variable" href="classdyno_1_1Formulation.html#af8fa9cd53878c20db3b398f702e45b49">is_other_values_in_map</a>.exists(point_key)) {</div>
<div class="line"><span class="lineno">  236</span>      <span class="keyword">const</span> <a class="code hl_typedef" href="namespacedyno.html#a6c8dbdcd5e61797d494457220b875761">Landmark</a> measured = lmk_node-&gt;getMeasurement(frame_id_k).landmark;</div>
<div class="line"><span class="lineno">  237</span>      internal_new_factors</div>
<div class="line"><span class="lineno">  238</span>          .emplace_shared&lt;gtsam::PoseToPointFactor&lt;gtsam::Pose3, Landmark&gt;&gt;(</div>
<div class="line"><span class="lineno">  239</span>              frame_node_k-&gt;makePoseKey(),  <span class="comment">// pose key for this frame</span></div>
<div class="line"><span class="lineno">  240</span>              point_key, measured, static_point_noise);</div>
<div class="line"><span class="lineno">  241</span> </div>
<div class="line"><span class="lineno">  242</span>      <span class="keywordflow">if</span> (result.debug_info) result.debug_info-&gt;num_static_factors++;</div>
<div class="line"><span class="lineno">  243</span>      result.updateAffectedObject(frame_id_k, 0);</div>
<div class="line"><span class="lineno">  244</span> </div>
<div class="line"><span class="lineno">  245</span>    } <span class="keywordflow">else</span> {</div>
<div class="line"><span class="lineno">  246</span>      <span class="comment">// see if we have enough observations to add this lmk</span></div>
<div class="line"><span class="lineno">  247</span>      <span class="keywordflow">if</span> (lmk_node-&gt;numObservations() &lt; <a class="code hl_variable" href="classdyno_1_1Formulation.html#a18df73bd68393b6b9860c6c332bd5496">params_</a>.<a class="code hl_variable" href="structdyno_1_1FormulationParams.html#a032be0453492c51720c8a7bc207a3099">min_static_observations</a>) {</div>
<div class="line"><span class="lineno">  248</span>        <span class="keywordflow">continue</span>;</div>
<div class="line"><span class="lineno">  249</span>      }</div>
<div class="line"><span class="lineno">  250</span> </div>
<div class="line"><span class="lineno">  251</span>      <span class="comment">// this condition should only run once per tracklet (ie.e the first time</span></div>
<div class="line"><span class="lineno">  252</span>      <span class="comment">// the tracklet has enough observations) we gather the tracklet</span></div>
<div class="line"><span class="lineno">  253</span>      <span class="comment">// observations and then initalise it in the new values these should then</span></div>
<div class="line"><span class="lineno">  254</span>      <span class="comment">// get added to the map and map_-&gt;exists() should return true for all</span></div>
<div class="line"><span class="lineno">  255</span>      <span class="comment">// other times</span></div>
<div class="line"><span class="lineno">  256</span>      <span class="keyword">const</span> <span class="keyword">auto</span>&amp; seen_frames = lmk_node-&gt;getSeenFrames();</div>
<div class="line"><span class="lineno">  257</span>      <span class="keywordflow">for</span> (<span class="keyword">const</span> <span class="keyword">auto</span>&amp; seen_frame : seen_frames) {</div>
<div class="line"><span class="lineno">  258</span>        <span class="keyword">auto</span> seen_frame_id = seen_frame-&gt;getId();</div>
<div class="line"><span class="lineno">  259</span>        <span class="comment">// only iterate up to the query frame</span></div>
<div class="line"><span class="lineno">  260</span>        <span class="keywordflow">if</span> ((<a class="code hl_typedef" href="namespacedyno.html#ac4303d6fafb755f794b072d76f9cfb41">FrameId</a>)seen_frame_id &gt; frame_id_k) {</div>
<div class="line"><span class="lineno">  261</span>          <span class="keywordflow">break</span>;</div>
<div class="line"><span class="lineno">  262</span>        }</div>
<div class="line"><span class="lineno">  263</span> </div>
<div class="line"><span class="lineno">  264</span>        <span class="comment">// if we should not backtrack, only add the current frame!!!</span></div>
<div class="line"><span class="lineno">  265</span>        <span class="keyword">const</span> <span class="keyword">auto</span> do_backtrack = update_params.do_backtrack;</div>
<div class="line"><span class="lineno">  266</span>        <span class="keywordflow">if</span> (!do_backtrack &amp;&amp; (<a class="code hl_typedef" href="namespacedyno.html#ac4303d6fafb755f794b072d76f9cfb41">FrameId</a>)seen_frame_id &lt; frame_id_k) {</div>
<div class="line"><span class="lineno">  267</span>          <span class="keywordflow">continue</span>;</div>
<div class="line"><span class="lineno">  268</span>        }</div>
<div class="line"><span class="lineno">  269</span> </div>
<div class="line"><span class="lineno">  270</span>        <span class="keyword">const</span> <a class="code hl_typedef" href="namespacedyno.html#a6c8dbdcd5e61797d494457220b875761">Landmark</a>&amp; measured =</div>
<div class="line"><span class="lineno">  271</span>            lmk_node-&gt;getMeasurement(seen_frame).landmark;</div>
<div class="line"><span class="lineno">  272</span>        internal_new_factors.emplace_shared&lt;<a class="code hl_typedef" href="namespacedyno.html#ad2695c66ea8d7bd38aaa57ef1bca4365">PoseToPointFactor</a>&gt;(</div>
<div class="line"><span class="lineno">  273</span>            seen_frame-&gt;makePoseKey(),  <span class="comment">// pose key at previous frames</span></div>
<div class="line"><span class="lineno">  274</span>            point_key, measured, static_point_noise);</div>
<div class="line"><span class="lineno">  275</span>        <span class="keywordflow">if</span> (result.debug_info) result.debug_info-&gt;num_static_factors++;</div>
<div class="line"><span class="lineno">  276</span>        result.updateAffectedObject(seen_frame_id, 0);</div>
<div class="line"><span class="lineno">  277</span>      }</div>
<div class="line"><span class="lineno">  278</span> </div>
<div class="line"><span class="lineno">  279</span>      <span class="comment">// pick the one in this frame</span></div>
<div class="line"><span class="lineno">  280</span>      <span class="keyword">const</span> <a class="code hl_typedef" href="namespacedyno.html#a6c8dbdcd5e61797d494457220b875761">Landmark</a>&amp; measured = lmk_node-&gt;getMeasurement(frame_id_k).landmark;</div>
<div class="line"><span class="lineno">  281</span>      <span class="comment">// add initial value, either from measurement or previous estimate</span></div>
<div class="line"><span class="lineno">  282</span>      gtsam::Point3 lmk_world;</div>
<div class="line"><span class="lineno">  283</span>      <a class="code hl_function" href="namespacedyno.html#ad5ce0869676f7888164ba26aceda60a9">getSafeQuery</a>(lmk_world,</div>
<div class="line"><span class="lineno">  284</span>                   accessor-&gt;getStaticLandmark(lmk_node-&gt;tracklet_id),</div>
<div class="line"><span class="lineno">  285</span>                   gtsam::Point3(T_world_camera_frontend * measured));</div>
<div class="line"><span class="lineno">  286</span>      new_values.insert(point_key, lmk_world);</div>
<div class="line"><span class="lineno">  287</span>      <a class="code hl_variable" href="classdyno_1_1Formulation.html#af8fa9cd53878c20db3b398f702e45b49">is_other_values_in_map</a>.insert2(point_key, <span class="keyword">true</span>);</div>
<div class="line"><span class="lineno">  288</span> </div>
<div class="line"><span class="lineno">  289</span>      <span class="keywordflow">if</span> (result.debug_info) result.debug_info-&gt;num_new_static_points++;</div>
<div class="line"><span class="lineno">  290</span>      result.updateAffectedObject(frame_id_k, 0);</div>
<div class="line"><span class="lineno">  291</span>    }</div>
<div class="line"><span class="lineno">  292</span>  }</div>
<div class="line"><span class="lineno">  293</span> </div>
<div class="line"><span class="lineno">  294</span>  <span class="comment">// update internal data structures</span></div>
<div class="line"><span class="lineno">  295</span>  <a class="code hl_variable" href="classdyno_1_1Formulation.html#aece87cef780a5692feeffc034e3dbd44">theta_</a>.insert_or_assign(new_values);</div>
<div class="line"><span class="lineno">  296</span>  <a class="code hl_variable" href="classdyno_1_1Formulation.html#aabc461bd6dfa004c931e99356477104e">factors_</a> += internal_new_factors;</div>
<div class="line"><span class="lineno">  297</span>  new_factors += internal_new_factors;</div>
<div class="line"><span class="lineno">  298</span> </div>
<div class="line"><span class="lineno">  299</span>  <span class="keywordflow">if</span> (result.debug_info)</div>
<div class="line"><span class="lineno">  300</span>    LOG(INFO) &lt;&lt; <span class="stringliteral">&quot;Num new static points: &quot;</span></div>
<div class="line"><span class="lineno">  301</span>              &lt;&lt; result.debug_info-&gt;num_new_static_points</div>
<div class="line"><span class="lineno">  302</span>              &lt;&lt; <span class="stringliteral">&quot; Num new static factors &quot;</span></div>
<div class="line"><span class="lineno">  303</span>              &lt;&lt; result.debug_info-&gt;num_static_factors;</div>
<div class="line"><span class="lineno">  304</span>  <span class="keywordflow">return</span> result;</div>
<div class="line"><span class="lineno">  305</span>}</div>
<div class="ttc" id="aclassdyno_1_1Formulation_html_af8fa9cd53878c20db3b398f702e45b49"><div class="ttname"><a href="classdyno_1_1Formulation.html#af8fa9cd53878c20db3b398f702e45b49">dyno::Formulation::is_other_values_in_map</a></div><div class="ttdeci">gtsam::FastMap&lt; gtsam::Key, bool &gt; is_other_values_in_map</div><div class="ttdoc">the set of (static related) values managed by this updater. Allows checking if values have already be...</div><div class="ttdef"><b>Definition:</b> <a href="Formulation_8hpp_source.html#l00448">Formulation.hpp:448</a></div></div>
<div class="ttc" id="anamespacedyno_html_a6c8dbdcd5e61797d494457220b875761"><div class="ttname"><a href="namespacedyno.html#a6c8dbdcd5e61797d494457220b875761">dyno::Landmark</a></div><div class="ttdeci">gtsam::Point3 Landmark</div><div class="ttdef"><b>Definition:</b> <a href="Types_8hpp_source.html#l00086">Types.hpp:86</a></div></div>
<div class="ttc" id="anamespacedyno_html_ad2695c66ea8d7bd38aaa57ef1bca4365"><div class="ttname"><a href="namespacedyno.html#ad2695c66ea8d7bd38aaa57ef1bca4365">dyno::PoseToPointFactor</a></div><div class="ttdeci">gtsam::PoseToPointFactor&lt; gtsam::Pose3, Landmark &gt; PoseToPointFactor</div><div class="ttdoc">Alias to a gtsam::PoseToPointFactor&lt;gtsam::Pose3, Landmark&gt;</div><div class="ttdef"><b>Definition:</b> <a href="BackendDefinitions_8hpp_source.html#l00054">BackendDefinitions.hpp:54</a></div></div>
<div class="ttc" id="astructdyno_1_1FormulationParams_html_a032be0453492c51720c8a7bc207a3099"><div class="ttname"><a href="structdyno_1_1FormulationParams.html#a032be0453492c51720c8a7bc207a3099">dyno::FormulationParams::min_static_observations</a></div><div class="ttdeci">size_t min_static_observations</div><div class="ttdef"><b>Definition:</b> <a href="Formulation_8hpp_source.html#l00119">Formulation.hpp:119</a></div></div>
<div class="ttc" id="astructdyno_1_1NoiseModels_html_a8a6fbd96ef271a3670ab1b1a2fcc999c"><div class="ttname"><a href="structdyno_1_1NoiseModels.html#a8a6fbd96ef271a3670ab1b1a2fcc999c">dyno::NoiseModels::static_point_noise</a></div><div class="ttdeci">gtsam::SharedNoiseModel static_point_noise</div><div class="ttdoc">Isometric [3x3] noise model on static points;.</div><div class="ttdef"><b>Definition:</b> <a href="BackendDefinitions_8hpp_source.html#l00107">BackendDefinitions.hpp:107</a></div></div>
</div><!-- fragment -->
<p class="reference">References <a class="el" href="structdyno_1_1UpdateObservationResult.html#a8a980ad2e2f463b0a78b5c6e8a412976">dyno::UpdateObservationResult::debug_info</a>, <a class="el" href="structdyno_1_1UpdateObservationParams.html#ab28873ec59906f1a1c7b266a6b454f77">dyno::UpdateObservationParams::do_backtrack</a>, <a class="el" href="structdyno_1_1UpdateObservationParams.html#aaca4a55e978d91915de6b99e98e8ae3d">dyno::UpdateObservationParams::enable_debug_info</a>, and <a class="el" href="structdyno_1_1UpdateObservationResult.html#a002ddcad2bc2b520dd274acc8370d0a9">dyno::UpdateObservationResult::updateAffectedObject()</a>.</p>
<div class="dynheader">
Here is the call graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="classdyno_1_1Formulation_a74de91cf6b4755060af63627d28fed2c_cgraph.png" border="0" usemap="#aclassdyno_1_1Formulation_a74de91cf6b4755060af63627d28fed2c_cgraph" alt=""/></div>
<map name="aclassdyno_1_1Formulation_a74de91cf6b4755060af63627d28fed2c_cgraph" id="aclassdyno_1_1Formulation_a74de91cf6b4755060af63627d28fed2c_cgraph">
<area shape="rect" title="Updates the static&#45;point part of the factor graph for frame k. This contains all the bookeeping logic..." alt="" coords="5,5,196,45"/>
<area shape="rect" href="structdyno_1_1UpdateObservationResult.html#a002ddcad2bc2b520dd274acc8370d0a9" title=" " alt="" coords="244,5,473,45"/>
</map>
</div>

</div>
</div>
<a id="a4e62c29e14bd5ea89fc24d5693bdefea" name="a4e62c29e14bd5ea89fc24d5693bdefea"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a4e62c29e14bd5ea89fc24d5693bdefea">&#9670;&#160;</a></span>updateStaticObservations() <span class="overload">[2/2]</span></h2>

<div class="memitem">
<div class="memproto">
<div class="memtemplate">
template&lt;typename MAP &gt; </div>
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="structdyno_1_1UpdateObservationResult.html">UpdateObservationResult</a> <a class="el" href="classdyno_1_1Formulation.html">dyno::Formulation</a>&lt; MAP &gt;::updateStaticObservations </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="namespacedyno.html#ac4303d6fafb755f794b072d76f9cfb41">FrameId</a>&#160;</td>
          <td class="paramname"><em>from_frame</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="namespacedyno.html#ac4303d6fafb755f794b072d76f9cfb41">FrameId</a>&#160;</td>
          <td class="paramname"><em>to_frame</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">gtsam::Values &amp;&#160;</td>
          <td class="paramname"><em>new_values</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">gtsam::NonlinearFactorGraph &amp;&#160;</td>
          <td class="paramname"><em>new_factors</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const <a class="el" href="structdyno_1_1UpdateObservationParams.html">UpdateObservationParams</a> &amp;&#160;</td>
          <td class="paramname"><em>update_params</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Update the static-point part of the factor graph between multiple frames. Internally makes several calls to <a class="el" href="classdyno_1_1Formulation.html#a74de91cf6b4755060af63627d28fed2c" title="Updates the static-point part of the factor graph for frame k. This contains all the bookeeping logic...">updateStaticObservations(FrameId,gtsam::Values&amp;,gtsam::NonlinearFactorGraph&amp;,const UpdateObservationParams&amp;)</a> and returns the accumulated <a class="el" href="structdyno_1_1UpdateObservationResult.html">UpdateObservationResult</a>. </p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">from_frame</td><td>FrameId </td></tr>
    <tr><td class="paramname">to_frame</td><td>FrameId </td></tr>
    <tr><td class="paramname">new_values</td><td>gtsam::Values&amp; </td></tr>
    <tr><td class="paramname">new_factors</td><td>gtsam::NonlinearFactorGraph&amp; </td></tr>
    <tr><td class="paramname">update_params</td><td>const <a class="el" href="structdyno_1_1UpdateObservationParams.html">UpdateObservationParams</a>&amp; </td></tr>
  </table>
  </dd>
</dl>
<dl class="section return"><dt>Returns</dt><dd><a class="el" href="structdyno_1_1UpdateObservationResult.html">UpdateObservationResult</a> </dd></dl>

<p class="definition">Definition at line <a class="el" href="Formulation-impl_8hpp_source.html#l00164">164</a> of file <a class="el" href="Formulation-impl_8hpp_source.html">Formulation-impl.hpp</a>.</p>
<div class="fragment"><div class="line"><span class="lineno">  167</span>                                                  {</div>
<div class="line"><span class="lineno">  168</span>  CHECK_LT(from_frame, to_frame);</div>
<div class="line"><span class="lineno">  169</span>  CHECK_GT(from_frame, this-&gt;<a class="code hl_function" href="classdyno_1_1Formulation.html#aa882dfc5e5e0cc12a03184b08889ad7f">map</a>()-&gt;firstFrameId());</div>
<div class="line"><span class="lineno">  170</span> </div>
<div class="line"><span class="lineno">  171</span>  UpdateObservationResult result;</div>
<div class="line"><span class="lineno">  172</span>  <span class="keywordflow">for</span> (<span class="keyword">auto</span> frame_id = from_frame; frame_id &lt;= to_frame; frame_id++) {</div>
<div class="line"><span class="lineno">  173</span>    <span class="comment">// TODO: not sure we need this extra factors variable here now we use the</span></div>
<div class="line"><span class="lineno">  174</span>    <span class="comment">// internal_new_factors</span></div>
<div class="line"><span class="lineno">  175</span>    gtsam::NonlinearFactorGraph factors;</div>
<div class="line"><span class="lineno">  176</span>    result +=</div>
<div class="line"><span class="lineno">  177</span>        <a class="code hl_function" href="classdyno_1_1Formulation.html#a4e62c29e14bd5ea89fc24d5693bdefea">updateStaticObservations</a>(frame_id, new_values, factors, update_params);</div>
<div class="line"><span class="lineno">  178</span> </div>
<div class="line"><span class="lineno">  179</span>    new_factors += factors;</div>
<div class="line"><span class="lineno">  180</span>  }</div>
<div class="line"><span class="lineno">  181</span> </div>
<div class="line"><span class="lineno">  182</span>  <span class="keywordflow">return</span> result;</div>
<div class="line"><span class="lineno">  183</span>}</div>
<div class="ttc" id="aclassdyno_1_1Formulation_html_a4e62c29e14bd5ea89fc24d5693bdefea"><div class="ttname"><a href="classdyno_1_1Formulation.html#a4e62c29e14bd5ea89fc24d5693bdefea">dyno::Formulation::updateStaticObservations</a></div><div class="ttdeci">UpdateObservationResult updateStaticObservations(FrameId from_frame, FrameId to_frame, gtsam::Values &amp;new_values, gtsam::NonlinearFactorGraph &amp;new_factors, const UpdateObservationParams &amp;update_params)</div><div class="ttdoc">Update the static-point part of the factor graph between multiple frames. Internally makes several ca...</div><div class="ttdef"><b>Definition:</b> <a href="Formulation-impl_8hpp_source.html#l00164">Formulation-impl.hpp:164</a></div></div>
</div><!-- fragment -->
</div>
</div>
<a id="a1b5ff63de3f707bd29838b65ef7a2ec9" name="a1b5ff63de3f707bd29838b65ef7a2ec9"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a1b5ff63de3f707bd29838b65ef7a2ec9">&#9670;&#160;</a></span>updateTheta()</h2>

<div class="memitem">
<div class="memproto">
<div class="memtemplate">
template&lt;typename MAP &gt; </div>
      <table class="memname">
        <tr>
          <td class="memname">void <a class="el" href="classdyno_1_1Formulation.html">dyno::Formulation</a>&lt; MAP &gt;::updateTheta </td>
          <td>(</td>
          <td class="paramtype">const gtsam::Values &amp;&#160;</td>
          <td class="paramname"><em>linearization</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Updates and assigns new values to theta. This is used after external optimisation to update the values for the accessor which has a internal reference (pointer) to theta. </p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">linearization</td><td>const gtsam::Values&amp; </td></tr>
  </table>
  </dd>
</dl>

<p class="definition">Definition at line <a class="el" href="Formulation-impl_8hpp_source.html#l00054">54</a> of file <a class="el" href="Formulation-impl_8hpp_source.html">Formulation-impl.hpp</a>.</p>
<div class="fragment"><div class="line"><span class="lineno">   54</span>                                                                   {</div>
<div class="line"><span class="lineno">   55</span>  <span class="comment">// theta_.update(linearization);</span></div>
<div class="line"><span class="lineno">   56</span>  <span class="comment">// why would we need to assign new values?</span></div>
<div class="line"><span class="lineno">   57</span>  <a class="code hl_variable" href="classdyno_1_1Formulation.html#aece87cef780a5692feeffc034e3dbd44">theta_</a>.insert_or_assign(linearization);</div>
<div class="line"><span class="lineno">   58</span>  <span class="comment">// TODO: comment backed in!!</span></div>
<div class="line"><span class="lineno">   59</span>  <span class="comment">//  accessorFromTheta()-&gt;postUpdateCallback();</span></div>
<div class="line"><span class="lineno">   60</span>}</div>
</div><!-- fragment -->
</div>
</div>
<h2 class="groupheader">Member Data Documentation</h2>
<a id="ad73481666a52d300f4a4e4da65a718ba" name="ad73481666a52d300f4a4e4da65a718ba"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ad73481666a52d300f4a4e4da65a718ba">&#9670;&#160;</a></span>accessor_theta_</h2>

<div class="memitem">
<div class="memproto">
<div class="memtemplate">
template&lt;typename MAP &gt; </div>
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">AccessorType::Ptr <a class="el" href="classdyno_1_1Formulation.html">dyno::Formulation</a>&lt; MAP &gt;::accessor_theta_</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">mutable</span><span class="mlabel">private</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="Formulation_8hpp_source.html#l00454">454</a> of file <a class="el" href="Formulation_8hpp_source.html">Formulation.hpp</a>.</p>

</div>
</div>
<a id="aabc461bd6dfa004c931e99356477104e" name="aabc461bd6dfa004c931e99356477104e"></a>
<h2 class="memtitle"><span class="permalink"><a href="#aabc461bd6dfa004c931e99356477104e">&#9670;&#160;</a></span>factors_</h2>

<div class="memitem">
<div class="memproto">
<div class="memtemplate">
template&lt;typename MAP &gt; </div>
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">gtsam::NonlinearFactorGraph <a class="el" href="classdyno_1_1Formulation.html">dyno::Formulation</a>&lt; MAP &gt;::factors_</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">private</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="Formulation_8hpp_source.html#l00453">453</a> of file <a class="el" href="Formulation_8hpp_source.html">Formulation.hpp</a>.</p>

<p class="reference">Referenced by <a class="el" href="classdyno_1_1Formulation.html#a5897842d346d80f87315ed7870d7d580">dyno::Formulation&lt; MAP &gt;::getGraph()</a>.</p>

</div>
</div>
<a id="a1f64fc4ad8d279acfb5402ba9748087d" name="a1f64fc4ad8d279acfb5402ba9748087d"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a1f64fc4ad8d279acfb5402ba9748087d">&#9670;&#160;</a></span>fully_qualified_name_</h2>

<div class="memitem">
<div class="memproto">
<div class="memtemplate">
template&lt;typename MAP &gt; </div>
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">std::optional&lt;std::string&gt; <a class="el" href="classdyno_1_1Formulation.html">dyno::Formulation</a>&lt; MAP &gt;::fully_qualified_name_ {std::nullopt}</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">mutable</span><span class="mlabel">private</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>Full name of the formulation and accounts for the additional configuration from the <a class="el" href="structdyno_1_1FormulationParams.html">FormulationParams</a>. </p>

<p class="definition">Definition at line <a class="el" href="Formulation_8hpp_source.html#l00456">456</a> of file <a class="el" href="Formulation_8hpp_source.html">Formulation.hpp</a>.</p>

<p class="reference">Referenced by <a class="el" href="classdyno_1_1Formulation.html#a6b9b3b3a6c14748b57725bee233bcca4">dyno::Formulation&lt; MAP &gt;::getFullyQualifiedName()</a>.</p>

</div>
</div>
<a id="af8fa9cd53878c20db3b398f702e45b49" name="af8fa9cd53878c20db3b398f702e45b49"></a>
<h2 class="memtitle"><span class="permalink"><a href="#af8fa9cd53878c20db3b398f702e45b49">&#9670;&#160;</a></span>is_other_values_in_map</h2>

<div class="memitem">
<div class="memproto">
<div class="memtemplate">
template&lt;typename MAP &gt; </div>
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">gtsam::FastMap&lt;gtsam::Key, bool&gt; <a class="el" href="classdyno_1_1Formulation.html">dyno::Formulation</a>&lt; MAP &gt;::is_other_values_in_map</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">protected</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>the set of (static related) values managed by this updater. Allows checking if values have already been added over successifve function calls </p>

<p class="definition">Definition at line <a class="el" href="Formulation_8hpp_source.html#l00448">448</a> of file <a class="el" href="Formulation_8hpp_source.html">Formulation.hpp</a>.</p>

</div>
</div>
<a id="a100326929d58a9a30f663f51969058f9" name="a100326929d58a9a30f663f51969058f9"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a100326929d58a9a30f663f51969058f9">&#9670;&#160;</a></span>map_</h2>

<div class="memitem">
<div class="memproto">
<div class="memtemplate">
template&lt;typename MAP &gt; </div>
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">Map::Ptr <a class="el" href="classdyno_1_1Formulation.html">dyno::Formulation</a>&lt; MAP &gt;::map_</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">protected</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="Formulation_8hpp_source.html#l00445">445</a> of file <a class="el" href="Formulation_8hpp_source.html">Formulation.hpp</a>.</p>

<p class="reference">Referenced by <a class="el" href="classdyno_1_1Formulation.html#aa882dfc5e5e0cc12a03184b08889ad7f">dyno::Formulation&lt; MAP &gt;::map()</a>.</p>

</div>
</div>
<a id="a0e9e95a8f33f2da1fe8f7123feecf81c" name="a0e9e95a8f33f2da1fe8f7123feecf81c"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a0e9e95a8f33f2da1fe8f7123feecf81c">&#9670;&#160;</a></span>noise_models_</h2>

<div class="memitem">
<div class="memproto">
<div class="memtemplate">
template&lt;typename MAP &gt; </div>
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">const <a class="el" href="structdyno_1_1NoiseModels.html">NoiseModels</a> <a class="el" href="classdyno_1_1Formulation.html">dyno::Formulation</a>&lt; MAP &gt;::noise_models_</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">protected</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="Formulation_8hpp_source.html#l00446">446</a> of file <a class="el" href="Formulation_8hpp_source.html">Formulation.hpp</a>.</p>

</div>
</div>
<a id="a18df73bd68393b6b9860c6c332bd5496" name="a18df73bd68393b6b9860c6c332bd5496"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a18df73bd68393b6b9860c6c332bd5496">&#9670;&#160;</a></span>params_</h2>

<div class="memitem">
<div class="memproto">
<div class="memtemplate">
template&lt;typename MAP &gt; </div>
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">const <a class="el" href="structdyno_1_1FormulationParams.html">FormulationParams</a> <a class="el" href="classdyno_1_1Formulation.html">dyno::Formulation</a>&lt; MAP &gt;::params_</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">protected</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="Formulation_8hpp_source.html#l00444">444</a> of file <a class="el" href="Formulation_8hpp_source.html">Formulation.hpp</a>.</p>

</div>
</div>
<a id="aece87cef780a5692feeffc034e3dbd44" name="aece87cef780a5692feeffc034e3dbd44"></a>
<h2 class="memtitle"><span class="permalink"><a href="#aece87cef780a5692feeffc034e3dbd44">&#9670;&#160;</a></span>theta_</h2>

<div class="memitem">
<div class="memproto">
<div class="memtemplate">
template&lt;typename MAP &gt; </div>
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">gtsam::Values <a class="el" href="classdyno_1_1Formulation.html">dyno::Formulation</a>&lt; MAP &gt;::theta_</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">private</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>Current linearisation that will be associated with the current graph. </p>

<p class="definition">Definition at line <a class="el" href="Formulation_8hpp_source.html#l00452">452</a> of file <a class="el" href="Formulation_8hpp_source.html">Formulation.hpp</a>.</p>

<p class="reference">Referenced by <a class="el" href="classdyno_1_1Formulation.html#ab453db0a7949192fc9499aab026e012f">dyno::Formulation&lt; MAP &gt;::getTheta()</a>.</p>

</div>
</div>
<hr/>The documentation for this class was generated from the following files:<ul>
<li>dynosam/include/dynosam/backend/<a class="el" href="Formulation_8hpp_source.html">Formulation.hpp</a></li>
<li>dynosam/include/dynosam/backend/<a class="el" href="Formulation-impl_8hpp_source.html">Formulation-impl.hpp</a></li>
</ul>
</div><!-- contents -->
<!-- start footer part -->
<hr class="footer"/><address class="footer"><small>
Generated by&#160;<a href="https://www.doxygen.org/index.html"><img class="footer" src="doxygen.svg" width="104" height="31" alt="doxygen"/></a> 1.9.6
</small></address>
</body>
</html>
