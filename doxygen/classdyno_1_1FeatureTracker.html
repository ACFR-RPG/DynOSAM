<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "https://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml" lang="en-US">
<head>
<meta http-equiv="Content-Type" content="text/xhtml;charset=UTF-8"/>
<meta http-equiv="X-UA-Compatible" content="IE=11"/>
<meta name="generator" content="Doxygen 1.9.6"/>
<meta name="viewport" content="width=device-width, initial-scale=1"/>
<title>DynoSAM: dyno::FeatureTracker Class Reference</title>
<link href="tabs.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="jquery.js"></script>
<script type="text/javascript" src="dynsections.js"></script>
<link href="search/search.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="search/searchdata.js"></script>
<script type="text/javascript" src="search/search.js"></script>
<link href="doxygen.css" rel="stylesheet" type="text/css" />
</head>
<body>
<div id="top"><!-- do not remove this div, it is closed by doxygen! -->
<div id="titlearea">
<table cellspacing="0" cellpadding="0">
 <tbody>
 <tr id="projectrow">
  <td id="projectalign">
   <div id="projectname">DynoSAM
   </div>
   <div id="projectbrief">Dynamic Object Smoothing and Mapping for Dynamic SLAM</div>
  </td>
 </tr>
 </tbody>
</table>
</div>
<!-- end header part -->
<!-- Generated by Doxygen 1.9.6 -->
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:d3d9a9a6595521f9666a5e94cc830dab83b65699&amp;dn=expat.txt MIT */
var searchBox = new SearchBox("searchBox", "search/",'.html');
/* @license-end */
</script>
<script type="text/javascript" src="menudata.js"></script>
<script type="text/javascript" src="menu.js"></script>
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:d3d9a9a6595521f9666a5e94cc830dab83b65699&amp;dn=expat.txt MIT */
$(function() {
  initMenu('',true,false,'search.php','Search');
  $(document).ready(function() { init_search(); });
});
/* @license-end */
</script>
<div id="main-nav"></div>
<!-- window showing the filter options -->
<div id="MSearchSelectWindow"
     onmouseover="return searchBox.OnSearchSelectShow()"
     onmouseout="return searchBox.OnSearchSelectHide()"
     onkeydown="return searchBox.OnSearchSelectKey(event)">
</div>

<!-- iframe showing the search results (closed by default) -->
<div id="MSearchResultsWindow">
<div id="MSearchResults">
<div class="SRPage">
<div id="SRIndex">
<div id="SRResults"></div>
<div class="SRStatus" id="Loading">Loading...</div>
<div class="SRStatus" id="Searching">Searching...</div>
<div class="SRStatus" id="NoMatches">No Matches</div>
</div>
</div>
</div>
</div>

<div id="nav-path" class="navpath">
  <ul>
<li class="navelem"><a class="el" href="namespacedyno.html">dyno</a></li><li class="navelem"><a class="el" href="classdyno_1_1FeatureTracker.html">FeatureTracker</a></li>  </ul>
</div>
</div><!-- top -->
<div class="header">
  <div class="summary">
<a href="#pub-methods">Public Member Functions</a> &#124;
<a href="#pro-methods">Protected Member Functions</a> &#124;
<a href="#pri-methods">Private Member Functions</a> &#124;
<a href="#pri-attribs">Private Attributes</a> &#124;
<a href="classdyno_1_1FeatureTracker-members.html">List of all members</a>  </div>
  <div class="headertitle"><div class="title">dyno::FeatureTracker Class Reference</div></div>
</div><!--header-->
<div class="contents">

<p><a class="el" href="classdyno_1_1Feature.html" title="2D tracking and id information for a feature observation at a single frame.">Feature</a> detector that combines sparse static feature detection and tracking with dense feature detection and tracking on dynamic objects.  
 <a href="classdyno_1_1FeatureTracker.html#details">More...</a></p>

<p><code>#include &lt;<a class="el" href="FeatureTracker_8hpp_source.html">FeatureTracker.hpp</a>&gt;</code></p>
<div class="dynheader">
Inheritance diagram for dyno::FeatureTracker:</div>
<div class="dyncontent">
<div class="center"><img src="classdyno_1_1FeatureTracker__inherit__graph.png" border="0" usemap="#adyno_1_1FeatureTracker_inherit__map" alt="Inheritance graph"/></div>
<map name="adyno_1_1FeatureTracker_inherit__map" id="adyno_1_1FeatureTracker_inherit__map">
<area shape="rect" title="Feature detector that combines sparse static feature detection and tracking with dense feature detect..." alt="" coords="21,79,179,104"/>
<area shape="rect" href="classdyno_1_1FeatureTrackerBase.html" title=" " alt="" coords="5,5,195,31"/>
</map>
<center><span class="legend">[<a href="graph_legend.html">legend</a>]</span></center></div>
<div class="dynheader">
Collaboration diagram for dyno::FeatureTracker:</div>
<div class="dyncontent">
<div class="center"><img src="classdyno_1_1FeatureTracker__coll__graph.png" border="0" usemap="#adyno_1_1FeatureTracker_coll__map" alt="Collaboration graph"/></div>
<map name="adyno_1_1FeatureTracker_coll__map" id="adyno_1_1FeatureTracker_coll__map">
<area shape="rect" title="Feature detector that combines sparse static feature detection and tracking with dense feature detect..." alt="" coords="1225,295,1383,321"/>
<area shape="rect" href="classdyno_1_1FeatureTrackerBase.html" title=" " alt="" coords="865,295,1055,321"/>
<area shape="rect" href="structdyno_1_1TrackerParams.html" title="Params for the feature tracker but also the feature detector." alt="" coords="469,295,625,321"/>
<area shape="rect" href="structdyno_1_1FrontendParams.html" title=" " alt="" coords="877,181,1043,206"/>
<area shape="rect" href="structdyno_1_1TrackerParams_1_1AnmsParams.html" title=" " alt="" coords="33,215,189,255"/>
<area shape="rect" href="structdyno_1_1TrackerParams_1_1SubPixelCornerRefinementParams.html" title=" " alt="" coords="10,279,213,334"/>
<area shape="rect" href="structdyno_1_1TrackerParams_1_1GFFTParams.html" title=" " alt="" coords="33,359,189,399"/>
<area shape="rect" href="structdyno_1_1TrackerParams_1_1OrbParams.html" title=" " alt="" coords="33,423,189,463"/>
<area shape="rect" href="classThreadsafeQueue.html" title=" " alt="" coords="459,415,634,441"/>
<area shape="rect" href="classThreadsafeQueueBase.html" title=" " alt="" coords="8,487,215,513"/>
<area shape="rect" href="structdyno_1_1ObjectMotionSovlerF2F_1_1Params.html" title=" " alt="" coords="451,91,642,131"/>
<area shape="rect" href="structdyno_1_1EgoMotionSolver_1_1Params.html" title=" " alt="" coords="25,23,197,63"/>
<area shape="rect" href="structdyno_1_1OpticalFlowAndPoseOptimizer_1_1Params.html" title=" " alt="" coords="14,87,209,127"/>
<area shape="rect" href="structdyno_1_1MotionOnlyRefinementOptimizer_1_1Params.html" title=" " alt="" coords="5,151,217,191"/>
<area shape="rect" href="classdyno_1_1ImageTracksParams.html" title="Parameter struct to control the visualisation for FeatureTrackerBase::computeImageTracks." alt="" coords="451,155,643,181"/>
<area shape="rect" href="structdyno_1_1ImuParams.html" title=" " alt="" coords="479,205,614,230"/>
<area shape="rect" href="structdyno_1_1FeatureTrackerInfo.html" title=" " alt="" coords="869,345,1051,370"/>
</map>
<center><span class="legend">[<a href="graph_legend.html">legend</a>]</span></center></div>
<table class="memberdecls">
<tr class="heading"><td colspan="2"><h2 class="groupheader"><a id="pub-methods" name="pub-methods"></a>
Public Member Functions</h2></td></tr>
<tr class="memitem:aa1858ceb580cb42aff98e3b57bfe9303"><td class="memItemLeft" align="right" valign="top">&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classdyno_1_1FeatureTracker.html#aa1858ceb580cb42aff98e3b57bfe9303">FeatureTracker</a> (const <a class="el" href="structdyno_1_1FrontendParams.html">FrontendParams</a> &amp;params, Camera::Ptr camera, <a class="el" href="namespacedyno.html#a6cc0b19d1d56a213497e94a199888977">ImageDisplayQueue</a> *display_queue=nullptr)</td></tr>
<tr class="separator:aa1858ceb580cb42aff98e3b57bfe9303"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:acb13ec41bfc2870bdb80ad43eaef4009"><td class="memItemLeft" align="right" valign="top">virtual&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classdyno_1_1FeatureTracker.html#acb13ec41bfc2870bdb80ad43eaef4009">~FeatureTracker</a> ()</td></tr>
<tr class="separator:acb13ec41bfc2870bdb80ad43eaef4009"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a40ee79c94fe2de7f16d2a4508cc2ba11"><td class="memItemLeft" align="right" valign="top">Frame::Ptr&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classdyno_1_1FeatureTracker.html#a40ee79c94fe2de7f16d2a4508cc2ba11">track</a> (<a class="el" href="namespacedyno.html#ac4303d6fafb755f794b072d76f9cfb41">FrameId</a> frame_id, <a class="el" href="namespacedyno.html#a7fda67c0575c4b7a8210dcc8ae227370">Timestamp</a> timestamp, const <a class="el" href="classdyno_1_1ImageContainer.html">ImageContainer</a> &amp;image_container, const std::optional&lt; gtsam::Rot3 &gt; &amp;R_km1_k={})</td></tr>
<tr class="separator:a40ee79c94fe2de7f16d2a4508cc2ba11"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a31f607c5d1fca4c1ace6af223abb5ead"><td class="memItemLeft" align="right" valign="top">bool&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classdyno_1_1FeatureTracker.html#a31f607c5d1fca4c1ace6af223abb5ead">stereoTrack</a> (<a class="el" href="namespacedyno.html#aa17f60b0d2c3c01070964846f940f60c">FeaturePtrs</a> &amp;stereo_features, <a class="el" href="classdyno_1_1FeatureContainer.html">FeatureContainer</a> &amp;left_features, const cv::Mat &amp;left_image, const cv::Mat &amp;right_image, const double &amp;virtual_baseline) const</td></tr>
<tr class="separator:a31f607c5d1fca4c1ace6af223abb5ead"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a96eacfcb1a94b8061bb8bde6926c889c"><td class="memItemLeft" align="right" valign="top">Frame::Ptr&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classdyno_1_1FeatureTracker.html#a96eacfcb1a94b8061bb8bde6926c889c">getPreviousFrame</a> ()</td></tr>
<tr class="memdesc:a96eacfcb1a94b8061bb8bde6926c889c"><td class="mdescLeft">&#160;</td><td class="mdescRight">Get the previous frame.  <br /></td></tr>
<tr class="separator:a96eacfcb1a94b8061bb8bde6926c889c"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ae6e26766be0549fd5b4b00854ee50105"><td class="memItemLeft" align="right" valign="top">const Frame::ConstPtr&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classdyno_1_1FeatureTracker.html#ae6e26766be0549fd5b4b00854ee50105">getPreviousFrame</a> () const</td></tr>
<tr class="separator:ae6e26766be0549fd5b4b00854ee50105"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a229eaa06426b3f43ee471b01ba9eb900"><td class="memItemLeft" align="right" valign="top">Frame::Ptr&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classdyno_1_1FeatureTracker.html#a229eaa06426b3f43ee471b01ba9eb900">getCurrentFrame</a> ()</td></tr>
<tr class="memdesc:a229eaa06426b3f43ee471b01ba9eb900"><td class="mdescLeft">&#160;</td><td class="mdescRight">Get the most recent frame that has been tracked. After a call to track, this will be the frame that is returned and will track features between <a class="el" href="classdyno_1_1FeatureTracker.html#a96eacfcb1a94b8061bb8bde6926c889c" title="Get the previous frame.">getPreviousFrame()</a> to this frame.  <br /></td></tr>
<tr class="separator:a229eaa06426b3f43ee471b01ba9eb900"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:aa7019643454cc8a78295fea4dd65002b"><td class="memItemLeft" align="right" valign="top">const <a class="el" href="structdyno_1_1FeatureTrackerInfo.html">FeatureTrackerInfo</a> &amp;&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classdyno_1_1FeatureTracker.html#aa7019643454cc8a78295fea4dd65002b">getTrackerInfo</a> ()</td></tr>
<tr class="separator:aa7019643454cc8a78295fea4dd65002b"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:aa27ff1b23b609807f027b1d19edfe66f"><td class="memItemLeft" align="right" valign="top">const cv::Mat &amp;&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classdyno_1_1FeatureTracker.html#aa27ff1b23b609807f027b1d19edfe66f">getBoarderDetectionMask</a> () const</td></tr>
<tr class="separator:aa27ff1b23b609807f027b1d19edfe66f"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="inherit_header pub_methods_classdyno_1_1FeatureTrackerBase"><td colspan="2" onclick="javascript:toggleInherit('pub_methods_classdyno_1_1FeatureTrackerBase')"><img src="closed.png" alt="-"/>&#160;Public Member Functions inherited from <a class="el" href="classdyno_1_1FeatureTrackerBase.html">dyno::FeatureTrackerBase</a></td></tr>
<tr class="memitem:a4e2f1808b0a97e128df8f7a6695161d5 inherit pub_methods_classdyno_1_1FeatureTrackerBase"><td class="memItemLeft" align="right" valign="top">&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classdyno_1_1FeatureTrackerBase.html#a4e2f1808b0a97e128df8f7a6695161d5">FeatureTrackerBase</a> (const <a class="el" href="structdyno_1_1TrackerParams.html">TrackerParams</a> &amp;params, Camera::Ptr camera, <a class="el" href="namespacedyno.html#a6cc0b19d1d56a213497e94a199888977">ImageDisplayQueue</a> *display_queue)</td></tr>
<tr class="separator:a4e2f1808b0a97e128df8f7a6695161d5 inherit pub_methods_classdyno_1_1FeatureTrackerBase"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:aa902950650699301214f776a905e3b77 inherit pub_methods_classdyno_1_1FeatureTrackerBase"><td class="memItemLeft" align="right" valign="top">cv::Mat&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classdyno_1_1FeatureTrackerBase.html#aa902950650699301214f776a905e3b77">computeImageTracks</a> (const <a class="el" href="classdyno_1_1Frame.html">Frame</a> &amp;previous_frame, const <a class="el" href="classdyno_1_1Frame.html">Frame</a> &amp;current_frame, const <a class="el" href="classdyno_1_1ImageTracksParams.html">ImageTracksParams</a> &amp;config=false) const</td></tr>
<tr class="separator:aa902950650699301214f776a905e3b77 inherit pub_methods_classdyno_1_1FeatureTrackerBase"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a4e9b9b77752d80d8bb8c2236776ca5a8 inherit pub_methods_classdyno_1_1FeatureTrackerBase"><td class="memItemLeft" align="right" valign="top">bool&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classdyno_1_1FeatureTrackerBase.html#a4e9b9b77752d80d8bb8c2236776ca5a8">drawStereoMatches</a> (cv::Mat &amp;output_image, const <a class="el" href="classdyno_1_1Frame.html">Frame</a> &amp;current_frame) const</td></tr>
<tr class="separator:a4e9b9b77752d80d8bb8c2236776ca5a8 inherit pub_methods_classdyno_1_1FeatureTrackerBase"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:aac4fd637116f1a55b857968d6f84d33d inherit pub_methods_classdyno_1_1FeatureTrackerBase"><td class="memItemLeft" align="right" valign="top">bool&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classdyno_1_1FeatureTrackerBase.html#aac4fd637116f1a55b857968d6f84d33d">predictKeypointsGivenRotation</a> (std::vector&lt; cv::Point2f &gt; &amp;predicted_pts_k, const std::vector&lt; cv::Point2f &gt; &amp;pts_km1, const gtsam::Rot3 &amp;R_km1_k) const</td></tr>
<tr class="separator:aac4fd637116f1a55b857968d6f84d33d inherit pub_methods_classdyno_1_1FeatureTrackerBase"><td class="memSeparator" colspan="2">&#160;</td></tr>
</table><table class="memberdecls">
<tr class="heading"><td colspan="2"><h2 class="groupheader"><a id="pro-methods" name="pro-methods"></a>
Protected Member Functions</h2></td></tr>
<tr class="memitem:a145614fe29bef7728075492870ac9c41"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classdyno_1_1FeatureTracker.html#a145614fe29bef7728075492870ac9c41">trackDynamic</a> (<a class="el" href="namespacedyno.html#ac4303d6fafb755f794b072d76f9cfb41">FrameId</a> frame_id, const <a class="el" href="classdyno_1_1ImageContainer.html">ImageContainer</a> &amp;image_container, <a class="el" href="classdyno_1_1FeatureContainer.html">FeatureContainer</a> &amp;dynamic_features, std::set&lt; <a class="el" href="namespacedyno.html#a38bb86e4154b86428b8d133be03fb2b5">ObjectId</a> &gt; &amp;object_keyframes, const <a class="el" href="structdyno_1_1vision__tools_1_1ObjectBoundaryMaskResult.html">vision_tools::ObjectBoundaryMaskResult</a> &amp;boundary_mask_result)</td></tr>
<tr class="separator:a145614fe29bef7728075492870ac9c41"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a4796a29c1f89cde0ace1668fc8fcd9a3"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classdyno_1_1FeatureTracker.html#a4796a29c1f89cde0ace1668fc8fcd9a3">trackDynamicKLT</a> (<a class="el" href="namespacedyno.html#ac4303d6fafb755f794b072d76f9cfb41">FrameId</a> frame_id, const <a class="el" href="classdyno_1_1ImageContainer.html">ImageContainer</a> &amp;image_container, <a class="el" href="classdyno_1_1FeatureContainer.html">FeatureContainer</a> &amp;dynamic_features, std::set&lt; <a class="el" href="namespacedyno.html#a38bb86e4154b86428b8d133be03fb2b5">ObjectId</a> &gt; &amp;object_keyframes, const <a class="el" href="structdyno_1_1vision__tools_1_1ObjectBoundaryMaskResult.html">vision_tools::ObjectBoundaryMaskResult</a> &amp;boundary_mask_result)</td></tr>
<tr class="separator:a4796a29c1f89cde0ace1668fc8fcd9a3"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:af6093d870bad67d12dee0c9cb913f87c"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classdyno_1_1FeatureTracker.html#af6093d870bad67d12dee0c9cb913f87c">sampleDynamic</a> (<a class="el" href="namespacedyno.html#ac4303d6fafb755f794b072d76f9cfb41">FrameId</a> frame_id, const <a class="el" href="classdyno_1_1ImageContainer.html">ImageContainer</a> &amp;image_container, const std::set&lt; <a class="el" href="namespacedyno.html#a38bb86e4154b86428b8d133be03fb2b5">ObjectId</a> &gt; &amp;objects_to_sample, <a class="el" href="classdyno_1_1FeatureContainer.html">FeatureContainer</a> &amp;dynamic_features, std::set&lt; <a class="el" href="namespacedyno.html#a38bb86e4154b86428b8d133be03fb2b5">ObjectId</a> &gt; &amp;objects_sampled, const cv::Mat &amp;detection_mask)</td></tr>
<tr class="separator:af6093d870bad67d12dee0c9cb913f87c"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ab50422938e62bccc34295c155357213a"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classdyno_1_1FeatureTracker.html#ab50422938e62bccc34295c155357213a">requiresSampling</a> (std::set&lt; <a class="el" href="namespacedyno.html#a38bb86e4154b86428b8d133be03fb2b5">ObjectId</a> &gt; &amp;objects_to_sample, const <a class="el" href="structdyno_1_1FeatureTrackerInfo.html">FeatureTrackerInfo</a> &amp;info, const <a class="el" href="classdyno_1_1ImageContainer.html">ImageContainer</a> &amp;image_container, const gtsam::FastMap&lt; <a class="el" href="namespacedyno.html#a38bb86e4154b86428b8d133be03fb2b5">ObjectId</a>, <a class="el" href="classdyno_1_1FeatureContainer.html">FeatureContainer</a> &gt; &amp;features_per_object, const <a class="el" href="structdyno_1_1vision__tools_1_1ObjectBoundaryMaskResult.html">vision_tools::ObjectBoundaryMaskResult</a> &amp;boundary_mask_result, const cv::Mat &amp;dynamic_tracking_mask) const</td></tr>
<tr class="memdesc:ab50422938e62bccc34295c155357213a"><td class="mdescLeft">&#160;</td><td class="mdescRight">Check which objects require new features to be detected on them based on a set of 'keyframing' criteria.  <br /></td></tr>
<tr class="separator:ab50422938e62bccc34295c155357213a"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a7877773d1c6d5b9cef0c379cd701c1e4"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classdyno_1_1FeatureTracker.html#a7877773d1c6d5b9cef0c379cd701c1e4">propogateMask</a> (<a class="el" href="classdyno_1_1ImageContainer.html">ImageContainer</a> &amp;image_container)</td></tr>
<tr class="separator:a7877773d1c6d5b9cef0c379cd701c1e4"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="inherit_header pro_methods_classdyno_1_1FeatureTrackerBase"><td colspan="2" onclick="javascript:toggleInherit('pro_methods_classdyno_1_1FeatureTrackerBase')"><img src="closed.png" alt="-"/>&#160;Protected Member Functions inherited from <a class="el" href="classdyno_1_1FeatureTrackerBase.html">dyno::FeatureTrackerBase</a></td></tr>
<tr class="memitem:a32d80be7e74a096c2b816529b7fd2c69 inherit pro_methods_classdyno_1_1FeatureTrackerBase"><td class="memItemLeft" align="right" valign="top">bool&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classdyno_1_1FeatureTrackerBase.html#a32d80be7e74a096c2b816529b7fd2c69">isWithinShrunkenImage</a> (const <a class="el" href="namespacedyno.html#aaa260a8022691078c59e1ac6a4fa05b5">Keypoint</a> &amp;kp) const</td></tr>
<tr class="memdesc:a32d80be7e74a096c2b816529b7fd2c69 inherit pro_methods_classdyno_1_1FeatureTrackerBase"><td class="mdescLeft">&#160;</td><td class="mdescRight">Checks if a keypoint is within an image, taking into account the shrink row/col values in the params. If these values are zero, it just checks that the keypoint is within the image size, as given by the camera parameters.  <br /></td></tr>
<tr class="separator:a32d80be7e74a096c2b816529b7fd2c69 inherit pro_methods_classdyno_1_1FeatureTrackerBase"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:af4e17d3f13305f40698a9b284d767c74 inherit pro_methods_classdyno_1_1FeatureTrackerBase"><td class="memItemLeft" align="right" valign="top">bool&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classdyno_1_1FeatureTrackerBase.html#af4e17d3f13305f40698a9b284d767c74">isWithinShrunkenImage</a> (const cv::Point2f &amp;kp) const</td></tr>
<tr class="separator:af4e17d3f13305f40698a9b284d767c74 inherit pro_methods_classdyno_1_1FeatureTrackerBase"><td class="memSeparator" colspan="2">&#160;</td></tr>
</table><table class="memberdecls">
<tr class="heading"><td colspan="2"><h2 class="groupheader"><a id="pri-methods" name="pri-methods"></a>
Private Member Functions</h2></td></tr>
<tr class="memitem:aa6e3d79ddd4fc72062ea58d8211a50b2"><td class="memItemLeft" align="right" valign="top">bool&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classdyno_1_1FeatureTracker.html#aa6e3d79ddd4fc72062ea58d8211a50b2">objectDetection</a> (<a class="el" href="structdyno_1_1vision__tools_1_1ObjectBoundaryMaskResult.html">vision_tools::ObjectBoundaryMaskResult</a> &amp;boundary_mask_result, <a class="el" href="classdyno_1_1ImageContainer.html">ImageContainer</a> &amp;image_container)</td></tr>
<tr class="separator:aa6e3d79ddd4fc72062ea58d8211a50b2"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a4b00e3f3f20471946b2a5e224b0d0512"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classdyno_1_1FeatureTracker.html#a4b00e3f3f20471946b2a5e224b0d0512">computeImageBounds</a> (const cv::Size &amp;size, int &amp;min_x, int &amp;max_x, int &amp;min_y, int &amp;max_y) const</td></tr>
<tr class="separator:a4b00e3f3f20471946b2a5e224b0d0512"><td class="memSeparator" colspan="2">&#160;</td></tr>
</table><table class="memberdecls">
<tr class="heading"><td colspan="2"><h2 class="groupheader"><a id="pri-attribs" name="pri-attribs"></a>
Private Attributes</h2></td></tr>
<tr class="memitem:ade60e243c668c32f13e16fb22f45458a"><td class="memItemLeft" align="right" valign="top">const <a class="el" href="structdyno_1_1FrontendParams.html">FrontendParams</a>&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classdyno_1_1FeatureTracker.html#ade60e243c668c32f13e16fb22f45458a">frontend_params_</a></td></tr>
<tr class="separator:ade60e243c668c32f13e16fb22f45458a"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a879d0cd574b194e89bffbe05f85c23fc"><td class="memItemLeft" align="right" valign="top">Frame::Ptr&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classdyno_1_1FeatureTracker.html#a879d0cd574b194e89bffbe05f85c23fc">previous_frame_</a></td></tr>
<tr class="separator:a879d0cd574b194e89bffbe05f85c23fc"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a674be7a497efeed1cf90fe3ae44c86d7"><td class="memItemLeft" align="right" valign="top">Frame::Ptr&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classdyno_1_1FeatureTracker.html#a674be7a497efeed1cf90fe3ae44c86d7">previous_tracked_frame_</a></td></tr>
<tr class="separator:a674be7a497efeed1cf90fe3ae44c86d7"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a1ab92bdc22dc50575b8395b4adfae0c1"><td class="memItemLeft" align="right" valign="top">StaticFeatureTracker::UniquePtr&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classdyno_1_1FeatureTracker.html#a1ab92bdc22dc50575b8395b4adfae0c1">static_feature_tracker_</a></td></tr>
<tr class="separator:a1ab92bdc22dc50575b8395b4adfae0c1"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a3cace3a01a3ef42dcfcff3799a789c54"><td class="memItemLeft" align="right" valign="top">cv::Mat&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classdyno_1_1FeatureTracker.html#a3cace3a01a3ef42dcfcff3799a789c54">boarder_detection_mask_</a></td></tr>
<tr class="separator:a3cace3a01a3ef42dcfcff3799a789c54"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:aaf08b9f655f94c59eadf15564f2e69f3"><td class="memItemLeft" align="right" valign="top"><a class="el" href="structdyno_1_1FeatureTrackerInfo.html">FeatureTrackerInfo</a>&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classdyno_1_1FeatureTracker.html#aaf08b9f655f94c59eadf15564f2e69f3">info_</a></td></tr>
<tr class="separator:aaf08b9f655f94c59eadf15564f2e69f3"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a0484d7f8c41021d4e8435caa579af71e"><td class="memItemLeft" align="right" valign="top">bool&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classdyno_1_1FeatureTracker.html#a0484d7f8c41021d4e8435caa579af71e">initial_computation_</a> {true}</td></tr>
<tr class="separator:a0484d7f8c41021d4e8435caa579af71e"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a6310d9416f4c7485740ccc80b9a9732a"><td class="memItemLeft" align="right" valign="top">cv::Ptr&lt; cv::cuda::SparsePyrLKOpticalFlow &gt;&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classdyno_1_1FeatureTracker.html#a6310d9416f4c7485740ccc80b9a9732a">lk_cuda_tracker_</a></td></tr>
<tr class="separator:a6310d9416f4c7485740ccc80b9a9732a"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a36557c1362b705513be73dd2b5fd1ded"><td class="memItemLeft" align="right" valign="top">ObjectDetectionEngine::Ptr&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classdyno_1_1FeatureTracker.html#a36557c1362b705513be73dd2b5fd1ded">object_detection_</a></td></tr>
<tr class="separator:a36557c1362b705513be73dd2b5fd1ded"><td class="memSeparator" colspan="2">&#160;</td></tr>
</table><table class="memberdecls">
<tr class="heading"><td colspan="2"><h2 class="groupheader"><a id="inherited" name="inherited"></a>
Additional Inherited Members</h2></td></tr>
<tr class="inherit_header pro_attribs_classdyno_1_1FeatureTrackerBase"><td colspan="2" onclick="javascript:toggleInherit('pro_attribs_classdyno_1_1FeatureTrackerBase')"><img src="closed.png" alt="-"/>&#160;Protected Attributes inherited from <a class="el" href="classdyno_1_1FeatureTrackerBase.html">dyno::FeatureTrackerBase</a></td></tr>
<tr class="memitem:a04f0948954381269fedd5a6856662cb7 inherit pro_attribs_classdyno_1_1FeatureTrackerBase"><td class="memItemLeft" align="right" valign="top">const <a class="el" href="structdyno_1_1TrackerParams.html">TrackerParams</a>&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classdyno_1_1FeatureTrackerBase.html#a04f0948954381269fedd5a6856662cb7">params_</a></td></tr>
<tr class="separator:a04f0948954381269fedd5a6856662cb7 inherit pro_attribs_classdyno_1_1FeatureTrackerBase"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a23d0ec748366b789be491e61e536839c inherit pro_attribs_classdyno_1_1FeatureTrackerBase"><td class="memItemLeft" align="right" valign="top">const cv::Size&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classdyno_1_1FeatureTrackerBase.html#a23d0ec748366b789be491e61e536839c">img_size_</a></td></tr>
<tr class="separator:a23d0ec748366b789be491e61e536839c inherit pro_attribs_classdyno_1_1FeatureTrackerBase"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:abf6eba19baf18b1c3648347401c15a56 inherit pro_attribs_classdyno_1_1FeatureTrackerBase"><td class="memItemLeft" align="right" valign="top">Camera::Ptr&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classdyno_1_1FeatureTrackerBase.html#abf6eba19baf18b1c3648347401c15a56">camera_</a></td></tr>
<tr class="memdesc:abf6eba19baf18b1c3648347401c15a56 inherit pro_attribs_classdyno_1_1FeatureTrackerBase"><td class="mdescLeft">&#160;</td><td class="mdescRight">Expected image size from the camera.  <br /></td></tr>
<tr class="separator:abf6eba19baf18b1c3648347401c15a56 inherit pro_attribs_classdyno_1_1FeatureTrackerBase"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a26a7bdd81c43eb39b8578403f9c7a9d2 inherit pro_attribs_classdyno_1_1FeatureTrackerBase"><td class="memItemLeft" align="right" valign="top"><a class="el" href="namespacedyno.html#a6cc0b19d1d56a213497e94a199888977">ImageDisplayQueue</a> *&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classdyno_1_1FeatureTrackerBase.html#a26a7bdd81c43eb39b8578403f9c7a9d2">display_queue_</a></td></tr>
<tr class="separator:a26a7bdd81c43eb39b8578403f9c7a9d2 inherit pro_attribs_classdyno_1_1FeatureTrackerBase"><td class="memSeparator" colspan="2">&#160;</td></tr>
</table>
<a name="details" id="details"></a><h2 class="groupheader">Detailed Description</h2>
<div class="textblock"><p><a class="el" href="classdyno_1_1Feature.html" title="2D tracking and id information for a feature observation at a single frame.">Feature</a> detector that combines sparse static feature detection and tracking with dense feature detection and tracking on dynamic objects. </p>

<p class="definition">Definition at line <a class="el" href="FeatureTracker_8hpp_source.html#l00054">54</a> of file <a class="el" href="FeatureTracker_8hpp_source.html">FeatureTracker.hpp</a>.</p>
</div><h2 class="groupheader">Constructor &amp; Destructor Documentation</h2>
<a id="aa1858ceb580cb42aff98e3b57bfe9303" name="aa1858ceb580cb42aff98e3b57bfe9303"></a>
<h2 class="memtitle"><span class="permalink"><a href="#aa1858ceb580cb42aff98e3b57bfe9303">&#9670;&#160;</a></span>FeatureTracker()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">dyno::FeatureTracker::FeatureTracker </td>
          <td>(</td>
          <td class="paramtype">const <a class="el" href="structdyno_1_1FrontendParams.html">FrontendParams</a> &amp;&#160;</td>
          <td class="paramname"><em>params</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">Camera::Ptr&#160;</td>
          <td class="paramname"><em>camera</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="namespacedyno.html#a6cc0b19d1d56a213497e94a199888977">ImageDisplayQueue</a> *&#160;</td>
          <td class="paramname"><em>display_queue</em> = <code>nullptr</code>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="FeatureTracker_8cc_source.html#l00050">50</a> of file <a class="el" href="FeatureTracker_8cc_source.html">FeatureTracker.cc</a>.</p>
<div class="fragment"><div class="line"><span class="lineno">   52</span>    : <a class="code hl_function" href="classdyno_1_1FeatureTrackerBase.html#a4e2f1808b0a97e128df8f7a6695161d5">FeatureTrackerBase</a>(params.tracker_params, camera, display_queue),</div>
<div class="line"><span class="lineno">   53</span>      <a class="code hl_variable" href="classdyno_1_1FeatureTracker.html#ade60e243c668c32f13e16fb22f45458a">frontend_params_</a>(params) {</div>
<div class="line"><span class="lineno">   54</span>  <a class="code hl_variable" href="classdyno_1_1FeatureTracker.html#a1ab92bdc22dc50575b8395b4adfae0c1">static_feature_tracker_</a> = std::make_unique&lt;KltFeatureTracker&gt;(</div>
<div class="line"><span class="lineno">   55</span>      params.tracker_params, camera, display_queue);</div>
<div class="line"><span class="lineno">   56</span>  CHECK(!<a class="code hl_variable" href="classdyno_1_1FeatureTrackerBase.html#a23d0ec748366b789be491e61e536839c">img_size_</a>.empty());</div>
<div class="line"><span class="lineno">   57</span> </div>
<div class="line"><span class="lineno">   58</span>  <span class="keyword">static</span> <span class="keyword">const</span> cv::Size klt_window_size(21, 21);  <span class="comment">// Window size for KLT</span></div>
<div class="line"><span class="lineno">   59</span>  <span class="keyword">static</span> <span class="keyword">const</span> <span class="keywordtype">int</span> klt_max_level = 3;             <span class="comment">// Max pyramid levels for KLT</span></div>
<div class="line"><span class="lineno">   60</span>  <a class="code hl_variable" href="classdyno_1_1FeatureTracker.html#a6310d9416f4c7485740ccc80b9a9732a">lk_cuda_tracker_</a> = cv::cuda::SparsePyrLKOpticalFlow::create(</div>
<div class="line"><span class="lineno">   61</span>      klt_window_size, klt_max_level, 30);</div>
<div class="line"><span class="lineno">   62</span> </div>
<div class="line"><span class="lineno">   63</span>  <span class="keywordflow">if</span> (!<a class="code hl_variable" href="classdyno_1_1FeatureTrackerBase.html#a04f0948954381269fedd5a6856662cb7">params_</a>.<a class="code hl_variable" href="structdyno_1_1TrackerParams.html#aa1ca252f62bd7adeaedc35e76a03be62">prefer_provided_object_detection</a>) {</div>
<div class="line"><span class="lineno">   64</span>    LOG(INFO) &lt;&lt; <span class="stringliteral">&quot;Creating object detection engine&quot;</span>;</div>
<div class="line"><span class="lineno">   65</span>    <a class="code hl_struct" href="structdyno_1_1YoloConfig.html">dyno::YoloConfig</a> yolo_config;</div>
<div class="line"><span class="lineno">   66</span>    <a class="code hl_struct" href="structdyno_1_1ModelConfig.html">dyno::ModelConfig</a> model_config;</div>
<div class="line"><span class="lineno">   67</span>    model_config.<a class="code hl_variable" href="structdyno_1_1ModelConfig.html#a605d2bcacbc941b8d51570d7e9ac352b">model_file</a> = <span class="stringliteral">&quot;yolov8n-seg.pt&quot;</span>;</div>
<div class="line"><span class="lineno">   68</span>    <a class="code hl_variable" href="classdyno_1_1FeatureTracker.html#a36557c1362b705513be73dd2b5fd1ded">object_detection_</a> =</div>
<div class="line"><span class="lineno">   69</span>        std::make_shared&lt;dyno::YoloV8ObjectDetector&gt;(model_config, yolo_config);</div>
<div class="line"><span class="lineno">   70</span>  }</div>
<div class="line"><span class="lineno">   71</span>}</div>
<div class="ttc" id="aclassdyno_1_1FeatureTrackerBase_html_a04f0948954381269fedd5a6856662cb7"><div class="ttname"><a href="classdyno_1_1FeatureTrackerBase.html#a04f0948954381269fedd5a6856662cb7">dyno::FeatureTrackerBase::params_</a></div><div class="ttdeci">const TrackerParams params_</div><div class="ttdef"><b>Definition:</b> <a href="FeatureTrackerBase_8hpp_source.html#l00173">FeatureTrackerBase.hpp:173</a></div></div>
<div class="ttc" id="aclassdyno_1_1FeatureTrackerBase_html_a23d0ec748366b789be491e61e536839c"><div class="ttname"><a href="classdyno_1_1FeatureTrackerBase.html#a23d0ec748366b789be491e61e536839c">dyno::FeatureTrackerBase::img_size_</a></div><div class="ttdeci">const cv::Size img_size_</div><div class="ttdef"><b>Definition:</b> <a href="FeatureTrackerBase_8hpp_source.html#l00174">FeatureTrackerBase.hpp:174</a></div></div>
<div class="ttc" id="aclassdyno_1_1FeatureTrackerBase_html_a4e2f1808b0a97e128df8f7a6695161d5"><div class="ttname"><a href="classdyno_1_1FeatureTrackerBase.html#a4e2f1808b0a97e128df8f7a6695161d5">dyno::FeatureTrackerBase::FeatureTrackerBase</a></div><div class="ttdeci">FeatureTrackerBase(const TrackerParams &amp;params, Camera::Ptr camera, ImageDisplayQueue *display_queue)</div><div class="ttdef"><b>Definition:</b> <a href="FeatureTrackerBase_8cc_source.html#l00042">FeatureTrackerBase.cc:42</a></div></div>
<div class="ttc" id="aclassdyno_1_1FeatureTracker_html_a1ab92bdc22dc50575b8395b4adfae0c1"><div class="ttname"><a href="classdyno_1_1FeatureTracker.html#a1ab92bdc22dc50575b8395b4adfae0c1">dyno::FeatureTracker::static_feature_tracker_</a></div><div class="ttdeci">StaticFeatureTracker::UniquePtr static_feature_tracker_</div><div class="ttdef"><b>Definition:</b> <a href="FeatureTracker_8hpp_source.html#l00165">FeatureTracker.hpp:165</a></div></div>
<div class="ttc" id="aclassdyno_1_1FeatureTracker_html_a36557c1362b705513be73dd2b5fd1ded"><div class="ttname"><a href="classdyno_1_1FeatureTracker.html#a36557c1362b705513be73dd2b5fd1ded">dyno::FeatureTracker::object_detection_</a></div><div class="ttdeci">ObjectDetectionEngine::Ptr object_detection_</div><div class="ttdef"><b>Definition:</b> <a href="FeatureTracker_8hpp_source.html#l00177">FeatureTracker.hpp:177</a></div></div>
<div class="ttc" id="aclassdyno_1_1FeatureTracker_html_a6310d9416f4c7485740ccc80b9a9732a"><div class="ttname"><a href="classdyno_1_1FeatureTracker.html#a6310d9416f4c7485740ccc80b9a9732a">dyno::FeatureTracker::lk_cuda_tracker_</a></div><div class="ttdeci">cv::Ptr&lt; cv::cuda::SparsePyrLKOpticalFlow &gt; lk_cuda_tracker_</div><div class="ttdef"><b>Definition:</b> <a href="FeatureTracker_8hpp_source.html#l00176">FeatureTracker.hpp:176</a></div></div>
<div class="ttc" id="aclassdyno_1_1FeatureTracker_html_ade60e243c668c32f13e16fb22f45458a"><div class="ttname"><a href="classdyno_1_1FeatureTracker.html#ade60e243c668c32f13e16fb22f45458a">dyno::FeatureTracker::frontend_params_</a></div><div class="ttdeci">const FrontendParams frontend_params_</div><div class="ttdef"><b>Definition:</b> <a href="FeatureTracker_8hpp_source.html#l00157">FeatureTracker.hpp:157</a></div></div>
<div class="ttc" id="astructdyno_1_1ModelConfig_html"><div class="ttname"><a href="structdyno_1_1ModelConfig.html">dyno::ModelConfig</a></div><div class="ttdef"><b>Definition:</b> <a href="ModelConfig_8hpp_source.html#l00025">ModelConfig.hpp:25</a></div></div>
<div class="ttc" id="astructdyno_1_1ModelConfig_html_a605d2bcacbc941b8d51570d7e9ac352b"><div class="ttname"><a href="structdyno_1_1ModelConfig.html#a605d2bcacbc941b8d51570d7e9ac352b">dyno::ModelConfig::model_file</a></div><div class="ttdeci">std::filesystem::path model_file</div><div class="ttdef"><b>Definition:</b> <a href="ModelConfig_8hpp_source.html#l00028">ModelConfig.hpp:28</a></div></div>
<div class="ttc" id="astructdyno_1_1TrackerParams_html_aa1ca252f62bd7adeaedc35e76a03be62"><div class="ttname"><a href="structdyno_1_1TrackerParams.html#aa1ca252f62bd7adeaedc35e76a03be62">dyno::TrackerParams::prefer_provided_object_detection</a></div><div class="ttdeci">bool prefer_provided_object_detection</div><div class="ttdef"><b>Definition:</b> <a href="TrackerParams_8hpp_source.html#l00126">TrackerParams.hpp:126</a></div></div>
<div class="ttc" id="astructdyno_1_1YoloConfig_html"><div class="ttname"><a href="structdyno_1_1YoloConfig.html">dyno::YoloConfig</a></div><div class="ttdef"><b>Definition:</b> <a href="YoloObjectDetector_8hpp_source.html#l00011">YoloObjectDetector.hpp:11</a></div></div>
</div><!-- fragment -->
<p class="reference">References <a class="el" href="classdyno_1_1FeatureTrackerBase.html#a23d0ec748366b789be491e61e536839c">dyno::FeatureTrackerBase::img_size_</a>, <a class="el" href="classdyno_1_1FeatureTracker.html#a6310d9416f4c7485740ccc80b9a9732a">lk_cuda_tracker_</a>, <a class="el" href="structdyno_1_1ModelConfig.html#a605d2bcacbc941b8d51570d7e9ac352b">dyno::ModelConfig::model_file</a>, <a class="el" href="classdyno_1_1FeatureTracker.html#a36557c1362b705513be73dd2b5fd1ded">object_detection_</a>, <a class="el" href="classdyno_1_1FeatureTrackerBase.html#a04f0948954381269fedd5a6856662cb7">dyno::FeatureTrackerBase::params_</a>, <a class="el" href="structdyno_1_1TrackerParams.html#aa1ca252f62bd7adeaedc35e76a03be62">dyno::TrackerParams::prefer_provided_object_detection</a>, <a class="el" href="classdyno_1_1FeatureTracker.html#a1ab92bdc22dc50575b8395b4adfae0c1">static_feature_tracker_</a>, and <a class="el" href="structdyno_1_1FrontendParams.html#a6a99c9f2ac61d71c11b4e1d07df3681c">dyno::FrontendParams::tracker_params</a>.</p>

</div>
</div>
<a id="acb13ec41bfc2870bdb80ad43eaef4009" name="acb13ec41bfc2870bdb80ad43eaef4009"></a>
<h2 class="memtitle"><span class="permalink"><a href="#acb13ec41bfc2870bdb80ad43eaef4009">&#9670;&#160;</a></span>~FeatureTracker()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">virtual dyno::FeatureTracker::~FeatureTracker </td>
          <td>(</td>
          <td class="paramname"></td><td>)</td>
          <td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">inline</span><span class="mlabel">virtual</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="FeatureTracker_8hpp_source.html#l00063">63</a> of file <a class="el" href="FeatureTracker_8hpp_source.html">FeatureTracker.hpp</a>.</p>
<div class="fragment"><div class="line"><span class="lineno">   63</span>{}</div>
</div><!-- fragment -->
</div>
</div>
<h2 class="groupheader">Member Function Documentation</h2>
<a id="a4b00e3f3f20471946b2a5e224b0d0512" name="a4b00e3f3f20471946b2a5e224b0d0512"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a4b00e3f3f20471946b2a5e224b0d0512">&#9670;&#160;</a></span>computeImageBounds()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">void dyno::FeatureTracker::computeImageBounds </td>
          <td>(</td>
          <td class="paramtype">const cv::Size &amp;&#160;</td>
          <td class="paramname"><em>size</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int &amp;&#160;</td>
          <td class="paramname"><em>min_x</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int &amp;&#160;</td>
          <td class="paramname"><em>max_x</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int &amp;&#160;</td>
          <td class="paramname"><em>min_y</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int &amp;&#160;</td>
          <td class="paramname"><em>max_y</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td> const</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">private</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

</div>
</div>
<a id="aa27ff1b23b609807f027b1d19edfe66f" name="aa27ff1b23b609807f027b1d19edfe66f"></a>
<h2 class="memtitle"><span class="permalink"><a href="#aa27ff1b23b609807f027b1d19edfe66f">&#9670;&#160;</a></span>getBoarderDetectionMask()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">const cv::Mat &amp; dyno::FeatureTracker::getBoarderDetectionMask </td>
          <td>(</td>
          <td class="paramname"></td><td>)</td>
          <td> const</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">inline</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="FeatureTracker_8hpp_source.html#l00099">99</a> of file <a class="el" href="FeatureTracker_8hpp_source.html">FeatureTracker.hpp</a>.</p>
<div class="fragment"><div class="line"><span class="lineno">   99</span>                                                      {</div>
<div class="line"><span class="lineno">  100</span>    <span class="keywordflow">return</span> <a class="code hl_variable" href="classdyno_1_1FeatureTracker.html#a3cace3a01a3ef42dcfcff3799a789c54">boarder_detection_mask_</a>;</div>
<div class="line"><span class="lineno">  101</span>  }</div>
<div class="ttc" id="aclassdyno_1_1FeatureTracker_html_a3cace3a01a3ef42dcfcff3799a789c54"><div class="ttname"><a href="classdyno_1_1FeatureTracker.html#a3cace3a01a3ef42dcfcff3799a789c54">dyno::FeatureTracker::boarder_detection_mask_</a></div><div class="ttdeci">cv::Mat boarder_detection_mask_</div><div class="ttdef"><b>Definition:</b> <a href="FeatureTracker_8hpp_source.html#l00168">FeatureTracker.hpp:168</a></div></div>
</div><!-- fragment -->
<p class="reference">References <a class="el" href="classdyno_1_1FeatureTracker.html#a3cace3a01a3ef42dcfcff3799a789c54">boarder_detection_mask_</a>.</p>

</div>
</div>
<a id="a229eaa06426b3f43ee471b01ba9eb900" name="a229eaa06426b3f43ee471b01ba9eb900"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a229eaa06426b3f43ee471b01ba9eb900">&#9670;&#160;</a></span>getCurrentFrame()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">Frame::Ptr dyno::FeatureTracker::getCurrentFrame </td>
          <td>(</td>
          <td class="paramname"></td><td>)</td>
          <td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">inline</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>Get the most recent frame that has been tracked. After a call to track, this will be the frame that is returned and will track features between <a class="el" href="classdyno_1_1FeatureTracker.html#a96eacfcb1a94b8061bb8bde6926c889c" title="Get the previous frame.">getPreviousFrame()</a> to this frame. </p>
<dl class="section return"><dt>Returns</dt><dd>Frame::Ptr </dd></dl>

<p class="definition">Definition at line <a class="el" href="FeatureTracker_8hpp_source.html#l00096">96</a> of file <a class="el" href="FeatureTracker_8hpp_source.html">FeatureTracker.hpp</a>.</p>
<div class="fragment"><div class="line"><span class="lineno">   96</span>{ <span class="keywordflow">return</span> <a class="code hl_variable" href="classdyno_1_1FeatureTracker.html#a879d0cd574b194e89bffbe05f85c23fc">previous_frame_</a>; }</div>
<div class="ttc" id="aclassdyno_1_1FeatureTracker_html_a879d0cd574b194e89bffbe05f85c23fc"><div class="ttname"><a href="classdyno_1_1FeatureTracker.html#a879d0cd574b194e89bffbe05f85c23fc">dyno::FeatureTracker::previous_frame_</a></div><div class="ttdeci">Frame::Ptr previous_frame_</div><div class="ttdef"><b>Definition:</b> <a href="FeatureTracker_8hpp_source.html#l00158">FeatureTracker.hpp:158</a></div></div>
</div><!-- fragment -->
<p class="reference">References <a class="el" href="classdyno_1_1FeatureTracker.html#a879d0cd574b194e89bffbe05f85c23fc">previous_frame_</a>.</p>

</div>
</div>
<a id="a96eacfcb1a94b8061bb8bde6926c889c" name="a96eacfcb1a94b8061bb8bde6926c889c"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a96eacfcb1a94b8061bb8bde6926c889c">&#9670;&#160;</a></span>getPreviousFrame() <span class="overload">[1/2]</span></h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">Frame::Ptr dyno::FeatureTracker::getPreviousFrame </td>
          <td>(</td>
          <td class="paramname"></td><td>)</td>
          <td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">inline</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>Get the previous frame. </p>
<p>Will be null on the first call of track</p>
<dl class="section return"><dt>Returns</dt><dd>Frame::Ptr </dd></dl>

<p class="definition">Definition at line <a class="el" href="FeatureTracker_8hpp_source.html#l00084">84</a> of file <a class="el" href="FeatureTracker_8hpp_source.html">FeatureTracker.hpp</a>.</p>
<div class="fragment"><div class="line"><span class="lineno">   84</span>{ <span class="keywordflow">return</span> <a class="code hl_variable" href="classdyno_1_1FeatureTracker.html#a674be7a497efeed1cf90fe3ae44c86d7">previous_tracked_frame_</a>; }</div>
<div class="ttc" id="aclassdyno_1_1FeatureTracker_html_a674be7a497efeed1cf90fe3ae44c86d7"><div class="ttname"><a href="classdyno_1_1FeatureTracker.html#a674be7a497efeed1cf90fe3ae44c86d7">dyno::FeatureTracker::previous_tracked_frame_</a></div><div class="ttdeci">Frame::Ptr previous_tracked_frame_</div><div class="ttdef"><b>Definition:</b> <a href="FeatureTracker_8hpp_source.html#l00162">FeatureTracker.hpp:162</a></div></div>
</div><!-- fragment -->
<p class="reference">References <a class="el" href="classdyno_1_1FeatureTracker.html#a674be7a497efeed1cf90fe3ae44c86d7">previous_tracked_frame_</a>.</p>

</div>
</div>
<a id="ae6e26766be0549fd5b4b00854ee50105" name="ae6e26766be0549fd5b4b00854ee50105"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ae6e26766be0549fd5b4b00854ee50105">&#9670;&#160;</a></span>getPreviousFrame() <span class="overload">[2/2]</span></h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">const Frame::ConstPtr dyno::FeatureTracker::getPreviousFrame </td>
          <td>(</td>
          <td class="paramname"></td><td>)</td>
          <td> const</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">inline</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="FeatureTracker_8hpp_source.html#l00085">85</a> of file <a class="el" href="FeatureTracker_8hpp_source.html">FeatureTracker.hpp</a>.</p>
<div class="fragment"><div class="line"><span class="lineno">   85</span>                                                      {</div>
<div class="line"><span class="lineno">   86</span>    <span class="keywordflow">return</span> <a class="code hl_variable" href="classdyno_1_1FeatureTracker.html#a674be7a497efeed1cf90fe3ae44c86d7">previous_tracked_frame_</a>;</div>
<div class="line"><span class="lineno">   87</span>  }</div>
</div><!-- fragment -->
<p class="reference">References <a class="el" href="classdyno_1_1FeatureTracker.html#a674be7a497efeed1cf90fe3ae44c86d7">previous_tracked_frame_</a>.</p>

</div>
</div>
<a id="aa7019643454cc8a78295fea4dd65002b" name="aa7019643454cc8a78295fea4dd65002b"></a>
<h2 class="memtitle"><span class="permalink"><a href="#aa7019643454cc8a78295fea4dd65002b">&#9670;&#160;</a></span>getTrackerInfo()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">const <a class="el" href="structdyno_1_1FeatureTrackerInfo.html">FeatureTrackerInfo</a> &amp; dyno::FeatureTracker::getTrackerInfo </td>
          <td>(</td>
          <td class="paramname"></td><td>)</td>
          <td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">inline</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="FeatureTracker_8hpp_source.html#l00098">98</a> of file <a class="el" href="FeatureTracker_8hpp_source.html">FeatureTracker.hpp</a>.</p>
<div class="fragment"><div class="line"><span class="lineno">   98</span>{ <span class="keywordflow">return</span> <a class="code hl_variable" href="classdyno_1_1FeatureTracker.html#aaf08b9f655f94c59eadf15564f2e69f3">info_</a>; }</div>
<div class="ttc" id="aclassdyno_1_1FeatureTracker_html_aaf08b9f655f94c59eadf15564f2e69f3"><div class="ttname"><a href="classdyno_1_1FeatureTracker.html#aaf08b9f655f94c59eadf15564f2e69f3">dyno::FeatureTracker::info_</a></div><div class="ttdeci">FeatureTrackerInfo info_</div><div class="ttdef"><b>Definition:</b> <a href="FeatureTracker_8hpp_source.html#l00170">FeatureTracker.hpp:170</a></div></div>
</div><!-- fragment -->
<p class="reference">References <a class="el" href="classdyno_1_1FeatureTracker.html#aaf08b9f655f94c59eadf15564f2e69f3">info_</a>.</p>

</div>
</div>
<a id="aa6e3d79ddd4fc72062ea58d8211a50b2" name="aa6e3d79ddd4fc72062ea58d8211a50b2"></a>
<h2 class="memtitle"><span class="permalink"><a href="#aa6e3d79ddd4fc72062ea58d8211a50b2">&#9670;&#160;</a></span>objectDetection()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">bool dyno::FeatureTracker::objectDetection </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="structdyno_1_1vision__tools_1_1ObjectBoundaryMaskResult.html">vision_tools::ObjectBoundaryMaskResult</a> &amp;&#160;</td>
          <td class="paramname"><em>boundary_mask_result</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="classdyno_1_1ImageContainer.html">ImageContainer</a> &amp;&#160;</td>
          <td class="paramname"><em>image_container</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">private</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="FeatureTracker_8cc_source.html#l01142">1142</a> of file <a class="el" href="FeatureTracker_8cc_source.html">FeatureTracker.cc</a>.</p>
<div class="fragment"><div class="line"><span class="lineno"> 1144</span>                                     {</div>
<div class="line"><span class="lineno"> 1145</span>  <span class="comment">// from some experimental testing 10 pixles is a good boarder to add around</span></div>
<div class="line"><span class="lineno"> 1146</span>  <span class="comment">// objects when the image is 640x480 assuming we have some scaling factor r,</span></div>
<div class="line"><span class="lineno"> 1147</span>  <span class="comment">// width/height * r = 10 and for 640/480, r = (approx) 7.51 for images not</span></div>
<div class="line"><span class="lineno"> 1148</span>  <span class="comment">// this size we will try and keep the same ratio as this seemed to work well</span></div>
<div class="line"><span class="lineno"> 1149</span>  <span class="comment">// NOTE: assumes img_size_ has been set</span></div>
<div class="line"><span class="lineno"> 1150</span>  <span class="keywordtype">double</span> image_ratio =</div>
<div class="line"><span class="lineno"> 1151</span>      <span class="keyword">static_cast&lt;</span><span class="keywordtype">double</span><span class="keyword">&gt;</span>(<a class="code hl_variable" href="classdyno_1_1FeatureTrackerBase.html#a23d0ec748366b789be491e61e536839c">img_size_</a>.width * <a class="code hl_variable" href="classdyno_1_1FeatureTrackerBase.html#a23d0ec748366b789be491e61e536839c">img_size_</a>.height) / (640.0 * 480.0);</div>
<div class="line"><span class="lineno"> 1152</span>  <span class="keyword">static</span> <span class="keyword">constexpr</span> <span class="keywordtype">double</span> kScalingFactorR = 7.51;</div>
<div class="line"><span class="lineno"> 1153</span>  <span class="comment">// desired boarder thickness in pixels for a 640 x 480 image</span></div>
<div class="line"><span class="lineno"> 1154</span>  <span class="keyword">const</span> <span class="keywordtype">int</span> scaled_boarder_thickness =</div>
<div class="line"><span class="lineno"> 1155</span>      std::round(image_ratio * 640.0 / 480.0 * kScalingFactorR);</div>
<div class="line"><span class="lineno"> 1156</span>  <span class="comment">// create detection mask around the boarder of each dynamic object with some</span></div>
<div class="line"><span class="lineno"> 1157</span>  <span class="comment">// thickness this prevents static and dynamic points being detected around the</span></div>
<div class="line"><span class="lineno"> 1158</span>  <span class="comment">// edge of the dynamic object as there are lots of inconsistencies here the</span></div>
<div class="line"><span class="lineno"> 1159</span>  <span class="comment">// detection mask is in the opencv mask form: CV_8UC1 where white pixels (255)</span></div>
<div class="line"><span class="lineno"> 1160</span>  <span class="comment">// are valid and black pixels (0) should not be detected on</span></div>
<div class="line"><span class="lineno"> 1161</span>  <span class="keyword">static</span> <span class="keyword">constexpr</span> <span class="keywordtype">bool</span> kUseAsFeatureDetectionMask = <span class="keyword">true</span>;</div>
<div class="line"><span class="lineno"> 1162</span>  <span class="comment">// else run etection</span></div>
<div class="line"><span class="lineno"> 1163</span>  <span class="keywordflow">if</span> (<a class="code hl_variable" href="classdyno_1_1FeatureTrackerBase.html#a04f0948954381269fedd5a6856662cb7">params_</a>.<a class="code hl_variable" href="structdyno_1_1TrackerParams.html#aa1ca252f62bd7adeaedc35e76a03be62">prefer_provided_object_detection</a>) {</div>
<div class="line"><span class="lineno"> 1164</span>    <span class="keywordflow">if</span> (image_container.hasObjectMask()) {</div>
<div class="line"><span class="lineno"> 1165</span>      cv::Mat object_mask = image_container.objectMotionMask();</div>
<div class="line"><span class="lineno"> 1166</span>      <span class="comment">// NOTE: importantly this will calculate the observed objects in this</span></div>
<div class="line"><span class="lineno"> 1167</span>      <span class="comment">// frame so we dont need to recalculate!</span></div>
<div class="line"><span class="lineno"> 1168</span>      VLOG(30) &lt;&lt; <span class="stringliteral">&quot;Using provided object detection mask k=&quot;</span></div>
<div class="line"><span class="lineno"> 1169</span>               &lt;&lt; image_container.frameId();</div>
<div class="line"><span class="lineno"> 1170</span>      <a class="code hl_function" href="namespacedyno_1_1vision__tools.html#ad7347d14d7f68183415227f23bbd6f7d">vision_tools::computeObjectMaskBoundaryMask</a>(</div>
<div class="line"><span class="lineno"> 1171</span>          boundary_mask_result, object_mask, scaled_boarder_thickness,</div>
<div class="line"><span class="lineno"> 1172</span>          kUseAsFeatureDetectionMask);</div>
<div class="line"><span class="lineno"> 1173</span>      <span class="keywordflow">return</span> <span class="keyword">false</span>;</div>
<div class="line"><span class="lineno"> 1174</span>    } <span class="keywordflow">else</span> {</div>
<div class="line"><span class="lineno"> 1175</span>      LOG(FATAL) &lt;&lt; <span class="stringliteral">&quot;Params specify prefer provided object mask but input &quot;</span></div>
<div class="line"><span class="lineno"> 1176</span>                    <span class="stringliteral">&quot;is missing!&quot;</span>;</div>
<div class="line"><span class="lineno"> 1177</span>    }</div>
<div class="line"><span class="lineno"> 1178</span>  } <span class="keywordflow">else</span> {</div>
<div class="line"><span class="lineno"> 1179</span>    CHECK(<a class="code hl_variable" href="classdyno_1_1FeatureTracker.html#a36557c1362b705513be73dd2b5fd1ded">object_detection_</a>);</div>
<div class="line"><span class="lineno"> 1180</span>    VLOG(30) &lt;&lt; <span class="stringliteral">&quot;Running object detection and tracking inference k=&quot;</span></div>
<div class="line"><span class="lineno"> 1181</span>             &lt;&lt; image_container.frameId();</div>
<div class="line"><span class="lineno"> 1182</span>    ObjectDetectionResult detection_result;</div>
<div class="line"><span class="lineno"> 1183</span>    {</div>
<div class="line"><span class="lineno"> 1184</span>      utils::TimingStatsCollector timing(<span class="stringliteral">&quot;tracking_timer.detection_inference&quot;</span>);</div>
<div class="line"><span class="lineno"> 1185</span>      detection_result = <a class="code hl_variable" href="classdyno_1_1FeatureTracker.html#a36557c1362b705513be73dd2b5fd1ded">object_detection_</a>-&gt;process(image_container.rgb());</div>
<div class="line"><span class="lineno"> 1186</span>    }</div>
<div class="line"><span class="lineno"> 1187</span>    cv::Mat object_mask = detection_result.labelled_mask;</div>
<div class="line"><span class="lineno"> 1188</span> </div>
<div class="line"><span class="lineno"> 1189</span>    {</div>
<div class="line"><span class="lineno"> 1190</span>      utils::TimingStatsCollector timing(</div>
<div class="line"><span class="lineno"> 1191</span>          <span class="stringliteral">&quot;tracking_timer.compute_boundary_mask&quot;</span>);</div>
<div class="line"><span class="lineno"> 1192</span>      <a class="code hl_function" href="namespacedyno_1_1vision__tools.html#ad7347d14d7f68183415227f23bbd6f7d">vision_tools::computeObjectMaskBoundaryMask</a>(</div>
<div class="line"><span class="lineno"> 1193</span>          boundary_mask_result, detection_result, scaled_boarder_thickness,</div>
<div class="line"><span class="lineno"> 1194</span>          kUseAsFeatureDetectionMask);</div>
<div class="line"><span class="lineno"> 1195</span>    }</div>
<div class="line"><span class="lineno"> 1196</span> </div>
<div class="line"><span class="lineno"> 1197</span>    <span class="comment">// update or insert image container with object mask</span></div>
<div class="line"><span class="lineno"> 1198</span>    image_container.replace&lt;ImageType::MotionMask&gt;(<a class="code hl_variable" href="classdyno_1_1ImageContainer.html#aca97f94103c325a4aefa2d824f50f7f3">ImageContainer::kObjectMask</a>,</div>
<div class="line"><span class="lineno"> 1199</span>                                                   object_mask);</div>
<div class="line"><span class="lineno"> 1200</span>    <span class="keywordflow">return</span> <span class="keyword">true</span>;</div>
<div class="line"><span class="lineno"> 1201</span>  }</div>
<div class="line"><span class="lineno"> 1202</span>}</div>
<div class="ttc" id="aclassdyno_1_1ImageContainer_html_aca97f94103c325a4aefa2d824f50f7f3"><div class="ttname"><a href="classdyno_1_1ImageContainer.html#aca97f94103c325a4aefa2d824f50f7f3">dyno::ImageContainer::kObjectMask</a></div><div class="ttdeci">static constexpr char kObjectMask[]</div><div class="ttdef"><b>Definition:</b> <a href="ImageContainer_8hpp_source.html#l00232">ImageContainer.hpp:232</a></div></div>
<div class="ttc" id="anamespacedyno_1_1vision__tools_html_ad7347d14d7f68183415227f23bbd6f7d"><div class="ttname"><a href="namespacedyno_1_1vision__tools.html#ad7347d14d7f68183415227f23bbd6f7d">dyno::vision_tools::computeObjectMaskBoundaryMask</a></div><div class="ttdeci">void computeObjectMaskBoundaryMask(ObjectBoundaryMaskResult &amp;result, const cv::Mat &amp;mask, int thickness, bool use_as_feature_detection_mask=true)</div><div class="ttdoc">From an input instance/semantic mask type img construct a image mask (binary) that has True values ar...</div><div class="ttdef"><b>Definition:</b> <a href="VisionTools_8cc_source.html#l00443">VisionTools.cc:443</a></div></div>
</div><!-- fragment -->
<p class="reference">References <a class="el" href="classdyno_1_1ImageContainer.html#ae5023f3df359ad7a5196ce15cd632ca3">dyno::ImageContainer::frameId()</a>, <a class="el" href="classdyno_1_1ImageContainer.html#a58380247600b24f657657316b195faaf">dyno::ImageContainer::hasObjectMask()</a>, <a class="el" href="structdyno_1_1ObjectDetectionResult.html#a619e9d2c4cabbd14410f835253707141">dyno::ObjectDetectionResult::labelled_mask</a>, <a class="el" href="classdyno_1_1ImageContainer.html#ae5eead678f02be0ab9de7464e1833c55">dyno::ImageContainer::objectMotionMask()</a>, <a class="el" href="classdyno_1_1ImageContainer.html#a0f5c67b77443b776a57d5ec38ddad291">dyno::ImageContainer::replace()</a>, and <a class="el" href="classdyno_1_1ImageContainer.html#a6f35259f95c31b861ff6515c159e1ee3">dyno::ImageContainer::rgb()</a>.</p>

<p class="reference">Referenced by <a class="el" href="classdyno_1_1FeatureTracker.html#a40ee79c94fe2de7f16d2a4508cc2ba11">track()</a>.</p>
<div class="dynheader">
Here is the call graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="classdyno_1_1FeatureTracker_aa6e3d79ddd4fc72062ea58d8211a50b2_cgraph.png" border="0" usemap="#aclassdyno_1_1FeatureTracker_aa6e3d79ddd4fc72062ea58d8211a50b2_cgraph" alt=""/></div>
<map name="aclassdyno_1_1FeatureTracker_aa6e3d79ddd4fc72062ea58d8211a50b2_cgraph" id="aclassdyno_1_1FeatureTracker_aa6e3d79ddd4fc72062ea58d8211a50b2_cgraph">
<area shape="rect" title=" " alt="" coords="5,133,163,173"/>
<area shape="rect" href="classdyno_1_1ImageContainer.html#ae5023f3df359ad7a5196ce15cd632ca3" title=" " alt="" coords="225,5,391,45"/>
<area shape="rect" href="classdyno_1_1ImageContainer.html#a58380247600b24f657657316b195faaf" title=" " alt="" coords="225,69,391,109"/>
<area shape="rect" href="classdyno_1_1ImageContainer.html#ae5eead678f02be0ab9de7464e1833c55" title=" " alt="" coords="225,133,391,173"/>
<area shape="rect" href="classdyno_1_1ImageContainer.html#a0f5c67b77443b776a57d5ec38ddad291" title=" " alt="" coords="225,197,391,237"/>
<area shape="rect" href="classdyno_1_1ImageContainer.html#a6f35259f95c31b861ff6515c159e1ee3" title=" " alt="" coords="211,262,405,287"/>
<area shape="rect" href="classdyno_1_1ImageContainer.html#a2cd4807310bce124878792073e9122e9" title=" " alt="" coords="453,133,620,173"/>
</map>
</div>
<div class="dynheader">
Here is the caller graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="classdyno_1_1FeatureTracker_aa6e3d79ddd4fc72062ea58d8211a50b2_icgraph.png" border="0" usemap="#aclassdyno_1_1FeatureTracker_aa6e3d79ddd4fc72062ea58d8211a50b2_icgraph" alt=""/></div>
<map name="aclassdyno_1_1FeatureTracker_aa6e3d79ddd4fc72062ea58d8211a50b2_icgraph" id="aclassdyno_1_1FeatureTracker_aa6e3d79ddd4fc72062ea58d8211a50b2_icgraph">
<area shape="rect" title=" " alt="" coords="211,5,368,45"/>
<area shape="rect" href="classdyno_1_1FeatureTracker.html#a40ee79c94fe2de7f16d2a4508cc2ba11" title=" " alt="" coords="5,5,163,45"/>
</map>
</div>

</div>
</div>
<a id="a7877773d1c6d5b9cef0c379cd701c1e4" name="a7877773d1c6d5b9cef0c379cd701c1e4"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a7877773d1c6d5b9cef0c379cd701c1e4">&#9670;&#160;</a></span>propogateMask()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">void dyno::FeatureTracker::propogateMask </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="classdyno_1_1ImageContainer.html">ImageContainer</a> &amp;&#160;</td>
          <td class="paramname"><em>image_container</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">protected</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="FeatureTracker_8cc_source.html#l01204">1204</a> of file <a class="el" href="FeatureTracker_8cc_source.html">FeatureTracker.cc</a>.</p>
<div class="fragment"><div class="line"><span class="lineno"> 1204</span>                                                                  {</div>
<div class="line"><span class="lineno"> 1205</span>  <span class="keywordflow">if</span> (!<a class="code hl_variable" href="classdyno_1_1FeatureTracker.html#a879d0cd574b194e89bffbe05f85c23fc">previous_frame_</a>) <span class="keywordflow">return</span>;</div>
<div class="line"><span class="lineno"> 1206</span> </div>
<div class="line"><span class="lineno"> 1207</span>  <span class="keyword">const</span> cv::Mat&amp; previous_rgb = <a class="code hl_variable" href="classdyno_1_1FeatureTracker.html#a879d0cd574b194e89bffbe05f85c23fc">previous_frame_</a>-&gt;image_container_.rgb();</div>
<div class="line"><span class="lineno"> 1208</span>  <span class="keyword">const</span> cv::Mat&amp; previous_mask =</div>
<div class="line"><span class="lineno"> 1209</span>      <a class="code hl_variable" href="classdyno_1_1FeatureTracker.html#a879d0cd574b194e89bffbe05f85c23fc">previous_frame_</a>-&gt;image_container_.objectMotionMask();</div>
<div class="line"><span class="lineno"> 1210</span>  <span class="keyword">const</span> cv::Mat&amp; previous_flow =</div>
<div class="line"><span class="lineno"> 1211</span>      <a class="code hl_variable" href="classdyno_1_1FeatureTracker.html#a879d0cd574b194e89bffbe05f85c23fc">previous_frame_</a>-&gt;image_container_.opticalFlow();</div>
<div class="line"><span class="lineno"> 1212</span> </div>
<div class="line"><span class="lineno"> 1213</span>  <span class="comment">// note reference</span></div>
<div class="line"><span class="lineno"> 1214</span>  cv::Mat&amp; current_mask = image_container.objectMotionMask();</div>
<div class="line"><span class="lineno"> 1215</span> </div>
<div class="line"><span class="lineno"> 1216</span>  <a class="code hl_typedef" href="namespacedyno.html#ae777b079c377ffa066d89051ee0cc623">ObjectIds</a> instance_labels;</div>
<div class="line"><span class="lineno"> 1217</span>  <span class="keywordflow">for</span> (<span class="keyword">const</span> Feature::Ptr&amp; dynamic_feature :</div>
<div class="line"><span class="lineno"> 1218</span>       <a class="code hl_variable" href="classdyno_1_1FeatureTracker.html#a879d0cd574b194e89bffbe05f85c23fc">previous_frame_</a>-&gt;usableDynamicFeaturesBegin()) {</div>
<div class="line"><span class="lineno"> 1219</span>    CHECK(dynamic_feature-&gt;objectId() != <a class="code hl_variable" href="namespacedyno.html#ae78915ea0afc5025dafb398829f15ba3">background_label</a>);</div>
<div class="line"><span class="lineno"> 1220</span>    instance_labels.push_back(dynamic_feature-&gt;objectId());</div>
<div class="line"><span class="lineno"> 1221</span>  }</div>
<div class="line"><span class="lineno"> 1222</span> </div>
<div class="line"><span class="lineno"> 1223</span>  CHECK_EQ(instance_labels.size(), <a class="code hl_variable" href="classdyno_1_1FeatureTracker.html#a879d0cd574b194e89bffbe05f85c23fc">previous_frame_</a>-&gt;numDynamicUsableFeatures());</div>
<div class="line"><span class="lineno"> 1224</span>  std::sort(instance_labels.begin(), instance_labels.end());</div>
<div class="line"><span class="lineno"> 1225</span>  instance_labels.erase(</div>
<div class="line"><span class="lineno"> 1226</span>      std::unique(instance_labels.begin(), instance_labels.end()),</div>
<div class="line"><span class="lineno"> 1227</span>      instance_labels.end());</div>
<div class="line"><span class="lineno"> 1228</span>  <span class="comment">// each row is correlated with a specific instance label and each column is</span></div>
<div class="line"><span class="lineno"> 1229</span>  <span class="comment">// the tracklet id associated with that label</span></div>
<div class="line"><span class="lineno"> 1230</span>  std::vector&lt;TrackletIds&gt; object_features(instance_labels.size());</div>
<div class="line"><span class="lineno"> 1231</span> </div>
<div class="line"><span class="lineno"> 1232</span>  <span class="comment">// collect the predicted labels and semantic labels in vector</span></div>
<div class="line"><span class="lineno"> 1233</span> </div>
<div class="line"><span class="lineno"> 1234</span>  <span class="comment">// TODO: inliers?</span></div>
<div class="line"><span class="lineno"> 1235</span>  <span class="keywordflow">for</span> (<span class="keyword">const</span> Feature::Ptr&amp; dynamic_feature :</div>
<div class="line"><span class="lineno"> 1236</span>       <a class="code hl_variable" href="classdyno_1_1FeatureTracker.html#a879d0cd574b194e89bffbe05f85c23fc">previous_frame_</a>-&gt;usableDynamicFeaturesBegin()) {</div>
<div class="line"><span class="lineno"> 1237</span>    CHECK(<a class="code hl_function" href="classdyno_1_1Feature.html#a6ef4cbae2843a4646954bcb53f63c7a8">Feature::IsNotNull</a>(dynamic_feature));</div>
<div class="line"><span class="lineno"> 1238</span>    <span class="keywordflow">for</span> (<span class="keywordtype">size_t</span> j = 0; j &lt; instance_labels.size(); j++) {</div>
<div class="line"><span class="lineno"> 1239</span>      <span class="comment">// save object label for object j with feature i</span></div>
<div class="line"><span class="lineno"> 1240</span>      <span class="keywordflow">if</span> (dynamic_feature-&gt;objectId() == instance_labels[j]) {</div>
<div class="line"><span class="lineno"> 1241</span>        object_features[j].push_back(dynamic_feature-&gt;trackletId());</div>
<div class="line"><span class="lineno"> 1242</span>        CHECK(dynamic_feature-&gt;objectId() != <a class="code hl_variable" href="namespacedyno.html#ae78915ea0afc5025dafb398829f15ba3">background_label</a>);</div>
<div class="line"><span class="lineno"> 1243</span>        <span class="keywordflow">break</span>;</div>
<div class="line"><span class="lineno"> 1244</span>      }</div>
<div class="line"><span class="lineno"> 1245</span>    }</div>
<div class="line"><span class="lineno"> 1246</span>  }</div>
<div class="line"><span class="lineno"> 1247</span> </div>
<div class="line"><span class="lineno"> 1248</span>  <span class="comment">// check each object label distribution in the coming frame</span></div>
<div class="line"><span class="lineno"> 1249</span>  <span class="keywordflow">for</span> (<span class="keywordtype">size_t</span> i = 0; i &lt; object_features.size(); i++) {</div>
<div class="line"><span class="lineno"> 1250</span>    <span class="comment">// labels at the current mask using the predicted keypoint from the previous</span></div>
<div class="line"><span class="lineno"> 1251</span>    <span class="comment">// frame each iteration is per label so temp_label should correspond to</span></div>
<div class="line"><span class="lineno"> 1252</span>    <span class="comment">// features within the same object</span></div>
<div class="line"><span class="lineno"> 1253</span>    <a class="code hl_typedef" href="namespacedyno.html#ae777b079c377ffa066d89051ee0cc623">ObjectIds</a> temp_label;</div>
<div class="line"><span class="lineno"> 1254</span>    <span class="keywordflow">for</span> (<span class="keywordtype">size_t</span> j = 0; j &lt; object_features[i].size(); j++) {</div>
<div class="line"><span class="lineno"> 1255</span>      <span class="comment">// feature at k-1</span></div>
<div class="line"><span class="lineno"> 1256</span>      Feature::Ptr feature = <a class="code hl_variable" href="classdyno_1_1FeatureTracker.html#a879d0cd574b194e89bffbe05f85c23fc">previous_frame_</a>-&gt;dynamic_features_.getByTrackletId(</div>
<div class="line"><span class="lineno"> 1257</span>          object_features[i][j]);</div>
<div class="line"><span class="lineno"> 1258</span>      CHECK(<a class="code hl_function" href="classdyno_1_1Feature.html#a6ef4cbae2843a4646954bcb53f63c7a8">Feature::IsNotNull</a>(feature));</div>
<div class="line"><span class="lineno"> 1259</span>      <span class="comment">// kp at k</span></div>
<div class="line"><span class="lineno"> 1260</span>      <span class="keyword">const</span> <a class="code hl_typedef" href="namespacedyno.html#aaa260a8022691078c59e1ac6a4fa05b5">Keypoint</a>&amp; predicted_kp = feature-&gt;predictedKeypoint();</div>
<div class="line"><span class="lineno"> 1261</span>      <span class="keyword">const</span> <span class="keywordtype">int</span> u = <a class="code hl_function" href="structdyno_1_1functional__keypoint.html#a3896d96a6f95b5311ae768cdd0ad97e8">functional_keypoint::u</a>(predicted_kp);</div>
<div class="line"><span class="lineno"> 1262</span>      <span class="keyword">const</span> <span class="keywordtype">int</span> v = <a class="code hl_function" href="structdyno_1_1functional__keypoint.html#a24933450cad8bc70b7b76b339756cd94">functional_keypoint::v</a>(predicted_kp);</div>
<div class="line"><span class="lineno"> 1263</span>      <span class="comment">// ensure u and v are sitll inside the CURRENT frame</span></div>
<div class="line"><span class="lineno"> 1264</span>      <span class="keywordflow">if</span> (u &lt; previous_rgb.cols &amp;&amp; u &gt; 0 &amp;&amp; v &lt; previous_rgb.rows &amp;&amp; v &gt; 0) {</div>
<div class="line"><span class="lineno"> 1265</span>        <span class="comment">// add instance label at predicted keypoint</span></div>
<div class="line"><span class="lineno"> 1266</span>        temp_label.push_back(current_mask.at&lt;<a class="code hl_typedef" href="namespacedyno.html#a38bb86e4154b86428b8d133be03fb2b5">ObjectId</a>&gt;(v, u));</div>
<div class="line"><span class="lineno"> 1267</span>      }</div>
<div class="line"><span class="lineno"> 1268</span>    }</div>
<div class="line"><span class="lineno"> 1269</span> </div>
<div class="line"><span class="lineno"> 1270</span>    <span class="comment">// this is a lovely magic number inherited from some old code :)</span></div>
<div class="line"><span class="lineno"> 1271</span>    <span class="keywordflow">if</span> (temp_label.size() &lt; 150) {</div>
<div class="line"><span class="lineno"> 1272</span>      LOG(WARNING) &lt;&lt; <span class="stringliteral">&quot;not enoug points to track object &quot;</span> &lt;&lt; instance_labels[i]</div>
<div class="line"><span class="lineno"> 1273</span>                   &lt;&lt; <span class="stringliteral">&quot; points size - &quot;</span> &lt;&lt; temp_label.size();</div>
<div class="line"><span class="lineno"> 1274</span>      <span class="comment">// TODO:mark has static!!???</span></div>
<div class="line"><span class="lineno"> 1275</span>      <span class="keywordflow">continue</span>;</div>
<div class="line"><span class="lineno"> 1276</span>    }</div>
<div class="line"><span class="lineno"> 1277</span> </div>
<div class="line"><span class="lineno"> 1278</span>    <span class="comment">// find label that appears most in LabTmp()</span></div>
<div class="line"><span class="lineno"> 1279</span>    <span class="comment">// (1) count duplicates</span></div>
<div class="line"><span class="lineno"> 1280</span>    std::map&lt;int, int&gt; label_duplicates;</div>
<div class="line"><span class="lineno"> 1281</span>    <span class="comment">// k is object label</span></div>
<div class="line"><span class="lineno"> 1282</span>    <span class="keywordflow">for</span> (<span class="keywordtype">int</span> k : temp_label) {</div>
<div class="line"><span class="lineno"> 1283</span>      <span class="keywordflow">if</span> (label_duplicates.find(k) == label_duplicates.end()) {</div>
<div class="line"><span class="lineno"> 1284</span>        label_duplicates.insert({k, 0});</div>
<div class="line"><span class="lineno"> 1285</span>      } <span class="keywordflow">else</span> {</div>
<div class="line"><span class="lineno"> 1286</span>        label_duplicates.at(k)++;</div>
<div class="line"><span class="lineno"> 1287</span>      }</div>
<div class="line"><span class="lineno"> 1288</span>    }</div>
<div class="line"><span class="lineno"> 1289</span>    <span class="comment">// (2) and sort them by descending order by number of times an object</span></div>
<div class="line"><span class="lineno"> 1290</span>    <span class="comment">// appeared (ie. by pair.second)</span></div>
<div class="line"><span class="lineno"> 1291</span>    std::vector&lt;std::pair&lt;int, int&gt;&gt; sorted;</div>
<div class="line"><span class="lineno"> 1292</span>    <span class="keywordflow">for</span> (<span class="keyword">auto</span> k : label_duplicates) {</div>
<div class="line"><span class="lineno"> 1293</span>      sorted.push_back(std::make_pair(k.first, k.second));</div>
<div class="line"><span class="lineno"> 1294</span>    }</div>
<div class="line"><span class="lineno"> 1295</span> </div>
<div class="line"><span class="lineno"> 1296</span>    <span class="keyword">auto</span> sort_pair_int = [](<span class="keyword">const</span> std::pair&lt;int, int&gt;&amp; a,</div>
<div class="line"><span class="lineno"> 1297</span>                            <span class="keyword">const</span> std::pair&lt;int, int&gt;&amp; b) -&gt; <span class="keywordtype">bool</span> {</div>
<div class="line"><span class="lineno"> 1298</span>      <span class="keywordflow">return</span> (a.second &gt; b.second);</div>
<div class="line"><span class="lineno"> 1299</span>    };</div>
<div class="line"><span class="lineno"> 1300</span>    std::sort(sorted.begin(), sorted.end(), sort_pair_int);</div>
<div class="line"><span class="lineno"> 1301</span> </div>
<div class="line"><span class="lineno"> 1302</span>    <span class="comment">// recover the missing mask (time consuming!)</span></div>
<div class="line"><span class="lineno"> 1303</span>    <span class="comment">// LOG(INFO) &lt;&lt; sorted[0].first &lt;&lt; &quot; &quot; &lt;&lt; sorted[0].second &lt;&lt; &quot; &quot; &lt;&lt;</span></div>
<div class="line"><span class="lineno"> 1304</span>    <span class="comment">// instance_labels[i];</span></div>
<div class="line"><span class="lineno"> 1305</span>    <span class="comment">//  if (sorted[0].second &lt; 30)</span></div>
<div class="line"><span class="lineno"> 1306</span>    <span class="comment">// {</span></div>
<div class="line"><span class="lineno"> 1307</span>    <span class="comment">//   LOG(WARNING) &lt;&lt; &quot;not enoug points to track object &quot; &lt;&lt;</span></div>
<div class="line"><span class="lineno"> 1308</span>    <span class="comment">//   instance_labels[i] &lt;&lt; &quot; points size - &quot;</span></div>
<div class="line"><span class="lineno"> 1309</span>    <span class="comment">//                &lt;&lt; sorted[0].second;</span></div>
<div class="line"><span class="lineno"> 1310</span>    <span class="comment">//   //TODO:mark has static!!</span></div>
<div class="line"><span class="lineno"> 1311</span>    <span class="comment">//   continue;</span></div>
<div class="line"><span class="lineno"> 1312</span>    <span class="comment">// }</span></div>
<div class="line"><span class="lineno"> 1313</span>    <span class="keywordflow">if</span> (sorted[0].first == 0)  <span class="comment">//?</span></div>
<div class="line"><span class="lineno"> 1314</span>    <span class="comment">// if (sorted[0].first == instance_labels[i])  //?</span></div>
<div class="line"><span class="lineno"> 1315</span>    {</div>
<div class="line"><span class="lineno"> 1316</span>      <span class="keywordflow">for</span> (<span class="keywordtype">int</span> j = 0; j &lt; previous_rgb.rows; j++) {</div>
<div class="line"><span class="lineno"> 1317</span>        <span class="keywordflow">for</span> (<span class="keywordtype">int</span> k = 0; k &lt; previous_rgb.cols; k++) {</div>
<div class="line"><span class="lineno"> 1318</span>          <span class="keywordflow">if</span> (previous_mask.at&lt;<a class="code hl_typedef" href="namespacedyno.html#a38bb86e4154b86428b8d133be03fb2b5">ObjectId</a>&gt;(j, k) == instance_labels[i]) {</div>
<div class="line"><span class="lineno"> 1319</span>            <span class="keyword">const</span> <span class="keywordtype">double</span> flow_xe =</div>
<div class="line"><span class="lineno"> 1320</span>                <span class="keyword">static_cast&lt;</span><span class="keywordtype">double</span><span class="keyword">&gt;</span>(previous_flow.at&lt;cv::Vec2f&gt;(j, k)[0]);</div>
<div class="line"><span class="lineno"> 1321</span>            <span class="keyword">const</span> <span class="keywordtype">double</span> flow_ye =</div>
<div class="line"><span class="lineno"> 1322</span>                <span class="keyword">static_cast&lt;</span><span class="keywordtype">double</span><span class="keyword">&gt;</span>(previous_flow.at&lt;cv::Vec2f&gt;(j, k)[1]);</div>
<div class="line"><span class="lineno"> 1323</span> </div>
<div class="line"><span class="lineno"> 1324</span>            <span class="keywordflow">if</span> (flow_xe == 0 || flow_ye == 0) {</div>
<div class="line"><span class="lineno"> 1325</span>              <span class="keywordflow">continue</span>;</div>
<div class="line"><span class="lineno"> 1326</span>            }</div>
<div class="line"><span class="lineno"> 1327</span> </div>
<div class="line"><span class="lineno"> 1328</span>            <a class="code hl_typedef" href="namespacedyno.html#aba8bf92162160923c6e5c7249892d5f8">OpticalFlow</a> flow(flow_xe, flow_ye);</div>
<div class="line"><span class="lineno"> 1329</span>            <span class="comment">// x, y</span></div>
<div class="line"><span class="lineno"> 1330</span>            <a class="code hl_typedef" href="namespacedyno.html#aaa260a8022691078c59e1ac6a4fa05b5">Keypoint</a> kp(k, j);</div>
<div class="line"><span class="lineno"> 1331</span>            <span class="keyword">const</span> <a class="code hl_typedef" href="namespacedyno.html#aaa260a8022691078c59e1ac6a4fa05b5">Keypoint</a> predicted_kp =</div>
<div class="line"><span class="lineno"> 1332</span>                <a class="code hl_function" href="classdyno_1_1Feature.html#a37dbbe8da704c2f51e237d38760534fb">Feature::CalculatePredictedKeypoint</a>(kp, flow);</div>
<div class="line"><span class="lineno"> 1333</span> </div>
<div class="line"><span class="lineno"> 1334</span>            <span class="keywordflow">if</span> (!<a class="code hl_function" href="classdyno_1_1FeatureTrackerBase.html#a32d80be7e74a096c2b816529b7fd2c69">isWithinShrunkenImage</a>(predicted_kp)) {</div>
<div class="line"><span class="lineno"> 1335</span>              <span class="keywordflow">continue</span>;</div>
<div class="line"><span class="lineno"> 1336</span>            }</div>
<div class="line"><span class="lineno"> 1337</span> </div>
<div class="line"><span class="lineno"> 1338</span>            <span class="keywordflow">if</span> ((predicted_kp(0) &lt; previous_rgb.cols &amp;&amp; predicted_kp(0) &gt; 0 &amp;&amp;</div>
<div class="line"><span class="lineno"> 1339</span>                 predicted_kp(1) &lt; previous_rgb.rows &amp;&amp; predicted_kp(1) &gt; 0)) {</div>
<div class="line"><span class="lineno"> 1340</span>              current_mask.at&lt;<a class="code hl_typedef" href="namespacedyno.html#a38bb86e4154b86428b8d133be03fb2b5">ObjectId</a>&gt;(<a class="code hl_function" href="structdyno_1_1functional__keypoint.html#a24933450cad8bc70b7b76b339756cd94">functional_keypoint::v</a>(predicted_kp),</div>
<div class="line"><span class="lineno"> 1341</span>                                        <a class="code hl_function" href="structdyno_1_1functional__keypoint.html#a3896d96a6f95b5311ae768cdd0ad97e8">functional_keypoint::u</a>(predicted_kp)) =</div>
<div class="line"><span class="lineno"> 1342</span>                  instance_labels[i];</div>
<div class="line"><span class="lineno"> 1343</span>              <span class="comment">//  current_rgb</span></div>
<div class="line"><span class="lineno"> 1344</span>              <span class="comment">// updated_mask_points++;</span></div>
<div class="line"><span class="lineno"> 1345</span>            }</div>
<div class="line"><span class="lineno"> 1346</span>          }</div>
<div class="line"><span class="lineno"> 1347</span>        }</div>
<div class="line"><span class="lineno"> 1348</span>      }</div>
<div class="line"><span class="lineno"> 1349</span>    }</div>
<div class="line"><span class="lineno"> 1350</span>  }</div>
<div class="line"><span class="lineno"> 1351</span>}</div>
<div class="ttc" id="aclassdyno_1_1FeatureTrackerBase_html_a32d80be7e74a096c2b816529b7fd2c69"><div class="ttname"><a href="classdyno_1_1FeatureTrackerBase.html#a32d80be7e74a096c2b816529b7fd2c69">dyno::FeatureTrackerBase::isWithinShrunkenImage</a></div><div class="ttdeci">bool isWithinShrunkenImage(const Keypoint &amp;kp) const</div><div class="ttdoc">Checks if a keypoint is within an image, taking into account the shrink row/col values in the params....</div><div class="ttdef"><b>Definition:</b> <a href="FeatureTrackerBase_8cc_source.html#l00313">FeatureTrackerBase.cc:313</a></div></div>
<div class="ttc" id="aclassdyno_1_1Feature_html_a37dbbe8da704c2f51e237d38760534fb"><div class="ttname"><a href="classdyno_1_1Feature.html#a37dbbe8da704c2f51e237d38760534fb">dyno::Feature::CalculatePredictedKeypoint</a></div><div class="ttdeci">static Keypoint CalculatePredictedKeypoint(const Keypoint &amp;keypoint, const OpticalFlow &amp;measured_flow)</div><div class="ttdef"><b>Definition:</b> <a href="Feature_8hpp_source.html#l00229">Feature.hpp:229</a></div></div>
<div class="ttc" id="aclassdyno_1_1Feature_html_a6ef4cbae2843a4646954bcb53f63c7a8"><div class="ttname"><a href="classdyno_1_1Feature.html#a6ef4cbae2843a4646954bcb53f63c7a8">dyno::Feature::IsNotNull</a></div><div class="ttdeci">static bool IsNotNull(const Feature::Ptr &amp;f)</div><div class="ttdef"><b>Definition:</b> <a href="Feature_8hpp_source.html#l00359">Feature.hpp:359</a></div></div>
<div class="ttc" id="anamespacedyno_html_a38bb86e4154b86428b8d133be03fb2b5"><div class="ttname"><a href="namespacedyno.html#a38bb86e4154b86428b8d133be03fb2b5">dyno::ObjectId</a></div><div class="ttdeci">int ObjectId</div><div class="ttdoc">Discrete object id, j.</div><div class="ttdef"><b>Definition:</b> <a href="Types_8hpp_source.html#l00070">Types.hpp:70</a></div></div>
<div class="ttc" id="anamespacedyno_html_aaa260a8022691078c59e1ac6a4fa05b5"><div class="ttname"><a href="namespacedyno.html#aaa260a8022691078c59e1ac6a4fa05b5">dyno::Keypoint</a></div><div class="ttdeci">gtsam::Point2 Keypoint</div><div class="ttdoc">Observed optical flow vector (ordered x, y)</div><div class="ttdef"><b>Definition:</b> <a href="Types_8hpp_source.html#l00096">Types.hpp:96</a></div></div>
<div class="ttc" id="anamespacedyno_html_aba8bf92162160923c6e5c7249892d5f8"><div class="ttname"><a href="namespacedyno.html#aba8bf92162160923c6e5c7249892d5f8">dyno::OpticalFlow</a></div><div class="ttdeci">gtsam::Point2 OpticalFlow</div><div class="ttdef"><b>Definition:</b> <a href="Types_8hpp_source.html#l00093">Types.hpp:94</a></div></div>
<div class="ttc" id="anamespacedyno_html_ae777b079c377ffa066d89051ee0cc623"><div class="ttname"><a href="namespacedyno.html#ae777b079c377ffa066d89051ee0cc623">dyno::ObjectIds</a></div><div class="ttdeci">std::vector&lt; ObjectId &gt; ObjectIds</div><div class="ttdef"><b>Definition:</b> <a href="Types_8hpp_source.html#l00071">Types.hpp:71</a></div></div>
<div class="ttc" id="anamespacedyno_html_ae78915ea0afc5025dafb398829f15ba3"><div class="ttname"><a href="namespacedyno.html#ae78915ea0afc5025dafb398829f15ba3">dyno::background_label</a></div><div class="ttdeci">static constexpr ObjectId background_label</div><div class="ttdoc">Expected label for the background in a semantic or motion mask.</div><div class="ttdef"><b>Definition:</b> <a href="Types_8hpp_source.html#l00188">Types.hpp:188</a></div></div>
<div class="ttc" id="astructdyno_1_1functional__keypoint_html_a24933450cad8bc70b7b76b339756cd94"><div class="ttname"><a href="structdyno_1_1functional__keypoint.html#a24933450cad8bc70b7b76b339756cd94">dyno::functional_keypoint::v</a></div><div class="ttdeci">static int v(const Keypoint &amp;kp)</div><div class="ttdef"><b>Definition:</b> <a href="Feature_8hpp_source.html#l00053">Feature.hpp:53</a></div></div>
<div class="ttc" id="astructdyno_1_1functional__keypoint_html_a3896d96a6f95b5311ae768cdd0ad97e8"><div class="ttname"><a href="structdyno_1_1functional__keypoint.html#a3896d96a6f95b5311ae768cdd0ad97e8">dyno::functional_keypoint::u</a></div><div class="ttdeci">static T u(const Keypoint &amp;kp)</div><div class="ttdef"><b>Definition:</b> <a href="Feature_8hpp_source.html#l00048">Feature.hpp:48</a></div></div>
</div><!-- fragment -->
<p class="reference">References <a class="el" href="classdyno_1_1ImageContainer.html#ae5eead678f02be0ab9de7464e1833c55">dyno::ImageContainer::objectMotionMask()</a>.</p>

<p class="reference">Referenced by <a class="el" href="classdyno_1_1FeatureTracker.html#a40ee79c94fe2de7f16d2a4508cc2ba11">track()</a>.</p>
<div class="dynheader">
Here is the call graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="classdyno_1_1FeatureTracker_a7877773d1c6d5b9cef0c379cd701c1e4_cgraph.png" border="0" usemap="#aclassdyno_1_1FeatureTracker_a7877773d1c6d5b9cef0c379cd701c1e4_cgraph" alt=""/></div>
<map name="aclassdyno_1_1FeatureTracker_a7877773d1c6d5b9cef0c379cd701c1e4_cgraph" id="aclassdyno_1_1FeatureTracker_a7877773d1c6d5b9cef0c379cd701c1e4_cgraph">
<area shape="rect" title=" " alt="" coords="5,5,163,45"/>
<area shape="rect" href="classdyno_1_1ImageContainer.html#ae5eead678f02be0ab9de7464e1833c55" title=" " alt="" coords="211,5,377,45"/>
</map>
</div>
<div class="dynheader">
Here is the caller graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="classdyno_1_1FeatureTracker_a7877773d1c6d5b9cef0c379cd701c1e4_icgraph.png" border="0" usemap="#aclassdyno_1_1FeatureTracker_a7877773d1c6d5b9cef0c379cd701c1e4_icgraph" alt=""/></div>
<map name="aclassdyno_1_1FeatureTracker_a7877773d1c6d5b9cef0c379cd701c1e4_icgraph" id="aclassdyno_1_1FeatureTracker_a7877773d1c6d5b9cef0c379cd701c1e4_icgraph">
<area shape="rect" title=" " alt="" coords="211,5,368,45"/>
<area shape="rect" href="classdyno_1_1FeatureTracker.html#a40ee79c94fe2de7f16d2a4508cc2ba11" title=" " alt="" coords="5,5,163,45"/>
</map>
</div>

</div>
</div>
<a id="ab50422938e62bccc34295c155357213a" name="ab50422938e62bccc34295c155357213a"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ab50422938e62bccc34295c155357213a">&#9670;&#160;</a></span>requiresSampling()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">void dyno::FeatureTracker::requiresSampling </td>
          <td>(</td>
          <td class="paramtype">std::set&lt; <a class="el" href="namespacedyno.html#a38bb86e4154b86428b8d133be03fb2b5">ObjectId</a> &gt; &amp;&#160;</td>
          <td class="paramname"><em>objects_to_sample</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const <a class="el" href="structdyno_1_1FeatureTrackerInfo.html">FeatureTrackerInfo</a> &amp;&#160;</td>
          <td class="paramname"><em>info</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const <a class="el" href="classdyno_1_1ImageContainer.html">ImageContainer</a> &amp;&#160;</td>
          <td class="paramname"><em>image_container</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const gtsam::FastMap&lt; <a class="el" href="namespacedyno.html#a38bb86e4154b86428b8d133be03fb2b5">ObjectId</a>, <a class="el" href="classdyno_1_1FeatureContainer.html">FeatureContainer</a> &gt; &amp;&#160;</td>
          <td class="paramname"><em>features_per_object</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const <a class="el" href="structdyno_1_1vision__tools_1_1ObjectBoundaryMaskResult.html">vision_tools::ObjectBoundaryMaskResult</a> &amp;&#160;</td>
          <td class="paramname"><em>boundary_mask_result</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const cv::Mat &amp;&#160;</td>
          <td class="paramname"><em>dynamic_tracking_mask</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td> const</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">protected</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>Check which objects require new features to be detected on them based on a set of 'keyframing' criteria. </p>
<p>The number of current tracks for each object is encapsualted in <a class="el" href="structdyno_1_1FeatureTrackerInfo.html">FeatureTrackerInfo</a>.</p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">objects_to_sample</td><td>std::set&lt;ObjectId&gt;&amp; </td></tr>
    <tr><td class="paramname">info</td><td>const <a class="el" href="structdyno_1_1FeatureTrackerInfo.html">FeatureTrackerInfo</a>&amp; </td></tr>
    <tr><td class="paramname">image_container</td><td>const <a class="el" href="classdyno_1_1ImageContainer.html" title="Basic class to contain Images which are the input for the DynoSAM system. Instead of just containing ...">ImageContainer</a>&amp; </td></tr>
    <tr><td class="paramname">features_per_object</td><td>const gtsam::FastMap&lt;ObjectId, <a class="el" href="classdyno_1_1FeatureContainer.html" title="Basic container mapping tracklet id&#39;s to a feature (pointer).">FeatureContainer</a>&gt;&amp; </td></tr>
    <tr><td class="paramname">boundary_mask_result</td><td>const <a class="el" href="structdyno_1_1vision__tools_1_1ObjectBoundaryMaskResult.html">vision_tools::ObjectBoundaryMaskResult</a>&amp; </td></tr>
    <tr><td class="paramname">dynamic_tracking_mask</td><td>const cv::Mat&amp; </td></tr>
  </table>
  </dd>
</dl>

<p class="definition">Definition at line <a class="el" href="FeatureTracker_8cc_source.html#l01023">1023</a> of file <a class="el" href="FeatureTracker_8cc_source.html">FeatureTracker.cc</a>.</p>
<div class="fragment"><div class="line"><span class="lineno"> 1028</span>                                              {</div>
<div class="line"><span class="lineno"> 1029</span>  VLOG(20) &lt;&lt; <span class="stringliteral">&quot;Starting sampling check&quot;</span>;</div>
<div class="line"><span class="lineno"> 1030</span>  <a class="code hl_typedef" href="namespacedyno.html#ae777b079c377ffa066d89051ee0cc623">ObjectIds</a> detected_objects = boundary_mask_result.objects_detected;</div>
<div class="line"><span class="lineno"> 1031</span> </div>
<div class="line"><span class="lineno"> 1032</span>  <span class="comment">// {</span></div>
<div class="line"><span class="lineno"> 1033</span>  <span class="comment">//   utils::TimingStatsCollector</span></div>
<div class="line"><span class="lineno"> 1034</span>  <span class="comment">//   timing(&quot;dynamic_feature_track_klt.get_labels&quot;); detected_objects =</span></div>
<div class="line"><span class="lineno"> 1035</span>  <span class="comment">//   vision_tools::getObjectLabels(image_container.objectMotionMask());</span></div>
<div class="line"><span class="lineno"> 1036</span>  <span class="comment">// }</span></div>
<div class="line"><span class="lineno"> 1037</span> </div>
<div class="line"><span class="lineno"> 1038</span>  {</div>
<div class="line"><span class="lineno"> 1039</span>    <span class="comment">// sanity check assert</span></div>
<div class="line"><span class="lineno"> 1040</span>    CHECK(<a class="code hl_function" href="namespacedyno.html#ab5ae05966c6056b343a960a80c5b1db3">equals_with_abs_tol</a>(detected_objects,</div>
<div class="line"><span class="lineno"> 1041</span>                              boundary_mask_result.objects_detected))</div>
<div class="line"><span class="lineno"> 1042</span>        &lt;&lt; <span class="stringliteral">&quot;Explicit detected objects &quot;</span> &lt;&lt; <a class="code hl_function" href="namespacedyno.html#a17d3c448677824ae83870358b2a3e01d">container_to_string</a>(detected_objects)</div>
<div class="line"><span class="lineno"> 1043</span>        &lt;&lt; <span class="stringliteral">&quot; != boundary mask result: &quot;</span></div>
<div class="line"><span class="lineno"> 1044</span>        &lt;&lt; <a class="code hl_function" href="namespacedyno.html#a17d3c448677824ae83870358b2a3e01d">container_to_string</a>(boundary_mask_result.objects_detected)</div>
<div class="line"><span class="lineno"> 1045</span>        &lt;&lt; <span class="stringliteral">&quot; this could happen if the object mask changes dramatically...!!&quot;</span>;</div>
<div class="line"><span class="lineno"> 1046</span>  }</div>
<div class="line"><span class="lineno"> 1047</span> </div>
<div class="line"><span class="lineno"> 1048</span>  <span class="keywordflow">if</span> (!<a class="code hl_variable" href="classdyno_1_1FeatureTracker.html#a879d0cd574b194e89bffbe05f85c23fc">previous_frame_</a>) {</div>
<div class="line"><span class="lineno"> 1049</span>    <span class="keywordflow">if</span> (!detected_objects.empty()) {</div>
<div class="line"><span class="lineno"> 1050</span>      VLOG(5) &lt;&lt; <span class="stringliteral">&quot;All objects sampled as first frame&quot;</span>;</div>
<div class="line"><span class="lineno"> 1051</span>      objects_to_sample.insert(detected_objects.begin(),</div>
<div class="line"><span class="lineno"> 1052</span>                               detected_objects.end());</div>
<div class="line"><span class="lineno"> 1053</span>    }</div>
<div class="line"><span class="lineno"> 1054</span>    <span class="keywordflow">return</span>;</div>
<div class="line"><span class="lineno"> 1055</span>  }</div>
<div class="line"><span class="lineno"> 1056</span> </div>
<div class="line"><span class="lineno"> 1057</span>  <span class="keyword">const</span> <span class="keywordtype">int</span>&amp; max_dynamic_point_age = <a class="code hl_variable" href="classdyno_1_1FeatureTrackerBase.html#a04f0948954381269fedd5a6856662cb7">params_</a>.<a class="code hl_variable" href="structdyno_1_1TrackerParams.html#a169251cb91b823891ca91504f9486e3f">max_dynamic_feature_age</a>;</div>
<div class="line"><span class="lineno"> 1058</span>  <span class="comment">// bascially how early we want to retrack points based on their expiry</span></div>
<div class="line"><span class="lineno"> 1059</span>  <span class="comment">// it takes a few frames for the feature to end up in the backend (ie. at</span></div>
<div class="line"><span class="lineno"> 1060</span>  <span class="comment">// least twice, to ensure a valid track) so we want to track new points</span></div>
<div class="line"><span class="lineno"> 1061</span>  <span class="comment">// earlier than that to ensure we dont have a frame with NO points</span></div>
<div class="line"><span class="lineno"> 1062</span>  <span class="keyword">const</span> <span class="keyword">auto</span> age_buffer = std::max(3, <a class="code hl_variable" href="classdyno_1_1FeatureTrackerBase.html#a04f0948954381269fedd5a6856662cb7">params_</a>.<a class="code hl_variable" href="structdyno_1_1TrackerParams.html#a00b27430778f5c780b624732d29d1438">dynamic_feature_age_buffer</a>);</div>
<div class="line"><span class="lineno"> 1063</span>  <span class="keyword">const</span> <span class="keyword">auto</span>&amp; min_dynamic_tracks = <a class="code hl_variable" href="classdyno_1_1FeatureTrackerBase.html#a04f0948954381269fedd5a6856662cb7">params_</a>.<a class="code hl_variable" href="structdyno_1_1TrackerParams.html#a84df3942974daf36a5d755d1feec054f">min_dynamic_tracks</a>;</div>
<div class="line"><span class="lineno"> 1064</span>  <span class="keyword">const</span> <span class="keyword">auto</span>&amp; min_iou = <a class="code hl_variable" href="classdyno_1_1FeatureTrackerBase.html#a04f0948954381269fedd5a6856662cb7">params_</a>.<a class="code hl_variable" href="structdyno_1_1TrackerParams.html#a436b19f6f3bcc3efea725166fa2fab44">min_dynamic_mask_iou</a>;</div>
<div class="line"><span class="lineno"> 1065</span>  <span class="keyword">const</span> <span class="keywordtype">size_t</span> expiry_age =</div>
<div class="line"><span class="lineno"> 1066</span>      <span class="keyword">static_cast&lt;</span><span class="keywordtype">size_t</span><span class="keyword">&gt;</span>(max_dynamic_point_age - age_buffer);</div>
<div class="line"><span class="lineno"> 1067</span>  CHECK_GT(expiry_age, 0u);</div>
<div class="line"><span class="lineno"> 1068</span> </div>
<div class="line"><span class="lineno"> 1069</span>  <span class="keywordflow">for</span> (<span class="keywordtype">size_t</span> i = 0; i &lt; detected_objects.size(); i++) {</div>
<div class="line"><span class="lineno"> 1070</span>    <a class="code hl_typedef" href="namespacedyno.html#a38bb86e4154b86428b8d133be03fb2b5">ObjectId</a> object_id = detected_objects.at(i);</div>
<div class="line"><span class="lineno"> 1071</span> </div>
<div class="line"><span class="lineno"> 1072</span>    <span class="comment">// object is tracked and therefore should exist in the previous frame!</span></div>
<div class="line"><span class="lineno"> 1073</span>    <span class="keywordflow">if</span> (info.dynamic_track.exists(object_id)) {</div>
<div class="line"><span class="lineno"> 1074</span>      <span class="keyword">const</span> <span class="keyword">auto</span>&amp; per_object_status = info.dynamic_track.at(object_id);</div>
<div class="line"><span class="lineno"> 1075</span> </div>
<div class="line"><span class="lineno"> 1076</span>      <span class="keywordflow">if</span> (!features_per_object.exists(object_id)) {</div>
<div class="line"><span class="lineno"> 1077</span>        LOG(WARNING) &lt;&lt; <span class="stringliteral">&quot;Object &quot;</span> &lt;&lt; object_id</div>
<div class="line"><span class="lineno"> 1078</span>                     &lt;&lt; <span class="stringliteral">&quot; found in mask and info at k=&quot;</span> &lt;&lt; info.frame_id</div>
<div class="line"><span class="lineno"> 1079</span>                     &lt;&lt; <span class="stringliteral">&quot; but missing tracked features. Skipping...&quot;</span>;</div>
<div class="line"><span class="lineno"> 1080</span>        <span class="keywordflow">continue</span>;</div>
<div class="line"><span class="lineno"> 1081</span>      }</div>
<div class="line"><span class="lineno"> 1082</span>      <span class="keyword">const</span> FeatureContainer&amp; per_object_tracks =</div>
<div class="line"><span class="lineno"> 1083</span>          features_per_object.at(object_id);</div>
<div class="line"><span class="lineno"> 1084</span>      <span class="keywordtype">size_t</span> num_tracked = per_object_status.num_track;</div>
<div class="line"><span class="lineno"> 1085</span>      CHECK_EQ(num_tracked, per_object_tracks.size());</div>
<div class="line"><span class="lineno"> 1086</span>      <span class="comment">// if more than 80% of points on the object are going to expire within the</span></div>
<div class="line"><span class="lineno"> 1087</span>      <span class="comment">// next (at least 3) frames</span></div>
<div class="line"><span class="lineno"> 1088</span>      <span class="keywordtype">size_t</span> are_geriatric = 0u;</div>
<div class="line"><span class="lineno"> 1089</span>      <span class="keywordflow">for</span> (<span class="keyword">const</span> <span class="keyword">auto</span>&amp; feature : per_object_tracks) {</div>
<div class="line"><span class="lineno"> 1090</span>        <span class="keywordtype">size_t</span> age = feature-&gt;age();</div>
<div class="line"><span class="lineno"> 1091</span>        <span class="keywordflow">if</span> (age &gt; expiry_age) {</div>
<div class="line"><span class="lineno"> 1092</span>          are_geriatric++;</div>
<div class="line"><span class="lineno"> 1093</span>        }</div>
<div class="line"><span class="lineno"> 1094</span>      }</div>
<div class="line"><span class="lineno"> 1095</span>      <span class="keyword">const</span> <span class="keywordtype">bool</span> many_old_points =</div>
<div class="line"><span class="lineno"> 1096</span>          (double)are_geriatric / (<span class="keywordtype">double</span>)num_tracked &gt; 0.8;</div>
<div class="line"><span class="lineno"> 1097</span>      <span class="comment">// if we have less than N tracks</span></div>
<div class="line"><span class="lineno"> 1098</span>      <span class="keyword">const</span> <span class="keywordtype">bool</span> too_few_tracks = num_tracked &lt; min_dynamic_tracks;</div>
<div class="line"><span class="lineno"> 1099</span>      <span class="comment">// eventually also area based tings</span></div>
<div class="line"><span class="lineno"> 1100</span> </div>
<div class="line"><span class="lineno"> 1101</span>      <span class="comment">// bounding box of the whole mask, representing the object detected in the</span></div>
<div class="line"><span class="lineno"> 1102</span>      <span class="comment">// actual image</span></div>
<div class="line"><span class="lineno"> 1103</span>      <span class="keyword">const</span> cv::Rect&amp; detection_bb =</div>
<div class="line"><span class="lineno"> 1104</span>          boundary_mask_result.inner_boarder_object_bounding_boxes.at(i);</div>
<div class="line"><span class="lineno"> 1105</span> </div>
<div class="line"><span class="lineno"> 1106</span>      <span class="comment">// bounding box of the tracked feature points on the object</span></div>
<div class="line"><span class="lineno"> 1107</span>      cv::Rect tracked_bb;</div>
<div class="line"><span class="lineno"> 1108</span>      {</div>
<div class="line"><span class="lineno"> 1109</span>        utils::TimingStatsCollector timing(</div>
<div class="line"><span class="lineno"> 1110</span>            <span class="stringliteral">&quot;dynamic_feature_track_klt.tracking_BB&quot;</span>);</div>
<div class="line"><span class="lineno"> 1111</span>        tracked_bb =</div>
<div class="line"><span class="lineno"> 1112</span>            cv::boundingRect(per_object_tracks.toOpenCV(<span class="keyword">nullptr</span>, <span class="keyword">true</span>));</div>
<div class="line"><span class="lineno"> 1113</span>      }</div>
<div class="line"><span class="lineno"> 1114</span>      <span class="keywordtype">double</span> iou;</div>
<div class="line"><span class="lineno"> 1115</span>      {</div>
<div class="line"><span class="lineno"> 1116</span>        utils::TimingStatsCollector timing(<span class="stringliteral">&quot;dynamic_feature_track_klt.iou&quot;</span>);</div>
<div class="line"><span class="lineno"> 1117</span>        iou = <a class="code hl_function" href="namespacedyno_1_1utils.html#a6176c158eee250623d90248c77177fec">utils::calculateIoU</a>(detection_bb, tracked_bb);</div>
<div class="line"><span class="lineno"> 1118</span>      }</div>
<div class="line"><span class="lineno"> 1119</span>      <span class="keyword">const</span> <span class="keywordtype">bool</span> small_iou = iou &lt; min_iou;</div>
<div class="line"><span class="lineno"> 1120</span> </div>
<div class="line"><span class="lineno"> 1121</span>      <span class="keyword">const</span> <span class="keywordtype">bool</span> needs_sampling =</div>
<div class="line"><span class="lineno"> 1122</span>          many_old_points || too_few_tracks || small_iou;</div>
<div class="line"><span class="lineno"> 1123</span> </div>
<div class="line"><span class="lineno"> 1124</span>      <span class="keywordflow">if</span> (needs_sampling) {</div>
<div class="line"><span class="lineno"> 1125</span>        objects_to_sample.insert(object_id);</div>
<div class="line"><span class="lineno"> 1126</span> </div>
<div class="line"><span class="lineno"> 1127</span>        VLOG(5) &lt;&lt; <span class="stringliteral">&quot;Object &quot;</span> &lt;&lt; <a class="code hl_function" href="namespacedyno.html#a7d1c7a6dc85df63392893631e436d45e">info_string</a>(info.frame_id, object_id)</div>
<div class="line"><span class="lineno"> 1128</span>                &lt;&lt; <span class="stringliteral">&quot; requires sampling&quot;</span>;</div>
<div class="line"><span class="lineno"> 1129</span> </div>
<div class="line"><span class="lineno"> 1130</span>        VLOG_IF(5, many_old_points) &lt;&lt; <span class="stringliteral">&quot;Sampling reason: too many old points&quot;</span>;</div>
<div class="line"><span class="lineno"> 1131</span>        VLOG_IF(5, too_few_tracks) &lt;&lt; <span class="stringliteral">&quot;Sampling reason: too few points&quot;</span>;</div>
<div class="line"><span class="lineno"> 1132</span>        VLOG_IF(5, small_iou) &lt;&lt; <span class="stringliteral">&quot;Sampling reason: IoU too small&quot;</span>;</div>
<div class="line"><span class="lineno"> 1133</span>      }</div>
<div class="line"><span class="lineno"> 1134</span>    } <span class="keywordflow">else</span> {</div>
<div class="line"><span class="lineno"> 1135</span>      objects_to_sample.insert(object_id);</div>
<div class="line"><span class="lineno"> 1136</span>      VLOG(5) &lt;&lt; <span class="stringliteral">&quot;Object &quot;</span> &lt;&lt; <a class="code hl_function" href="namespacedyno.html#a7d1c7a6dc85df63392893631e436d45e">info_string</a>(info.frame_id, object_id)</div>
<div class="line"><span class="lineno"> 1137</span>              &lt;&lt; <span class="stringliteral">&quot; requires sampling. Sampling reason: new object&quot;</span>;</div>
<div class="line"><span class="lineno"> 1138</span>    }</div>
<div class="line"><span class="lineno"> 1139</span>  }</div>
<div class="line"><span class="lineno"> 1140</span>}</div>
<div class="ttc" id="anamespacedyno_1_1utils_html_a6176c158eee250623d90248c77177fec"><div class="ttname"><a href="namespacedyno_1_1utils.html#a6176c158eee250623d90248c77177fec">dyno::utils::calculateIoU</a></div><div class="ttdeci">double calculateIoU(const cv::Rect &amp;a, const cv::Rect &amp;b)</div><div class="ttdef"><b>Definition:</b> <a href="OpenCVUtils_8cc_source.html#l00087">OpenCVUtils.cc:87</a></div></div>
<div class="ttc" id="anamespacedyno_html_a17d3c448677824ae83870358b2a3e01d"><div class="ttname"><a href="namespacedyno.html#a17d3c448677824ae83870358b2a3e01d">dyno::container_to_string</a></div><div class="ttdeci">std::string container_to_string(const Container &amp;container, const std::string &amp;delimiter=&quot; &quot;)</div><div class="ttdef"><b>Definition:</b> <a href="Types_8hpp_source.html#l00717">Types.hpp:717</a></div></div>
<div class="ttc" id="anamespacedyno_html_a7d1c7a6dc85df63392893631e436d45e"><div class="ttname"><a href="namespacedyno.html#a7d1c7a6dc85df63392893631e436d45e">dyno::info_string</a></div><div class="ttdeci">std::string info_string(FrameId frame_id, ObjectId object_id)</div><div class="ttdef"><b>Definition:</b> <a href="Types_8hpp_source.html#l00726">Types.hpp:726</a></div></div>
<div class="ttc" id="anamespacedyno_html_ab5ae05966c6056b343a960a80c5b1db3"><div class="ttname"><a href="namespacedyno.html#ab5ae05966c6056b343a960a80c5b1db3">dyno::equals_with_abs_tol</a></div><div class="ttdeci">bool equals_with_abs_tol(const std::vector&lt; T &gt; &amp;vec1, const std::vector&lt; T &gt; &amp;vec2, double tol=1e-9)</div><div class="ttdef"><b>Definition:</b> <a href="Numerical_8hpp_source.html#l00195">Numerical.hpp:195</a></div></div>
<div class="ttc" id="astructdyno_1_1TrackerParams_html_a00b27430778f5c780b624732d29d1438"><div class="ttname"><a href="structdyno_1_1TrackerParams.html#a00b27430778f5c780b624732d29d1438">dyno::TrackerParams::dynamic_feature_age_buffer</a></div><div class="ttdeci">int dynamic_feature_age_buffer</div><div class="ttdoc">How early we want to retrack points based on their expiry age.</div><div class="ttdef"><b>Definition:</b> <a href="TrackerParams_8hpp_source.html#l00138">TrackerParams.hpp:138</a></div></div>
<div class="ttc" id="astructdyno_1_1TrackerParams_html_a169251cb91b823891ca91504f9486e3f"><div class="ttname"><a href="structdyno_1_1TrackerParams.html#a169251cb91b823891ca91504f9486e3f">dyno::TrackerParams::max_dynamic_feature_age</a></div><div class="ttdeci">size_t max_dynamic_feature_age</div><div class="ttdef"><b>Definition:</b> <a href="TrackerParams_8hpp_source.html#l00134">TrackerParams.hpp:134</a></div></div>
<div class="ttc" id="astructdyno_1_1TrackerParams_html_a436b19f6f3bcc3efea725166fa2fab44"><div class="ttname"><a href="structdyno_1_1TrackerParams.html#a436b19f6f3bcc3efea725166fa2fab44">dyno::TrackerParams::min_dynamic_mask_iou</a></div><div class="ttdeci">double min_dynamic_mask_iou</div><div class="ttdef"><b>Definition:</b> <a href="TrackerParams_8hpp_source.html#l00143">TrackerParams.hpp:143</a></div></div>
<div class="ttc" id="astructdyno_1_1TrackerParams_html_a84df3942974daf36a5d755d1feec054f"><div class="ttname"><a href="structdyno_1_1TrackerParams.html#a84df3942974daf36a5d755d1feec054f">dyno::TrackerParams::min_dynamic_tracks</a></div><div class="ttdeci">int min_dynamic_tracks</div><div class="ttdoc">Smallest number of good tracks on an object before re-sampling.</div><div class="ttdef"><b>Definition:</b> <a href="TrackerParams_8hpp_source.html#l00140">TrackerParams.hpp:140</a></div></div>
</div><!-- fragment -->
<p class="reference">References <a class="el" href="namespacedyno.html#a17d3c448677824ae83870358b2a3e01d">dyno::container_to_string()</a>, <a class="el" href="structdyno_1_1FeatureTrackerInfo.html#a0bcb89c858b27efb711f174b860cafe0">dyno::FeatureTrackerInfo::dynamic_track</a>, <a class="el" href="namespacedyno.html#ab5ae05966c6056b343a960a80c5b1db3">dyno::equals_with_abs_tol()</a>, <a class="el" href="structdyno_1_1FeatureTrackerInfo.html#a3e451313696cef2553e256c4136f6096">dyno::FeatureTrackerInfo::frame_id</a>, <a class="el" href="namespacedyno.html#a7d1c7a6dc85df63392893631e436d45e">dyno::info_string()</a>, <a class="el" href="structdyno_1_1vision__tools_1_1ObjectBoundaryMaskResult.html#a958a5bea7c6cd388fcd88bfde7b2a730">dyno::vision_tools::ObjectBoundaryMaskResult::inner_boarder_object_bounding_boxes</a>, <a class="el" href="structdyno_1_1vision__tools_1_1ObjectBoundaryMaskResult.html#a1c842ce8ec0121d8f5e71ba0e48a7a6b">dyno::vision_tools::ObjectBoundaryMaskResult::objects_detected</a>, <a class="el" href="classdyno_1_1FeatureContainer.html#afd095f6a9e0f25539e7febe6eeeaf003">dyno::FeatureContainer::size()</a>, and <a class="el" href="classdyno_1_1FeatureContainer.html#a00fb07fccff523cba9783e6d00186f28">dyno::FeatureContainer::toOpenCV()</a>.</p>

<p class="reference">Referenced by <a class="el" href="classdyno_1_1FeatureTracker.html#a145614fe29bef7728075492870ac9c41">trackDynamic()</a>, and <a class="el" href="classdyno_1_1FeatureTracker.html#a4796a29c1f89cde0ace1668fc8fcd9a3">trackDynamicKLT()</a>.</p>
<div class="dynheader">
Here is the call graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="classdyno_1_1FeatureTracker_ab50422938e62bccc34295c155357213a_cgraph.png" border="0" usemap="#aclassdyno_1_1FeatureTracker_ab50422938e62bccc34295c155357213a_cgraph" alt=""/></div>
<map name="aclassdyno_1_1FeatureTracker_ab50422938e62bccc34295c155357213a_cgraph" id="aclassdyno_1_1FeatureTracker_ab50422938e62bccc34295c155357213a_cgraph">
<area shape="rect" title="Check which objects require new features to be detected on them based on a set of &#39;keyframing&#39; criter..." alt="" coords="5,112,163,152"/>
<area shape="rect" href="namespacedyno.html#a17d3c448677824ae83870358b2a3e01d" title=" " alt="" coords="237,5,379,45"/>
<area shape="rect" href="namespacedyno.html#ab5ae05966c6056b343a960a80c5b1db3" title=" " alt="" coords="211,70,405,95"/>
<area shape="rect" href="namespacedyno.html#a7d1c7a6dc85df63392893631e436d45e" title=" " alt="" coords="243,119,373,145"/>
<area shape="rect" href="classdyno_1_1FeatureContainer.html#afd095f6a9e0f25539e7febe6eeeaf003" title="Returns the number of features in the container." alt="" coords="221,169,395,209"/>
<area shape="rect" href="classdyno_1_1FeatureContainer.html#a00fb07fccff523cba9783e6d00186f28" title="Converts the keypoints of all features in the container to cv::Point2f representation...." alt="" coords="221,233,395,273"/>
<area shape="rect" href="namespacedyno.html#adf545b8b790321f0f83e16e7b4927192" title="Float point comparison up to a tolerance." alt="" coords="453,70,564,95"/>
</map>
</div>
<div class="dynheader">
Here is the caller graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="classdyno_1_1FeatureTracker_ab50422938e62bccc34295c155357213a_icgraph.png" border="0" usemap="#aclassdyno_1_1FeatureTracker_ab50422938e62bccc34295c155357213a_icgraph" alt=""/></div>
<map name="aclassdyno_1_1FeatureTracker_ab50422938e62bccc34295c155357213a_icgraph" id="aclassdyno_1_1FeatureTracker_ab50422938e62bccc34295c155357213a_icgraph">
<area shape="rect" title="Check which objects require new features to be detected on them based on a set of &#39;keyframing&#39; criter..." alt="" coords="416,37,573,77"/>
<area shape="rect" href="classdyno_1_1FeatureTracker.html#a145614fe29bef7728075492870ac9c41" title=" " alt="" coords="211,5,368,45"/>
<area shape="rect" href="classdyno_1_1FeatureTracker.html#a4796a29c1f89cde0ace1668fc8fcd9a3" title=" " alt="" coords="211,69,368,109"/>
<area shape="rect" href="classdyno_1_1FeatureTracker.html#a40ee79c94fe2de7f16d2a4508cc2ba11" title=" " alt="" coords="5,37,163,77"/>
</map>
</div>

</div>
</div>
<a id="af6093d870bad67d12dee0c9cb913f87c" name="af6093d870bad67d12dee0c9cb913f87c"></a>
<h2 class="memtitle"><span class="permalink"><a href="#af6093d870bad67d12dee0c9cb913f87c">&#9670;&#160;</a></span>sampleDynamic()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">void dyno::FeatureTracker::sampleDynamic </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="namespacedyno.html#ac4303d6fafb755f794b072d76f9cfb41">FrameId</a>&#160;</td>
          <td class="paramname"><em>frame_id</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const <a class="el" href="classdyno_1_1ImageContainer.html">ImageContainer</a> &amp;&#160;</td>
          <td class="paramname"><em>image_container</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const std::set&lt; <a class="el" href="namespacedyno.html#a38bb86e4154b86428b8d133be03fb2b5">ObjectId</a> &gt; &amp;&#160;</td>
          <td class="paramname"><em>objects_to_sample</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="classdyno_1_1FeatureContainer.html">FeatureContainer</a> &amp;&#160;</td>
          <td class="paramname"><em>dynamic_features</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">std::set&lt; <a class="el" href="namespacedyno.html#a38bb86e4154b86428b8d133be03fb2b5">ObjectId</a> &gt; &amp;&#160;</td>
          <td class="paramname"><em>objects_sampled</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const cv::Mat &amp;&#160;</td>
          <td class="paramname"><em>detection_mask</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">protected</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="FeatureTracker_8cc_source.html#l00869">869</a> of file <a class="el" href="FeatureTracker_8cc_source.html">FeatureTracker.cc</a>.</p>
<div class="fragment"><div class="line"><span class="lineno">  874</span>                                                                {</div>
<div class="line"><span class="lineno">  875</span>  <span class="keyword">struct </span>KeypointData {</div>
<div class="line"><span class="lineno">  876</span>    <a class="code hl_typedef" href="namespacedyno.html#aba8bf92162160923c6e5c7249892d5f8">OpticalFlow</a> flow;</div>
<div class="line"><span class="lineno">  877</span>    <a class="code hl_typedef" href="namespacedyno.html#aaa260a8022691078c59e1ac6a4fa05b5">Keypoint</a> predicted_kp;</div>
<div class="line"><span class="lineno">  878</span>  };</div>
<div class="line"><span class="lineno">  879</span> </div>
<div class="line"><span class="lineno">  880</span>  <span class="keyword">const</span> cv::Mat&amp; rgb = image_container.rgb();</div>
<div class="line"><span class="lineno">  881</span>  <span class="comment">// flow is going to take us from THIS frame to the next frame (which does not</span></div>
<div class="line"><span class="lineno">  882</span>  <span class="comment">// make sense for a realtime system)</span></div>
<div class="line"><span class="lineno">  883</span>  <span class="keyword">const</span> cv::Mat&amp; flow = image_container.opticalFlow();</div>
<div class="line"><span class="lineno">  884</span>  <span class="keyword">const</span> cv::Mat&amp; motion_mask = image_container.objectMotionMask();</div>
<div class="line"><span class="lineno">  885</span> </div>
<div class="line"><span class="lineno">  886</span>  TrackletIdManager&amp; tracked_id_manager = <a class="code hl_function" href="classdyno_1_1TrackletIdManager.html#a53cb3472fa0367b8dd2a9127111277b2">TrackletIdManager::instance</a>();</div>
<div class="line"><span class="lineno">  887</span> </div>
<div class="line"><span class="lineno">  888</span>  <span class="comment">// container to store keypoints per object</span></div>
<div class="line"><span class="lineno">  889</span>  tbb::concurrent_hash_map&lt;ObjectId, KeypointsCV&gt; sampled_keypoints;</div>
<div class="line"><span class="lineno">  890</span>  <span class="keyword">const</span> <span class="keywordtype">int</span> rows = rgb.rows;</div>
<div class="line"><span class="lineno">  891</span>  <span class="keyword">const</span> <span class="keywordtype">int</span> cols = rgb.cols;</div>
<div class="line"><span class="lineno">  892</span> </div>
<div class="line"><span class="lineno">  893</span>  std::vector&lt;KeypointData&gt; cached_keypoint_data;</div>
<div class="line"><span class="lineno">  894</span>  cached_keypoint_data.resize(rows * cols);</div>
<div class="line"><span class="lineno">  895</span>  <span class="comment">// TODO: since we&#39;re looping over the whole image here anyway why dont we also</span></div>
<div class="line"><span class="lineno">  896</span>  <span class="comment">// use this to create the dense point cloud image and then pass it to the</span></div>
<div class="line"><span class="lineno">  897</span>  <span class="comment">// frame!!!</span></div>
<div class="line"><span class="lineno">  898</span>  std::mutex mutex;</div>
<div class="line"><span class="lineno">  899</span>  tbb::parallel_for(0, rows, [&amp;](<span class="keywordtype">int</span> i) {</div>
<div class="line"><span class="lineno">  900</span>    <span class="keyword">const</span> <span class="keywordtype">unsigned</span> <span class="keywordtype">char</span>* detection_ptr = detection_mask.ptr&lt;<span class="keywordtype">unsigned</span> <span class="keywordtype">char</span>&gt;(i);</div>
<div class="line"><span class="lineno">  901</span>    <span class="keyword">const</span> <a class="code hl_typedef" href="namespacedyno.html#a38bb86e4154b86428b8d133be03fb2b5">ObjectId</a>* motion_ptr = motion_mask.ptr&lt;<a class="code hl_typedef" href="namespacedyno.html#a38bb86e4154b86428b8d133be03fb2b5">ObjectId</a>&gt;(i);</div>
<div class="line"><span class="lineno">  902</span>    <span class="keyword">const</span> cv::Vec2f* flow_ptr = flow.ptr&lt;cv::Vec2f&gt;(i);</div>
<div class="line"><span class="lineno">  903</span> </div>
<div class="line"><span class="lineno">  904</span>    <span class="keywordflow">for</span> (<span class="keywordtype">int</span> j = 0; j &lt; cols; j++) {</div>
<div class="line"><span class="lineno">  905</span>      <span class="keywordflow">if</span> (detection_ptr[j] == 0) <span class="keywordflow">continue</span>;  <span class="comment">// Skip invalid pixels</span></div>
<div class="line"><span class="lineno">  906</span> </div>
<div class="line"><span class="lineno">  907</span>      <a class="code hl_typedef" href="namespacedyno.html#a38bb86e4154b86428b8d133be03fb2b5">ObjectId</a> object_id = motion_ptr[j];</div>
<div class="line"><span class="lineno">  908</span> </div>
<div class="line"><span class="lineno">  909</span>      <span class="comment">// skip if this object does not need to be sampled</span></div>
<div class="line"><span class="lineno">  910</span>      <span class="keywordflow">if</span> (objects_to_sample.find(object_id) == objects_to_sample.end()) {</div>
<div class="line"><span class="lineno">  911</span>        <span class="keywordflow">continue</span>;</div>
<div class="line"><span class="lineno">  912</span>      }</div>
<div class="line"><span class="lineno">  913</span> </div>
<div class="line"><span class="lineno">  914</span>      <span class="keywordflow">if</span> (object_id == <a class="code hl_variable" href="namespacedyno.html#ae78915ea0afc5025dafb398829f15ba3">background_label</a>) <span class="keywordflow">continue</span>;</div>
<div class="line"><span class="lineno">  915</span> </div>
<div class="line"><span class="lineno">  916</span>      <span class="keywordtype">double</span> flow_xe = <span class="keyword">static_cast&lt;</span><span class="keywordtype">double</span><span class="keyword">&gt;</span>(flow_ptr[j][0]);</div>
<div class="line"><span class="lineno">  917</span>      <span class="keywordtype">double</span> flow_ye = <span class="keyword">static_cast&lt;</span><span class="keywordtype">double</span><span class="keyword">&gt;</span>(flow_ptr[j][1]);</div>
<div class="line"><span class="lineno">  918</span>      <span class="keywordflow">if</span> (flow_xe == 0 || flow_ye == 0) {</div>
<div class="line"><span class="lineno">  919</span>        <span class="keyword">const</span> std::lock_guard&lt;std::mutex&gt; lock(mutex);</div>
<div class="line"><span class="lineno">  920</span>        <a class="code hl_variable" href="classdyno_1_1FeatureTracker.html#aaf08b9f655f94c59eadf15564f2e69f3">info_</a>.<a class="code hl_function" href="structdyno_1_1FeatureTrackerInfo.html#a8d5e1a05167ecd041783f39243dd508e">getObjectStatus</a>(object_id).<a class="code hl_variable" href="structdyno_1_1PerObjectStatus.html#aed2f4e73fd0c2100788cc0fa0ecbc8b1">num_zero_flow</a>++;</div>
<div class="line"><span class="lineno">  921</span>        <span class="keywordflow">continue</span>;</div>
<div class="line"><span class="lineno">  922</span>      }</div>
<div class="line"><span class="lineno">  923</span> </div>
<div class="line"><span class="lineno">  924</span>      <a class="code hl_typedef" href="namespacedyno.html#aba8bf92162160923c6e5c7249892d5f8">OpticalFlow</a> flow(flow_xe, flow_ye);</div>
<div class="line"><span class="lineno">  925</span>      <a class="code hl_typedef" href="namespacedyno.html#aaa260a8022691078c59e1ac6a4fa05b5">Keypoint</a> keypoint(j, i);</div>
<div class="line"><span class="lineno">  926</span>      <a class="code hl_typedef" href="namespacedyno.html#aaa260a8022691078c59e1ac6a4fa05b5">Keypoint</a> predicted_kp =</div>
<div class="line"><span class="lineno">  927</span>          <a class="code hl_function" href="classdyno_1_1Feature.html#a37dbbe8da704c2f51e237d38760534fb">Feature::CalculatePredictedKeypoint</a>(keypoint, flow);</div>
<div class="line"><span class="lineno">  928</span> </div>
<div class="line"><span class="lineno">  929</span>      <span class="keywordflow">if</span> (<a class="code hl_function" href="classdyno_1_1FeatureTrackerBase.html#a32d80be7e74a096c2b816529b7fd2c69">isWithinShrunkenImage</a>(keypoint)) {</div>
<div class="line"><span class="lineno">  930</span>        <span class="keywordtype">int</span> cache_index = i * cols + j;</div>
<div class="line"><span class="lineno">  931</span> </div>
<div class="line"><span class="lineno">  932</span>        <span class="comment">// Directly assign instead of creating a new object</span></div>
<div class="line"><span class="lineno">  933</span>        cached_keypoint_data[cache_index] = {flow, predicted_kp};</div>
<div class="line"><span class="lineno">  934</span> </div>
<div class="line"><span class="lineno">  935</span>        <a class="code hl_typedef" href="namespacedyno.html#ae0b7b312ca1880ca7030acdbe981966a">KeypointCV</a> opencv_keypoint = <a class="code hl_function" href="namespacedyno_1_1utils.html#a5f3c7f83fac92f1c3d2d11d41927a205">utils::gtsamPointToKeyPoint</a>(keypoint);</div>
<div class="line"><span class="lineno">  936</span>        opencv_keypoint.class_id = cache_index;</div>
<div class="line"><span class="lineno">  937</span> </div>
<div class="line"><span class="lineno">  938</span>        tbb::concurrent_hash_map&lt;ObjectId, KeypointsCV&gt;::accessor acc;</div>
<div class="line"><span class="lineno">  939</span>        <span class="keywordflow">if</span> (sampled_keypoints.insert(acc, object_id)) {</div>
<div class="line"><span class="lineno">  940</span>          acc-&gt;second = <a class="code hl_typedef" href="namespacedyno.html#ae45b8b62a0efd7dbcf047db8751f6739">KeypointsCV</a>{};  <span class="comment">// Initialize with an empty vector</span></div>
<div class="line"><span class="lineno">  941</span>        }</div>
<div class="line"><span class="lineno">  942</span>        acc-&gt;second.push_back(opencv_keypoint);  <span class="comment">// Add keypoint safely</span></div>
<div class="line"><span class="lineno">  943</span> </div>
<div class="line"><span class="lineno">  944</span>        <span class="comment">// is this going to be slow?</span></div>
<div class="line"><span class="lineno">  945</span>        <span class="comment">// need the statusObject to exit by the time we get to the next tbb loop</span></div>
<div class="line"><span class="lineno">  946</span>        <span class="comment">// so we can get the number of tracks</span></div>
<div class="line"><span class="lineno">  947</span>        <span class="keyword">const</span> std::lock_guard&lt;std::mutex&gt; lock(mutex);</div>
<div class="line"><span class="lineno">  948</span>        <a class="code hl_variable" href="classdyno_1_1FeatureTracker.html#aaf08b9f655f94c59eadf15564f2e69f3">info_</a>.<a class="code hl_function" href="structdyno_1_1FeatureTrackerInfo.html#a8d5e1a05167ecd041783f39243dd508e">getObjectStatus</a>(object_id).<a class="code hl_variable" href="structdyno_1_1PerObjectStatus.html#a3d7fa1487d536d3845f96da8ff173fb8">num_sampled</a>++;</div>
<div class="line"><span class="lineno">  949</span>        <span class="comment">// object_tracking_info.num_sampled++;</span></div>
<div class="line"><span class="lineno">  950</span> </div>
<div class="line"><span class="lineno">  951</span>      } <span class="keywordflow">else</span> {</div>
<div class="line"><span class="lineno">  952</span>        <span class="comment">// const std::lock_guard&lt;std::mutex&gt; lock(mutex);</span></div>
<div class="line"><span class="lineno">  953</span>        <span class="comment">// PerObjectStatus&amp; object_tracking_info =</span></div>
<div class="line"><span class="lineno">  954</span>        <span class="comment">// info_.getObjectStatus(object_id);</span></div>
<div class="line"><span class="lineno">  955</span>        <span class="comment">// object_tracking_info.num_outside_shrunken_image++;</span></div>
<div class="line"><span class="lineno">  956</span>      }</div>
<div class="line"><span class="lineno">  957</span>    }</div>
<div class="line"><span class="lineno">  958</span>  });</div>
<div class="line"><span class="lineno">  959</span> </div>
<div class="line"><span class="lineno">  960</span>  <span class="keyword">const</span> <span class="keywordtype">int</span>&amp; max_features_to_track = <a class="code hl_variable" href="classdyno_1_1FeatureTrackerBase.html#a04f0948954381269fedd5a6856662cb7">params_</a>.<a class="code hl_variable" href="structdyno_1_1TrackerParams.html#a251d59812229f53def1c285d69d56b7e">max_dynamic_features_per_frame</a>;</div>
<div class="line"><span class="lineno">  961</span>  <span class="keyword">static</span> <span class="keyword">constexpr</span> <span class="keywordtype">float</span> tolerance = 0.01;</div>
<div class="line"><span class="lineno">  962</span>  Eigen::MatrixXd binning_mask;</div>
<div class="line"><span class="lineno">  963</span> </div>
<div class="line"><span class="lineno">  964</span>  <span class="comment">// for(const auto&amp; [object_id, opencv_keypoints] : sampled_keypoints) {</span></div>
<div class="line"><span class="lineno">  965</span>  tbb::parallel_for_each(</div>
<div class="line"><span class="lineno">  966</span>      sampled_keypoints.begin(), sampled_keypoints.end(), [&amp;](<span class="keyword">auto</span>&amp; entry) {</div>
<div class="line"><span class="lineno">  967</span>        auto&amp; [object_id, opencv_keypoints] = entry;</div>
<div class="line"><span class="lineno">  968</span> </div>
<div class="line"><span class="lineno">  969</span>        const PerObjectStatus&amp; object_tracking_info =</div>
<div class="line"><span class="lineno">  970</span>            info_.getObjectStatus(object_id);</div>
<div class="line"><span class="lineno">  971</span>        const int&amp; number_tracked = object_tracking_info.num_track;</div>
<div class="line"><span class="lineno">  972</span> </div>
<div class="line"><span class="lineno">  973</span>        int nr_corners_needed =</div>
<div class="line"><span class="lineno">  974</span>            std::max(max_features_to_track - number_tracked, 0);</div>
<div class="line"><span class="lineno">  975</span> </div>
<div class="line"><span class="lineno">  976</span>        std::vector&lt;KeypointCV&gt;&amp; max_keypoints = opencv_keypoints;</div>
<div class="line"><span class="lineno">  977</span> </div>
<div class="line"><span class="lineno">  978</span>        const size_t sampled_size = max_keypoints.size();</div>
<div class="line"><span class="lineno">  979</span> </div>
<div class="line"><span class="lineno">  980</span>        <span class="comment">// TODO: Ssc better but maybe bad alloc????</span></div>
<div class="line"><span class="lineno">  981</span>        AdaptiveNonMaximumSuppression non_maximum_supression(</div>
<div class="line"><span class="lineno">  982</span>            AnmsAlgorithmType::RangeTree);</div>
<div class="line"><span class="lineno">  983</span>        max_keypoints = non_maximum_supression.suppressNonMax(</div>
<div class="line"><span class="lineno">  984</span>            opencv_keypoints, nr_corners_needed, tolerance, img_size_.width,</div>
<div class="line"><span class="lineno">  985</span>            img_size_.height, 5, 5, binning_mask);</div>
<div class="line"><span class="lineno">  986</span> </div>
<div class="line"><span class="lineno">  987</span>        VLOG(10) &lt;&lt; <span class="stringliteral">&quot;Kps: &quot;</span> &lt;&lt; max_keypoints.size() &lt;&lt; <span class="stringliteral">&quot; for j=&quot;</span> &lt;&lt; object_id</div>
<div class="line"><span class="lineno">  988</span>                 &lt;&lt; <span class="stringliteral">&quot; after ANMS (originally &quot;</span> &lt;&lt; sampled_size &lt;&lt; <span class="stringliteral">&quot;)&quot;</span>;</div>
<div class="line"><span class="lineno">  989</span>        {</div>
<div class="line"><span class="lineno">  990</span>          const std::lock_guard&lt;std::mutex&gt; lock(mutex);</div>
<div class="line"><span class="lineno">  991</span>          info_.getObjectStatus(object_id).num_sampled = max_keypoints.size();</div>
<div class="line"><span class="lineno">  992</span>        }</div>
<div class="line"><span class="lineno">  993</span> </div>
<div class="line"><span class="lineno">  994</span>        for (<span class="keyword">const</span> <a class="code hl_typedef" href="namespacedyno.html#ae0b7b312ca1880ca7030acdbe981966a">KeypointCV</a>&amp; cv_keypoint : max_keypoints) {</div>
<div class="line"><span class="lineno">  995</span>          <a class="code hl_typedef" href="namespacedyno.html#aaa260a8022691078c59e1ac6a4fa05b5">Keypoint</a> keypoint = <a class="code hl_function" href="namespacedyno_1_1utils.html#a5097b96d97a17d79f22caa4b11a4ba64">utils::cvKeypointToGtsam</a>(cv_keypoint);</div>
<div class="line"><span class="lineno">  996</span>          <span class="keywordtype">int</span> cache_index = cv_keypoint.class_id;</div>
<div class="line"><span class="lineno">  997</span>          <span class="comment">// recover cached data</span></div>
<div class="line"><span class="lineno">  998</span>          <span class="keyword">const</span> KeypointData&amp; cached_data = cached_keypoint_data[cache_index];</div>
<div class="line"><span class="lineno">  999</span> </div>
<div class="line"><span class="lineno"> 1000</span>          CHECK(<a class="code hl_function" href="classdyno_1_1FeatureTrackerBase.html#a32d80be7e74a096c2b816529b7fd2c69">isWithinShrunkenImage</a>(keypoint));</div>
<div class="line"><span class="lineno"> 1001</span>          <a class="code hl_typedef" href="namespacedyno.html#afdd174eb44901fb205371d796287378c">TrackletId</a> tracklet_id =</div>
<div class="line"><span class="lineno"> 1002</span>              tracked_id_manager.getAndIncrementTrackletId();</div>
<div class="line"><span class="lineno"> 1003</span>          Feature::Ptr feature = std::make_shared&lt;Feature&gt;();</div>
<div class="line"><span class="lineno"> 1004</span>          (*feature)</div>
<div class="line"><span class="lineno"> 1005</span>              .objectId(object_id)</div>
<div class="line"><span class="lineno"> 1006</span>              .frameId(frame_id)</div>
<div class="line"><span class="lineno"> 1007</span>              .keypointType(<a class="code hl_enumvalue" href="namespacedyno.html#ad6aa767541eb74e30fc5a7b018322952ac942f1cf01159e70b36aaf8bc517bf9d">KeyPointType::DYNAMIC</a>)</div>
<div class="line"><span class="lineno"> 1008</span>              .age(0)</div>
<div class="line"><span class="lineno"> 1009</span>              .trackletId(tracklet_id)</div>
<div class="line"><span class="lineno"> 1010</span>              .keypoint(keypoint)</div>
<div class="line"><span class="lineno"> 1011</span>              .measuredFlow(cached_data.flow)</div>
<div class="line"><span class="lineno"> 1012</span>              .predictedKeypoint(cached_data.predicted_kp);</div>
<div class="line"><span class="lineno"> 1013</span> </div>
<div class="line"><span class="lineno"> 1014</span>          {</div>
<div class="line"><span class="lineno"> 1015</span>            <span class="keyword">const</span> std::lock_guard&lt;std::mutex&gt; lock(mutex);</div>
<div class="line"><span class="lineno"> 1016</span>            dynamic_features.add(feature);</div>
<div class="line"><span class="lineno"> 1017</span>            objects_sampled.insert(feature-&gt;objectId());</div>
<div class="line"><span class="lineno"> 1018</span>          }</div>
<div class="line"><span class="lineno"> 1019</span>        }</div>
<div class="line"><span class="lineno"> 1020</span>      });</div>
<div class="line"><span class="lineno"> 1021</span>}</div>
<div class="ttc" id="aclassdyno_1_1TrackletIdManager_html_a53cb3472fa0367b8dd2a9127111277b2"><div class="ttname"><a href="classdyno_1_1TrackletIdManager.html#a53cb3472fa0367b8dd2a9127111277b2">dyno::TrackletIdManager::instance</a></div><div class="ttdeci">static TrackletIdManager &amp; instance()</div><div class="ttdef"><b>Definition:</b> <a href="FeatureTrackerBase_8hpp_source.html#l00054">FeatureTrackerBase.hpp:54</a></div></div>
<div class="ttc" id="anamespacedyno_1_1utils_html_a5097b96d97a17d79f22caa4b11a4ba64"><div class="ttname"><a href="namespacedyno_1_1utils.html#a5097b96d97a17d79f22caa4b11a4ba64">dyno::utils::cvKeypointToGtsam</a></div><div class="ttdeci">gtsam::Point2 cvKeypointToGtsam(const cv::KeyPoint &amp;point)</div><div class="ttdef"><b>Definition:</b> <a href="GtsamUtils_8hpp_source.html#l00254">GtsamUtils.hpp:254</a></div></div>
<div class="ttc" id="anamespacedyno_1_1utils_html_a5f3c7f83fac92f1c3d2d11d41927a205"><div class="ttname"><a href="namespacedyno_1_1utils.html#a5f3c7f83fac92f1c3d2d11d41927a205">dyno::utils::gtsamPointToKeyPoint</a></div><div class="ttdeci">cv::KeyPoint gtsamPointToKeyPoint(const gtsam::Point2 &amp;point, float size=1, float angle=-1, float response=0, int octave=0, int class_id=-1)</div><div class="ttdef"><b>Definition:</b> <a href="GtsamUtils_8hpp_source.html#l00273">GtsamUtils.hpp:273</a></div></div>
<div class="ttc" id="anamespacedyno_html_ad6aa767541eb74e30fc5a7b018322952ac942f1cf01159e70b36aaf8bc517bf9d"><div class="ttname"><a href="namespacedyno.html#ad6aa767541eb74e30fc5a7b018322952ac942f1cf01159e70b36aaf8bc517bf9d">dyno::DYNAMIC</a></div><div class="ttdeci">@ DYNAMIC</div><div class="ttdef"><b>Definition:</b> <a href="Types_8hpp_source.html#l00190">Types.hpp:190</a></div></div>
<div class="ttc" id="anamespacedyno_html_ae0b7b312ca1880ca7030acdbe981966a"><div class="ttname"><a href="namespacedyno.html#ae0b7b312ca1880ca7030acdbe981966a">dyno::KeypointCV</a></div><div class="ttdeci">cv::KeyPoint KeypointCV</div><div class="ttdef"><b>Definition:</b> <a href="Types_8hpp_source.html#l00103">Types.hpp:103</a></div></div>
<div class="ttc" id="anamespacedyno_html_ae45b8b62a0efd7dbcf047db8751f6739"><div class="ttname"><a href="namespacedyno.html#ae45b8b62a0efd7dbcf047db8751f6739">dyno::KeypointsCV</a></div><div class="ttdeci">std::vector&lt; KeypointCV &gt; KeypointsCV</div><div class="ttdef"><b>Definition:</b> <a href="Types_8hpp_source.html#l00104">Types.hpp:104</a></div></div>
<div class="ttc" id="anamespacedyno_html_afdd174eb44901fb205371d796287378c"><div class="ttname"><a href="namespacedyno.html#afdd174eb44901fb205371d796287378c">dyno::TrackletId</a></div><div class="ttdeci">long int TrackletId</div><div class="ttdoc">Unique tracklet/landmark id, i.</div><div class="ttdef"><b>Definition:</b> <a href="Types_8hpp_source.html#l00081">Types.hpp:81</a></div></div>
<div class="ttc" id="astructdyno_1_1FeatureTrackerInfo_html_a8d5e1a05167ecd041783f39243dd508e"><div class="ttname"><a href="structdyno_1_1FeatureTrackerInfo.html#a8d5e1a05167ecd041783f39243dd508e">dyno::FeatureTrackerInfo::getObjectStatus</a></div><div class="ttdeci">PerObjectStatus &amp; getObjectStatus(ObjectId object_id)</div><div class="ttdef"><b>Definition:</b> <a href="Vision-Definitions_8hpp_source.html#l00102">Vision-Definitions.hpp:102</a></div></div>
<div class="ttc" id="astructdyno_1_1PerObjectStatus_html_a3d7fa1487d536d3845f96da8ff173fb8"><div class="ttname"><a href="structdyno_1_1PerObjectStatus.html#a3d7fa1487d536d3845f96da8ff173fb8">dyno::PerObjectStatus::num_sampled</a></div><div class="ttdeci">size_t num_sampled</div><div class="ttdef"><b>Definition:</b> <a href="Vision-Definitions_8hpp_source.html#l00079">Vision-Definitions.hpp:79</a></div></div>
<div class="ttc" id="astructdyno_1_1PerObjectStatus_html_aed2f4e73fd0c2100788cc0fa0ecbc8b1"><div class="ttname"><a href="structdyno_1_1PerObjectStatus.html#aed2f4e73fd0c2100788cc0fa0ecbc8b1">dyno::PerObjectStatus::num_zero_flow</a></div><div class="ttdeci">size_t num_zero_flow</div><div class="ttdef"><b>Definition:</b> <a href="Vision-Definitions_8hpp_source.html#l00082">Vision-Definitions.hpp:82</a></div></div>
<div class="ttc" id="astructdyno_1_1TrackerParams_html_a251d59812229f53def1c285d69d56b7e"><div class="ttname"><a href="structdyno_1_1TrackerParams.html#a251d59812229f53def1c285d69d56b7e">dyno::TrackerParams::max_dynamic_features_per_frame</a></div><div class="ttdeci">size_t max_dynamic_features_per_frame</div><div class="ttdef"><b>Definition:</b> <a href="TrackerParams_8hpp_source.html#l00133">TrackerParams.hpp:133</a></div></div>
</div><!-- fragment -->
<p class="reference">References <a class="el" href="classdyno_1_1FeatureContainer.html#a3af7c9e40df21b96a8c7067348aed5f5">dyno::FeatureContainer::add()</a>, <a class="el" href="classdyno_1_1TrackletIdManager.html#acf6eded9b5e98917d2510d96074ef138">dyno::TrackletIdManager::getAndIncrementTrackletId()</a>, <a class="el" href="classdyno_1_1ImageContainer.html#ae5eead678f02be0ab9de7464e1833c55">dyno::ImageContainer::objectMotionMask()</a>, <a class="el" href="classdyno_1_1ImageContainer.html#a460749ede77f3694f4f2dfaab76531f7">dyno::ImageContainer::opticalFlow()</a>, and <a class="el" href="classdyno_1_1ImageContainer.html#a6f35259f95c31b861ff6515c159e1ee3">dyno::ImageContainer::rgb()</a>.</p>

<p class="reference">Referenced by <a class="el" href="classdyno_1_1FeatureTracker.html#a145614fe29bef7728075492870ac9c41">trackDynamic()</a>.</p>
<div class="dynheader">
Here is the call graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="classdyno_1_1FeatureTracker_af6093d870bad67d12dee0c9cb913f87c_cgraph.png" border="0" usemap="#aclassdyno_1_1FeatureTracker_af6093d870bad67d12dee0c9cb913f87c_cgraph" alt=""/></div>
<map name="aclassdyno_1_1FeatureTracker_af6093d870bad67d12dee0c9cb913f87c_cgraph" id="aclassdyno_1_1FeatureTracker_af6093d870bad67d12dee0c9cb913f87c_cgraph">
<area shape="rect" title=" " alt="" coords="5,143,163,183"/>
<area shape="rect" href="classdyno_1_1FeatureContainer.html#a3af7c9e40df21b96a8c7067348aed5f5" title="Adds a new feature to the container. Uses feature.trackletId() to set the tracklet key." alt="" coords="211,29,417,55"/>
<area shape="rect" href="classdyno_1_1TrackletIdManager.html#acf6eded9b5e98917d2510d96074ef138" title=" " alt="" coords="211,79,417,119"/>
<area shape="rect" href="classdyno_1_1ImageContainer.html#ae5eead678f02be0ab9de7464e1833c55" title=" " alt="" coords="231,143,397,183"/>
<area shape="rect" href="classdyno_1_1ImageContainer.html#a460749ede77f3694f4f2dfaab76531f7" title=" " alt="" coords="231,207,397,247"/>
<area shape="rect" href="classdyno_1_1ImageContainer.html#a6f35259f95c31b861ff6515c159e1ee3" title=" " alt="" coords="217,272,411,297"/>
</map>
</div>
<div class="dynheader">
Here is the caller graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="classdyno_1_1FeatureTracker_af6093d870bad67d12dee0c9cb913f87c_icgraph.png" border="0" usemap="#aclassdyno_1_1FeatureTracker_af6093d870bad67d12dee0c9cb913f87c_icgraph" alt=""/></div>
<map name="aclassdyno_1_1FeatureTracker_af6093d870bad67d12dee0c9cb913f87c_icgraph" id="aclassdyno_1_1FeatureTracker_af6093d870bad67d12dee0c9cb913f87c_icgraph">
<area shape="rect" title=" " alt="" coords="416,5,573,45"/>
<area shape="rect" href="classdyno_1_1FeatureTracker.html#a145614fe29bef7728075492870ac9c41" title=" " alt="" coords="211,5,368,45"/>
<area shape="rect" href="classdyno_1_1FeatureTracker.html#a40ee79c94fe2de7f16d2a4508cc2ba11" title=" " alt="" coords="5,5,163,45"/>
</map>
</div>

</div>
</div>
<a id="a31f607c5d1fca4c1ace6af223abb5ead" name="a31f607c5d1fca4c1ace6af223abb5ead"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a31f607c5d1fca4c1ace6af223abb5ead">&#9670;&#160;</a></span>stereoTrack()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">bool dyno::FeatureTracker::stereoTrack </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="namespacedyno.html#aa17f60b0d2c3c01070964846f940f60c">FeaturePtrs</a> &amp;&#160;</td>
          <td class="paramname"><em>stereo_features</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="classdyno_1_1FeatureContainer.html">FeatureContainer</a> &amp;&#160;</td>
          <td class="paramname"><em>left_features</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const cv::Mat &amp;&#160;</td>
          <td class="paramname"><em>left_image</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const cv::Mat &amp;&#160;</td>
          <td class="paramname"><em>right_image</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const double &amp;&#160;</td>
          <td class="paramname"><em>virtual_baseline</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td> const</td>
        </tr>
      </table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="FeatureTracker_8cc_source.html#l00195">195</a> of file <a class="el" href="FeatureTracker_8cc_source.html">FeatureTracker.cc</a>.</p>
<div class="fragment"><div class="line"><span class="lineno">  199</span>                                                                       {</div>
<div class="line"><span class="lineno">  200</span>  utils::TimingStatsCollector timing(<span class="stringliteral">&quot;stereo_track_timer&quot;</span>);</div>
<div class="line"><span class="lineno">  201</span>  <a class="code hl_typedef" href="namespacedyno.html#a7b74611da938f0d55a3b1fdb16219037">TrackletIds</a> tracklets_ids;</div>
<div class="line"><span class="lineno">  202</span>  <span class="comment">// collect left feature points to cv::point2f</span></div>
<div class="line"><span class="lineno">  203</span>  std::vector&lt;cv::Point2f&gt; left_feature_points =</div>
<div class="line"><span class="lineno">  204</span>      left_features.toOpenCV(&amp;tracklets_ids, <span class="keyword">true</span>);</div>
<div class="line"><span class="lineno">  205</span> </div>
<div class="line"><span class="lineno">  206</span>  <span class="keywordflow">if</span> (left_feature_points.size() &lt; 8) {</div>
<div class="line"><span class="lineno">  207</span>    LOG(WARNING) &lt;&lt; <span class="stringliteral">&quot;Not enough left feature points for stereo matching...&quot;</span>;</div>
<div class="line"><span class="lineno">  208</span>    <span class="keywordflow">return</span> <span class="keyword">false</span>;</div>
<div class="line"><span class="lineno">  209</span>  }</div>
<div class="line"><span class="lineno">  210</span> </div>
<div class="line"><span class="lineno">  211</span>  std::vector&lt;cv::Point2f&gt; right_feature_points;</div>
<div class="line"><span class="lineno">  212</span>  std::vector&lt;uchar&gt; klt_status;</div>
<div class="line"><span class="lineno">  213</span>  std::vector&lt;float&gt; err;</div>
<div class="line"><span class="lineno">  214</span> </div>
<div class="line"><span class="lineno">  215</span>  <span class="keyword">const</span> cv::Mat&amp; left_rgb = left_image;</div>
<div class="line"><span class="lineno">  216</span>  cv::Mat left_mono = <a class="code hl_function" href="structdyno_1_1ImageType_1_1RGBMono.html#ac6c656492aaeff4bb8b60f42b0cfa7a3">ImageType::RGBMono::toMono</a>(left_rgb);</div>
<div class="line"><span class="lineno">  217</span>  CHECK(!left_mono.empty());</div>
<div class="line"><span class="lineno">  218</span>  cv::Mat right_mono = <a class="code hl_function" href="structdyno_1_1ImageType_1_1RGBMono.html#ac6c656492aaeff4bb8b60f42b0cfa7a3">ImageType::RGBMono::toMono</a>(right_image);</div>
<div class="line"><span class="lineno">  219</span>  CHECK(!right_mono.empty());</div>
<div class="line"><span class="lineno">  220</span> </div>
<div class="line"><span class="lineno">  221</span>  right_feature_points = left_feature_points;</div>
<div class="line"><span class="lineno">  222</span> </div>
<div class="line"><span class="lineno">  223</span>  cv::calcOpticalFlowPyrLK(left_mono, right_mono, left_feature_points,</div>
<div class="line"><span class="lineno">  224</span>                           right_feature_points, klt_status, err,</div>
<div class="line"><span class="lineno">  225</span>                           cv::Size(21, 21), 5);</div>
<div class="line"><span class="lineno">  226</span>  CHECK_EQ(klt_status.size(), tracklets_ids.size());</div>
<div class="line"><span class="lineno">  227</span> </div>
<div class="line"><span class="lineno">  228</span>  <span class="comment">// check flow back</span></div>
<div class="line"><span class="lineno">  229</span>  std::vector&lt;cv::Point2f&gt; reverse_left_feature_points = right_feature_points;</div>
<div class="line"><span class="lineno">  230</span>  std::vector&lt;uchar&gt; klt_reverse_status;</div>
<div class="line"><span class="lineno">  231</span>  cv::calcOpticalFlowPyrLK(right_mono, left_mono, right_feature_points,</div>
<div class="line"><span class="lineno">  232</span>                           reverse_left_feature_points, klt_reverse_status, err,</div>
<div class="line"><span class="lineno">  233</span>                           cv::Size(21, 21), 5);</div>
<div class="line"><span class="lineno">  234</span>  CHECK_EQ(klt_reverse_status.size(), tracklets_ids.size());</div>
<div class="line"><span class="lineno">  235</span> </div>
<div class="line"><span class="lineno">  236</span>  <span class="keyword">auto</span> distance = [](<span class="keyword">const</span> cv::Point2f&amp; pt1, <span class="keyword">const</span> cv::Point2f&amp; pt2) -&gt; <span class="keywordtype">float</span> {</div>
<div class="line"><span class="lineno">  237</span>    <span class="keywordtype">float</span> dx = pt1.x - pt2.x;</div>
<div class="line"><span class="lineno">  238</span>    <span class="keywordtype">float</span> dy = pt1.y - pt2.y;</div>
<div class="line"><span class="lineno">  239</span>    <span class="keywordflow">return</span> std::sqrt(dx * dx + dy * dy);</div>
<div class="line"><span class="lineno">  240</span>  };</div>
<div class="line"><span class="lineno">  241</span>  <span class="comment">// update klt status based on result from flow</span></div>
<div class="line"><span class="lineno">  242</span>  <span class="keywordflow">for</span> (<span class="keywordtype">size_t</span> i = 0; i &lt; klt_status.size(); i++) {</div>
<div class="line"><span class="lineno">  243</span>    <span class="keyword">const</span> <span class="keywordtype">bool</span> both_status_good = klt_status.at(i) &amp;&amp; klt_reverse_status.at(i);</div>
<div class="line"><span class="lineno">  244</span>    <span class="keyword">const</span> <span class="keywordtype">bool</span> within_image = <a class="code hl_function" href="classdyno_1_1FeatureTrackerBase.html#a32d80be7e74a096c2b816529b7fd2c69">isWithinShrunkenImage</a>(right_feature_points.at(i));</div>
<div class="line"><span class="lineno">  245</span>    <span class="keyword">const</span> <span class="keywordtype">bool</span> within_distance =</div>
<div class="line"><span class="lineno">  246</span>        distance(left_feature_points.at(i),</div>
<div class="line"><span class="lineno">  247</span>                 reverse_left_feature_points.at(i)) &lt;= 0.5;</div>
<div class="line"><span class="lineno">  248</span> </div>
<div class="line"><span class="lineno">  249</span>    <span class="keywordflow">if</span> (both_status_good &amp;&amp; within_image &amp;&amp; within_distance) {</div>
<div class="line"><span class="lineno">  250</span>      klt_status.at(i) = 1;</div>
<div class="line"><span class="lineno">  251</span>    } <span class="keywordflow">else</span> {</div>
<div class="line"><span class="lineno">  252</span>      klt_status.at(i) = 0;</div>
<div class="line"><span class="lineno">  253</span>    }</div>
<div class="line"><span class="lineno">  254</span>  }</div>
<div class="line"><span class="lineno">  255</span> </div>
<div class="line"><span class="lineno">  256</span>  <a class="code hl_typedef" href="namespacedyno.html#a7b74611da938f0d55a3b1fdb16219037">TrackletIds</a> good_stereo_tracklets;</div>
<div class="line"><span class="lineno">  257</span> </div>
<div class="line"><span class="lineno">  258</span>  std::vector&lt;cv::Point2f&gt; pts_left_tracked, pts_right_tracked;</div>
<div class="line"><span class="lineno">  259</span>  <span class="keywordflow">for</span> (<span class="keywordtype">size_t</span> i = 0; i &lt; klt_status.size(); ++i) {</div>
<div class="line"><span class="lineno">  260</span>    <span class="keyword">auto</span> tracklet_id = tracklets_ids.at(i);</div>
<div class="line"><span class="lineno">  261</span>    <span class="comment">// LOG(INFO) &lt;&lt; tracklet_id;</span></div>
<div class="line"><span class="lineno">  262</span>    <span class="keywordflow">if</span> (klt_status[i]) {</div>
<div class="line"><span class="lineno">  263</span>      pts_left_tracked.push_back(left_feature_points[i]);</div>
<div class="line"><span class="lineno">  264</span>      pts_right_tracked.push_back(right_feature_points[i]);</div>
<div class="line"><span class="lineno">  265</span>      good_stereo_tracklets.push_back(tracklet_id);</div>
<div class="line"><span class="lineno">  266</span>    }</div>
<div class="line"><span class="lineno">  267</span>  }</div>
<div class="line"><span class="lineno">  268</span>  <span class="comment">// LOG(INFO) &lt;&lt; &quot;Stereo KLT tracked: &quot; &lt;&lt; pts_left_tracked.size() &lt;&lt; &quot;</span></div>
<div class="line"><span class="lineno">  269</span>  <span class="comment">// points&quot;;</span></div>
<div class="line"><span class="lineno">  270</span> </div>
<div class="line"><span class="lineno">  271</span>  <span class="comment">// need more than 8 points for fundamental matrix calc with ransac</span></div>
<div class="line"><span class="lineno">  272</span>  <a class="code hl_typedef" href="namespacedyno.html#a7b74611da938f0d55a3b1fdb16219037">TrackletIds</a> inlier_stereo_tracklets;</div>
<div class="line"><span class="lineno">  273</span>  <span class="keywordflow">if</span> (pts_left_tracked.size() &lt; 8) {</div>
<div class="line"><span class="lineno">  274</span>    LOG(WARNING)</div>
<div class="line"><span class="lineno">  275</span>        &lt;&lt; <span class="stringliteral">&quot;Not enough stereo matches to perform fundamental matrix calc&quot;</span>;</div>
<div class="line"><span class="lineno">  276</span>    <span class="keywordflow">return</span> <span class="keyword">false</span>;</div>
<div class="line"><span class="lineno">  277</span>  } <span class="keywordflow">else</span> {</div>
<div class="line"><span class="lineno">  278</span>    std::vector&lt;uchar&gt; epipolar_inliers;</div>
<div class="line"><span class="lineno">  279</span>    cv::Mat F =</div>
<div class="line"><span class="lineno">  280</span>        cv::findFundamentalMat(pts_left_tracked, pts_right_tracked,</div>
<div class="line"><span class="lineno">  281</span>                               cv::FM_RANSAC, 1.0, 0.99, epipolar_inliers);</div>
<div class="line"><span class="lineno">  282</span>    CHECK_EQ(epipolar_inliers.size(), good_stereo_tracklets.size());</div>
<div class="line"><span class="lineno">  283</span> </div>
<div class="line"><span class="lineno">  284</span>    std::vector&lt;cv::Point2f&gt; pts_left_inlier, pts_right_inlier;</div>
<div class="line"><span class="lineno">  285</span>    <span class="keywordflow">for</span> (<span class="keywordtype">size_t</span> i = 0; i &lt; epipolar_inliers.size(); ++i) {</div>
<div class="line"><span class="lineno">  286</span>      <span class="keyword">auto</span> tracklet_id = good_stereo_tracklets.at(i);</div>
<div class="line"><span class="lineno">  287</span>      <span class="keywordflow">if</span> (epipolar_inliers[i]) {</div>
<div class="line"><span class="lineno">  288</span>        pts_left_inlier.push_back(pts_left_tracked[i]);</div>
<div class="line"><span class="lineno">  289</span>        pts_right_inlier.push_back(pts_right_tracked[i]);</div>
<div class="line"><span class="lineno">  290</span> </div>
<div class="line"><span class="lineno">  291</span>        CHECK(left_features.getByTrackletId(tracklet_id))</div>
<div class="line"><span class="lineno">  292</span>            &lt;&lt; <span class="stringliteral">&quot;Somehow tracklet id &quot;</span> &lt;&lt; tracklet_id &lt;&lt; <span class="stringliteral">&quot; is missing!&quot;</span>;</div>
<div class="line"><span class="lineno">  293</span>        inlier_stereo_tracklets.push_back(tracklet_id);</div>
<div class="line"><span class="lineno">  294</span>      }</div>
<div class="line"><span class="lineno">  295</span>    }</div>
<div class="line"><span class="lineno">  296</span> </div>
<div class="line"><span class="lineno">  297</span>    LOG(INFO) &lt;&lt; <span class="stringliteral">&quot;After epipolar filtering: &quot;</span> &lt;&lt; inlier_stereo_tracklets.size()</div>
<div class="line"><span class="lineno">  298</span>              &lt;&lt; <span class="stringliteral">&quot; inliers&quot;</span>;</div>
<div class="line"><span class="lineno">  299</span>    <span class="keyword">const</span> <span class="keyword">auto</span>&amp; fx = <a class="code hl_variable" href="classdyno_1_1FeatureTrackerBase.html#abf6eba19baf18b1c3648347401c15a56">camera_</a>-&gt;getParams().fx();</div>
<div class="line"><span class="lineno">  300</span> </div>
<div class="line"><span class="lineno">  301</span>    <span class="keywordflow">for</span> (<span class="keywordtype">size_t</span> i = 0; i &lt; inlier_stereo_tracklets.size(); i++) {</div>
<div class="line"><span class="lineno">  302</span>      <span class="keyword">auto</span> inlier_stereo_track = inlier_stereo_tracklets.at(i);</div>
<div class="line"><span class="lineno">  303</span>      Feature::Ptr feature = left_features.getByTrackletId(inlier_stereo_track);</div>
<div class="line"><span class="lineno">  304</span>      CHECK(feature);</div>
<div class="line"><span class="lineno">  305</span>      CHECK(feature-&gt;usable());</div>
<div class="line"><span class="lineno">  306</span> </div>
<div class="line"><span class="lineno">  307</span>      <span class="keywordtype">double</span> uL = <span class="keyword">static_cast&lt;</span><span class="keywordtype">double</span><span class="keyword">&gt;</span>(pts_left_inlier[i].x);</div>
<div class="line"><span class="lineno">  308</span>      <span class="keywordtype">double</span> v = <span class="keyword">static_cast&lt;</span><span class="keywordtype">double</span><span class="keyword">&gt;</span>(pts_left_inlier[i].y);</div>
<div class="line"><span class="lineno">  309</span>      <span class="keywordtype">double</span> uR = <span class="keyword">static_cast&lt;</span><span class="keywordtype">double</span><span class="keyword">&gt;</span>(pts_right_inlier[i].x);</div>
<div class="line"><span class="lineno">  310</span> </div>
<div class="line"><span class="lineno">  311</span>      <span class="keywordtype">double</span> disparity = uL - uR;</div>
<div class="line"><span class="lineno">  312</span>      <span class="comment">// Reject near-zero disparity</span></div>
<div class="line"><span class="lineno">  313</span>      <span class="comment">// this will also mean far away points.... multi-view triangulation</span></div>
<div class="line"><span class="lineno">  314</span>      <span class="comment">// across frames is needed here... fall back on depth map...</span></div>
<div class="line"><span class="lineno">  315</span>      <span class="keywordflow">if</span> (disparity &lt;= 1.0 || uR &lt; 0.0f) {</div>
<div class="line"><span class="lineno">  316</span>        feature-&gt;markOutlier();</div>
<div class="line"><span class="lineno">  317</span>        <span class="keywordflow">continue</span>;</div>
<div class="line"><span class="lineno">  318</span>      }</div>
<div class="line"><span class="lineno">  319</span> </div>
<div class="line"><span class="lineno">  320</span>      <span class="comment">// TODO: should use RGBDCamera class!</span></div>
<div class="line"><span class="lineno">  321</span>      <span class="keywordtype">double</span> depth = fx * virtual_baseline / disparity;</div>
<div class="line"><span class="lineno">  322</span>      <span class="comment">// for testing</span></div>
<div class="line"><span class="lineno">  323</span>      <span class="comment">// TODO: no max depth</span></div>
<div class="line"><span class="lineno">  324</span>      feature-&gt;depth(depth);</div>
<div class="line"><span class="lineno">  325</span>      feature-&gt;rightKeypoint(<a class="code hl_typedef" href="namespacedyno.html#aaa260a8022691078c59e1ac6a4fa05b5">Keypoint</a>(uR, v));</div>
<div class="line"><span class="lineno">  326</span> </div>
<div class="line"><span class="lineno">  327</span>      stereo_features.push_back(feature);</div>
<div class="line"><span class="lineno">  328</span>    }</div>
<div class="line"><span class="lineno">  329</span> </div>
<div class="line"><span class="lineno">  330</span>    <a class="code hl_typedef" href="namespacedyno.html#a7b74611da938f0d55a3b1fdb16219037">TrackletIds</a> outlier_stereo_tracklets;</div>
<div class="line"><span class="lineno">  331</span>    <a class="code hl_function" href="namespacedyno.html#af008198dcb75012836115300a522ca86">determineOutlierIds</a>(inlier_stereo_tracklets, tracklets_ids,</div>
<div class="line"><span class="lineno">  332</span>                        outlier_stereo_tracklets);</div>
<div class="line"><span class="lineno">  333</span> </div>
<div class="line"><span class="lineno">  334</span>    left_features.markOutliers(outlier_stereo_tracklets);</div>
<div class="line"><span class="lineno">  335</span>    <span class="keywordflow">return</span> <span class="keyword">true</span>;</div>
<div class="line"><span class="lineno">  336</span>  }</div>
<div class="line"><span class="lineno">  337</span>}</div>
<div class="ttc" id="aclassdyno_1_1FeatureTrackerBase_html_abf6eba19baf18b1c3648347401c15a56"><div class="ttname"><a href="classdyno_1_1FeatureTrackerBase.html#abf6eba19baf18b1c3648347401c15a56">dyno::FeatureTrackerBase::camera_</a></div><div class="ttdeci">Camera::Ptr camera_</div><div class="ttdoc">Expected image size from the camera.</div><div class="ttdef"><b>Definition:</b> <a href="FeatureTrackerBase_8hpp_source.html#l00176">FeatureTrackerBase.hpp:176</a></div></div>
<div class="ttc" id="anamespacedyno_html_a7b74611da938f0d55a3b1fdb16219037"><div class="ttname"><a href="namespacedyno.html#a7b74611da938f0d55a3b1fdb16219037">dyno::TrackletIds</a></div><div class="ttdeci">std::vector&lt; TrackletId &gt; TrackletIds</div><div class="ttdef"><b>Definition:</b> <a href="Types_8hpp_source.html#l00083">Types.hpp:83</a></div></div>
<div class="ttc" id="anamespacedyno_html_af008198dcb75012836115300a522ca86"><div class="ttname"><a href="namespacedyno.html#af008198dcb75012836115300a522ca86">dyno::determineOutlierIds</a></div><div class="ttdeci">void determineOutlierIds(const TrackletIds &amp;inliers, const TrackletIds &amp;tracklets, TrackletIds &amp;outliers)</div><div class="ttdoc">From a set a tracklets and a subset (of the tracklet) inliers, calculate the remaining subset of outl...</div><div class="ttdef"><b>Definition:</b> <a href="VisionTools_8cc_source.html#l00744">VisionTools.cc:744</a></div></div>
<div class="ttc" id="astructdyno_1_1ImageType_1_1RGBMono_html_ac6c656492aaeff4bb8b60f42b0cfa7a3"><div class="ttname"><a href="structdyno_1_1ImageType_1_1RGBMono.html#ac6c656492aaeff4bb8b60f42b0cfa7a3">dyno::ImageType::RGBMono::toMono</a></div><div class="ttdeci">static cv::Mat toMono(const ImageWrapper&lt; RGBMono &gt; &amp;image)</div><div class="ttdef"><b>Definition:</b> <a href="ImageTypes_8cc_source.html#l00119">ImageTypes.cc:119</a></div></div>
</div><!-- fragment -->
<p class="reference">References <a class="el" href="classdyno_1_1FeatureTrackerBase.html#abf6eba19baf18b1c3648347401c15a56">dyno::FeatureTrackerBase::camera_</a>, <a class="el" href="namespacedyno.html#af008198dcb75012836115300a522ca86">dyno::determineOutlierIds()</a>, <a class="el" href="classdyno_1_1FeatureContainer.html#a5b73e75d2f4063ac9c16dd0fd565f8da">dyno::FeatureContainer::getByTrackletId()</a>, <a class="el" href="classdyno_1_1FeatureTrackerBase.html#a32d80be7e74a096c2b816529b7fd2c69">dyno::FeatureTrackerBase::isWithinShrunkenImage()</a>, <a class="el" href="classdyno_1_1FeatureContainer.html#ae987542e555aa684659c07b3aa006a4f">dyno::FeatureContainer::markOutliers()</a>, <a class="el" href="structdyno_1_1ImageType_1_1RGBMono.html#ac6c656492aaeff4bb8b60f42b0cfa7a3">dyno::ImageType::RGBMono::toMono()</a>, and <a class="el" href="classdyno_1_1FeatureContainer.html#a00fb07fccff523cba9783e6d00186f28">dyno::FeatureContainer::toOpenCV()</a>.</p>
<div class="dynheader">
Here is the call graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="classdyno_1_1FeatureTracker_a31f607c5d1fca4c1ace6af223abb5ead_cgraph.png" border="0" usemap="#aclassdyno_1_1FeatureTracker_a31f607c5d1fca4c1ace6af223abb5ead_cgraph" alt=""/></div>
<map name="aclassdyno_1_1FeatureTracker_a31f607c5d1fca4c1ace6af223abb5ead_cgraph" id="aclassdyno_1_1FeatureTracker_a31f607c5d1fca4c1ace6af223abb5ead_cgraph">
<area shape="rect" title=" " alt="" coords="5,142,163,182"/>
<area shape="rect" href="namespacedyno.html#af008198dcb75012836115300a522ca86" title="From a set a tracklets and a subset (of the tracklet) inliers, calculate the remaining subset of outl..." alt="" coords="217,5,409,31"/>
<area shape="rect" href="classdyno_1_1FeatureContainer.html#a5b73e75d2f4063ac9c16dd0fd565f8da" title="Gets a feature given its tracklet id. If the feature does not exist, nullptr is returned." alt="" coords="480,113,655,153"/>
<area shape="rect" href="classdyno_1_1FeatureTrackerBase.html#a32d80be7e74a096c2b816529b7fd2c69" title="Checks if a keypoint is within an image, taking into account the shrink row/col values in the params...." alt="" coords="219,55,408,95"/>
<area shape="rect" href="classdyno_1_1FeatureContainer.html#ae987542e555aa684659c07b3aa006a4f" title="Mark all features with the provided tracklet ids as outliers. If the present feature is already an ou..." alt="" coords="226,170,401,210"/>
<area shape="rect" href="structdyno_1_1ImageType_1_1RGBMono.html#ac6c656492aaeff4bb8b60f42b0cfa7a3" title=" " alt="" coords="211,234,416,274"/>
<area shape="rect" href="classdyno_1_1FeatureContainer.html#a00fb07fccff523cba9783e6d00186f28" title="Converts the keypoints of all features in the container to cv::Point2f representation...." alt="" coords="226,298,401,338"/>
<area shape="rect" href="classdyno_1_1FeatureContainer.html#abf2f2d568f5dc17944cc122c537a65f5" title="Returns true if a feature with the given tracklet id exists." alt="" coords="719,142,893,182"/>
<area shape="rect" href="structdyno_1_1functional__keypoint.html#a3896d96a6f95b5311ae768cdd0ad97e8" title=" " alt="" coords="464,13,671,39"/>
<area shape="rect" href="structdyno_1_1functional__keypoint.html#a24933450cad8bc70b7b76b339756cd94" title=" " alt="" coords="464,63,671,88"/>
<area shape="rect" href="namespacedyno.html#a80329a3506c3ccb953481bb403dd320f" title=" " alt="" coords="479,241,655,267"/>
</map>
</div>

</div>
</div>
<a id="a40ee79c94fe2de7f16d2a4508cc2ba11" name="a40ee79c94fe2de7f16d2a4508cc2ba11"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a40ee79c94fe2de7f16d2a4508cc2ba11">&#9670;&#160;</a></span>track()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">Frame::Ptr dyno::FeatureTracker::track </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="namespacedyno.html#ac4303d6fafb755f794b072d76f9cfb41">FrameId</a>&#160;</td>
          <td class="paramname"><em>frame_id</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="namespacedyno.html#a7fda67c0575c4b7a8210dcc8ae227370">Timestamp</a>&#160;</td>
          <td class="paramname"><em>timestamp</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const <a class="el" href="classdyno_1_1ImageContainer.html">ImageContainer</a> &amp;&#160;</td>
          <td class="paramname"><em>image_container</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const std::optional&lt; gtsam::Rot3 &gt; &amp;&#160;</td>
          <td class="paramname"><em>R_km1_k</em> = <code>{}</code>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="FeatureTracker_8cc_source.html#l00073">73</a> of file <a class="el" href="FeatureTracker_8cc_source.html">FeatureTracker.cc</a>.</p>
<div class="fragment"><div class="line"><span class="lineno">   75</span>                                                                        {</div>
<div class="line"><span class="lineno">   76</span>  <span class="comment">// take &quot;copy&quot; of tracking_images which is then given to the frame</span></div>
<div class="line"><span class="lineno">   77</span>  <span class="comment">// this will mean that the tracking images (input) are not necessarily the</span></div>
<div class="line"><span class="lineno">   78</span>  <span class="comment">// same as the ones inside the returned frame</span></div>
<div class="line"><span class="lineno">   79</span>  utils::TimingStatsCollector tracking_timer(<span class="stringliteral">&quot;tracking_timer&quot;</span>);</div>
<div class="line"><span class="lineno">   80</span>  ImageContainer input_images = image_container;</div>
<div class="line"><span class="lineno">   81</span> </div>
<div class="line"><span class="lineno">   82</span>  <a class="code hl_variable" href="classdyno_1_1FeatureTracker.html#aaf08b9f655f94c59eadf15564f2e69f3">info_</a> = FeatureTrackerInfo();  <span class="comment">// clear the info</span></div>
<div class="line"><span class="lineno">   83</span>  <a class="code hl_variable" href="classdyno_1_1FeatureTracker.html#aaf08b9f655f94c59eadf15564f2e69f3">info_</a>.<a class="code hl_variable" href="structdyno_1_1FeatureTrackerInfo.html#a3e451313696cef2553e256c4136f6096">frame_id</a> = frame_id;</div>
<div class="line"><span class="lineno">   84</span>  <a class="code hl_variable" href="classdyno_1_1FeatureTracker.html#aaf08b9f655f94c59eadf15564f2e69f3">info_</a>.<a class="code hl_variable" href="structdyno_1_1FeatureTrackerInfo.html#ad5ffbf938aa7ae6c100a92e1bca09c6a">timestamp</a> = timestamp;</div>
<div class="line"><span class="lineno">   85</span> </div>
<div class="line"><span class="lineno">   86</span>  <span class="keywordflow">if</span> (<a class="code hl_variable" href="classdyno_1_1FeatureTracker.html#a0484d7f8c41021d4e8435caa579af71e">initial_computation_</a>) {</div>
<div class="line"><span class="lineno">   87</span>    <span class="comment">// intitial computation</span></div>
<div class="line"><span class="lineno">   88</span>    <span class="keyword">const</span> cv::Size&amp; other_size =</div>
<div class="line"><span class="lineno">   89</span>        <span class="keyword">static_cast&lt;</span><span class="keyword">const </span>cv::Mat&amp;<span class="keyword">&gt;</span>(input_images.rgb()).size();</div>
<div class="line"><span class="lineno">   90</span>    CHECK(!<a class="code hl_variable" href="classdyno_1_1FeatureTracker.html#a879d0cd574b194e89bffbe05f85c23fc">previous_frame_</a>);</div>
<div class="line"><span class="lineno">   91</span>    CHECK_EQ(<a class="code hl_variable" href="classdyno_1_1FeatureTrackerBase.html#a23d0ec748366b789be491e61e536839c">img_size_</a>.width, other_size.width);</div>
<div class="line"><span class="lineno">   92</span>    CHECK_EQ(<a class="code hl_variable" href="classdyno_1_1FeatureTrackerBase.html#a23d0ec748366b789be491e61e536839c">img_size_</a>.height, other_size.height);</div>
<div class="line"><span class="lineno">   93</span>    <a class="code hl_variable" href="classdyno_1_1FeatureTracker.html#a0484d7f8c41021d4e8435caa579af71e">initial_computation_</a> = <span class="keyword">false</span>;</div>
<div class="line"><span class="lineno">   94</span>  } <span class="keywordflow">else</span> {</div>
<div class="line"><span class="lineno">   95</span>    CHECK(<a class="code hl_variable" href="classdyno_1_1FeatureTracker.html#a879d0cd574b194e89bffbe05f85c23fc">previous_frame_</a>);</div>
<div class="line"><span class="lineno">   96</span>    CHECK_EQ(<a class="code hl_variable" href="classdyno_1_1FeatureTracker.html#a879d0cd574b194e89bffbe05f85c23fc">previous_frame_</a>-&gt;frame_id_, frame_id - 1u)</div>
<div class="line"><span class="lineno">   97</span>        &lt;&lt; <span class="stringliteral">&quot;Incoming frame id must be consequative&quot;</span>;</div>
<div class="line"><span class="lineno">   98</span>  }</div>
<div class="line"><span class="lineno">   99</span> </div>
<div class="line"><span class="lineno">  100</span>  <span class="comment">// compute the ObjectBoundaryMaskResult AND detect/track object on the image</span></div>
<div class="line"><span class="lineno">  101</span>  <span class="comment">// if required using the ObjectDetectionEngine (currently we throw away the</span></div>
<div class="line"><span class="lineno">  102</span>  <span class="comment">// result after the function call) ObjectDetectionEngine is used if</span></div>
<div class="line"><span class="lineno">  103</span>  <span class="comment">// params_.prefer_provided_object_detection is false</span></div>
<div class="line"><span class="lineno">  104</span>  vision_tools::ObjectBoundaryMaskResult boundary_mask_result;</div>
<div class="line"><span class="lineno">  105</span>  <a class="code hl_function" href="classdyno_1_1FeatureTracker.html#aa6e3d79ddd4fc72062ea58d8211a50b2">objectDetection</a>(boundary_mask_result, input_images);</div>
<div class="line"><span class="lineno">  106</span> </div>
<div class="line"><span class="lineno">  107</span>  <span class="keywordflow">if</span> (!<a class="code hl_variable" href="classdyno_1_1FeatureTracker.html#a0484d7f8c41021d4e8435caa579af71e">initial_computation_</a> &amp;&amp; <a class="code hl_variable" href="classdyno_1_1FeatureTrackerBase.html#a04f0948954381269fedd5a6856662cb7">params_</a>.<a class="code hl_variable" href="structdyno_1_1TrackerParams.html#a7f0191869820c7d9791d5d680ee4e710">use_propogate_mask</a>) {</div>
<div class="line"><span class="lineno">  108</span>    utils::TimingStatsCollector timer(<span class="stringliteral">&quot;propogate_mask&quot;</span>);</div>
<div class="line"><span class="lineno">  109</span>    <a class="code hl_function" href="classdyno_1_1FeatureTracker.html#a7877773d1c6d5b9cef0c379cd701c1e4">propogateMask</a>(input_images);</div>
<div class="line"><span class="lineno">  110</span>  }</div>
<div class="line"><span class="lineno">  111</span> </div>
<div class="line"><span class="lineno">  112</span>  <span class="comment">// data-structure to handle which objects required re-tracking/sampling</span></div>
<div class="line"><span class="lineno">  113</span>  std::set&lt;ObjectId&gt; object_keyframes;</div>
<div class="line"><span class="lineno">  114</span> </div>
<div class="line"><span class="lineno">  115</span>  <span class="keyword">auto</span> static_track = [&amp;](FeatureContainer&amp; static_features) {</div>
<div class="line"><span class="lineno">  116</span>    VLOG(20) &lt;&lt; <span class="stringliteral">&quot;Starting static track&quot;</span>;</div>
<div class="line"><span class="lineno">  117</span>    utils::TimingStatsCollector static_track_timer(<span class="stringliteral">&quot;static_feature_track&quot;</span>);</div>
<div class="line"><span class="lineno">  118</span>    static_features = <a class="code hl_variable" href="classdyno_1_1FeatureTracker.html#a1ab92bdc22dc50575b8395b4adfae0c1">static_feature_tracker_</a>-&gt;trackStatic(</div>
<div class="line"><span class="lineno">  119</span>        <a class="code hl_variable" href="classdyno_1_1FeatureTracker.html#a879d0cd574b194e89bffbe05f85c23fc">previous_frame_</a>, input_images, <a class="code hl_variable" href="classdyno_1_1FeatureTracker.html#aaf08b9f655f94c59eadf15564f2e69f3">info_</a>,</div>
<div class="line"><span class="lineno">  120</span>        boundary_mask_result.boundary_mask, R_km1_k);</div>
<div class="line"><span class="lineno">  121</span>  };</div>
<div class="line"><span class="lineno">  122</span> </div>
<div class="line"><span class="lineno">  123</span>  <span class="keyword">auto</span> dynamic_track = [&amp;](FeatureContainer&amp; dynamic_features) {</div>
<div class="line"><span class="lineno">  124</span>    VLOG(30) &lt;&lt; <span class="stringliteral">&quot;Starting dynamic track&quot;</span>;</div>
<div class="line"><span class="lineno">  125</span>    <span class="keywordflow">if</span> (<a class="code hl_variable" href="classdyno_1_1FeatureTrackerBase.html#a04f0948954381269fedd5a6856662cb7">params_</a>.<a class="code hl_variable" href="structdyno_1_1TrackerParams.html#a7904cacb28831b9c8b1ddbb4affc5dda">prefer_provided_optical_flow</a> &amp;&amp; input_images.hasOpticalFlow()) {</div>
<div class="line"><span class="lineno">  126</span>      VLOG(30) &lt;&lt; <span class="stringliteral">&quot;Starting dense object feature tracking&quot;</span>;</div>
<div class="line"><span class="lineno">  127</span>      utils::TimingStatsCollector dynamic_track_timer(<span class="stringliteral">&quot;dynamic_feature_track&quot;</span>);</div>
<div class="line"><span class="lineno">  128</span>      <a class="code hl_function" href="classdyno_1_1FeatureTracker.html#a145614fe29bef7728075492870ac9c41">trackDynamic</a>(frame_id, input_images, dynamic_features, object_keyframes,</div>
<div class="line"><span class="lineno">  129</span>                   boundary_mask_result);</div>
<div class="line"><span class="lineno">  130</span>    } <span class="keywordflow">else</span> {</div>
<div class="line"><span class="lineno">  131</span>      <span class="keywordflow">if</span> (<a class="code hl_variable" href="classdyno_1_1FeatureTrackerBase.html#a04f0948954381269fedd5a6856662cb7">params_</a>.<a class="code hl_variable" href="structdyno_1_1TrackerParams.html#a7904cacb28831b9c8b1ddbb4affc5dda">prefer_provided_optical_flow</a> &amp;&amp;</div>
<div class="line"><span class="lineno">  132</span>          !input_images.hasOpticalFlow()) {</div>
<div class="line"><span class="lineno">  133</span>        LOG(WARNING) &lt;&lt; <span class="stringliteral">&quot;Params specify prefer provided optical flow but input &quot;</span></div>
<div class="line"><span class="lineno">  134</span>                        <span class="stringliteral">&quot;is missing! Falling back to KLT&quot;</span>;</div>
<div class="line"><span class="lineno">  135</span>      }</div>
<div class="line"><span class="lineno">  136</span>      VLOG(30) &lt;&lt; <span class="stringliteral">&quot;Starting KLT object feature tracking&quot;</span>;</div>
<div class="line"><span class="lineno">  137</span>      utils::TimingStatsCollector dynamic_track_timer(</div>
<div class="line"><span class="lineno">  138</span>          <span class="stringliteral">&quot;dynamic_feature_track_klt&quot;</span>);</div>
<div class="line"><span class="lineno">  139</span>      <a class="code hl_function" href="classdyno_1_1FeatureTracker.html#a4796a29c1f89cde0ace1668fc8fcd9a3">trackDynamicKLT</a>(frame_id, input_images, dynamic_features,</div>
<div class="line"><span class="lineno">  140</span>                      object_keyframes, boundary_mask_result);</div>
<div class="line"><span class="lineno">  141</span>    }</div>
<div class="line"><span class="lineno">  142</span>  };</div>
<div class="line"><span class="lineno">  143</span> </div>
<div class="line"><span class="lineno">  144</span>  <span class="comment">// start tracking threads since we can do this independantly</span></div>
<div class="line"><span class="lineno">  145</span>  FeatureContainer static_features, dynamic_features;</div>
<div class="line"><span class="lineno">  146</span>  std::thread static_track_thread(static_track, std::ref(static_features));</div>
<div class="line"><span class="lineno">  147</span>  std::thread dynamic_track_thread(dynamic_track, std::ref(dynamic_features));</div>
<div class="line"><span class="lineno">  148</span> </div>
<div class="line"><span class="lineno">  149</span>  static_track_thread.join();</div>
<div class="line"><span class="lineno">  150</span>  dynamic_track_thread.join();</div>
<div class="line"><span class="lineno">  151</span> </div>
<div class="line"><span class="lineno">  152</span>  <a class="code hl_variable" href="classdyno_1_1FeatureTracker.html#a674be7a497efeed1cf90fe3ae44c86d7">previous_tracked_frame_</a> = <a class="code hl_variable" href="classdyno_1_1FeatureTracker.html#a879d0cd574b194e89bffbe05f85c23fc">previous_frame_</a>;  <span class="comment">// Update previous frame (previous</span></div>
<div class="line"><span class="lineno">  153</span>                                              <span class="comment">// to the newly created frame)</span></div>
<div class="line"><span class="lineno">  154</span> </div>
<div class="line"><span class="lineno">  155</span>  <span class="comment">// calculate dynamic observations for existing data</span></div>
<div class="line"><span class="lineno">  156</span>  <span class="comment">// TODO: SingleDetectionResult really does not need the tracklet ids they</span></div>
<div class="line"><span class="lineno">  157</span>  <span class="comment">// are never actually used!! this prevents the frame from needing to do the</span></div>
<div class="line"><span class="lineno">  158</span>  <span class="comment">// same calculations we&#39;ve alrady done</span></div>
<div class="line"><span class="lineno">  159</span>  std::map&lt;ObjectId, SingleDetectionResult&gt; object_observations;</div>
<div class="line"><span class="lineno">  160</span>  <span class="keywordflow">for</span> (<span class="keywordtype">size_t</span> i = 0; i &lt; boundary_mask_result.objects_detected.size(); i++) {</div>
<div class="line"><span class="lineno">  161</span>    <a class="code hl_typedef" href="namespacedyno.html#a38bb86e4154b86428b8d133be03fb2b5">ObjectId</a> object_id = boundary_mask_result.objects_detected.at(i);</div>
<div class="line"><span class="lineno">  162</span>    <span class="keyword">const</span> cv::Rect&amp; bb_detection =</div>
<div class="line"><span class="lineno">  163</span>        boundary_mask_result.object_bounding_boxes.at(i);</div>
<div class="line"><span class="lineno">  164</span> </div>
<div class="line"><span class="lineno">  165</span>    SingleDetectionResult observation;</div>
<div class="line"><span class="lineno">  166</span>    observation.object_id = object_id;</div>
<div class="line"><span class="lineno">  167</span>    <span class="comment">// observation.object_features = dynamic_features.getByObject(object_id);</span></div>
<div class="line"><span class="lineno">  168</span>    observation.bounding_box = bb_detection;</div>
<div class="line"><span class="lineno">  169</span> </div>
<div class="line"><span class="lineno">  170</span>    object_observations[object_id] = observation;</div>
<div class="line"><span class="lineno">  171</span>  }</div>
<div class="line"><span class="lineno">  172</span> </div>
<div class="line"><span class="lineno">  173</span>  utils::TimingStatsCollector f_timer(<span class="stringliteral">&quot;tracking_timer.frame_construction&quot;</span>);</div>
<div class="line"><span class="lineno">  174</span>  <span class="keyword">auto</span> new_frame = std::make_shared&lt;Frame&gt;(</div>
<div class="line"><span class="lineno">  175</span>      frame_id, timestamp, <a class="code hl_variable" href="classdyno_1_1FeatureTrackerBase.html#abf6eba19baf18b1c3648347401c15a56">camera_</a>, input_images, static_features,</div>
<div class="line"><span class="lineno">  176</span>      dynamic_features, object_observations, <a class="code hl_variable" href="classdyno_1_1FeatureTracker.html#aaf08b9f655f94c59eadf15564f2e69f3">info_</a>);</div>
<div class="line"><span class="lineno">  177</span> </div>
<div class="line"><span class="lineno">  178</span>  <span class="comment">// update tracking/sampling information for dynamic obejcts</span></div>
<div class="line"><span class="lineno">  179</span>  new_frame-&gt;retracked_objects_ =</div>
<div class="line"><span class="lineno">  180</span>      <a class="code hl_typedef" href="namespacedyno.html#ae777b079c377ffa066d89051ee0cc623">ObjectIds</a>(object_keyframes.begin(), object_keyframes.end());</div>
<div class="line"><span class="lineno">  181</span> </div>
<div class="line"><span class="lineno">  182</span>  <span class="comment">// update depth threshold information</span></div>
<div class="line"><span class="lineno">  183</span>  new_frame-&gt;setMaxBackgroundDepth(<a class="code hl_variable" href="classdyno_1_1FeatureTracker.html#ade60e243c668c32f13e16fb22f45458a">frontend_params_</a>.<a class="code hl_variable" href="structdyno_1_1FrontendParams.html#abb23d85f45c7aeac3651aba752c23671">max_background_depth</a>);</div>
<div class="line"><span class="lineno">  184</span>  new_frame-&gt;setMaxObjectDepth(<a class="code hl_variable" href="classdyno_1_1FeatureTracker.html#ade60e243c668c32f13e16fb22f45458a">frontend_params_</a>.<a class="code hl_variable" href="structdyno_1_1FrontendParams.html#ab31b237e23ca95dbc327cc3f9b80a81b">max_object_depth</a>);</div>
<div class="line"><span class="lineno">  185</span> </div>
<div class="line"><span class="lineno">  186</span>  VLOG(1) &lt;&lt; <span class="stringliteral">&quot;Tracked on frame &quot;</span> &lt;&lt; frame_id &lt;&lt; <span class="stringliteral">&quot; t= &quot;</span> &lt;&lt; std::setprecision(15)</div>
<div class="line"><span class="lineno">  187</span>          &lt;&lt; timestamp &lt;&lt; <span class="stringliteral">&quot;, object ids &quot;</span></div>
<div class="line"><span class="lineno">  188</span>          &lt;&lt; <a class="code hl_function" href="namespacedyno.html#a17d3c448677824ae83870358b2a3e01d">container_to_string</a>(new_frame-&gt;getObjectIds());</div>
<div class="line"><span class="lineno">  189</span>  <a class="code hl_variable" href="classdyno_1_1FeatureTracker.html#a879d0cd574b194e89bffbe05f85c23fc">previous_frame_</a> = new_frame;</div>
<div class="line"><span class="lineno">  190</span>  <a class="code hl_variable" href="classdyno_1_1FeatureTracker.html#a3cace3a01a3ef42dcfcff3799a789c54">boarder_detection_mask_</a> = boundary_mask_result.boundary_mask;</div>
<div class="line"><span class="lineno">  191</span> </div>
<div class="line"><span class="lineno">  192</span>  <span class="keywordflow">return</span> new_frame;</div>
<div class="line"><span class="lineno">  193</span>}</div>
<div class="ttc" id="aclassdyno_1_1FeatureTracker_html_a0484d7f8c41021d4e8435caa579af71e"><div class="ttname"><a href="classdyno_1_1FeatureTracker.html#a0484d7f8c41021d4e8435caa579af71e">dyno::FeatureTracker::initial_computation_</a></div><div class="ttdeci">bool initial_computation_</div><div class="ttdef"><b>Definition:</b> <a href="FeatureTracker_8hpp_source.html#l00173">FeatureTracker.hpp:173</a></div></div>
<div class="ttc" id="aclassdyno_1_1FeatureTracker_html_a145614fe29bef7728075492870ac9c41"><div class="ttname"><a href="classdyno_1_1FeatureTracker.html#a145614fe29bef7728075492870ac9c41">dyno::FeatureTracker::trackDynamic</a></div><div class="ttdeci">void trackDynamic(FrameId frame_id, const ImageContainer &amp;image_container, FeatureContainer &amp;dynamic_features, std::set&lt; ObjectId &gt; &amp;object_keyframes, const vision_tools::ObjectBoundaryMaskResult &amp;boundary_mask_result)</div><div class="ttdef"><b>Definition:</b> <a href="FeatureTracker_8cc_source.html#l00339">FeatureTracker.cc:339</a></div></div>
<div class="ttc" id="aclassdyno_1_1FeatureTracker_html_a4796a29c1f89cde0ace1668fc8fcd9a3"><div class="ttname"><a href="classdyno_1_1FeatureTracker.html#a4796a29c1f89cde0ace1668fc8fcd9a3">dyno::FeatureTracker::trackDynamicKLT</a></div><div class="ttdeci">void trackDynamicKLT(FrameId frame_id, const ImageContainer &amp;image_container, FeatureContainer &amp;dynamic_features, std::set&lt; ObjectId &gt; &amp;object_keyframes, const vision_tools::ObjectBoundaryMaskResult &amp;boundary_mask_result)</div><div class="ttdef"><b>Definition:</b> <a href="FeatureTracker_8cc_source.html#l00500">FeatureTracker.cc:500</a></div></div>
<div class="ttc" id="aclassdyno_1_1FeatureTracker_html_a7877773d1c6d5b9cef0c379cd701c1e4"><div class="ttname"><a href="classdyno_1_1FeatureTracker.html#a7877773d1c6d5b9cef0c379cd701c1e4">dyno::FeatureTracker::propogateMask</a></div><div class="ttdeci">void propogateMask(ImageContainer &amp;image_container)</div><div class="ttdef"><b>Definition:</b> <a href="FeatureTracker_8cc_source.html#l01204">FeatureTracker.cc:1204</a></div></div>
<div class="ttc" id="aclassdyno_1_1FeatureTracker_html_aa6e3d79ddd4fc72062ea58d8211a50b2"><div class="ttname"><a href="classdyno_1_1FeatureTracker.html#aa6e3d79ddd4fc72062ea58d8211a50b2">dyno::FeatureTracker::objectDetection</a></div><div class="ttdeci">bool objectDetection(vision_tools::ObjectBoundaryMaskResult &amp;boundary_mask_result, ImageContainer &amp;image_container)</div><div class="ttdef"><b>Definition:</b> <a href="FeatureTracker_8cc_source.html#l01142">FeatureTracker.cc:1142</a></div></div>
<div class="ttc" id="astructdyno_1_1FeatureTrackerInfo_html_a3e451313696cef2553e256c4136f6096"><div class="ttname"><a href="structdyno_1_1FeatureTrackerInfo.html#a3e451313696cef2553e256c4136f6096">dyno::FeatureTrackerInfo::frame_id</a></div><div class="ttdeci">FrameId frame_id</div><div class="ttdef"><b>Definition:</b> <a href="Vision-Definitions_8hpp_source.html#l00095">Vision-Definitions.hpp:95</a></div></div>
<div class="ttc" id="astructdyno_1_1FeatureTrackerInfo_html_ad5ffbf938aa7ae6c100a92e1bca09c6a"><div class="ttname"><a href="structdyno_1_1FeatureTrackerInfo.html#ad5ffbf938aa7ae6c100a92e1bca09c6a">dyno::FeatureTrackerInfo::timestamp</a></div><div class="ttdeci">Timestamp timestamp</div><div class="ttdef"><b>Definition:</b> <a href="Vision-Definitions_8hpp_source.html#l00096">Vision-Definitions.hpp:96</a></div></div>
<div class="ttc" id="astructdyno_1_1FrontendParams_html_ab31b237e23ca95dbc327cc3f9b80a81b"><div class="ttname"><a href="structdyno_1_1FrontendParams.html#ab31b237e23ca95dbc327cc3f9b80a81b">dyno::FrontendParams::max_object_depth</a></div><div class="ttdeci">double max_object_depth</div><div class="ttdef"><b>Definition:</b> <a href="FrontendParams_8hpp_source.html#l00050">FrontendParams.hpp:50</a></div></div>
<div class="ttc" id="astructdyno_1_1FrontendParams_html_abb23d85f45c7aeac3651aba752c23671"><div class="ttname"><a href="structdyno_1_1FrontendParams.html#abb23d85f45c7aeac3651aba752c23671">dyno::FrontendParams::max_background_depth</a></div><div class="ttdeci">double max_background_depth</div><div class="ttdef"><b>Definition:</b> <a href="FrontendParams_8hpp_source.html#l00049">FrontendParams.hpp:49</a></div></div>
<div class="ttc" id="astructdyno_1_1TrackerParams_html_a7904cacb28831b9c8b1ddbb4affc5dda"><div class="ttname"><a href="structdyno_1_1TrackerParams.html#a7904cacb28831b9c8b1ddbb4affc5dda">dyno::TrackerParams::prefer_provided_optical_flow</a></div><div class="ttdeci">bool prefer_provided_optical_flow</div><div class="ttdef"><b>Definition:</b> <a href="TrackerParams_8hpp_source.html#l00125">TrackerParams.hpp:125</a></div></div>
<div class="ttc" id="astructdyno_1_1TrackerParams_html_a7f0191869820c7d9791d5d680ee4e710"><div class="ttname"><a href="structdyno_1_1TrackerParams.html#a7f0191869820c7d9791d5d680ee4e710">dyno::TrackerParams::use_propogate_mask</a></div><div class="ttdeci">bool use_propogate_mask</div><div class="ttdef"><b>Definition:</b> <a href="TrackerParams_8hpp_source.html#l00145">TrackerParams.hpp:145</a></div></div>
</div><!-- fragment -->
<p class="reference">References <a class="el" href="classdyno_1_1FeatureTracker.html#a3cace3a01a3ef42dcfcff3799a789c54">boarder_detection_mask_</a>, <a class="el" href="structdyno_1_1vision__tools_1_1ObjectBoundaryMaskResult.html#ad9dd5629b10f507672aa4b623ca6f503">dyno::vision_tools::ObjectBoundaryMaskResult::boundary_mask</a>, <a class="el" href="structdyno_1_1ObjectDetection.html#ad9fabdcfbe6598d220f7756d65425dd1">dyno::ObjectDetection::bounding_box</a>, <a class="el" href="classdyno_1_1FeatureTrackerBase.html#abf6eba19baf18b1c3648347401c15a56">dyno::FeatureTrackerBase::camera_</a>, <a class="el" href="namespacedyno.html#a17d3c448677824ae83870358b2a3e01d">dyno::container_to_string()</a>, <a class="el" href="structdyno_1_1FeatureTrackerInfo.html#a3e451313696cef2553e256c4136f6096">dyno::FeatureTrackerInfo::frame_id</a>, <a class="el" href="classdyno_1_1FeatureTracker.html#ade60e243c668c32f13e16fb22f45458a">frontend_params_</a>, <a class="el" href="classdyno_1_1ImageContainer.html#a4cd8237239f8756cb43980553c6612a7">dyno::ImageContainer::hasOpticalFlow()</a>, <a class="el" href="classdyno_1_1FeatureTrackerBase.html#a23d0ec748366b789be491e61e536839c">dyno::FeatureTrackerBase::img_size_</a>, <a class="el" href="classdyno_1_1FeatureTracker.html#aaf08b9f655f94c59eadf15564f2e69f3">info_</a>, <a class="el" href="classdyno_1_1FeatureTracker.html#a0484d7f8c41021d4e8435caa579af71e">initial_computation_</a>, <a class="el" href="structdyno_1_1FrontendParams.html#abb23d85f45c7aeac3651aba752c23671">dyno::FrontendParams::max_background_depth</a>, <a class="el" href="structdyno_1_1FrontendParams.html#ab31b237e23ca95dbc327cc3f9b80a81b">dyno::FrontendParams::max_object_depth</a>, <a class="el" href="structdyno_1_1vision__tools_1_1ObjectBoundaryMaskResult.html#a29441e3eec8c8abe9cfc969eb4320930">dyno::vision_tools::ObjectBoundaryMaskResult::object_bounding_boxes</a>, <a class="el" href="structdyno_1_1SingleDetectionResult.html#a551f9f3622d6acb8cc98dee5854cf80b">dyno::SingleDetectionResult::object_id</a>, <a class="el" href="classdyno_1_1FeatureTracker.html#aa6e3d79ddd4fc72062ea58d8211a50b2">objectDetection()</a>, <a class="el" href="structdyno_1_1vision__tools_1_1ObjectBoundaryMaskResult.html#a1c842ce8ec0121d8f5e71ba0e48a7a6b">dyno::vision_tools::ObjectBoundaryMaskResult::objects_detected</a>, <a class="el" href="classdyno_1_1FeatureTrackerBase.html#a04f0948954381269fedd5a6856662cb7">dyno::FeatureTrackerBase::params_</a>, <a class="el" href="structdyno_1_1TrackerParams.html#a7904cacb28831b9c8b1ddbb4affc5dda">dyno::TrackerParams::prefer_provided_optical_flow</a>, <a class="el" href="classdyno_1_1FeatureTracker.html#a879d0cd574b194e89bffbe05f85c23fc">previous_frame_</a>, <a class="el" href="classdyno_1_1FeatureTracker.html#a674be7a497efeed1cf90fe3ae44c86d7">previous_tracked_frame_</a>, <a class="el" href="classdyno_1_1FeatureTracker.html#a7877773d1c6d5b9cef0c379cd701c1e4">propogateMask()</a>, <a class="el" href="classdyno_1_1ImageContainer.html#a6f35259f95c31b861ff6515c159e1ee3">dyno::ImageContainer::rgb()</a>, <a class="el" href="classdyno_1_1FeatureTracker.html#a1ab92bdc22dc50575b8395b4adfae0c1">static_feature_tracker_</a>, <a class="el" href="structdyno_1_1FeatureTrackerInfo.html#ad5ffbf938aa7ae6c100a92e1bca09c6a">dyno::FeatureTrackerInfo::timestamp</a>, <a class="el" href="classdyno_1_1FeatureTracker.html#a145614fe29bef7728075492870ac9c41">trackDynamic()</a>, <a class="el" href="classdyno_1_1FeatureTracker.html#a4796a29c1f89cde0ace1668fc8fcd9a3">trackDynamicKLT()</a>, and <a class="el" href="structdyno_1_1TrackerParams.html#a7f0191869820c7d9791d5d680ee4e710">dyno::TrackerParams::use_propogate_mask</a>.</p>
<div class="dynheader">
Here is the call graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="classdyno_1_1FeatureTracker_a40ee79c94fe2de7f16d2a4508cc2ba11_cgraph.png" border="0" usemap="#aclassdyno_1_1FeatureTracker_a40ee79c94fe2de7f16d2a4508cc2ba11_cgraph" alt=""/></div>
<map name="aclassdyno_1_1FeatureTracker_a40ee79c94fe2de7f16d2a4508cc2ba11_cgraph" id="aclassdyno_1_1FeatureTracker_a40ee79c94fe2de7f16d2a4508cc2ba11_cgraph">
<area shape="rect" title=" " alt="" coords="5,415,163,455"/>
<area shape="rect" href="namespacedyno.html#a17d3c448677824ae83870358b2a3e01d" title=" " alt="" coords="711,1573,853,1613"/>
<area shape="rect" href="classdyno_1_1ImageContainer.html#a4cd8237239f8756cb43980553c6612a7" title=" " alt="" coords="211,42,377,82"/>
<area shape="rect" href="classdyno_1_1FeatureTracker.html#aa6e3d79ddd4fc72062ea58d8211a50b2" title=" " alt="" coords="215,178,373,218"/>
<area shape="rect" href="classdyno_1_1ImageContainer.html#a6f35259f95c31b861ff6515c159e1ee3" title=" " alt="" coords="685,321,879,347"/>
<area shape="rect" href="classdyno_1_1FeatureTracker.html#a7877773d1c6d5b9cef0c379cd701c1e4" title=" " alt="" coords="215,415,373,455"/>
<area shape="rect" href="classdyno_1_1FeatureTracker.html#a145614fe29bef7728075492870ac9c41" title=" " alt="" coords="215,826,373,866"/>
<area shape="rect" href="classdyno_1_1FeatureTracker.html#a4796a29c1f89cde0ace1668fc8fcd9a3" title=" " alt="" coords="215,1249,373,1289"/>
<area shape="rect" href="classdyno_1_1ImageContainer.html#a2cd4807310bce124878792073e9122e9" title=" " alt="" coords="699,27,865,67"/>
<area shape="rect" href="classdyno_1_1ImageContainer.html#ae5023f3df359ad7a5196ce15cd632ca3" title=" " alt="" coords="445,206,611,246"/>
<area shape="rect" href="classdyno_1_1ImageContainer.html#a58380247600b24f657657316b195faaf" title=" " alt="" coords="445,27,611,67"/>
<area shape="rect" href="classdyno_1_1ImageContainer.html#ae5eead678f02be0ab9de7464e1833c55" title=" " alt="" coords="699,466,865,506"/>
<area shape="rect" href="classdyno_1_1ImageContainer.html#a0f5c67b77443b776a57d5ec38ddad291" title=" " alt="" coords="445,91,611,131"/>
<area shape="rect" href="classdyno_1_1Feature.html#a37dbbe8da704c2f51e237d38760534fb" title=" " alt="" coords="438,854,618,894"/>
<area shape="rect" href="classdyno_1_1FeatureContainer.html#ae6b7ac557be9590ec1a329acfe00d1c7" title="Clears the entire container." alt="" coords="441,574,615,614"/>
<area shape="rect" href="classdyno_1_1TrackletIdManager.html#acf6eded9b5e98917d2510d96074ef138" title=" " alt="" coords="679,769,885,809"/>
<area shape="rect" href="structdyno_1_1FeatureTrackerInfo.html#a8d5e1a05167ecd041783f39243dd508e" title=" " alt="" coords="437,1019,619,1059"/>
<area shape="rect" href="classdyno_1_1TrackletIdManager.html#a53cb3472fa0367b8dd2a9127111277b2" title=" " alt="" coords="437,1249,619,1289"/>
<area shape="rect" href="classdyno_1_1FeatureTrackerBase.html#a32d80be7e74a096c2b816529b7fd2c69" title="Checks if a keypoint is within an image, taking into account the shrink row/col values in the params...." alt="" coords="433,1185,623,1225"/>
<area shape="rect" href="structdyno_1_1functional__keypoint.html#a3896d96a6f95b5311ae768cdd0ad97e8" title=" " alt="" coords="679,1145,885,1171"/>
<area shape="rect" href="structdyno_1_1functional__keypoint.html#a24933450cad8bc70b7b76b339756cd94" title=" " alt="" coords="679,1195,885,1220"/>
<area shape="rect" href="classdyno_1_1ImageContainer.html#a460749ede77f3694f4f2dfaab76531f7" title=" " alt="" coords="699,631,865,671"/>
<area shape="rect" href="classdyno_1_1FeatureTracker.html#ab50422938e62bccc34295c155357213a" title="Check which objects require new features to be detected on them based on a set of &#39;keyframing&#39; criter..." alt="" coords="449,1414,607,1454"/>
<area shape="rect" href="classdyno_1_1FeatureTracker.html#af6093d870bad67d12dee0c9cb913f87c" title=" " alt="" coords="449,739,607,779"/>
<area shape="rect" href="classdyno_1_1Feature.html#ada9f9980d950874a7a157a82b9921f8a" title="Gets keypoint observation." alt="" coords="695,907,869,932"/>
<area shape="rect" href="classdyno_1_1TrackletIdManager.html#a2a115366087e907d04e6c0d62643ef20" title=" " alt="" coords="691,1249,873,1289"/>
<area shape="rect" href="namespacedyno.html#ab5ae05966c6056b343a960a80c5b1db3" title=" " alt="" coords="685,1345,879,1371"/>
<area shape="rect" href="namespacedyno.html#a7d1c7a6dc85df63392893631e436d45e" title=" " alt="" coords="717,1395,847,1420"/>
<area shape="rect" href="classdyno_1_1FeatureContainer.html#afd095f6a9e0f25539e7febe6eeeaf003" title="Returns the number of features in the container." alt="" coords="695,1445,869,1485"/>
<area shape="rect" href="classdyno_1_1FeatureContainer.html#a00fb07fccff523cba9783e6d00186f28" title="Converts the keypoints of all features in the container to cv::Point2f representation...." alt="" coords="695,1509,869,1549"/>
<area shape="rect" href="namespacedyno.html#adf545b8b790321f0f83e16e7b4927192" title="Float point comparison up to a tolerance." alt="" coords="933,1345,1044,1371"/>
<area shape="rect" href="classdyno_1_1FeatureContainer.html#a3af7c9e40df21b96a8c7067348aed5f5" title="Adds a new feature to the container. Uses feature.trackletId() to set the tracklet key." alt="" coords="679,857,885,883"/>
<area shape="rect" href="classdyno_1_1FeatureContainer.html#a5b73e75d2f4063ac9c16dd0fd565f8da" title="Gets a feature given its tracklet id. If the feature does not exist, nullptr is returned." alt="" coords="441,1630,615,1670"/>
<area shape="rect" href="structdyno_1_1ImageType_1_1RGBMono.html#ac6c656492aaeff4bb8b60f42b0cfa7a3" title=" " alt="" coords="425,1694,631,1734"/>
<area shape="rect" href="classdyno_1_1FeatureContainer.html#abf2f2d568f5dc17944cc122c537a65f5" title="Returns true if a feature with the given tracklet id exists." alt="" coords="695,1637,869,1677"/>
<area shape="rect" href="namespacedyno.html#a80329a3506c3ccb953481bb403dd320f" title=" " alt="" coords="694,1701,870,1727"/>
</map>
</div>

</div>
</div>
<a id="a145614fe29bef7728075492870ac9c41" name="a145614fe29bef7728075492870ac9c41"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a145614fe29bef7728075492870ac9c41">&#9670;&#160;</a></span>trackDynamic()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">void dyno::FeatureTracker::trackDynamic </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="namespacedyno.html#ac4303d6fafb755f794b072d76f9cfb41">FrameId</a>&#160;</td>
          <td class="paramname"><em>frame_id</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const <a class="el" href="classdyno_1_1ImageContainer.html">ImageContainer</a> &amp;&#160;</td>
          <td class="paramname"><em>image_container</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="classdyno_1_1FeatureContainer.html">FeatureContainer</a> &amp;&#160;</td>
          <td class="paramname"><em>dynamic_features</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">std::set&lt; <a class="el" href="namespacedyno.html#a38bb86e4154b86428b8d133be03fb2b5">ObjectId</a> &gt; &amp;&#160;</td>
          <td class="paramname"><em>object_keyframes</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const <a class="el" href="structdyno_1_1vision__tools_1_1ObjectBoundaryMaskResult.html">vision_tools::ObjectBoundaryMaskResult</a> &amp;&#160;</td>
          <td class="paramname"><em>boundary_mask_result</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">protected</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="FeatureTracker_8cc_source.html#l00339">339</a> of file <a class="el" href="FeatureTracker_8cc_source.html">FeatureTracker.cc</a>.</p>
<div class="fragment"><div class="line"><span class="lineno">  342</span>                                                                      {</div>
<div class="line"><span class="lineno">  343</span>  <span class="comment">// first dectect dynamic points</span></div>
<div class="line"><span class="lineno">  344</span>  <span class="keyword">const</span> cv::Mat&amp; rgb = image_container.rgb();</div>
<div class="line"><span class="lineno">  345</span>  <span class="comment">// flow is going to take us from THIS frame to the next frame (which does not</span></div>
<div class="line"><span class="lineno">  346</span>  <span class="comment">// make sense for a realtime system)</span></div>
<div class="line"><span class="lineno">  347</span>  <span class="keyword">const</span> cv::Mat&amp; flow = image_container.opticalFlow();</div>
<div class="line"><span class="lineno">  348</span>  <span class="keyword">const</span> cv::Mat&amp; motion_mask = image_container.objectMotionMask();</div>
<div class="line"><span class="lineno">  349</span> </div>
<div class="line"><span class="lineno">  350</span>  TrackletIdManager&amp; tracked_id_manager = <a class="code hl_function" href="classdyno_1_1TrackletIdManager.html#a53cb3472fa0367b8dd2a9127111277b2">TrackletIdManager::instance</a>();</div>
<div class="line"><span class="lineno">  351</span> </div>
<div class="line"><span class="lineno">  352</span>  std::set&lt;ObjectId&gt; instance_labels;</div>
<div class="line"><span class="lineno">  353</span>  dynamic_features.clear();</div>
<div class="line"><span class="lineno">  354</span> </div>
<div class="line"><span class="lineno">  355</span>  gtsam::FastMap&lt;ObjectId, FeatureContainer&gt; tracks_per_object;</div>
<div class="line"><span class="lineno">  356</span>  <span class="keyword">const</span> cv::Mat&amp; detection_mask = boundary_mask_result.boundary_mask;</div>
<div class="line"><span class="lineno">  357</span>  <span class="comment">// internal detection mask that is appended with new invalid pixels</span></div>
<div class="line"><span class="lineno">  358</span>  <span class="comment">// this builds the static detection mask over the existing input mask</span></div>
<div class="line"><span class="lineno">  359</span>  cv::Mat detection_mask_impl;</div>
<div class="line"><span class="lineno">  360</span>  <span class="comment">// If we are provided with an external detection/feature mask, initalise the</span></div>
<div class="line"><span class="lineno">  361</span>  <span class="comment">// detection mask with this and add more invalid sections to it</span></div>
<div class="line"><span class="lineno">  362</span>  <span class="keywordflow">if</span> (!detection_mask.empty()) {</div>
<div class="line"><span class="lineno">  363</span>    CHECK_EQ(motion_mask.rows, detection_mask.rows);</div>
<div class="line"><span class="lineno">  364</span>    CHECK_EQ(motion_mask.cols, detection_mask.cols);</div>
<div class="line"><span class="lineno">  365</span>    detection_mask_impl = detection_mask.clone();</div>
<div class="line"><span class="lineno">  366</span>  } <span class="keywordflow">else</span> {</div>
<div class="line"><span class="lineno">  367</span>    detection_mask_impl = cv::Mat(motion_mask.size(), CV_8U, cv::Scalar(255));</div>
<div class="line"><span class="lineno">  368</span>  }</div>
<div class="line"><span class="lineno">  369</span>  CHECK_EQ(detection_mask_impl.type(), CV_8U);</div>
<div class="line"><span class="lineno">  370</span> </div>
<div class="line"><span class="lineno">  371</span>  <span class="comment">// creating tracking mask, pixel level indicator (1....N) of dynamic feature</span></div>
<div class="line"><span class="lineno">  372</span>  <span class="comment">// location this is different to the detection_mask_impl which is a binary</span></div>
<div class="line"><span class="lineno">  373</span>  <span class="comment">// mask (0/255) and indicates the location of all features (static and</span></div>
<div class="line"><span class="lineno">  374</span>  <span class="comment">// dynamic) and is used to avoid detecting features near existing ones</span></div>
<div class="line"><span class="lineno">  375</span>  cv::Mat dynamic_tracking_mask =</div>
<div class="line"><span class="lineno">  376</span>      cv::Mat(detection_mask_impl.size(), CV_8U, cv::Scalar(0));</div>
<div class="line"><span class="lineno">  377</span> </div>
<div class="line"><span class="lineno">  378</span>  <span class="keywordflow">if</span> (<a class="code hl_variable" href="classdyno_1_1FeatureTracker.html#a879d0cd574b194e89bffbe05f85c23fc">previous_frame_</a>) {</div>
<div class="line"><span class="lineno">  379</span>    <span class="keyword">const</span> cv::Mat&amp; previous_motion_mask =</div>
<div class="line"><span class="lineno">  380</span>        <a class="code hl_variable" href="classdyno_1_1FeatureTracker.html#a879d0cd574b194e89bffbe05f85c23fc">previous_frame_</a>-&gt;image_container_.objectMotionMask();</div>
<div class="line"><span class="lineno">  381</span>    utils::TimingStatsCollector tracked_dynamic_features(</div>
<div class="line"><span class="lineno">  382</span>        <span class="stringliteral">&quot;tracked_dynamic_features&quot;</span>);</div>
<div class="line"><span class="lineno">  383</span>    <span class="keywordflow">for</span> (Feature::Ptr previous_dynamic_feature :</div>
<div class="line"><span class="lineno">  384</span>         <a class="code hl_variable" href="classdyno_1_1FeatureTracker.html#a879d0cd574b194e89bffbe05f85c23fc">previous_frame_</a>-&gt;usableDynamicFeaturesBegin()) {</div>
<div class="line"><span class="lineno">  385</span>      <span class="keyword">const</span> <a class="code hl_typedef" href="namespacedyno.html#afdd174eb44901fb205371d796287378c">TrackletId</a> tracklet_id = previous_dynamic_feature-&gt;trackletId();</div>
<div class="line"><span class="lineno">  386</span>      <span class="keyword">const</span> <span class="keywordtype">size_t</span> age = previous_dynamic_feature-&gt;age();</div>
<div class="line"><span class="lineno">  387</span> </div>
<div class="line"><span class="lineno">  388</span>      <span class="keyword">const</span> <a class="code hl_typedef" href="namespacedyno.html#aaa260a8022691078c59e1ac6a4fa05b5">Keypoint</a> kp = previous_dynamic_feature-&gt;predictedKeypoint();</div>
<div class="line"><span class="lineno">  389</span>      <span class="keyword">const</span> <span class="keywordtype">int</span> x = <a class="code hl_function" href="structdyno_1_1functional__keypoint.html#a3896d96a6f95b5311ae768cdd0ad97e8">functional_keypoint::u</a>(kp);</div>
<div class="line"><span class="lineno">  390</span>      <span class="keyword">const</span> <span class="keywordtype">int</span> y = <a class="code hl_function" href="structdyno_1_1functional__keypoint.html#a24933450cad8bc70b7b76b339756cd94">functional_keypoint::v</a>(kp);</div>
<div class="line"><span class="lineno">  391</span>      <span class="keyword">const</span> <a class="code hl_typedef" href="namespacedyno.html#a38bb86e4154b86428b8d133be03fb2b5">ObjectId</a> predicted_label = motion_mask.at&lt;<a class="code hl_typedef" href="namespacedyno.html#a38bb86e4154b86428b8d133be03fb2b5">ObjectId</a>&gt;(y, x);</div>
<div class="line"><span class="lineno">  392</span> </div>
<div class="line"><span class="lineno">  393</span>      <span class="keywordflow">if</span> (!detection_mask_impl.empty()) {</div>
<div class="line"><span class="lineno">  394</span>        <span class="keyword">const</span> <span class="keywordtype">unsigned</span> <span class="keywordtype">char</span> valid_detection =</div>
<div class="line"><span class="lineno">  395</span>            detection_mask_impl.at&lt;<span class="keywordtype">unsigned</span> <span class="keywordtype">char</span>&gt;(y, x);</div>
<div class="line"><span class="lineno">  396</span>        <span class="keywordflow">if</span> (valid_detection == 0) {</div>
<div class="line"><span class="lineno">  397</span>          <span class="keywordflow">continue</span>;</div>
<div class="line"><span class="lineno">  398</span>        }</div>
<div class="line"><span class="lineno">  399</span>      }</div>
<div class="line"><span class="lineno">  400</span> </div>
<div class="line"><span class="lineno">  401</span>      <a class="code hl_typedef" href="namespacedyno.html#a38bb86e4154b86428b8d133be03fb2b5">ObjectId</a> previous_label = previous_dynamic_feature-&gt;objectId();</div>
<div class="line"><span class="lineno">  402</span>      CHECK_NE(previous_label, <a class="code hl_variable" href="namespacedyno.html#ae78915ea0afc5025dafb398829f15ba3">background_label</a>);</div>
<div class="line"><span class="lineno">  403</span>      CHECK_GT(previous_label, 0);</div>
<div class="line"><span class="lineno">  404</span> </div>
<div class="line"><span class="lineno">  405</span>      PerObjectStatus&amp; object_tracking_info =</div>
<div class="line"><span class="lineno">  406</span>          <a class="code hl_variable" href="classdyno_1_1FeatureTracker.html#aaf08b9f655f94c59eadf15564f2e69f3">info_</a>.<a class="code hl_function" href="structdyno_1_1FeatureTrackerInfo.html#a8d5e1a05167ecd041783f39243dd508e">getObjectStatus</a>(predicted_label);</div>
<div class="line"><span class="lineno">  407</span>      object_tracking_info.<a class="code hl_variable" href="structdyno_1_1PerObjectStatus.html#a589a729d85dfe39107222db8f5a9c567">num_previous_track</a>++;</div>
<div class="line"><span class="lineno">  408</span> </div>
<div class="line"><span class="lineno">  409</span>      <span class="comment">// true if predicted label not on the background</span></div>
<div class="line"><span class="lineno">  410</span>      <span class="keyword">const</span> <span class="keywordtype">bool</span> is_predicted_object_label =</div>
<div class="line"><span class="lineno">  411</span>          predicted_label != <a class="code hl_variable" href="namespacedyno.html#ae78915ea0afc5025dafb398829f15ba3">background_label</a>;</div>
<div class="line"><span class="lineno">  412</span>      <span class="comment">// true if predicted label the same as the previous label of the tracked</span></div>
<div class="line"><span class="lineno">  413</span>      <span class="comment">// point</span></div>
<div class="line"><span class="lineno">  414</span>      <span class="keyword">const</span> <span class="keywordtype">bool</span> is_precited_same_as_previous =</div>
<div class="line"><span class="lineno">  415</span>          predicted_label == previous_label;</div>
<div class="line"><span class="lineno">  416</span> </div>
<div class="line"><span class="lineno">  417</span>      <span class="comment">// update stats</span></div>
<div class="line"><span class="lineno">  418</span>      <span class="keywordflow">if</span> (!is_predicted_object_label)</div>
<div class="line"><span class="lineno">  419</span>        object_tracking_info.num_tracked_with_background_label++;</div>
<div class="line"><span class="lineno">  420</span>      <span class="keywordflow">if</span> (!is_precited_same_as_previous)</div>
<div class="line"><span class="lineno">  421</span>        object_tracking_info.num_tracked_with_different_label++;</div>
<div class="line"><span class="lineno">  422</span> </div>
<div class="line"><span class="lineno">  423</span>      <span class="comment">// only include point if it is contained, it is not static and the</span></div>
<div class="line"><span class="lineno">  424</span>      <span class="comment">// previous label is the same as the predicted label</span></div>
<div class="line"><span class="lineno">  425</span>      <span class="keywordflow">if</span> (<a class="code hl_variable" href="classdyno_1_1FeatureTrackerBase.html#abf6eba19baf18b1c3648347401c15a56">camera_</a>-&gt;isKeypointContained(kp) &amp;&amp; is_predicted_object_label &amp;&amp;</div>
<div class="line"><span class="lineno">  426</span>          is_precited_same_as_previous) {</div>
<div class="line"><span class="lineno">  427</span>        <span class="keywordtype">size_t</span> new_age = age + 1;</div>
<div class="line"><span class="lineno">  428</span>        <span class="keywordtype">double</span> flow_xe = <span class="keyword">static_cast&lt;</span><span class="keywordtype">double</span><span class="keyword">&gt;</span>(flow.at&lt;cv::Vec2f&gt;(y, x)[0]);</div>
<div class="line"><span class="lineno">  429</span>        <span class="keywordtype">double</span> flow_ye = <span class="keyword">static_cast&lt;</span><span class="keywordtype">double</span><span class="keyword">&gt;</span>(flow.at&lt;cv::Vec2f&gt;(y, x)[1]);</div>
<div class="line"><span class="lineno">  430</span> </div>
<div class="line"><span class="lineno">  431</span>        <a class="code hl_typedef" href="namespacedyno.html#aba8bf92162160923c6e5c7249892d5f8">OpticalFlow</a> flow(flow_xe, flow_ye);</div>
<div class="line"><span class="lineno">  432</span>        <span class="keyword">const</span> <a class="code hl_typedef" href="namespacedyno.html#aaa260a8022691078c59e1ac6a4fa05b5">Keypoint</a> predicted_kp =</div>
<div class="line"><span class="lineno">  433</span>            <a class="code hl_function" href="classdyno_1_1Feature.html#a37dbbe8da704c2f51e237d38760534fb">Feature::CalculatePredictedKeypoint</a>(kp, flow);</div>
<div class="line"><span class="lineno">  434</span> </div>
<div class="line"><span class="lineno">  435</span>        <span class="keywordflow">if</span> (!<a class="code hl_function" href="classdyno_1_1FeatureTrackerBase.html#a32d80be7e74a096c2b816529b7fd2c69">isWithinShrunkenImage</a>(predicted_kp)) {</div>
<div class="line"><span class="lineno">  436</span>          object_tracking_info.num_outside_shrunken_image++;</div>
<div class="line"><span class="lineno">  437</span>          <span class="keywordflow">continue</span>;</div>
<div class="line"><span class="lineno">  438</span>        }</div>
<div class="line"><span class="lineno">  439</span> </div>
<div class="line"><span class="lineno">  440</span>        <span class="keywordflow">if</span> (flow_xe == 0 || flow_ye == 0) {</div>
<div class="line"><span class="lineno">  441</span>          object_tracking_info.num_zero_flow++;</div>
<div class="line"><span class="lineno">  442</span>          <span class="keywordflow">continue</span>;</div>
<div class="line"><span class="lineno">  443</span>        }</div>
<div class="line"><span class="lineno">  444</span> </div>
<div class="line"><span class="lineno">  445</span>        <span class="comment">// limit point tracking of a certain age</span></div>
<div class="line"><span class="lineno">  446</span>        <a class="code hl_typedef" href="namespacedyno.html#afdd174eb44901fb205371d796287378c">TrackletId</a> tracklet_to_use = tracklet_id;</div>
<div class="line"><span class="lineno">  447</span>        <span class="keywordflow">if</span> (new_age &gt; <a class="code hl_variable" href="classdyno_1_1FeatureTrackerBase.html#a04f0948954381269fedd5a6856662cb7">params_</a>.<a class="code hl_variable" href="structdyno_1_1TrackerParams.html#a169251cb91b823891ca91504f9486e3f">max_dynamic_feature_age</a>) {</div>
<div class="line"><span class="lineno">  448</span>          tracklet_to_use = tracked_id_manager.getAndIncrementTrackletId();</div>
<div class="line"><span class="lineno">  449</span>          new_age = 0;</div>
<div class="line"><span class="lineno">  450</span>        }</div>
<div class="line"><span class="lineno">  451</span> </div>
<div class="line"><span class="lineno">  452</span>        Feature::Ptr feature = std::make_shared&lt;Feature&gt;();</div>
<div class="line"><span class="lineno">  453</span>        (*feature)</div>
<div class="line"><span class="lineno">  454</span>            .objectId(predicted_label)</div>
<div class="line"><span class="lineno">  455</span>            .frameId(frame_id)</div>
<div class="line"><span class="lineno">  456</span>            .keypointType(<a class="code hl_enumvalue" href="namespacedyno.html#ad6aa767541eb74e30fc5a7b018322952ac942f1cf01159e70b36aaf8bc517bf9d">KeyPointType::DYNAMIC</a>)</div>
<div class="line"><span class="lineno">  457</span>            .age(new_age)</div>
<div class="line"><span class="lineno">  458</span>            .trackletId(tracklet_to_use)</div>
<div class="line"><span class="lineno">  459</span>            .keypoint(kp)</div>
<div class="line"><span class="lineno">  460</span>            .measuredFlow(flow)</div>
<div class="line"><span class="lineno">  461</span>            .predictedKeypoint(predicted_kp);</div>
<div class="line"><span class="lineno">  462</span> </div>
<div class="line"><span class="lineno">  463</span>        <span class="keywordflow">if</span> (!tracks_per_object.exists(feature-&gt;objectId())) {</div>
<div class="line"><span class="lineno">  464</span>          tracks_per_object.insert2(feature-&gt;objectId(), FeatureContainer{});</div>
<div class="line"><span class="lineno">  465</span>        }</div>
<div class="line"><span class="lineno">  466</span>        tracks_per_object.at(feature-&gt;objectId()).add(feature);</div>
<div class="line"><span class="lineno">  467</span>        instance_labels.insert(feature-&gt;objectId());</div>
<div class="line"><span class="lineno">  468</span>        object_tracking_info.num_track++;</div>
<div class="line"><span class="lineno">  469</span> </div>
<div class="line"><span class="lineno">  470</span>        <span class="comment">// add zero fill to detection mask to indicate the existance of a</span></div>
<div class="line"><span class="lineno">  471</span>        <span class="comment">// tracked point at this feature location</span></div>
<div class="line"><span class="lineno">  472</span>        cv::circle(</div>
<div class="line"><span class="lineno">  473</span>            detection_mask_impl, cv::Point2f(x, y),</div>
<div class="line"><span class="lineno">  474</span>            <a class="code hl_variable" href="classdyno_1_1FeatureTrackerBase.html#a04f0948954381269fedd5a6856662cb7">params_</a>.<a class="code hl_variable" href="structdyno_1_1TrackerParams.html#af7f44eed9da99d0abf332eb9e40d072b">min_distance_btw_tracked_and_detected_dynamic_features</a>,</div>
<div class="line"><span class="lineno">  475</span>            cv::Scalar(0), cv::FILLED);</div>
<div class="line"><span class="lineno">  476</span> </div>
<div class="line"><span class="lineno">  477</span>        <span class="comment">// fill tracking mask with tracked points, labelled with the object</span></div>
<div class="line"><span class="lineno">  478</span>        <span class="comment">// label (j) to indicate places on object with keypoints</span></div>
<div class="line"><span class="lineno">  479</span>        cv::circle(</div>
<div class="line"><span class="lineno">  480</span>            dynamic_tracking_mask, cv::Point2f(x, y),</div>
<div class="line"><span class="lineno">  481</span>            <a class="code hl_variable" href="classdyno_1_1FeatureTrackerBase.html#a04f0948954381269fedd5a6856662cb7">params_</a>.<a class="code hl_variable" href="structdyno_1_1TrackerParams.html#af7f44eed9da99d0abf332eb9e40d072b">min_distance_btw_tracked_and_detected_dynamic_features</a>,</div>
<div class="line"><span class="lineno">  482</span>            cv::Scalar(predicted_label), cv::FILLED);</div>
<div class="line"><span class="lineno">  483</span>      }</div>
<div class="line"><span class="lineno">  484</span>    }</div>
<div class="line"><span class="lineno">  485</span>    <span class="comment">// merge features</span></div>
<div class="line"><span class="lineno">  486</span>    <span class="keywordflow">for</span> (<span class="keyword">const</span> <span class="keyword">auto</span>&amp; [_, features_j] : tracks_per_object) {</div>
<div class="line"><span class="lineno">  487</span>      dynamic_features += features_j;</div>
<div class="line"><span class="lineno">  488</span>    }</div>
<div class="line"><span class="lineno">  489</span>  }</div>
<div class="line"><span class="lineno">  490</span> </div>
<div class="line"><span class="lineno">  491</span>  <a class="code hl_function" href="classdyno_1_1FeatureTracker.html#ab50422938e62bccc34295c155357213a">requiresSampling</a>(object_keyframes, <a class="code hl_variable" href="classdyno_1_1FeatureTracker.html#aaf08b9f655f94c59eadf15564f2e69f3">info_</a>, image_container, tracks_per_object,</div>
<div class="line"><span class="lineno">  492</span>                   boundary_mask_result, dynamic_tracking_mask);</div>
<div class="line"><span class="lineno">  493</span> </div>
<div class="line"><span class="lineno">  494</span>  std::set&lt;ObjectId&gt; objects_sampled;</div>
<div class="line"><span class="lineno">  495</span>  <a class="code hl_function" href="classdyno_1_1FeatureTracker.html#af6093d870bad67d12dee0c9cb913f87c">sampleDynamic</a>(frame_id, image_container,</div>
<div class="line"><span class="lineno">  496</span>                object_keyframes,  <span class="comment">// indicates which objects to sample!!</span></div>
<div class="line"><span class="lineno">  497</span>                dynamic_features, objects_sampled, detection_mask_impl);</div>
<div class="line"><span class="lineno">  498</span>}</div>
<div class="ttc" id="aclassdyno_1_1FeatureTracker_html_ab50422938e62bccc34295c155357213a"><div class="ttname"><a href="classdyno_1_1FeatureTracker.html#ab50422938e62bccc34295c155357213a">dyno::FeatureTracker::requiresSampling</a></div><div class="ttdeci">void requiresSampling(std::set&lt; ObjectId &gt; &amp;objects_to_sample, const FeatureTrackerInfo &amp;info, const ImageContainer &amp;image_container, const gtsam::FastMap&lt; ObjectId, FeatureContainer &gt; &amp;features_per_object, const vision_tools::ObjectBoundaryMaskResult &amp;boundary_mask_result, const cv::Mat &amp;dynamic_tracking_mask) const</div><div class="ttdoc">Check which objects require new features to be detected on them based on a set of 'keyframing' criter...</div><div class="ttdef"><b>Definition:</b> <a href="FeatureTracker_8cc_source.html#l01023">FeatureTracker.cc:1023</a></div></div>
<div class="ttc" id="aclassdyno_1_1FeatureTracker_html_af6093d870bad67d12dee0c9cb913f87c"><div class="ttname"><a href="classdyno_1_1FeatureTracker.html#af6093d870bad67d12dee0c9cb913f87c">dyno::FeatureTracker::sampleDynamic</a></div><div class="ttdeci">void sampleDynamic(FrameId frame_id, const ImageContainer &amp;image_container, const std::set&lt; ObjectId &gt; &amp;objects_to_sample, FeatureContainer &amp;dynamic_features, std::set&lt; ObjectId &gt; &amp;objects_sampled, const cv::Mat &amp;detection_mask)</div><div class="ttdef"><b>Definition:</b> <a href="FeatureTracker_8cc_source.html#l00869">FeatureTracker.cc:869</a></div></div>
<div class="ttc" id="astructdyno_1_1PerObjectStatus_html_a589a729d85dfe39107222db8f5a9c567"><div class="ttname"><a href="structdyno_1_1PerObjectStatus.html#a589a729d85dfe39107222db8f5a9c567">dyno::PerObjectStatus::num_previous_track</a></div><div class="ttdeci">size_t num_previous_track</div><div class="ttdef"><b>Definition:</b> <a href="Vision-Definitions_8hpp_source.html#l00074">Vision-Definitions.hpp:74</a></div></div>
<div class="ttc" id="astructdyno_1_1TrackerParams_html_af7f44eed9da99d0abf332eb9e40d072b"><div class="ttname"><a href="structdyno_1_1TrackerParams.html#af7f44eed9da99d0abf332eb9e40d072b">dyno::TrackerParams::min_distance_btw_tracked_and_detected_dynamic_features</a></div><div class="ttdeci">int min_distance_btw_tracked_and_detected_dynamic_features</div><div class="ttdef"><b>Definition:</b> <a href="TrackerParams_8hpp_source.html#l00112">TrackerParams.hpp:112</a></div></div>
</div><!-- fragment -->
<p class="reference">References <a class="el" href="namespacedyno.html#ae78915ea0afc5025dafb398829f15ba3">dyno::background_label</a>, <a class="el" href="structdyno_1_1vision__tools_1_1ObjectBoundaryMaskResult.html#ad9dd5629b10f507672aa4b623ca6f503">dyno::vision_tools::ObjectBoundaryMaskResult::boundary_mask</a>, <a class="el" href="classdyno_1_1Feature.html#a37dbbe8da704c2f51e237d38760534fb">dyno::Feature::CalculatePredictedKeypoint()</a>, <a class="el" href="classdyno_1_1FeatureTrackerBase.html#abf6eba19baf18b1c3648347401c15a56">dyno::FeatureTrackerBase::camera_</a>, <a class="el" href="classdyno_1_1FeatureContainer.html#ae6b7ac557be9590ec1a329acfe00d1c7">dyno::FeatureContainer::clear()</a>, <a class="el" href="namespacedyno.html#ad6aa767541eb74e30fc5a7b018322952ac942f1cf01159e70b36aaf8bc517bf9d">dyno::DYNAMIC</a>, <a class="el" href="classdyno_1_1TrackletIdManager.html#acf6eded9b5e98917d2510d96074ef138">dyno::TrackletIdManager::getAndIncrementTrackletId()</a>, <a class="el" href="structdyno_1_1FeatureTrackerInfo.html#a8d5e1a05167ecd041783f39243dd508e">dyno::FeatureTrackerInfo::getObjectStatus()</a>, <a class="el" href="classdyno_1_1FeatureTracker.html#aaf08b9f655f94c59eadf15564f2e69f3">info_</a>, <a class="el" href="classdyno_1_1TrackletIdManager.html#a53cb3472fa0367b8dd2a9127111277b2">dyno::TrackletIdManager::instance()</a>, <a class="el" href="classdyno_1_1FeatureTrackerBase.html#a32d80be7e74a096c2b816529b7fd2c69">dyno::FeatureTrackerBase::isWithinShrunkenImage()</a>, <a class="el" href="structdyno_1_1TrackerParams.html#a169251cb91b823891ca91504f9486e3f">dyno::TrackerParams::max_dynamic_feature_age</a>, <a class="el" href="structdyno_1_1TrackerParams.html#af7f44eed9da99d0abf332eb9e40d072b">dyno::TrackerParams::min_distance_btw_tracked_and_detected_dynamic_features</a>, <a class="el" href="structdyno_1_1PerObjectStatus.html#a2716fdf6b7d90988e5eb30bd3eccbd83">dyno::PerObjectStatus::num_outside_shrunken_image</a>, <a class="el" href="structdyno_1_1PerObjectStatus.html#a589a729d85dfe39107222db8f5a9c567">dyno::PerObjectStatus::num_previous_track</a>, <a class="el" href="structdyno_1_1PerObjectStatus.html#a92177bf8894a5aec02dca34b853b4e06">dyno::PerObjectStatus::num_track</a>, <a class="el" href="structdyno_1_1PerObjectStatus.html#ad974a284ec89a832a0654102af603ca2">dyno::PerObjectStatus::num_tracked_with_background_label</a>, <a class="el" href="structdyno_1_1PerObjectStatus.html#a9054a60829be5c685646260a1f893162">dyno::PerObjectStatus::num_tracked_with_different_label</a>, <a class="el" href="structdyno_1_1PerObjectStatus.html#aed2f4e73fd0c2100788cc0fa0ecbc8b1">dyno::PerObjectStatus::num_zero_flow</a>, <a class="el" href="classdyno_1_1ImageContainer.html#ae5eead678f02be0ab9de7464e1833c55">dyno::ImageContainer::objectMotionMask()</a>, <a class="el" href="classdyno_1_1ImageContainer.html#a460749ede77f3694f4f2dfaab76531f7">dyno::ImageContainer::opticalFlow()</a>, <a class="el" href="classdyno_1_1FeatureTrackerBase.html#a04f0948954381269fedd5a6856662cb7">dyno::FeatureTrackerBase::params_</a>, <a class="el" href="classdyno_1_1FeatureTracker.html#a879d0cd574b194e89bffbe05f85c23fc">previous_frame_</a>, <a class="el" href="classdyno_1_1FeatureTracker.html#ab50422938e62bccc34295c155357213a">requiresSampling()</a>, <a class="el" href="classdyno_1_1ImageContainer.html#a6f35259f95c31b861ff6515c159e1ee3">dyno::ImageContainer::rgb()</a>, <a class="el" href="classdyno_1_1FeatureTracker.html#af6093d870bad67d12dee0c9cb913f87c">sampleDynamic()</a>, <a class="el" href="structdyno_1_1functional__keypoint.html#a3896d96a6f95b5311ae768cdd0ad97e8">dyno::functional_keypoint::u()</a>, and <a class="el" href="structdyno_1_1functional__keypoint.html#a24933450cad8bc70b7b76b339756cd94">dyno::functional_keypoint::v()</a>.</p>

<p class="reference">Referenced by <a class="el" href="classdyno_1_1FeatureTracker.html#a40ee79c94fe2de7f16d2a4508cc2ba11">track()</a>.</p>
<div class="dynheader">
Here is the call graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="classdyno_1_1FeatureTracker_a145614fe29bef7728075492870ac9c41_cgraph.png" border="0" usemap="#aclassdyno_1_1FeatureTracker_a145614fe29bef7728075492870ac9c41_cgraph" alt=""/></div>
<map name="aclassdyno_1_1FeatureTracker_a145614fe29bef7728075492870ac9c41_cgraph" id="aclassdyno_1_1FeatureTracker_a145614fe29bef7728075492870ac9c41_cgraph">
<area shape="rect" title=" " alt="" coords="5,343,163,383"/>
<area shape="rect" href="classdyno_1_1Feature.html#a37dbbe8da704c2f51e237d38760534fb" title=" " alt="" coords="215,5,395,45"/>
<area shape="rect" href="classdyno_1_1FeatureContainer.html#ae6b7ac557be9590ec1a329acfe00d1c7" title="Clears the entire container." alt="" coords="218,69,393,109"/>
<area shape="rect" href="classdyno_1_1TrackletIdManager.html#acf6eded9b5e98917d2510d96074ef138" title=" " alt="" coords="449,89,654,129"/>
<area shape="rect" href="structdyno_1_1FeatureTrackerInfo.html#a8d5e1a05167ecd041783f39243dd508e" title=" " alt="" coords="214,400,397,440"/>
<area shape="rect" href="classdyno_1_1TrackletIdManager.html#a53cb3472fa0367b8dd2a9127111277b2" title=" " alt="" coords="214,464,397,504"/>
<area shape="rect" href="classdyno_1_1FeatureTrackerBase.html#a32d80be7e74a096c2b816529b7fd2c69" title="Checks if a keypoint is within an image, taking into account the shrink row/col values in the params...." alt="" coords="211,579,400,619"/>
<area shape="rect" href="structdyno_1_1functional__keypoint.html#a3896d96a6f95b5311ae768cdd0ad97e8" title=" " alt="" coords="448,533,655,558"/>
<area shape="rect" href="structdyno_1_1functional__keypoint.html#a24933450cad8bc70b7b76b339756cd94" title=" " alt="" coords="448,586,655,611"/>
<area shape="rect" href="classdyno_1_1ImageContainer.html#ae5eead678f02be0ab9de7464e1833c55" title=" " alt="" coords="468,153,635,193"/>
<area shape="rect" href="classdyno_1_1ImageContainer.html#a460749ede77f3694f4f2dfaab76531f7" title=" " alt="" coords="468,292,635,332"/>
<area shape="rect" href="classdyno_1_1FeatureTracker.html#ab50422938e62bccc34295c155357213a" title="Check which objects require new features to be detected on them based on a set of &#39;keyframing&#39; criter..." alt="" coords="227,732,384,772"/>
<area shape="rect" href="classdyno_1_1ImageContainer.html#a6f35259f95c31b861ff6515c159e1ee3" title=" " alt="" coords="454,357,649,382"/>
<area shape="rect" href="classdyno_1_1FeatureTracker.html#af6093d870bad67d12dee0c9cb913f87c" title=" " alt="" coords="227,235,384,275"/>
<area shape="rect" href="classdyno_1_1Feature.html#ada9f9980d950874a7a157a82b9921f8a" title="Gets keypoint observation." alt="" coords="464,13,639,38"/>
<area shape="rect" href="classdyno_1_1TrackletIdManager.html#a2a115366087e907d04e6c0d62643ef20" title=" " alt="" coords="460,464,643,504"/>
<area shape="rect" href="namespacedyno.html#a17d3c448677824ae83870358b2a3e01d" title=" " alt="" coords="480,764,623,804"/>
<area shape="rect" href="namespacedyno.html#ab5ae05966c6056b343a960a80c5b1db3" title=" " alt="" coords="454,829,649,854"/>
<area shape="rect" href="namespacedyno.html#a7d1c7a6dc85df63392893631e436d45e" title=" " alt="" coords="486,878,617,903"/>
<area shape="rect" href="classdyno_1_1FeatureContainer.html#afd095f6a9e0f25539e7febe6eeeaf003" title="Returns the number of features in the container." alt="" coords="464,636,639,676"/>
<area shape="rect" href="classdyno_1_1FeatureContainer.html#a00fb07fccff523cba9783e6d00186f28" title="Converts the keypoints of all features in the container to cv::Point2f representation...." alt="" coords="464,700,639,740"/>
<area shape="rect" href="namespacedyno.html#adf545b8b790321f0f83e16e7b4927192" title="Float point comparison up to a tolerance." alt="" coords="703,829,813,854"/>
<area shape="rect" href="classdyno_1_1FeatureContainer.html#a3af7c9e40df21b96a8c7067348aed5f5" title="Adds a new feature to the container. Uses feature.trackletId() to set the tracklet key." alt="" coords="448,242,655,267"/>
</map>
</div>
<div class="dynheader">
Here is the caller graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="classdyno_1_1FeatureTracker_a145614fe29bef7728075492870ac9c41_icgraph.png" border="0" usemap="#aclassdyno_1_1FeatureTracker_a145614fe29bef7728075492870ac9c41_icgraph" alt=""/></div>
<map name="aclassdyno_1_1FeatureTracker_a145614fe29bef7728075492870ac9c41_icgraph" id="aclassdyno_1_1FeatureTracker_a145614fe29bef7728075492870ac9c41_icgraph">
<area shape="rect" title=" " alt="" coords="211,5,368,45"/>
<area shape="rect" href="classdyno_1_1FeatureTracker.html#a40ee79c94fe2de7f16d2a4508cc2ba11" title=" " alt="" coords="5,5,163,45"/>
</map>
</div>

</div>
</div>
<a id="a4796a29c1f89cde0ace1668fc8fcd9a3" name="a4796a29c1f89cde0ace1668fc8fcd9a3"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a4796a29c1f89cde0ace1668fc8fcd9a3">&#9670;&#160;</a></span>trackDynamicKLT()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">void dyno::FeatureTracker::trackDynamicKLT </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="namespacedyno.html#ac4303d6fafb755f794b072d76f9cfb41">FrameId</a>&#160;</td>
          <td class="paramname"><em>frame_id</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const <a class="el" href="classdyno_1_1ImageContainer.html">ImageContainer</a> &amp;&#160;</td>
          <td class="paramname"><em>image_container</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="classdyno_1_1FeatureContainer.html">FeatureContainer</a> &amp;&#160;</td>
          <td class="paramname"><em>dynamic_features</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">std::set&lt; <a class="el" href="namespacedyno.html#a38bb86e4154b86428b8d133be03fb2b5">ObjectId</a> &gt; &amp;&#160;</td>
          <td class="paramname"><em>object_keyframes</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const <a class="el" href="structdyno_1_1vision__tools_1_1ObjectBoundaryMaskResult.html">vision_tools::ObjectBoundaryMaskResult</a> &amp;&#160;</td>
          <td class="paramname"><em>boundary_mask_result</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">protected</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="FeatureTracker_8cc_source.html#l00500">500</a> of file <a class="el" href="FeatureTracker_8cc_source.html">FeatureTracker.cc</a>.</p>
<div class="fragment"><div class="line"><span class="lineno">  503</span>                                                                      {</div>
<div class="line"><span class="lineno">  504</span>  <span class="keyword">const</span> cv::Mat&amp; rgb = image_container.rgb();</div>
<div class="line"><span class="lineno">  505</span>  cv::Mat mono = <a class="code hl_function" href="structdyno_1_1ImageType_1_1RGBMono.html#ac6c656492aaeff4bb8b60f42b0cfa7a3">ImageType::RGBMono::toMono</a>(image_container.rgb());</div>
<div class="line"><span class="lineno">  506</span>  <span class="keyword">const</span> cv::Mat&amp; motion_mask = image_container.objectMotionMask();</div>
<div class="line"><span class="lineno">  507</span> </div>
<div class="line"><span class="lineno">  508</span>  TrackletIdManager&amp; tracked_id_manager = <a class="code hl_function" href="classdyno_1_1TrackletIdManager.html#a53cb3472fa0367b8dd2a9127111277b2">TrackletIdManager::instance</a>();</div>
<div class="line"><span class="lineno">  509</span> </div>
<div class="line"><span class="lineno">  510</span>  gtsam::FastMap&lt;ObjectId, FeatureContainer&gt; tracks_per_object;</div>
<div class="line"><span class="lineno">  511</span>  <span class="keyword">const</span> cv::Mat&amp; detection_mask = boundary_mask_result.boundary_mask;</div>
<div class="line"><span class="lineno">  512</span>  <span class="comment">// internal detection mask that is appended with new invalid pixels</span></div>
<div class="line"><span class="lineno">  513</span>  <span class="comment">// this builds the static detection mask over the existing input mask</span></div>
<div class="line"><span class="lineno">  514</span>  cv::Mat detection_mask_impl;</div>
<div class="line"><span class="lineno">  515</span>  <span class="comment">// If we are provided with an external detection/feature mask, initalise the</span></div>
<div class="line"><span class="lineno">  516</span>  <span class="comment">// detection mask with this and add more invalid sections to it</span></div>
<div class="line"><span class="lineno">  517</span>  <span class="keywordflow">if</span> (!detection_mask.empty()) {</div>
<div class="line"><span class="lineno">  518</span>    CHECK_EQ(motion_mask.rows, detection_mask.rows);</div>
<div class="line"><span class="lineno">  519</span>    CHECK_EQ(motion_mask.cols, detection_mask.cols);</div>
<div class="line"><span class="lineno">  520</span>    detection_mask_impl = detection_mask.clone();</div>
<div class="line"><span class="lineno">  521</span>  } <span class="keywordflow">else</span> {</div>
<div class="line"><span class="lineno">  522</span>    detection_mask_impl = cv::Mat(motion_mask.size(), CV_8U, cv::Scalar(255));</div>
<div class="line"><span class="lineno">  523</span>  }</div>
<div class="line"><span class="lineno">  524</span>  CHECK_EQ(detection_mask_impl.type(), CV_8U);</div>
<div class="line"><span class="lineno">  525</span> </div>
<div class="line"><span class="lineno">  526</span>  <span class="comment">// creating tracking mask, pixel level indicator (1....N) of dynamic feature</span></div>
<div class="line"><span class="lineno">  527</span>  <span class="comment">// location this is different to the detection_mask_impl which is a binary</span></div>
<div class="line"><span class="lineno">  528</span>  <span class="comment">// mask (0/255) and indicates the location of all features (static and</span></div>
<div class="line"><span class="lineno">  529</span>  <span class="comment">// dynamic) and is used to avoid detecting features near existing ones</span></div>
<div class="line"><span class="lineno">  530</span>  cv::Mat dynamic_tracking_mask =</div>
<div class="line"><span class="lineno">  531</span>      cv::Mat(detection_mask_impl.size(), CV_8U, cv::Scalar(0));</div>
<div class="line"><span class="lineno">  532</span> </div>
<div class="line"><span class="lineno">  533</span>  <span class="keyword">auto</span> constructNewDynamicFeature =</div>
<div class="line"><span class="lineno">  534</span>      [&amp;](<span class="keyword">const</span> <a class="code hl_typedef" href="namespacedyno.html#aaa260a8022691078c59e1ac6a4fa05b5">Keypoint</a>&amp; kp_current, <span class="keyword">const</span> <a class="code hl_typedef" href="namespacedyno.html#a38bb86e4154b86428b8d133be03fb2b5">ObjectId</a> object_id,</div>
<div class="line"><span class="lineno">  535</span>          <span class="keyword">const</span> <a class="code hl_typedef" href="namespacedyno.html#ac4303d6fafb755f794b072d76f9cfb41">FrameId</a> frame_id) -&gt; Feature::Ptr {</div>
<div class="line"><span class="lineno">  536</span>    <span class="keyword">static</span> <span class="keyword">const</span> <span class="keyword">auto</span> kAge = 0u;</div>
<div class="line"><span class="lineno">  537</span> </div>
<div class="line"><span class="lineno">  538</span>    <span class="keywordflow">if</span> (!<a class="code hl_function" href="classdyno_1_1FeatureTrackerBase.html#a32d80be7e74a096c2b816529b7fd2c69">isWithinShrunkenImage</a>(kp_current)) {</div>
<div class="line"><span class="lineno">  539</span>      <span class="keywordflow">return</span> <span class="keyword">nullptr</span>;</div>
<div class="line"><span class="lineno">  540</span>    }</div>
<div class="line"><span class="lineno">  541</span> </div>
<div class="line"><span class="lineno">  542</span>    <a class="code hl_typedef" href="namespacedyno.html#afdd174eb44901fb205371d796287378c">TrackletId</a> tracklet_to_use = tracked_id_manager.getAndIncrementTrackletId();</div>
<div class="line"><span class="lineno">  543</span> </div>
<div class="line"><span class="lineno">  544</span>    Feature::Ptr feature = std::make_shared&lt;Feature&gt;();</div>
<div class="line"><span class="lineno">  545</span>    (*feature)</div>
<div class="line"><span class="lineno">  546</span>        .objectId(object_id)</div>
<div class="line"><span class="lineno">  547</span>        .frameId(frame_id)</div>
<div class="line"><span class="lineno">  548</span>        .keypointType(<a class="code hl_enumvalue" href="namespacedyno.html#ad6aa767541eb74e30fc5a7b018322952ac942f1cf01159e70b36aaf8bc517bf9d">KeyPointType::DYNAMIC</a>)</div>
<div class="line"><span class="lineno">  549</span>        .age(kAge)</div>
<div class="line"><span class="lineno">  550</span>        .markInlier()</div>
<div class="line"><span class="lineno">  551</span>        .trackletId(tracklet_to_use)</div>
<div class="line"><span class="lineno">  552</span>        .keypoint(kp_current);</div>
<div class="line"><span class="lineno">  553</span>    <span class="keywordflow">return</span> feature;</div>
<div class="line"><span class="lineno">  554</span>  };</div>
<div class="line"><span class="lineno">  555</span> </div>
<div class="line"><span class="lineno">  556</span>  <span class="keyword">auto</span> constructDynamicFeatureFromPrevious =</div>
<div class="line"><span class="lineno">  557</span>      [&amp;](<span class="keyword">const</span> <a class="code hl_typedef" href="namespacedyno.html#aaa260a8022691078c59e1ac6a4fa05b5">Keypoint</a>&amp; kp_current, Feature::Ptr previous_feature,</div>
<div class="line"><span class="lineno">  558</span>          <span class="keyword">const</span> <a class="code hl_typedef" href="namespacedyno.html#afdd174eb44901fb205371d796287378c">TrackletId</a> tracklet_id, <span class="keyword">const</span> <a class="code hl_typedef" href="namespacedyno.html#a38bb86e4154b86428b8d133be03fb2b5">ObjectId</a> object_id,</div>
<div class="line"><span class="lineno">  559</span>          <span class="keyword">const</span> <a class="code hl_typedef" href="namespacedyno.html#ac4303d6fafb755f794b072d76f9cfb41">FrameId</a> frame_id) -&gt; Feature::Ptr {</div>
<div class="line"><span class="lineno">  560</span>    <span class="keywordflow">if</span> (!<a class="code hl_function" href="classdyno_1_1FeatureTrackerBase.html#a32d80be7e74a096c2b816529b7fd2c69">isWithinShrunkenImage</a>(kp_current)) {</div>
<div class="line"><span class="lineno">  561</span>      <span class="keywordflow">return</span> <span class="keyword">nullptr</span>;</div>
<div class="line"><span class="lineno">  562</span>    }</div>
<div class="line"><span class="lineno">  563</span> </div>
<div class="line"><span class="lineno">  564</span>    CHECK(previous_feature);</div>
<div class="line"><span class="lineno">  565</span>    CHECK_EQ(previous_feature-&gt;trackletId(), tracklet_id);</div>
<div class="line"><span class="lineno">  566</span>    CHECK_EQ(previous_feature-&gt;objectId(), object_id);</div>
<div class="line"><span class="lineno">  567</span> </div>
<div class="line"><span class="lineno">  568</span>    <span class="keywordtype">size_t</span> age = previous_feature-&gt;age();</div>
<div class="line"><span class="lineno">  569</span>    age++;</div>
<div class="line"><span class="lineno">  570</span> </div>
<div class="line"><span class="lineno">  571</span>    <a class="code hl_typedef" href="namespacedyno.html#afdd174eb44901fb205371d796287378c">TrackletId</a> tracklet_to_use = tracklet_id;</div>
<div class="line"><span class="lineno">  572</span>    <span class="comment">// if age is too large, or age is zero, retrieve new tracklet id</span></div>
<div class="line"><span class="lineno">  573</span>    <span class="keywordflow">if</span> (age &gt; <a class="code hl_variable" href="classdyno_1_1FeatureTrackerBase.html#a04f0948954381269fedd5a6856662cb7">params_</a>.<a class="code hl_variable" href="structdyno_1_1TrackerParams.html#a169251cb91b823891ca91504f9486e3f">max_dynamic_feature_age</a>) {</div>
<div class="line"><span class="lineno">  574</span>      <span class="keywordflow">return</span> <span class="keyword">nullptr</span>;</div>
<div class="line"><span class="lineno">  575</span>    }</div>
<div class="line"><span class="lineno">  576</span> </div>
<div class="line"><span class="lineno">  577</span>    <span class="comment">// update previous keypoint</span></div>
<div class="line"><span class="lineno">  578</span>    previous_feature-&gt;measuredFlow(kp_current - previous_feature-&gt;keypoint());</div>
<div class="line"><span class="lineno">  579</span>    <span class="comment">// This is so awful, but happens becuase the way the code was originally</span></div>
<div class="line"><span class="lineno">  580</span>    <span class="comment">// written, we expect flow from k to k+1 (grrrr)</span></div>
<div class="line"><span class="lineno">  581</span>    previous_feature-&gt;predictedKeypoint(kp_current);</div>
<div class="line"><span class="lineno">  582</span> </div>
<div class="line"><span class="lineno">  583</span>    Feature::Ptr feature = std::make_shared&lt;Feature&gt;();</div>
<div class="line"><span class="lineno">  584</span>    (*feature)</div>
<div class="line"><span class="lineno">  585</span>        .objectId(object_id)</div>
<div class="line"><span class="lineno">  586</span>        .frameId(frame_id)</div>
<div class="line"><span class="lineno">  587</span>        .keypointType(<a class="code hl_enumvalue" href="namespacedyno.html#ad6aa767541eb74e30fc5a7b018322952ac942f1cf01159e70b36aaf8bc517bf9d">KeyPointType::DYNAMIC</a>)</div>
<div class="line"><span class="lineno">  588</span>        .age(age)</div>
<div class="line"><span class="lineno">  589</span>        .markInlier()</div>
<div class="line"><span class="lineno">  590</span>        .trackletId(tracklet_to_use)</div>
<div class="line"><span class="lineno">  591</span>        .keypoint(kp_current);</div>
<div class="line"><span class="lineno">  592</span> </div>
<div class="line"><span class="lineno">  593</span>    <span class="keywordflow">return</span> feature;</div>
<div class="line"><span class="lineno">  594</span>  };</div>
<div class="line"><span class="lineno">  595</span> </div>
<div class="line"><span class="lineno">  596</span>  FeatureContainer previous_inliers;</div>
<div class="line"><span class="lineno">  597</span>  <span class="keywordflow">if</span> (<a class="code hl_variable" href="classdyno_1_1FeatureTracker.html#a879d0cd574b194e89bffbe05f85c23fc">previous_frame_</a>) {</div>
<div class="line"><span class="lineno">  598</span>    cv::Mat previous_mono =</div>
<div class="line"><span class="lineno">  599</span>        <a class="code hl_function" href="structdyno_1_1ImageType_1_1RGBMono.html#ac6c656492aaeff4bb8b60f42b0cfa7a3">ImageType::RGBMono::toMono</a>(<a class="code hl_variable" href="classdyno_1_1FeatureTracker.html#a879d0cd574b194e89bffbe05f85c23fc">previous_frame_</a>-&gt;image_container_.rgb());</div>
<div class="line"><span class="lineno">  600</span> </div>
<div class="line"><span class="lineno">  601</span>    FeatureContainer previous_inliers;</div>
<div class="line"><span class="lineno">  602</span>    <span class="keyword">auto</span> iter = <a class="code hl_variable" href="classdyno_1_1FeatureTracker.html#a879d0cd574b194e89bffbe05f85c23fc">previous_frame_</a>-&gt;dynamic_features_.beginUsable();</div>
<div class="line"><span class="lineno">  603</span>    <span class="keywordflow">for</span> (<span class="keyword">const</span> <span class="keyword">auto</span>&amp; inlier_feature : iter) {</div>
<div class="line"><span class="lineno">  604</span>      previous_inliers.add(inlier_feature);</div>
<div class="line"><span class="lineno">  605</span>    }</div>
<div class="line"><span class="lineno">  606</span> </div>
<div class="line"><span class="lineno">  607</span>    <span class="comment">// All tracklet ids from the set of previous features to track</span></div>
<div class="line"><span class="lineno">  608</span>    <a class="code hl_typedef" href="namespacedyno.html#a7b74611da938f0d55a3b1fdb16219037">TrackletIds</a> tracklet_ids;</div>
<div class="line"><span class="lineno">  609</span>    std::vector&lt;cv::Point2f&gt; previous_pts =</div>
<div class="line"><span class="lineno">  610</span>        previous_inliers.toOpenCV(&amp;tracklet_ids);</div>
<div class="line"><span class="lineno">  611</span>    CHECK_EQ(previous_pts.size(), previous_inliers.size());</div>
<div class="line"><span class="lineno">  612</span>    CHECK_EQ(previous_pts.size(), tracklet_ids.size());</div>
<div class="line"><span class="lineno">  613</span> </div>
<div class="line"><span class="lineno">  614</span>    CHECK_EQ(previous_pts.size(), previous_inliers.size());</div>
<div class="line"><span class="lineno">  615</span>    CHECK_EQ(previous_pts.size(), tracklet_ids.size());</div>
<div class="line"><span class="lineno">  616</span> </div>
<div class="line"><span class="lineno">  617</span>    std::vector&lt;cv::Point2f&gt; current_points;</div>
<div class="line"><span class="lineno">  618</span>    current_points.resize(previous_pts.size());</div>
<div class="line"><span class="lineno">  619</span> </div>
<div class="line"><span class="lineno">  620</span>    LOG(INFO) &lt;&lt; <span class="stringliteral">&quot;Found &quot;</span> &lt;&lt; tracklet_ids.size() &lt;&lt; <span class="stringliteral">&quot; dynamic inliers for KLT&quot;</span>;</div>
<div class="line"><span class="lineno">  621</span> </div>
<div class="line"><span class="lineno">  622</span>    <span class="keywordflow">if</span> (tracklet_ids.size() &gt; 0) {</div>
<div class="line"><span class="lineno">  623</span>      utils::TimingStatsCollector tracking_t(</div>
<div class="line"><span class="lineno">  624</span>          <span class="stringliteral">&quot;dynamic_feature_track_klt.tracking&quot;</span>);</div>
<div class="line"><span class="lineno">  625</span> </div>
<div class="line"><span class="lineno">  626</span>      <span class="keyword">static</span> <span class="keyword">const</span> cv::Size klt_window_size(21, 21);  <span class="comment">// Window size for KLT</span></div>
<div class="line"><span class="lineno">  627</span>      <span class="keyword">static</span> <span class="keyword">const</span> <span class="keywordtype">int</span> klt_max_level = 3;  <span class="comment">// Max pyramid levels for KLT</span></div>
<div class="line"><span class="lineno">  628</span>      <span class="keyword">static</span> <span class="keyword">const</span> cv::TermCriteria klt_criteria = cv::TermCriteria(</div>
<div class="line"><span class="lineno">  629</span>          cv::TermCriteria::EPS | cv::TermCriteria::COUNT, 30, 0.03);</div>
<div class="line"><span class="lineno">  630</span> </div>
<div class="line"><span class="lineno">  631</span>      <span class="comment">// used as flags argument for calcOpticalFlowPyrLK - initially starts as</span></div>
<div class="line"><span class="lineno">  632</span>      <span class="comment">// default (0) flag</span></div>
<div class="line"><span class="lineno">  633</span>      <span class="keywordtype">int</span> klt_flags = 0;</div>
<div class="line"><span class="lineno">  634</span>      std::vector&lt;uchar&gt; status;</div>
<div class="line"><span class="lineno">  635</span>      std::vector&lt;float&gt; err;</div>
<div class="line"><span class="lineno">  636</span> </div>
<div class="line"><span class="lineno">  637</span>      {</div>
<div class="line"><span class="lineno">  638</span>        utils::TimingStatsCollector timing(<span class="stringliteral">&quot;dynamic_feature_track_klt.calc_LK&quot;</span>);</div>
<div class="line"><span class="lineno">  639</span>        <span class="comment">// cv::calcOpticalFlowPyrLK(previous_mono, mono, previous_pts,</span></div>
<div class="line"><span class="lineno">  640</span>        <span class="comment">//                          current_points, status, err,</span></div>
<div class="line"><span class="lineno">  641</span>        <span class="comment">//                          klt_window_size, klt_max_level,</span></div>
<div class="line"><span class="lineno">  642</span>        <span class="comment">//                          klt_criteria, klt_flags);</span></div>
<div class="line"><span class="lineno">  643</span>        <span class="comment">// TODO: NO CACHING!</span></div>
<div class="line"><span class="lineno">  644</span>        cv::cuda::GpuMat gpu_prev_img(previous_mono);</div>
<div class="line"><span class="lineno">  645</span>        cv::cuda::GpuMat gpu_current_img(mono);</div>
<div class="line"><span class="lineno">  646</span> </div>
<div class="line"><span class="lineno">  647</span>        cv::cuda::GpuMat d_points1(previous_pts);    <span class="comment">// upload points</span></div>
<div class="line"><span class="lineno">  648</span>        cv::cuda::GpuMat d_points2(current_points);  <span class="comment">// output points</span></div>
<div class="line"><span class="lineno">  649</span>        cv::cuda::GpuMat d_status;                   <span class="comment">// status of each point</span></div>
<div class="line"><span class="lineno">  650</span>        cv::cuda::GpuMat d_err;                      <span class="comment">// error for each point</span></div>
<div class="line"><span class="lineno">  651</span> </div>
<div class="line"><span class="lineno">  652</span>        <a class="code hl_variable" href="classdyno_1_1FeatureTracker.html#a6310d9416f4c7485740ccc80b9a9732a">lk_cuda_tracker_</a>-&gt;calc(gpu_prev_img, gpu_current_img, d_points1,</div>
<div class="line"><span class="lineno">  653</span>                               d_points2, d_status, d_err);</div>
<div class="line"><span class="lineno">  654</span> </div>
<div class="line"><span class="lineno">  655</span>        <span class="comment">// Download results back to CPU</span></div>
<div class="line"><span class="lineno">  656</span>        d_points2.download(current_points);</div>
<div class="line"><span class="lineno">  657</span>        d_status.download(status);</div>
<div class="line"><span class="lineno">  658</span> </div>
<div class="line"><span class="lineno">  659</span>        <span class="comment">// if we used OPTFLOW_USE_INITIAL_FLOW check that we actually got good</span></div>
<div class="line"><span class="lineno">  660</span>        <span class="comment">// flow</span></div>
<div class="line"><span class="lineno">  661</span>        <span class="comment">// if (klt_flags == cv::OPTFLOW_USE_INITIAL_FLOW) {</span></div>
<div class="line"><span class="lineno">  662</span>        <span class="comment">//   static constexpr int kMinSuccessTracks = 10;</span></div>
<div class="line"><span class="lineno">  663</span>        <span class="comment">//   int succ_num = 0;</span></div>
<div class="line"><span class="lineno">  664</span>        <span class="comment">//   for (size_t i = 0; i &lt; status.size(); i++) {</span></div>
<div class="line"><span class="lineno">  665</span>        <span class="comment">//     if (status[i]) succ_num++;</span></div>
<div class="line"><span class="lineno">  666</span>        <span class="comment">//   }</span></div>
<div class="line"><span class="lineno">  667</span>        <span class="comment">//   if (succ_num &lt; kMinSuccessTracks) {</span></div>
<div class="line"><span class="lineno">  668</span>        <span class="comment">//     LOG(WARNING) &lt;&lt; &quot;Using initial flow for KLT tracking failed: only</span></div>
<div class="line"><span class="lineno">  669</span>        <span class="comment">//     &quot;</span></div>
<div class="line"><span class="lineno">  670</span>        <span class="comment">//                  &lt;&lt; succ_num &lt;&lt; &quot; tracked!&quot;;</span></div>
<div class="line"><span class="lineno">  671</span>        <span class="comment">//     cv::calcOpticalFlowPyrLK(</span></div>
<div class="line"><span class="lineno">  672</span>        <span class="comment">//         previous_mono, mono, previous_pts, current_points, status,</span></div>
<div class="line"><span class="lineno">  673</span>        <span class="comment">//         err, klt_window_size, klt_max_level, klt_criteria);</span></div>
<div class="line"><span class="lineno">  674</span>        <span class="comment">//   }</span></div>
<div class="line"><span class="lineno">  675</span>        <span class="comment">// }</span></div>
<div class="line"><span class="lineno">  676</span>      }</div>
<div class="line"><span class="lineno">  677</span> </div>
<div class="line"><span class="lineno">  678</span>      CHECK_EQ(previous_pts.size(), current_points.size());</div>
<div class="line"><span class="lineno">  679</span>      CHECK_EQ(status.size(), current_points.size());</div>
<div class="line"><span class="lineno">  680</span> </div>
<div class="line"><span class="lineno">  681</span>      std::vector&lt;cv::Point2f&gt; good_current, good_previous;</div>
<div class="line"><span class="lineno">  682</span>      <a class="code hl_typedef" href="namespacedyno.html#a7b74611da938f0d55a3b1fdb16219037">TrackletIds</a> good_tracklets;</div>
<div class="line"><span class="lineno">  683</span>      <span class="comment">// can also look at the err?</span></div>
<div class="line"><span class="lineno">  684</span>      <span class="keywordflow">for</span> (<span class="keywordtype">size_t</span> i = 0; i &lt; status.size(); i++) {</div>
<div class="line"><span class="lineno">  685</span>        <span class="keywordflow">if</span> (status[i]) {</div>
<div class="line"><span class="lineno">  686</span>          good_current.push_back(current_points.at(i));</div>
<div class="line"><span class="lineno">  687</span>          good_previous.push_back(previous_pts.at(i));</div>
<div class="line"><span class="lineno">  688</span>          good_tracklets.push_back(tracklet_ids.at(i));</div>
<div class="line"><span class="lineno">  689</span>        }</div>
<div class="line"><span class="lineno">  690</span>      }</div>
<div class="line"><span class="lineno">  691</span> </div>
<div class="line"><span class="lineno">  692</span>      <span class="keywordflow">for</span> (<span class="keywordtype">size_t</span> i = 0; i &lt; good_tracklets.size(); i++) {</div>
<div class="line"><span class="lineno">  693</span>        <a class="code hl_typedef" href="namespacedyno.html#afdd174eb44901fb205371d796287378c">TrackletId</a> tracklet_id = good_tracklets.at(i);</div>
<div class="line"><span class="lineno">  694</span> </div>
<div class="line"><span class="lineno">  695</span>        <span class="keyword">const</span> Feature::Ptr previous_feature =</div>
<div class="line"><span class="lineno">  696</span>            previous_inliers.getByTrackletId(tracklet_id);</div>
<div class="line"><span class="lineno">  697</span>        CHECK(previous_feature-&gt;usable());</div>
<div class="line"><span class="lineno">  698</span> </div>
<div class="line"><span class="lineno">  699</span>        <span class="keyword">const</span> cv::Point2f kp_cv = good_current.at(i);</div>
<div class="line"><span class="lineno">  700</span>        <a class="code hl_typedef" href="namespacedyno.html#aaa260a8022691078c59e1ac6a4fa05b5">Keypoint</a> kp(<span class="keyword">static_cast&lt;</span><span class="keywordtype">double</span><span class="keyword">&gt;</span>(kp_cv.x), <span class="keyword">static_cast&lt;</span><span class="keywordtype">double</span><span class="keyword">&gt;</span>(kp_cv.y));</div>
<div class="line"><span class="lineno">  701</span> </div>
<div class="line"><span class="lineno">  702</span>        <span class="keyword">const</span> <span class="keywordtype">int</span> x = <a class="code hl_function" href="structdyno_1_1functional__keypoint.html#a3896d96a6f95b5311ae768cdd0ad97e8">functional_keypoint::u</a>(kp);</div>
<div class="line"><span class="lineno">  703</span>        <span class="keyword">const</span> <span class="keywordtype">int</span> y = <a class="code hl_function" href="structdyno_1_1functional__keypoint.html#a24933450cad8bc70b7b76b339756cd94">functional_keypoint::v</a>(kp);</div>
<div class="line"><span class="lineno">  704</span> </div>
<div class="line"><span class="lineno">  705</span>        <span class="keyword">const</span> <a class="code hl_typedef" href="namespacedyno.html#a38bb86e4154b86428b8d133be03fb2b5">ObjectId</a> predicted_label = motion_mask.at&lt;<a class="code hl_typedef" href="namespacedyno.html#a38bb86e4154b86428b8d133be03fb2b5">ObjectId</a>&gt;(y, x);</div>
<div class="line"><span class="lineno">  706</span> </div>
<div class="line"><span class="lineno">  707</span>        <span class="keywordflow">if</span> (!detection_mask_impl.empty()) {</div>
<div class="line"><span class="lineno">  708</span>          <span class="keyword">const</span> <span class="keywordtype">unsigned</span> <span class="keywordtype">char</span> valid_detection =</div>
<div class="line"><span class="lineno">  709</span>              detection_mask_impl.at&lt;<span class="keywordtype">unsigned</span> <span class="keywordtype">char</span>&gt;(y, x);</div>
<div class="line"><span class="lineno">  710</span>          <span class="keywordflow">if</span> (valid_detection == 0) {</div>
<div class="line"><span class="lineno">  711</span>            <span class="keywordflow">continue</span>;</div>
<div class="line"><span class="lineno">  712</span>          }</div>
<div class="line"><span class="lineno">  713</span>        }</div>
<div class="line"><span class="lineno">  714</span> </div>
<div class="line"><span class="lineno">  715</span>        <a class="code hl_typedef" href="namespacedyno.html#a38bb86e4154b86428b8d133be03fb2b5">ObjectId</a> previous_label = previous_feature-&gt;objectId();</div>
<div class="line"><span class="lineno">  716</span>        CHECK_NE(previous_label, <a class="code hl_variable" href="namespacedyno.html#ae78915ea0afc5025dafb398829f15ba3">background_label</a>);</div>
<div class="line"><span class="lineno">  717</span>        CHECK_GT(previous_label, 0);</div>
<div class="line"><span class="lineno">  718</span> </div>
<div class="line"><span class="lineno">  719</span>        PerObjectStatus&amp; object_tracking_info =</div>
<div class="line"><span class="lineno">  720</span>            <a class="code hl_variable" href="classdyno_1_1FeatureTracker.html#aaf08b9f655f94c59eadf15564f2e69f3">info_</a>.<a class="code hl_function" href="structdyno_1_1FeatureTrackerInfo.html#a8d5e1a05167ecd041783f39243dd508e">getObjectStatus</a>(predicted_label);</div>
<div class="line"><span class="lineno">  721</span>        object_tracking_info.<a class="code hl_variable" href="structdyno_1_1PerObjectStatus.html#a589a729d85dfe39107222db8f5a9c567">num_previous_track</a>++;</div>
<div class="line"><span class="lineno">  722</span> </div>
<div class="line"><span class="lineno">  723</span>        <span class="comment">// true if predicted label not on the background</span></div>
<div class="line"><span class="lineno">  724</span>        <span class="keyword">const</span> <span class="keywordtype">bool</span> is_predicted_object_label =</div>
<div class="line"><span class="lineno">  725</span>            predicted_label != <a class="code hl_variable" href="namespacedyno.html#ae78915ea0afc5025dafb398829f15ba3">background_label</a>;</div>
<div class="line"><span class="lineno">  726</span>        <span class="comment">// true if predicted label the same as the previous label of the tracked</span></div>
<div class="line"><span class="lineno">  727</span>        <span class="comment">// point</span></div>
<div class="line"><span class="lineno">  728</span>        <span class="keyword">const</span> <span class="keywordtype">bool</span> is_precited_same_as_previous =</div>
<div class="line"><span class="lineno">  729</span>            predicted_label == previous_label;</div>
<div class="line"><span class="lineno">  730</span> </div>
<div class="line"><span class="lineno">  731</span>        <span class="comment">// update stats</span></div>
<div class="line"><span class="lineno">  732</span>        <span class="keywordflow">if</span> (!is_predicted_object_label)</div>
<div class="line"><span class="lineno">  733</span>          object_tracking_info.num_tracked_with_background_label++;</div>
<div class="line"><span class="lineno">  734</span>        <span class="keywordflow">if</span> (!is_precited_same_as_previous)</div>
<div class="line"><span class="lineno">  735</span>          object_tracking_info.num_tracked_with_different_label++;</div>
<div class="line"><span class="lineno">  736</span> </div>
<div class="line"><span class="lineno">  737</span>        <span class="keywordflow">if</span> (<a class="code hl_variable" href="classdyno_1_1FeatureTrackerBase.html#abf6eba19baf18b1c3648347401c15a56">camera_</a>-&gt;isKeypointContained(kp) &amp;&amp; is_predicted_object_label &amp;&amp;</div>
<div class="line"><span class="lineno">  738</span>            is_precited_same_as_previous) {</div>
<div class="line"><span class="lineno">  739</span>          <span class="keywordflow">if</span> (!<a class="code hl_function" href="classdyno_1_1FeatureTrackerBase.html#a32d80be7e74a096c2b816529b7fd2c69">isWithinShrunkenImage</a>(kp)) {</div>
<div class="line"><span class="lineno">  740</span>            object_tracking_info.num_outside_shrunken_image++;</div>
<div class="line"><span class="lineno">  741</span>            <span class="keywordflow">continue</span>;</div>
<div class="line"><span class="lineno">  742</span>          }</div>
<div class="line"><span class="lineno">  743</span> </div>
<div class="line"><span class="lineno">  744</span>          Feature::Ptr feature = constructDynamicFeatureFromPrevious(</div>
<div class="line"><span class="lineno">  745</span>              kp, previous_feature, tracklet_id, predicted_label, frame_id);</div>
<div class="line"><span class="lineno">  746</span> </div>
<div class="line"><span class="lineno">  747</span>          <span class="keywordflow">if</span> (feature) {</div>
<div class="line"><span class="lineno">  748</span>            <span class="keywordflow">if</span> (!tracks_per_object.exists(feature-&gt;objectId())) {</div>
<div class="line"><span class="lineno">  749</span>              tracks_per_object.insert2(feature-&gt;objectId(),</div>
<div class="line"><span class="lineno">  750</span>                                        FeatureContainer{});</div>
<div class="line"><span class="lineno">  751</span>            }</div>
<div class="line"><span class="lineno">  752</span>            tracks_per_object.at(feature-&gt;objectId()).add(feature);</div>
<div class="line"><span class="lineno">  753</span>            object_tracking_info.num_track++;</div>
<div class="line"><span class="lineno">  754</span> </div>
<div class="line"><span class="lineno">  755</span>            <span class="comment">// add zero fill to detection mask to indicate the existance of a</span></div>
<div class="line"><span class="lineno">  756</span>            <span class="comment">// tracked point at this feature location</span></div>
<div class="line"><span class="lineno">  757</span>            cv::circle(</div>
<div class="line"><span class="lineno">  758</span>                detection_mask_impl, cv::Point2f(x, y),</div>
<div class="line"><span class="lineno">  759</span>                <a class="code hl_variable" href="classdyno_1_1FeatureTrackerBase.html#a04f0948954381269fedd5a6856662cb7">params_</a>.<a class="code hl_variable" href="structdyno_1_1TrackerParams.html#af7f44eed9da99d0abf332eb9e40d072b">min_distance_btw_tracked_and_detected_dynamic_features</a>,</div>
<div class="line"><span class="lineno">  760</span>                cv::Scalar(0), cv::FILLED);</div>
<div class="line"><span class="lineno">  761</span> </div>
<div class="line"><span class="lineno">  762</span>            <span class="comment">// fill tracking mask with tracked points, labelled with the object</span></div>
<div class="line"><span class="lineno">  763</span>            <span class="comment">// label (j) to indicate places on object with keypoints</span></div>
<div class="line"><span class="lineno">  764</span>            cv::circle(</div>
<div class="line"><span class="lineno">  765</span>                dynamic_tracking_mask, cv::Point2f(x, y),</div>
<div class="line"><span class="lineno">  766</span>                <a class="code hl_variable" href="classdyno_1_1FeatureTrackerBase.html#a04f0948954381269fedd5a6856662cb7">params_</a>.<a class="code hl_variable" href="structdyno_1_1TrackerParams.html#af7f44eed9da99d0abf332eb9e40d072b">min_distance_btw_tracked_and_detected_dynamic_features</a>,</div>
<div class="line"><span class="lineno">  767</span>                cv::Scalar(predicted_label), cv::FILLED);</div>
<div class="line"><span class="lineno">  768</span>          }</div>
<div class="line"><span class="lineno">  769</span>        }</div>
<div class="line"><span class="lineno">  770</span>      }</div>
<div class="line"><span class="lineno">  771</span>    }</div>
<div class="line"><span class="lineno">  772</span> </div>
<div class="line"><span class="lineno">  773</span>    <span class="keywordflow">for</span> (<span class="keyword">const</span> <span class="keyword">auto</span>&amp; [object_id, features_j] : tracks_per_object) {</div>
<div class="line"><span class="lineno">  774</span>      LOG(INFO) &lt;&lt; <span class="stringliteral">&quot;Tracked &quot;</span> &lt;&lt; features_j.size() &lt;&lt; <span class="stringliteral">&quot; j= &quot;</span> &lt;&lt; object_id</div>
<div class="line"><span class="lineno">  775</span>                &lt;&lt; <span class="stringliteral">&quot; with KLT&quot;</span>;</div>
<div class="line"><span class="lineno">  776</span>      dynamic_features += features_j;</div>
<div class="line"><span class="lineno">  777</span>    }</div>
<div class="line"><span class="lineno">  778</span>  }</div>
<div class="line"><span class="lineno">  779</span> </div>
<div class="line"><span class="lineno">  780</span>  {</div>
<div class="line"><span class="lineno">  781</span>    utils::TimingStatsCollector ts_t(</div>
<div class="line"><span class="lineno">  782</span>        <span class="stringliteral">&quot;dynamic_feature_track_klt.requires_sampling&quot;</span>);</div>
<div class="line"><span class="lineno">  783</span>    <a class="code hl_function" href="classdyno_1_1FeatureTracker.html#ab50422938e62bccc34295c155357213a">requiresSampling</a>(object_keyframes, <a class="code hl_variable" href="classdyno_1_1FeatureTracker.html#aaf08b9f655f94c59eadf15564f2e69f3">info_</a>, image_container,</div>
<div class="line"><span class="lineno">  784</span>                     tracks_per_object, boundary_mask_result,</div>
<div class="line"><span class="lineno">  785</span>                     dynamic_tracking_mask);</div>
<div class="line"><span class="lineno">  786</span>  }</div>
<div class="line"><span class="lineno">  787</span> </div>
<div class="line"><span class="lineno">  788</span>  <span class="keywordtype">double</span> qualityLevel = 0.01;</div>
<div class="line"><span class="lineno">  789</span> </div>
<div class="line"><span class="lineno">  790</span>  <span class="keyword">static</span> <span class="keyword">constexpr</span> <span class="keywordtype">float</span> tolerance = 0.01;</div>
<div class="line"><span class="lineno">  791</span>  Eigen::MatrixXd binning_mask;</div>
<div class="line"><span class="lineno">  792</span> </div>
<div class="line"><span class="lineno">  793</span>  <span class="keyword">const</span> <span class="keywordtype">int</span>&amp; max_features_to_track = <a class="code hl_variable" href="classdyno_1_1FeatureTrackerBase.html#a04f0948954381269fedd5a6856662cb7">params_</a>.<a class="code hl_variable" href="structdyno_1_1TrackerParams.html#a251d59812229f53def1c285d69d56b7e">max_dynamic_features_per_frame</a>;</div>
<div class="line"><span class="lineno">  794</span>  <span class="keyword">const</span> <span class="keywordtype">int</span>&amp; min_feature_distance =</div>
<div class="line"><span class="lineno">  795</span>      <a class="code hl_variable" href="classdyno_1_1FeatureTrackerBase.html#a04f0948954381269fedd5a6856662cb7">params_</a>.<a class="code hl_variable" href="structdyno_1_1TrackerParams.html#af7f44eed9da99d0abf332eb9e40d072b">min_distance_btw_tracked_and_detected_dynamic_features</a>;</div>
<div class="line"><span class="lineno">  796</span> </div>
<div class="line"><span class="lineno">  797</span>  std::mutex mutex;</div>
<div class="line"><span class="lineno">  798</span>  <span class="keyword">auto</span>&amp; tracking_info = <a class="code hl_variable" href="classdyno_1_1FeatureTracker.html#aaf08b9f655f94c59eadf15564f2e69f3">info_</a>;</div>
<div class="line"><span class="lineno">  799</span>  <span class="comment">// thread safe function to calculate number of corners needed for each object</span></div>
<div class="line"><span class="lineno">  800</span>  <span class="keyword">auto</span> getNumberCornersNeeded =</div>
<div class="line"><span class="lineno">  801</span>      [&amp;tracking_info, &amp;mutex,</div>
<div class="line"><span class="lineno">  802</span>       &amp;max_features_to_track](<a class="code hl_typedef" href="namespacedyno.html#a38bb86e4154b86428b8d133be03fb2b5">ObjectId</a> object_id) -&gt; <span class="keywordtype">int</span> {</div>
<div class="line"><span class="lineno">  803</span>    std::unique_lock&lt;std::mutex&gt; lock(mutex);</div>
<div class="line"><span class="lineno">  804</span>    <span class="keyword">const</span> PerObjectStatus&amp; object_tracking_info =</div>
<div class="line"><span class="lineno">  805</span>        tracking_info.getObjectStatus(object_id);</div>
<div class="line"><span class="lineno">  806</span>    <span class="keyword">const</span> <span class="keywordtype">int</span>&amp; number_tracked = object_tracking_info.num_track;</div>
<div class="line"><span class="lineno">  807</span>    <span class="keywordtype">int</span> nr_corners_needed = std::max(max_features_to_track - number_tracked, 0);</div>
<div class="line"><span class="lineno">  808</span>    <span class="keywordflow">return</span> nr_corners_needed;</div>
<div class="line"><span class="lineno">  809</span>  };</div>
<div class="line"><span class="lineno">  810</span> </div>
<div class="line"><span class="lineno">  811</span>  tbb::concurrent_unordered_map&lt;ObjectId, std::vector&lt;KeypointCV&gt;&gt;</div>
<div class="line"><span class="lineno">  812</span>      keypoints_per_object;</div>
<div class="line"><span class="lineno">  813</span> </div>
<div class="line"><span class="lineno">  814</span>  utils::TimingStatsCollector detection_t(</div>
<div class="line"><span class="lineno">  815</span>      <span class="stringliteral">&quot;dynamic_feature_track_klt.detection&quot;</span>);</div>
<div class="line"><span class="lineno">  816</span>  tbb::parallel_for_each(</div>
<div class="line"><span class="lineno">  817</span>      object_keyframes.begin(), object_keyframes.end(), [&amp;](<span class="keyword">auto</span>&amp; object_id) {</div>
<div class="line"><span class="lineno">  818</span>        cv::Mat obj_mask = (motion_mask == object_id);</div>
<div class="line"><span class="lineno">  819</span>        <span class="comment">// ignore additonal features from the tracking mask</span></div>
<div class="line"><span class="lineno">  820</span>        cv::Mat combined_mask;</div>
<div class="line"><span class="lineno">  821</span>        cv::bitwise_and(obj_mask, detection_mask_impl, combined_mask);</div>
<div class="line"><span class="lineno">  822</span> </div>
<div class="line"><span class="lineno">  823</span>        std::vector&lt;cv::Point2f&gt; detected_points;</div>
<div class="line"><span class="lineno">  824</span>        cv::goodFeaturesToTrack(mono, detected_points, 300, qualityLevel,</div>
<div class="line"><span class="lineno">  825</span>                                min_feature_distance, combined_mask);</div>
<div class="line"><span class="lineno">  826</span> </div>
<div class="line"><span class="lineno">  827</span>        std::vector&lt;KeypointCV&gt; keypoints;</div>
<div class="line"><span class="lineno">  828</span>        cv::KeyPoint::convert(detected_points, keypoints);</div>
<div class="line"><span class="lineno">  829</span> </div>
<div class="line"><span class="lineno">  830</span>        std::vector&lt;KeypointCV&gt;&amp; max_keypoints = keypoints;</div>
<div class="line"><span class="lineno">  831</span>        const size_t detected_size = max_keypoints.size();</div>
<div class="line"><span class="lineno">  832</span> </div>
<div class="line"><span class="lineno">  833</span>        const int nr_corners_needed = getNumberCornersNeeded(object_id);</div>
<div class="line"><span class="lineno">  834</span> </div>
<div class="line"><span class="lineno">  835</span>        AdaptiveNonMaximumSuppression non_maximum_supression(</div>
<div class="line"><span class="lineno">  836</span>            AnmsAlgorithmType::RangeTree);</div>
<div class="line"><span class="lineno">  837</span>        max_keypoints = non_maximum_supression.suppressNonMax(</div>
<div class="line"><span class="lineno">  838</span>            keypoints, nr_corners_needed, tolerance, img_size_.width,</div>
<div class="line"><span class="lineno">  839</span>            img_size_.height, 5, 5, binning_mask);</div>
<div class="line"><span class="lineno">  840</span> </div>
<div class="line"><span class="lineno">  841</span>        VLOG(10) &lt;&lt; <span class="stringliteral">&quot;Kps: &quot;</span> &lt;&lt; max_keypoints.size() &lt;&lt; <span class="stringliteral">&quot; for j=&quot;</span> &lt;&lt; object_id</div>
<div class="line"><span class="lineno">  842</span>                 &lt;&lt; <span class="stringliteral">&quot; after ANMS (originally &quot;</span> &lt;&lt; detected_size &lt;&lt; <span class="stringliteral">&quot;)&quot;</span>;</div>
<div class="line"><span class="lineno">  843</span> </div>
<div class="line"><span class="lineno">  844</span>        keypoints_per_object.insert({object_id, max_keypoints});</div>
<div class="line"><span class="lineno">  845</span>        <span class="comment">// info_.getObjectStatus(object_id).num_sampled = max_keypoints.size();</span></div>
<div class="line"><span class="lineno">  846</span>      });</div>
<div class="line"><span class="lineno">  847</span> </div>
<div class="line"><span class="lineno">  848</span>  <span class="keywordflow">for</span> (<span class="keyword">const</span> <span class="keyword">auto</span>&amp; [object_id, keypoints] : keypoints_per_object) {</div>
<div class="line"><span class="lineno">  849</span>    <a class="code hl_variable" href="classdyno_1_1FeatureTracker.html#aaf08b9f655f94c59eadf15564f2e69f3">info_</a>.<a class="code hl_function" href="structdyno_1_1FeatureTrackerInfo.html#a8d5e1a05167ecd041783f39243dd508e">getObjectStatus</a>(object_id).<a class="code hl_variable" href="structdyno_1_1PerObjectStatus.html#a3d7fa1487d536d3845f96da8ff173fb8">num_sampled</a> = keypoints.size();</div>
<div class="line"><span class="lineno">  850</span> </div>
<div class="line"><span class="lineno">  851</span>    <span class="keywordflow">for</span> (<span class="keyword">const</span> <a class="code hl_typedef" href="namespacedyno.html#ae0b7b312ca1880ca7030acdbe981966a">KeypointCV</a>&amp; cv_keypoint : keypoints) {</div>
<div class="line"><span class="lineno">  852</span>      <a class="code hl_typedef" href="namespacedyno.html#aaa260a8022691078c59e1ac6a4fa05b5">Keypoint</a> keypoint = <a class="code hl_function" href="namespacedyno_1_1utils.html#a5097b96d97a17d79f22caa4b11a4ba64">utils::cvKeypointToGtsam</a>(cv_keypoint);</div>
<div class="line"><span class="lineno">  853</span> </div>
<div class="line"><span class="lineno">  854</span>      <span class="keyword">const</span> <span class="keywordtype">int</span> x = <a class="code hl_function" href="structdyno_1_1functional__keypoint.html#a3896d96a6f95b5311ae768cdd0ad97e8">functional_keypoint::u</a>(keypoint);</div>
<div class="line"><span class="lineno">  855</span>      <span class="keyword">const</span> <span class="keywordtype">int</span> y = <a class="code hl_function" href="structdyno_1_1functional__keypoint.html#a24933450cad8bc70b7b76b339756cd94">functional_keypoint::v</a>(keypoint);</div>
<div class="line"><span class="lineno">  856</span> </div>
<div class="line"><span class="lineno">  857</span>      <span class="keyword">const</span> <a class="code hl_typedef" href="namespacedyno.html#a38bb86e4154b86428b8d133be03fb2b5">ObjectId</a> predicted_label = motion_mask.at&lt;<a class="code hl_typedef" href="namespacedyno.html#a38bb86e4154b86428b8d133be03fb2b5">ObjectId</a>&gt;(y, x);</div>
<div class="line"><span class="lineno">  858</span>      CHECK_EQ(predicted_label, object_id);</div>
<div class="line"><span class="lineno">  859</span> </div>
<div class="line"><span class="lineno">  860</span>      <span class="keyword">auto</span> feature = constructNewDynamicFeature(keypoint, object_id, frame_id);</div>
<div class="line"><span class="lineno">  861</span> </div>
<div class="line"><span class="lineno">  862</span>      <span class="keywordflow">if</span> (feature) {</div>
<div class="line"><span class="lineno">  863</span>        dynamic_features.add(feature);</div>
<div class="line"><span class="lineno">  864</span>      }</div>
<div class="line"><span class="lineno">  865</span>    }</div>
<div class="line"><span class="lineno">  866</span>  }</div>
<div class="line"><span class="lineno">  867</span>}</div>
<div class="ttc" id="anamespacedyno_html_ac4303d6fafb755f794b072d76f9cfb41"><div class="ttname"><a href="namespacedyno.html#ac4303d6fafb755f794b072d76f9cfb41">dyno::FrameId</a></div><div class="ttdeci">size_t FrameId</div><div class="ttdoc">Discrete time-step k.</div><div class="ttdef"><b>Definition:</b> <a href="Types_8hpp_source.html#l00074">Types.hpp:74</a></div></div>
</div><!-- fragment -->
<p class="reference">References <a class="el" href="classdyno_1_1FeatureContainer.html#a3af7c9e40df21b96a8c7067348aed5f5">dyno::FeatureContainer::add()</a>, <a class="el" href="namespacedyno.html#ae78915ea0afc5025dafb398829f15ba3">dyno::background_label</a>, <a class="el" href="structdyno_1_1vision__tools_1_1ObjectBoundaryMaskResult.html#ad9dd5629b10f507672aa4b623ca6f503">dyno::vision_tools::ObjectBoundaryMaskResult::boundary_mask</a>, <a class="el" href="classdyno_1_1FeatureTrackerBase.html#abf6eba19baf18b1c3648347401c15a56">dyno::FeatureTrackerBase::camera_</a>, <a class="el" href="namespacedyno.html#ad6aa767541eb74e30fc5a7b018322952ac942f1cf01159e70b36aaf8bc517bf9d">dyno::DYNAMIC</a>, <a class="el" href="classdyno_1_1TrackletIdManager.html#acf6eded9b5e98917d2510d96074ef138">dyno::TrackletIdManager::getAndIncrementTrackletId()</a>, <a class="el" href="classdyno_1_1FeatureContainer.html#a5b73e75d2f4063ac9c16dd0fd565f8da">dyno::FeatureContainer::getByTrackletId()</a>, <a class="el" href="structdyno_1_1FeatureTrackerInfo.html#a8d5e1a05167ecd041783f39243dd508e">dyno::FeatureTrackerInfo::getObjectStatus()</a>, <a class="el" href="classdyno_1_1FeatureTracker.html#aaf08b9f655f94c59eadf15564f2e69f3">info_</a>, <a class="el" href="classdyno_1_1TrackletIdManager.html#a53cb3472fa0367b8dd2a9127111277b2">dyno::TrackletIdManager::instance()</a>, <a class="el" href="classdyno_1_1FeatureTrackerBase.html#a32d80be7e74a096c2b816529b7fd2c69">dyno::FeatureTrackerBase::isWithinShrunkenImage()</a>, <a class="el" href="classdyno_1_1FeatureTracker.html#a6310d9416f4c7485740ccc80b9a9732a">lk_cuda_tracker_</a>, <a class="el" href="structdyno_1_1TrackerParams.html#a169251cb91b823891ca91504f9486e3f">dyno::TrackerParams::max_dynamic_feature_age</a>, <a class="el" href="structdyno_1_1TrackerParams.html#a251d59812229f53def1c285d69d56b7e">dyno::TrackerParams::max_dynamic_features_per_frame</a>, <a class="el" href="structdyno_1_1TrackerParams.html#af7f44eed9da99d0abf332eb9e40d072b">dyno::TrackerParams::min_distance_btw_tracked_and_detected_dynamic_features</a>, <a class="el" href="structdyno_1_1PerObjectStatus.html#a2716fdf6b7d90988e5eb30bd3eccbd83">dyno::PerObjectStatus::num_outside_shrunken_image</a>, <a class="el" href="structdyno_1_1PerObjectStatus.html#a589a729d85dfe39107222db8f5a9c567">dyno::PerObjectStatus::num_previous_track</a>, <a class="el" href="structdyno_1_1PerObjectStatus.html#a92177bf8894a5aec02dca34b853b4e06">dyno::PerObjectStatus::num_track</a>, <a class="el" href="structdyno_1_1PerObjectStatus.html#ad974a284ec89a832a0654102af603ca2">dyno::PerObjectStatus::num_tracked_with_background_label</a>, <a class="el" href="structdyno_1_1PerObjectStatus.html#a9054a60829be5c685646260a1f893162">dyno::PerObjectStatus::num_tracked_with_different_label</a>, <a class="el" href="classdyno_1_1ImageContainer.html#ae5eead678f02be0ab9de7464e1833c55">dyno::ImageContainer::objectMotionMask()</a>, <a class="el" href="classdyno_1_1FeatureTrackerBase.html#a04f0948954381269fedd5a6856662cb7">dyno::FeatureTrackerBase::params_</a>, <a class="el" href="classdyno_1_1FeatureTracker.html#a879d0cd574b194e89bffbe05f85c23fc">previous_frame_</a>, <a class="el" href="classdyno_1_1FeatureTracker.html#ab50422938e62bccc34295c155357213a">requiresSampling()</a>, <a class="el" href="classdyno_1_1ImageContainer.html#a6f35259f95c31b861ff6515c159e1ee3">dyno::ImageContainer::rgb()</a>, <a class="el" href="classdyno_1_1FeatureContainer.html#afd095f6a9e0f25539e7febe6eeeaf003">dyno::FeatureContainer::size()</a>, <a class="el" href="structdyno_1_1ImageType_1_1RGBMono.html#ac6c656492aaeff4bb8b60f42b0cfa7a3">dyno::ImageType::RGBMono::toMono()</a>, <a class="el" href="classdyno_1_1FeatureContainer.html#a00fb07fccff523cba9783e6d00186f28">dyno::FeatureContainer::toOpenCV()</a>, <a class="el" href="structdyno_1_1functional__keypoint.html#a3896d96a6f95b5311ae768cdd0ad97e8">dyno::functional_keypoint::u()</a>, and <a class="el" href="structdyno_1_1functional__keypoint.html#a24933450cad8bc70b7b76b339756cd94">dyno::functional_keypoint::v()</a>.</p>

<p class="reference">Referenced by <a class="el" href="classdyno_1_1FeatureTracker.html#a40ee79c94fe2de7f16d2a4508cc2ba11">track()</a>.</p>
<div class="dynheader">
Here is the call graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="classdyno_1_1FeatureTracker_a4796a29c1f89cde0ace1668fc8fcd9a3_cgraph.png" border="0" usemap="#aclassdyno_1_1FeatureTracker_a4796a29c1f89cde0ace1668fc8fcd9a3_cgraph" alt=""/></div>
<map name="aclassdyno_1_1FeatureTracker_a4796a29c1f89cde0ace1668fc8fcd9a3_cgraph" id="aclassdyno_1_1FeatureTracker_a4796a29c1f89cde0ace1668fc8fcd9a3_cgraph">
<area shape="rect" title=" " alt="" coords="5,415,163,455"/>
<area shape="rect" href="classdyno_1_1FeatureContainer.html#a3af7c9e40df21b96a8c7067348aed5f5" title="Adds a new feature to the container. Uses feature.trackletId() to set the tracklet key." alt="" coords="211,29,417,55"/>
<area shape="rect" href="classdyno_1_1TrackletIdManager.html#acf6eded9b5e98917d2510d96074ef138" title=" " alt="" coords="211,79,417,119"/>
<area shape="rect" href="classdyno_1_1FeatureContainer.html#a5b73e75d2f4063ac9c16dd0fd565f8da" title="Gets a feature given its tracklet id. If the feature does not exist, nullptr is returned." alt="" coords="227,143,401,183"/>
<area shape="rect" href="structdyno_1_1FeatureTrackerInfo.html#a8d5e1a05167ecd041783f39243dd508e" title=" " alt="" coords="223,207,405,247"/>
<area shape="rect" href="classdyno_1_1TrackletIdManager.html#a53cb3472fa0367b8dd2a9127111277b2" title=" " alt="" coords="223,271,405,311"/>
<area shape="rect" href="classdyno_1_1FeatureTrackerBase.html#a32d80be7e74a096c2b816529b7fd2c69" title="Checks if a keypoint is within an image, taking into account the shrink row/col values in the params...." alt="" coords="219,386,409,426"/>
<area shape="rect" href="structdyno_1_1functional__keypoint.html#a3896d96a6f95b5311ae768cdd0ad97e8" title=" " alt="" coords="465,343,672,368"/>
<area shape="rect" href="structdyno_1_1functional__keypoint.html#a24933450cad8bc70b7b76b339756cd94" title=" " alt="" coords="465,400,672,425"/>
<area shape="rect" href="classdyno_1_1ImageContainer.html#ae5eead678f02be0ab9de7464e1833c55" title=" " alt="" coords="231,501,397,541"/>
<area shape="rect" href="classdyno_1_1FeatureTracker.html#ab50422938e62bccc34295c155357213a" title="Check which objects require new features to be detected on them based on a set of &#39;keyframing&#39; criter..." alt="" coords="235,565,393,605"/>
<area shape="rect" href="classdyno_1_1FeatureContainer.html#afd095f6a9e0f25539e7febe6eeeaf003" title="Returns the number of features in the container." alt="" coords="481,622,656,662"/>
<area shape="rect" href="classdyno_1_1FeatureContainer.html#a00fb07fccff523cba9783e6d00186f28" title="Converts the keypoints of all features in the container to cv::Point2f representation...." alt="" coords="481,686,656,726"/>
<area shape="rect" href="classdyno_1_1ImageContainer.html#a6f35259f95c31b861ff6515c159e1ee3" title=" " alt="" coords="217,731,411,756"/>
<area shape="rect" href="structdyno_1_1ImageType_1_1RGBMono.html#ac6c656492aaeff4bb8b60f42b0cfa7a3" title=" " alt="" coords="211,781,417,821"/>
<area shape="rect" href="classdyno_1_1FeatureContainer.html#abf2f2d568f5dc17944cc122c537a65f5" title="Returns true if a feature with the given tracklet id exists." alt="" coords="481,143,656,183"/>
<area shape="rect" href="classdyno_1_1TrackletIdManager.html#a2a115366087e907d04e6c0d62643ef20" title=" " alt="" coords="477,271,660,311"/>
<area shape="rect" href="namespacedyno.html#a17d3c448677824ae83870358b2a3e01d" title=" " alt="" coords="497,458,640,498"/>
<area shape="rect" href="namespacedyno.html#ab5ae05966c6056b343a960a80c5b1db3" title=" " alt="" coords="471,523,666,548"/>
<area shape="rect" href="namespacedyno.html#a7d1c7a6dc85df63392893631e436d45e" title=" " alt="" coords="503,572,634,597"/>
<area shape="rect" href="namespacedyno.html#adf545b8b790321f0f83e16e7b4927192" title="Float point comparison up to a tolerance." alt="" coords="720,523,831,548"/>
<area shape="rect" href="namespacedyno.html#a80329a3506c3ccb953481bb403dd320f" title=" " alt="" coords="481,788,657,813"/>
</map>
</div>
<div class="dynheader">
Here is the caller graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="classdyno_1_1FeatureTracker_a4796a29c1f89cde0ace1668fc8fcd9a3_icgraph.png" border="0" usemap="#aclassdyno_1_1FeatureTracker_a4796a29c1f89cde0ace1668fc8fcd9a3_icgraph" alt=""/></div>
<map name="aclassdyno_1_1FeatureTracker_a4796a29c1f89cde0ace1668fc8fcd9a3_icgraph" id="aclassdyno_1_1FeatureTracker_a4796a29c1f89cde0ace1668fc8fcd9a3_icgraph">
<area shape="rect" title=" " alt="" coords="211,5,368,45"/>
<area shape="rect" href="classdyno_1_1FeatureTracker.html#a40ee79c94fe2de7f16d2a4508cc2ba11" title=" " alt="" coords="5,5,163,45"/>
</map>
</div>

</div>
</div>
<h2 class="groupheader">Member Data Documentation</h2>
<a id="a3cace3a01a3ef42dcfcff3799a789c54" name="a3cace3a01a3ef42dcfcff3799a789c54"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a3cace3a01a3ef42dcfcff3799a789c54">&#9670;&#160;</a></span>boarder_detection_mask_</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">cv::Mat dyno::FeatureTracker::boarder_detection_mask_</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">private</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">
<p>Dynamic mask detection boarder which indicates valid (255) and invalid (0) pixles around the boarder of each dynamic object. Mask of type CV_8UC1 </p>

<p class="definition">Definition at line <a class="el" href="FeatureTracker_8hpp_source.html#l00168">168</a> of file <a class="el" href="FeatureTracker_8hpp_source.html">FeatureTracker.hpp</a>.</p>

<p class="reference">Referenced by <a class="el" href="classdyno_1_1FeatureTracker.html#aa27ff1b23b609807f027b1d19edfe66f">getBoarderDetectionMask()</a>, and <a class="el" href="classdyno_1_1FeatureTracker.html#a40ee79c94fe2de7f16d2a4508cc2ba11">track()</a>.</p>

</div>
</div>
<a id="ade60e243c668c32f13e16fb22f45458a" name="ade60e243c668c32f13e16fb22f45458a"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ade60e243c668c32f13e16fb22f45458a">&#9670;&#160;</a></span>frontend_params_</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">const <a class="el" href="structdyno_1_1FrontendParams.html">FrontendParams</a> dyno::FeatureTracker::frontend_params_</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">private</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="FeatureTracker_8hpp_source.html#l00157">157</a> of file <a class="el" href="FeatureTracker_8hpp_source.html">FeatureTracker.hpp</a>.</p>

<p class="reference">Referenced by <a class="el" href="classdyno_1_1FeatureTracker.html#a40ee79c94fe2de7f16d2a4508cc2ba11">track()</a>.</p>

</div>
</div>
<a id="aaf08b9f655f94c59eadf15564f2e69f3" name="aaf08b9f655f94c59eadf15564f2e69f3"></a>
<h2 class="memtitle"><span class="permalink"><a href="#aaf08b9f655f94c59eadf15564f2e69f3">&#9670;&#160;</a></span>info_</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="structdyno_1_1FeatureTrackerInfo.html">FeatureTrackerInfo</a> dyno::FeatureTracker::info_</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">private</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="FeatureTracker_8hpp_source.html#l00170">170</a> of file <a class="el" href="FeatureTracker_8hpp_source.html">FeatureTracker.hpp</a>.</p>

<p class="reference">Referenced by <a class="el" href="classdyno_1_1FeatureTracker.html#aa7019643454cc8a78295fea4dd65002b">getTrackerInfo()</a>, <a class="el" href="classdyno_1_1FeatureTracker.html#a40ee79c94fe2de7f16d2a4508cc2ba11">track()</a>, <a class="el" href="classdyno_1_1FeatureTracker.html#a145614fe29bef7728075492870ac9c41">trackDynamic()</a>, and <a class="el" href="classdyno_1_1FeatureTracker.html#a4796a29c1f89cde0ace1668fc8fcd9a3">trackDynamicKLT()</a>.</p>

</div>
</div>
<a id="a0484d7f8c41021d4e8435caa579af71e" name="a0484d7f8c41021d4e8435caa579af71e"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a0484d7f8c41021d4e8435caa579af71e">&#9670;&#160;</a></span>initial_computation_</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">bool dyno::FeatureTracker::initial_computation_ {true}</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">private</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="FeatureTracker_8hpp_source.html#l00173">173</a> of file <a class="el" href="FeatureTracker_8hpp_source.html">FeatureTracker.hpp</a>.</p>

<p class="reference">Referenced by <a class="el" href="classdyno_1_1FeatureTracker.html#a40ee79c94fe2de7f16d2a4508cc2ba11">track()</a>.</p>

</div>
</div>
<a id="a6310d9416f4c7485740ccc80b9a9732a" name="a6310d9416f4c7485740ccc80b9a9732a"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a6310d9416f4c7485740ccc80b9a9732a">&#9670;&#160;</a></span>lk_cuda_tracker_</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">cv::Ptr&lt;cv::cuda::SparsePyrLKOpticalFlow&gt; dyno::FeatureTracker::lk_cuda_tracker_</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">private</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="FeatureTracker_8hpp_source.html#l00176">176</a> of file <a class="el" href="FeatureTracker_8hpp_source.html">FeatureTracker.hpp</a>.</p>

<p class="reference">Referenced by <a class="el" href="classdyno_1_1FeatureTracker.html#aa1858ceb580cb42aff98e3b57bfe9303">FeatureTracker()</a>, and <a class="el" href="classdyno_1_1FeatureTracker.html#a4796a29c1f89cde0ace1668fc8fcd9a3">trackDynamicKLT()</a>.</p>

</div>
</div>
<a id="a36557c1362b705513be73dd2b5fd1ded" name="a36557c1362b705513be73dd2b5fd1ded"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a36557c1362b705513be73dd2b5fd1ded">&#9670;&#160;</a></span>object_detection_</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">ObjectDetectionEngine::Ptr dyno::FeatureTracker::object_detection_</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">private</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="FeatureTracker_8hpp_source.html#l00177">177</a> of file <a class="el" href="FeatureTracker_8hpp_source.html">FeatureTracker.hpp</a>.</p>

<p class="reference">Referenced by <a class="el" href="classdyno_1_1FeatureTracker.html#aa1858ceb580cb42aff98e3b57bfe9303">FeatureTracker()</a>.</p>

</div>
</div>
<a id="a879d0cd574b194e89bffbe05f85c23fc" name="a879d0cd574b194e89bffbe05f85c23fc"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a879d0cd574b194e89bffbe05f85c23fc">&#9670;&#160;</a></span>previous_frame_</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">Frame::Ptr dyno::FeatureTracker::previous_frame_</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">private</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">
<b>Initial value:</b><div class="fragment"><div class="line">{</div>
<div class="line">      <span class="keyword">nullptr</span>}</div>
</div><!-- fragment -->
<p class="definition">Definition at line <a class="el" href="FeatureTracker_8hpp_source.html#l00158">158</a> of file <a class="el" href="FeatureTracker_8hpp_source.html">FeatureTracker.hpp</a>.</p>

<p class="reference">Referenced by <a class="el" href="classdyno_1_1FeatureTracker.html#a229eaa06426b3f43ee471b01ba9eb900">getCurrentFrame()</a>, <a class="el" href="classdyno_1_1FeatureTracker.html#a40ee79c94fe2de7f16d2a4508cc2ba11">track()</a>, <a class="el" href="classdyno_1_1FeatureTracker.html#a145614fe29bef7728075492870ac9c41">trackDynamic()</a>, and <a class="el" href="classdyno_1_1FeatureTracker.html#a4796a29c1f89cde0ace1668fc8fcd9a3">trackDynamicKLT()</a>.</p>

</div>
</div>
<a id="a674be7a497efeed1cf90fe3ae44c86d7" name="a674be7a497efeed1cf90fe3ae44c86d7"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a674be7a497efeed1cf90fe3ae44c86d7">&#9670;&#160;</a></span>previous_tracked_frame_</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">Frame::Ptr dyno::FeatureTracker::previous_tracked_frame_</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">private</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">
<b>Initial value:</b><div class="fragment"><div class="line">{</div>
<div class="line">      <span class="keyword">nullptr</span>}</div>
</div><!-- fragment --><p>The frame that will be used as the previous frame next time track is called. After track, this is actually the frame that <a class="el" href="classdyno_1_1FeatureTracker.html#a40ee79c94fe2de7f16d2a4508cc2ba11">track()</a> returns </p>

<p class="definition">Definition at line <a class="el" href="FeatureTracker_8hpp_source.html#l00162">162</a> of file <a class="el" href="FeatureTracker_8hpp_source.html">FeatureTracker.hpp</a>.</p>

<p class="reference">Referenced by <a class="el" href="classdyno_1_1FeatureTracker.html#a96eacfcb1a94b8061bb8bde6926c889c">getPreviousFrame()</a>, and <a class="el" href="classdyno_1_1FeatureTracker.html#a40ee79c94fe2de7f16d2a4508cc2ba11">track()</a>.</p>

</div>
</div>
<a id="a1ab92bdc22dc50575b8395b4adfae0c1" name="a1ab92bdc22dc50575b8395b4adfae0c1"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a1ab92bdc22dc50575b8395b4adfae0c1">&#9670;&#160;</a></span>static_feature_tracker_</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">StaticFeatureTracker::UniquePtr dyno::FeatureTracker::static_feature_tracker_</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">private</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">
<p>The frame that has just beed used to track on a new frame is created. </p>

<p class="definition">Definition at line <a class="el" href="FeatureTracker_8hpp_source.html#l00165">165</a> of file <a class="el" href="FeatureTracker_8hpp_source.html">FeatureTracker.hpp</a>.</p>

<p class="reference">Referenced by <a class="el" href="classdyno_1_1FeatureTracker.html#aa1858ceb580cb42aff98e3b57bfe9303">FeatureTracker()</a>, and <a class="el" href="classdyno_1_1FeatureTracker.html#a40ee79c94fe2de7f16d2a4508cc2ba11">track()</a>.</p>

</div>
</div>
<hr/>The documentation for this class was generated from the following files:<ul>
<li>dynosam/include/dynosam/frontend/vision/<a class="el" href="FeatureTracker_8hpp_source.html">FeatureTracker.hpp</a></li>
<li>dynosam/src/frontend/vision/<a class="el" href="FeatureTracker_8cc_source.html">FeatureTracker.cc</a></li>
</ul>
</div><!-- contents -->
<!-- start footer part -->
<hr class="footer"/><address class="footer"><small>
Generated by&#160;<a href="https://www.doxygen.org/index.html"><img class="footer" src="doxygen.svg" width="104" height="31" alt="doxygen"/></a> 1.9.6
</small></address>
</body>
</html>
